function _mergeNamespaces(s,i){for(var a=0;a<i.length;a++){const d=i[a];if(typeof d!="string"&&!Array.isArray(d)){for(const g in d)if(g!=="default"&&!(g in s)){const b=Object.getOwnPropertyDescriptor(d,g);b&&Object.defineProperty(s,g,b.get?b:{enumerable:!0,get:()=>d[g]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))d(g);new MutationObserver(g=>{for(const b of g)if(b.type==="childList")for(const $ of b.addedNodes)$.tagName==="LINK"&&$.rel==="modulepreload"&&d($)}).observe(document,{childList:!0,subtree:!0});function a(g){const b={};return g.integrity&&(b.integrity=g.integrity),g.referrerPolicy&&(b.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?b.credentials="include":g.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function d(g){if(g.ep)return;g.ep=!0;const b=a(g);fetch(g.href,b)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function getAugmentedNamespace(s){if(s.__esModule)return s;var i=s.default;if(typeof i=="function"){var a=function d(){return this instanceof d?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};a.prototype=i.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(s).forEach(function(d){var g=Object.getOwnPropertyDescriptor(s,d);Object.defineProperty(a,d,g.get?g:{enumerable:!0,get:function(){return s[d]}})}),a}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(s){return s===null||typeof s!="object"?null:(s=z$1&&s[z$1]||s["@@iterator"],typeof s=="function"?s:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(s,i,a){this.props=s,this.context=i,this.refs=D$1,this.updater=a||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(s,i){if(typeof s!="object"&&typeof s!="function"&&s!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,s,i,"setState")};E$1.prototype.forceUpdate=function(s){this.updater.enqueueForceUpdate(this,s,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(s,i,a){this.props=s,this.context=i,this.refs=D$1,this.updater=a||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(s,i,a){var d,g={},b=null,$=null;if(i!=null)for(d in i.ref!==void 0&&($=i.ref),i.key!==void 0&&(b=""+i.key),i)J.call(i,d)&&!L$1.hasOwnProperty(d)&&(g[d]=i[d]);var tt=arguments.length-2;if(tt===1)g.children=a;else if(1<tt){for(var it=Array(tt),rt=0;rt<tt;rt++)it[rt]=arguments[rt+2];g.children=it}if(s&&s.defaultProps)for(d in tt=s.defaultProps,tt)g[d]===void 0&&(g[d]=tt[d]);return{$$typeof:l$1,type:s,key:b,ref:$,props:g,_owner:K$1.current}}function N$1(s,i){return{$$typeof:l$1,type:s.type,key:i,ref:s.ref,props:s.props,_owner:s._owner}}function O$1(s){return typeof s=="object"&&s!==null&&s.$$typeof===l$1}function escape(s){var i={"=":"=0",":":"=2"};return"$"+s.replace(/[=:]/g,function(a){return i[a]})}var P$1=/\/+/g;function Q$1(s,i){return typeof s=="object"&&s!==null&&s.key!=null?escape(""+s.key):i.toString(36)}function R$1(s,i,a,d,g){var b=typeof s;(b==="undefined"||b==="boolean")&&(s=null);var $=!1;if(s===null)$=!0;else switch(b){case"string":case"number":$=!0;break;case"object":switch(s.$$typeof){case l$1:case n$1:$=!0}}if($)return $=s,g=g($),s=d===""?"."+Q$1($,0):d,I$1(g)?(a="",s!=null&&(a=s.replace(P$1,"$&/")+"/"),R$1(g,i,a,"",function(rt){return rt})):g!=null&&(O$1(g)&&(g=N$1(g,a+(!g.key||$&&$.key===g.key?"":(""+g.key).replace(P$1,"$&/")+"/")+s)),i.push(g)),1;if($=0,d=d===""?".":d+":",I$1(s))for(var tt=0;tt<s.length;tt++){b=s[tt];var it=d+Q$1(b,tt);$+=R$1(b,i,a,it,g)}else if(it=A$1(s),typeof it=="function")for(s=it.call(s),tt=0;!(b=s.next()).done;)b=b.value,it=d+Q$1(b,tt++),$+=R$1(b,i,a,it,g);else if(b==="object")throw i=String(s),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return $}function S$1(s,i,a){if(s==null)return s;var d=[],g=0;return R$1(s,d,"","",function(b){return i.call(a,b,g++)}),d}function T$1(s){if(s._status===-1){var i=s._result;i=i(),i.then(function(a){(s._status===0||s._status===-1)&&(s._status=1,s._result=a)},function(a){(s._status===0||s._status===-1)&&(s._status=2,s._result=a)}),s._status===-1&&(s._status=0,s._result=i)}if(s._status===1)return s._result.default;throw s._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(s,i,a){S$1(s,function(){i.apply(this,arguments)},a)},count:function(s){var i=0;return S$1(s,function(){i++}),i},toArray:function(s){return S$1(s,function(i){return i})||[]},only:function(s){if(!O$1(s))throw Error("React.Children.only expected to receive a single React element child.");return s}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(s,i,a){if(s==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+s+".");var d=C$1({},s.props),g=s.key,b=s.ref,$=s._owner;if(i!=null){if(i.ref!==void 0&&(b=i.ref,$=K$1.current),i.key!==void 0&&(g=""+i.key),s.type&&s.type.defaultProps)var tt=s.type.defaultProps;for(it in i)J.call(i,it)&&!L$1.hasOwnProperty(it)&&(d[it]=i[it]===void 0&&tt!==void 0?tt[it]:i[it])}var it=arguments.length-2;if(it===1)d.children=a;else if(1<it){tt=Array(it);for(var rt=0;rt<it;rt++)tt[rt]=arguments[rt+2];d.children=tt}return{$$typeof:l$1,type:s.type,key:g,ref:b,props:d,_owner:$}};react_production_min.createContext=function(s){return s={$$typeof:u,_currentValue:s,_currentValue2:s,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},s.Provider={$$typeof:t,_context:s},s.Consumer=s};react_production_min.createElement=M$1;react_production_min.createFactory=function(s){var i=M$1.bind(null,s);return i.type=s,i};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(s){return{$$typeof:v$1,render:s}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(s){return{$$typeof:y,_payload:{_status:-1,_result:s},_init:T$1}};react_production_min.memo=function(s,i){return{$$typeof:x,type:s,compare:i===void 0?null:i}};react_production_min.startTransition=function(s){var i=V$1.transition;V$1.transition={};try{s()}finally{V$1.transition=i}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(s,i){return U$1.current.useCallback(s,i)};react_production_min.useContext=function(s){return U$1.current.useContext(s)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(s){return U$1.current.useDeferredValue(s)};react_production_min.useEffect=function(s,i){return U$1.current.useEffect(s,i)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(s,i,a){return U$1.current.useImperativeHandle(s,i,a)};react_production_min.useInsertionEffect=function(s,i){return U$1.current.useInsertionEffect(s,i)};react_production_min.useLayoutEffect=function(s,i){return U$1.current.useLayoutEffect(s,i)};react_production_min.useMemo=function(s,i){return U$1.current.useMemo(s,i)};react_production_min.useReducer=function(s,i,a){return U$1.current.useReducer(s,i,a)};react_production_min.useRef=function(s){return U$1.current.useRef(s)};react_production_min.useState=function(s){return U$1.current.useState(s)};react_production_min.useSyncExternalStore=function(s,i,a){return U$1.current.useSyncExternalStore(s,i,a)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(s,i,a){var d,g={},b=null,$=null;a!==void 0&&(b=""+a),i.key!==void 0&&(b=""+i.key),i.ref!==void 0&&($=i.ref);for(d in i)m$1.call(i,d)&&!p$1.hasOwnProperty(d)&&(g[d]=i[d]);if(s&&s.defaultProps)for(d in i=s.defaultProps,i)g[d]===void 0&&(g[d]=i[d]);return{$$typeof:k,type:s,key:b,ref:$,props:g,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(s){function i(St,Bt){var Pt=St.length;St.push(Bt);e:for(;0<Pt;){var Gt=Pt-1>>>1,Qt=St[Gt];if(0<g(Qt,Bt))St[Gt]=Bt,St[Pt]=Qt,Pt=Gt;else break e}}function a(St){return St.length===0?null:St[0]}function d(St){if(St.length===0)return null;var Bt=St[0],Pt=St.pop();if(Pt!==Bt){St[0]=Pt;e:for(var Gt=0,Qt=St.length,On=Qt>>>1;Gt<On;){var Dn=2*(Gt+1)-1,vr=St[Dn],sr=Dn+1,jr=St[sr];if(0>g(vr,Pt))sr<Qt&&0>g(jr,vr)?(St[Gt]=jr,St[sr]=Pt,Gt=sr):(St[Gt]=vr,St[Dn]=Pt,Gt=Dn);else if(sr<Qt&&0>g(jr,Pt))St[Gt]=jr,St[sr]=Pt,Gt=sr;else break e}}return Bt}function g(St,Bt){var Pt=St.sortIndex-Bt.sortIndex;return Pt!==0?Pt:St.id-Bt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var b=performance;s.unstable_now=function(){return b.now()}}else{var $=Date,tt=$.now();s.unstable_now=function(){return $.now()-tt}}var it=[],rt=[],ot=1,lt=null,ut=3,pt=!1,_t=!1,wt=!1,vt=typeof setTimeout=="function"?setTimeout:null,ht=typeof clearTimeout=="function"?clearTimeout:null,ft=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function mt(St){for(var Bt=a(rt);Bt!==null;){if(Bt.callback===null)d(rt);else if(Bt.startTime<=St)d(rt),Bt.sortIndex=Bt.expirationTime,i(it,Bt);else break;Bt=a(rt)}}function bt(St){if(wt=!1,mt(St),!_t)if(a(it)!==null)_t=!0,Dt(Et);else{var Bt=a(rt);Bt!==null&&Vt(bt,Bt.startTime-St)}}function Et(St,Bt){_t=!1,wt&&(wt=!1,ht(jt),jt=-1),pt=!0;var Pt=ut;try{for(mt(Bt),lt=a(it);lt!==null&&(!(lt.expirationTime>Bt)||St&&!qt());){var Gt=lt.callback;if(typeof Gt=="function"){lt.callback=null,ut=lt.priorityLevel;var Qt=Gt(lt.expirationTime<=Bt);Bt=s.unstable_now(),typeof Qt=="function"?lt.callback=Qt:lt===a(it)&&d(it),mt(Bt)}else d(it);lt=a(it)}if(lt!==null)var On=!0;else{var Dn=a(rt);Dn!==null&&Vt(bt,Dn.startTime-Bt),On=!1}return On}finally{lt=null,ut=Pt,pt=!1}}var It=!1,Ot=null,jt=-1,xt=5,Lt=-1;function qt(){return!(s.unstable_now()-Lt<xt)}function Yt(){if(Ot!==null){var St=s.unstable_now();Lt=St;var Bt=!0;try{Bt=Ot(!0,St)}finally{Bt?$n():(It=!1,Ot=null)}}else It=!1}var $n;if(typeof ft=="function")$n=function(){ft(Yt)};else if(typeof MessageChannel<"u"){var $t=new MessageChannel,Rt=$t.port2;$t.port1.onmessage=Yt,$n=function(){Rt.postMessage(null)}}else $n=function(){vt(Yt,0)};function Dt(St){Ot=St,It||(It=!0,$n())}function Vt(St,Bt){jt=vt(function(){St(s.unstable_now())},Bt)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(St){St.callback=null},s.unstable_continueExecution=function(){_t||pt||(_t=!0,Dt(Et))},s.unstable_forceFrameRate=function(St){0>St||125<St?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xt=0<St?Math.floor(1e3/St):5},s.unstable_getCurrentPriorityLevel=function(){return ut},s.unstable_getFirstCallbackNode=function(){return a(it)},s.unstable_next=function(St){switch(ut){case 1:case 2:case 3:var Bt=3;break;default:Bt=ut}var Pt=ut;ut=Bt;try{return St()}finally{ut=Pt}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(St,Bt){switch(St){case 1:case 2:case 3:case 4:case 5:break;default:St=3}var Pt=ut;ut=St;try{return Bt()}finally{ut=Pt}},s.unstable_scheduleCallback=function(St,Bt,Pt){var Gt=s.unstable_now();switch(typeof Pt=="object"&&Pt!==null?(Pt=Pt.delay,Pt=typeof Pt=="number"&&0<Pt?Gt+Pt:Gt):Pt=Gt,St){case 1:var Qt=-1;break;case 2:Qt=250;break;case 5:Qt=1073741823;break;case 4:Qt=1e4;break;default:Qt=5e3}return Qt=Pt+Qt,St={id:ot++,callback:Bt,priorityLevel:St,startTime:Pt,expirationTime:Qt,sortIndex:-1},Pt>Gt?(St.sortIndex=Pt,i(rt,St),a(it)===null&&St===a(rt)&&(wt?(ht(jt),jt=-1):wt=!0,Vt(bt,Pt-Gt))):(St.sortIndex=Qt,i(it,St),_t||pt||(_t=!0,Dt(Et))),St},s.unstable_shouldYield=qt,s.unstable_wrapCallback=function(St){var Bt=ut;return function(){var Pt=ut;ut=Bt;try{return St.apply(this,arguments)}finally{ut=Pt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(s,i){ha(s,i),ha(s+"Capture",i)}function ha(s,i){for(ea[s]=i,s=0;s<i.length;s++)da.add(i[s])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(s){return ja.call(ma,s)?!0:ja.call(la,s)?!1:ka.test(s)?ma[s]=!0:(la[s]=!0,!1)}function pa(s,i,a,d){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return d?!1:a!==null?!a.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function qa(s,i,a,d){if(i===null||typeof i>"u"||pa(s,i,a,d))return!0;if(d)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function v(s,i,a,d,g,b,$){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=d,this.attributeNamespace=g,this.mustUseProperty=a,this.propertyName=s,this.type=i,this.sanitizeURL=b,this.removeEmptyString=$}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){z[s]=new v(s,0,!1,s,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];z[i]=new v(i,1,!1,s[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(s){z[s]=new v(s,2,!1,s.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){z[s]=new v(s,2,!1,s,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){z[s]=new v(s,3,!1,s.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(s){z[s]=new v(s,3,!0,s,null,!1,!1)});["capture","download"].forEach(function(s){z[s]=new v(s,4,!1,s,null,!1,!1)});["cols","rows","size","span"].forEach(function(s){z[s]=new v(s,6,!1,s,null,!1,!1)});["rowSpan","start"].forEach(function(s){z[s]=new v(s,5,!1,s.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(ra,sa);z[i]=new v(i,1,!1,s,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(ra,sa);z[i]=new v(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(ra,sa);z[i]=new v(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(s){z[s]=new v(s,1,!1,s.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(s){z[s]=new v(s,1,!1,s.toLowerCase(),null,!0,!0)});function ta(s,i,a,d){var g=z.hasOwnProperty(i)?z[i]:null;(g!==null?g.type!==0:d||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(qa(i,a,g,d)&&(a=null),d||g===null?oa(i)&&(a===null?s.removeAttribute(i):s.setAttribute(i,""+a)):g.mustUseProperty?s[g.propertyName]=a===null?g.type===3?!1:"":a:(i=g.attributeName,d=g.attributeNamespace,a===null?s.removeAttribute(i):(g=g.type,a=g===3||g===4&&a===!0?"":""+a,d?s.setAttributeNS(d,i,a):s.setAttribute(i,a))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(s){return s===null||typeof s!="object"?null:(s=Ja&&s[Ja]||s["@@iterator"],typeof s=="function"?s:null)}var A=Object.assign,La;function Ma(s){if(La===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);La=i&&i[1]||""}return`
`+La+s}var Na=!1;function Oa(s,i){if(!s||Na)return"";Na=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(rt){var d=rt}Reflect.construct(s,[],i)}else{try{i.call()}catch(rt){d=rt}s.call(i.prototype)}else{try{throw Error()}catch(rt){d=rt}s()}}catch(rt){if(rt&&d&&typeof rt.stack=="string"){for(var g=rt.stack.split(`
`),b=d.stack.split(`
`),$=g.length-1,tt=b.length-1;1<=$&&0<=tt&&g[$]!==b[tt];)tt--;for(;1<=$&&0<=tt;$--,tt--)if(g[$]!==b[tt]){if($!==1||tt!==1)do if($--,tt--,0>tt||g[$]!==b[tt]){var it=`
`+g[$].replace(" at new "," at ");return s.displayName&&it.includes("<anonymous>")&&(it=it.replace("<anonymous>",s.displayName)),it}while(1<=$&&0<=tt);break}}}finally{Na=!1,Error.prepareStackTrace=a}return(s=s?s.displayName||s.name:"")?Ma(s):""}function Pa(s){switch(s.tag){case 5:return Ma(s.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return s=Oa(s.type,!1),s;case 11:return s=Oa(s.type.render,!1),s;case 1:return s=Oa(s.type,!0),s;default:return""}}function Qa(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case Ca:return(s.displayName||"Context")+".Consumer";case Ba:return(s._context.displayName||"Context")+".Provider";case Da:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Ga:return i=s.displayName||null,i!==null?i:Qa(s.type)||"Memo";case Ha:i=s._payload,s=s._init;try{return Qa(s(i))}catch{}}return null}function Ra(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(i);case 8:return i===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Sa(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ta(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ua(s){var i=Ta(s)?"checked":"value",a=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),d=""+s[i];if(!s.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var g=a.get,b=a.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return g.call(this)},set:function($){d=""+$,b.call(this,$)}}),Object.defineProperty(s,i,{enumerable:a.enumerable}),{getValue:function(){return d},setValue:function($){d=""+$},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Va(s){s._valueTracker||(s._valueTracker=Ua(s))}function Wa(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var a=i.getValue(),d="";return s&&(d=Ta(s)?s.checked?"true":"false":s.value),s=d,s!==a?(i.setValue(s),!0):!1}function Xa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ya(s,i){var a=i.checked;return A({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??s._wrapperState.initialChecked})}function Za(s,i){var a=i.defaultValue==null?"":i.defaultValue,d=i.checked!=null?i.checked:i.defaultChecked;a=Sa(i.value!=null?i.value:a),s._wrapperState={initialChecked:d,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function ab(s,i){i=i.checked,i!=null&&ta(s,"checked",i,!1)}function bb(s,i){ab(s,i);var a=Sa(i.value),d=i.type;if(a!=null)d==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+a):s.value!==""+a&&(s.value=""+a);else if(d==="submit"||d==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?cb(s,i.type,a):i.hasOwnProperty("defaultValue")&&cb(s,i.type,Sa(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function db$1(s,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var d=i.type;if(!(d!=="submit"&&d!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,a||i===s.value||(s.value=i),s.defaultValue=i}a=s.name,a!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,a!==""&&(s.name=a)}function cb(s,i,a){(i!=="number"||Xa(s.ownerDocument)!==s)&&(a==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+a&&(s.defaultValue=""+a))}var eb=Array.isArray;function fb(s,i,a,d){if(s=s.options,i){i={};for(var g=0;g<a.length;g++)i["$"+a[g]]=!0;for(a=0;a<s.length;a++)g=i.hasOwnProperty("$"+s[a].value),s[a].selected!==g&&(s[a].selected=g),g&&d&&(s[a].defaultSelected=!0)}else{for(a=""+Sa(a),i=null,g=0;g<s.length;g++){if(s[g].value===a){s[g].selected=!0,d&&(s[g].defaultSelected=!0);return}i!==null||s[g].disabled||(i=s[g])}i!==null&&(i.selected=!0)}}function gb(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function hb(s,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(p(92));if(eb(a)){if(1<a.length)throw Error(p(93));a=a[0]}i=a}i==null&&(i=""),a=i}s._wrapperState={initialValue:Sa(a)}}function ib(s,i){var a=Sa(i.value),d=Sa(i.defaultValue);a!=null&&(a=""+a,a!==s.value&&(s.value=a),i.defaultValue==null&&s.defaultValue!==a&&(s.defaultValue=a)),d!=null&&(s.defaultValue=""+d)}function jb(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function kb(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?kb(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var mb,nb=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,d,g){MSApp.execUnsafeLocalFunction(function(){return s(i,a,d,g)})}:s}(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=mb.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function ob(s,i){if(i){var a=s.firstChild;if(a&&a===s.lastChild&&a.nodeType===3){a.nodeValue=i;return}}s.textContent=i}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(s){qb.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),pb[i]=pb[s]})});function rb(s,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||pb.hasOwnProperty(s)&&pb[s]?(""+i).trim():i+"px"}function sb(s,i){s=s.style;for(var a in i)if(i.hasOwnProperty(a)){var d=a.indexOf("--")===0,g=rb(a,i[a],d);a==="float"&&(a="cssFloat"),d?s.setProperty(a,g):s[a]=g}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(s,i){if(i){if(tb[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(p(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(p(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(p(61))}if(i.style!=null&&typeof i.style!="object")throw Error(p(62))}}function vb(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var yb=null,zb=null,Ab=null;function Bb(s){if(s=Cb(s)){if(typeof yb!="function")throw Error(p(280));var i=s.stateNode;i&&(i=Db(i),yb(s.stateNode,s.type,i))}}function Eb(s){zb?Ab?Ab.push(s):Ab=[s]:zb=s}function Fb(){if(zb){var s=zb,i=Ab;if(Ab=zb=null,Bb(s),i)for(s=0;s<i.length;s++)Bb(i[s])}}function Gb(s,i){return s(i)}function Hb(){}var Ib=!1;function Jb(s,i,a){if(Ib)return s(i,a);Ib=!0;try{return Gb(s,i,a)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(s,i){var a=s.stateNode;if(a===null)return null;var d=Db(a);if(d===null)return null;a=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(a&&typeof a!="function")throw Error(p(231,i,typeof a));return a}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(s,i,a,d,g,b,$,tt,it){var rt=Array.prototype.slice.call(arguments,3);try{i.apply(a,rt)}catch(ot){this.onError(ot)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(s){Ob=!0,Pb=s}};function Tb(s,i,a,d,g,b,$,tt,it){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(s,i,a,d,g,b,$,tt,it){if(Tb.apply(this,arguments),Ob){if(Ob){var rt=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=rt)}}function Vb(s){var i=s,a=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,i.flags&4098&&(a=i.return),s=i.return;while(s)}return i.tag===3?a:null}function Wb(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function Xb(s){if(Vb(s)!==s)throw Error(p(188))}function Yb(s){var i=s.alternate;if(!i){if(i=Vb(s),i===null)throw Error(p(188));return i!==s?null:s}for(var a=s,d=i;;){var g=a.return;if(g===null)break;var b=g.alternate;if(b===null){if(d=g.return,d!==null){a=d;continue}break}if(g.child===b.child){for(b=g.child;b;){if(b===a)return Xb(g),s;if(b===d)return Xb(g),i;b=b.sibling}throw Error(p(188))}if(a.return!==d.return)a=g,d=b;else{for(var $=!1,tt=g.child;tt;){if(tt===a){$=!0,a=g,d=b;break}if(tt===d){$=!0,d=g,a=b;break}tt=tt.sibling}if(!$){for(tt=b.child;tt;){if(tt===a){$=!0,a=b,d=g;break}if(tt===d){$=!0,d=b,a=g;break}tt=tt.sibling}if(!$)throw Error(p(189))}}if(a.alternate!==d)throw Error(p(190))}if(a.tag!==3)throw Error(p(188));return a.stateNode.current===a?s:i}function Zb(s){return s=Yb(s),s!==null?$b(s):null}function $b(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=$b(s);if(i!==null)return i;s=s.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(s){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,s,void 0,(s.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(s){return s>>>=0,s===0?32:31-(pc(s)/qc|0)|0}var rc=64,sc=4194304;function tc(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function uc(s,i){var a=s.pendingLanes;if(a===0)return 0;var d=0,g=s.suspendedLanes,b=s.pingedLanes,$=a&268435455;if($!==0){var tt=$&~g;tt!==0?d=tc(tt):(b&=$,b!==0&&(d=tc(b)))}else $=a&~g,$!==0?d=tc($):b!==0&&(d=tc(b));if(d===0)return 0;if(i!==0&&i!==d&&!(i&g)&&(g=d&-d,b=i&-i,g>=b||g===16&&(b&4194240)!==0))return i;if(d&4&&(d|=a&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=d;0<i;)a=31-oc(i),g=1<<a,d|=s[a],i&=~g;return d}function vc(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(s,i){for(var a=s.suspendedLanes,d=s.pingedLanes,g=s.expirationTimes,b=s.pendingLanes;0<b;){var $=31-oc(b),tt=1<<$,it=g[$];it===-1?(!(tt&a)||tt&d)&&(g[$]=vc(tt,i)):it<=i&&(s.expiredLanes|=tt),b&=~tt}}function xc(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function yc(){var s=rc;return rc<<=1,!(rc&4194240)&&(rc=64),s}function zc(s){for(var i=[],a=0;31>a;a++)i.push(s);return i}function Ac(s,i,a){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-oc(i),s[i]=a}function Bc(s,i){var a=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var d=s.eventTimes;for(s=s.expirationTimes;0<a;){var g=31-oc(a),b=1<<g;i[g]=0,d[g]=-1,s[g]=-1,a&=~b}}function Cc(s,i){var a=s.entangledLanes|=i;for(s=s.entanglements;a;){var d=31-oc(a),g=1<<d;g&i|s[d]&i&&(s[d]|=i),a&=~g}}var C=0;function Dc(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(s,i){switch(s){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(i.pointerId)}}function Tc(s,i,a,d,g,b){return s===null||s.nativeEvent!==b?(s={blockedOn:i,domEventName:a,eventSystemFlags:d,nativeEvent:b,targetContainers:[g]},i!==null&&(i=Cb(i),i!==null&&Fc(i)),s):(s.eventSystemFlags|=d,i=s.targetContainers,g!==null&&i.indexOf(g)===-1&&i.push(g),s)}function Uc(s,i,a,d,g){switch(i){case"focusin":return Lc=Tc(Lc,s,i,a,d,g),!0;case"dragenter":return Mc=Tc(Mc,s,i,a,d,g),!0;case"mouseover":return Nc=Tc(Nc,s,i,a,d,g),!0;case"pointerover":var b=g.pointerId;return Oc.set(b,Tc(Oc.get(b)||null,s,i,a,d,g)),!0;case"gotpointercapture":return b=g.pointerId,Pc.set(b,Tc(Pc.get(b)||null,s,i,a,d,g)),!0}return!1}function Vc(s){var i=Wc(s.target);if(i!==null){var a=Vb(i);if(a!==null){if(i=a.tag,i===13){if(i=Wb(a),i!==null){s.blockedOn=i,Ic(s.priority,function(){Gc(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){s.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Xc(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var a=Yc(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(a===null){a=s.nativeEvent;var d=new a.constructor(a.type,a);wb=d,a.target.dispatchEvent(d),wb=null}else return i=Cb(a),i!==null&&Fc(i),s.blockedOn=a,!1;i.shift()}return!0}function Zc(s,i,a){Xc(s)&&a.delete(i)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(s,i){s.blockedOn===i&&(s.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(s){function i(g){return ad(g,s)}if(0<Kc.length){ad(Kc[0],s);for(var a=1;a<Kc.length;a++){var d=Kc[a];d.blockedOn===s&&(d.blockedOn=null)}}for(Lc!==null&&ad(Lc,s),Mc!==null&&ad(Mc,s),Nc!==null&&ad(Nc,s),Oc.forEach(i),Pc.forEach(i),a=0;a<Qc.length;a++)d=Qc[a],d.blockedOn===s&&(d.blockedOn=null);for(;0<Qc.length&&(a=Qc[0],a.blockedOn===null);)Vc(a),a.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(s,i,a,d){var g=C,b=cd.transition;cd.transition=null;try{C=1,fd(s,i,a,d)}finally{C=g,cd.transition=b}}function gd(s,i,a,d){var g=C,b=cd.transition;cd.transition=null;try{C=4,fd(s,i,a,d)}finally{C=g,cd.transition=b}}function fd(s,i,a,d){if(dd){var g=Yc(s,i,a,d);if(g===null)hd(s,i,d,id,a),Sc(s,d);else if(Uc(g,s,i,a,d))d.stopPropagation();else if(Sc(s,d),i&4&&-1<Rc.indexOf(s)){for(;g!==null;){var b=Cb(g);if(b!==null&&Ec(b),b=Yc(s,i,a,d),b===null&&hd(s,i,d,id,a),b===g)break;g=b}g!==null&&d.stopPropagation()}else hd(s,i,d,null,a)}}var id=null;function Yc(s,i,a,d){if(id=null,s=xb(d),s=Wc(s),s!==null)if(i=Vb(s),i===null)s=null;else if(a=i.tag,a===13){if(s=Wb(i),s!==null)return s;s=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return id=s,null}function jd(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var s,i=ld,a=i.length,d,g="value"in kd?kd.value:kd.textContent,b=g.length;for(s=0;s<a&&i[s]===g[s];s++);var $=a-s;for(d=1;d<=$&&i[a-d]===g[b-d];d++);return md=g.slice(s,1<d?1-d:void 0)}function od(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function pd(){return!0}function qd(){return!1}function rd(s){function i(a,d,g,b,$){this._reactName=a,this._targetInst=g,this.type=d,this.nativeEvent=b,this.target=$,this.currentTarget=null;for(var tt in s)s.hasOwnProperty(tt)&&(a=s[tt],this[tt]=a?a(b):b[tt]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),i}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==yd&&(yd&&s.type==="mousemove"?(wd=s.screenX-yd.screenX,xd=s.screenY-yd.screenY):xd=wd=0,yd=s),wd)},movementY:function(s){return"movementY"in s?s.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Od[s])?!!i[s]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(s){if(s.key){var i=Md[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=od(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Nd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(s){return s.type==="keypress"?od(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?od(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(s,i){switch(s){case"keyup":return $d.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ie=!1;function je(s,i){switch(s){case"compositionend":return he(i);case"keypress":return i.which!==32?null:(fe=!0,ee);case"textInput":return s=i.data,s===ee&&fe?null:s;default:return null}}function ke(s,i){if(ie)return s==="compositionend"||!ae&&ge(s,i)?(s=nd(),md=ld=kd=null,ie=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return de&&i.locale!=="ko"?null:i.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!le[s.type]:i==="textarea"}function ne(s,i,a,d){Eb(d),i=oe(i,"onChange"),0<i.length&&(a=new td("onChange","change",null,a,d),s.push({event:a,listeners:i}))}var pe=null,qe=null;function re(s){se(s,0)}function te(s){var i=ue(s);if(Wa(i))return s}function ve(s,i){if(s==="change")return i}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(s){if(s.propertyName==="value"&&te(qe)){var i=[];ne(i,qe,s,xb(s)),Jb(re,i)}}function Ce(s,i,a){s==="focusin"?(Ae(),pe=i,qe=a,pe.attachEvent("onpropertychange",Be)):s==="focusout"&&Ae()}function De(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return te(qe)}function Ee(s,i){if(s==="click")return te(i)}function Fe(s,i){if(s==="input"||s==="change")return te(i)}function Ge(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(s,i){if(He(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var a=Object.keys(s),d=Object.keys(i);if(a.length!==d.length)return!1;for(d=0;d<a.length;d++){var g=a[d];if(!ja.call(i,g)||!He(s[g],i[g]))return!1}return!0}function Je(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ke(s,i){var a=Je(s);s=0;for(var d;a;){if(a.nodeType===3){if(d=s+a.textContent.length,s<=i&&d>=i)return{node:a,offset:i-s};s=d}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Je(a)}}function Le(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?Le(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Me(){for(var s=window,i=Xa();i instanceof s.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)s=i.contentWindow;else break;i=Xa(s.document)}return i}function Ne(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function Oe(s){var i=Me(),a=s.focusedElem,d=s.selectionRange;if(i!==a&&a&&a.ownerDocument&&Le(a.ownerDocument.documentElement,a)){if(d!==null&&Ne(a)){if(i=d.start,s=d.end,s===void 0&&(s=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(s,a.value.length);else if(s=(i=a.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var g=a.textContent.length,b=Math.min(d.start,g);d=d.end===void 0?b:Math.min(d.end,g),!s.extend&&b>d&&(g=d,d=b,b=g),g=Ke(a,b);var $=Ke(a,d);g&&$&&(s.rangeCount!==1||s.anchorNode!==g.node||s.anchorOffset!==g.offset||s.focusNode!==$.node||s.focusOffset!==$.offset)&&(i=i.createRange(),i.setStart(g.node,g.offset),s.removeAllRanges(),b>d?(s.addRange(i),s.extend($.node,$.offset)):(i.setEnd($.node,$.offset),s.addRange(i)))}}for(i=[],s=a;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)s=i[a],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(s,i,a){var d=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Te||Qe==null||Qe!==Xa(d)||(d=Qe,"selectionStart"in d&&Ne(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Se&&Ie(Se,d)||(Se=d,d=oe(Re,"onSelect"),0<d.length&&(i=new td("onSelect","select",null,i,a),s.push({event:i,listeners:d}),i.target=Qe)))}function Ve(s,i){var a={};return a[s.toLowerCase()]=i.toLowerCase(),a["Webkit"+s]="webkit"+i,a["Moz"+s]="moz"+i,a}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(s){if(Xe[s])return Xe[s];if(!We[s])return s;var i=We[s],a;for(a in i)if(i.hasOwnProperty(a)&&a in Ye)return Xe[s]=i[a];return s}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(s,i){df.set(s,i),fa(i,[s])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(s,i,a){var d=s.type||"unknown-event";s.currentTarget=a,Ub(d,i,void 0,s),s.currentTarget=null}function se(s,i){i=(i&4)!==0;for(var a=0;a<s.length;a++){var d=s[a],g=d.event;d=d.listeners;e:{var b=void 0;if(i)for(var $=d.length-1;0<=$;$--){var tt=d[$],it=tt.instance,rt=tt.currentTarget;if(tt=tt.listener,it!==b&&g.isPropagationStopped())break e;nf(g,tt,rt),b=it}else for($=0;$<d.length;$++){if(tt=d[$],it=tt.instance,rt=tt.currentTarget,tt=tt.listener,it!==b&&g.isPropagationStopped())break e;nf(g,tt,rt),b=it}}}if(Qb)throw s=Rb,Qb=!1,Rb=null,s}function D(s,i){var a=i[of];a===void 0&&(a=i[of]=new Set);var d=s+"__bubble";a.has(d)||(pf(i,s,2,!1),a.add(d))}function qf(s,i,a){var d=0;i&&(d|=4),pf(a,s,d,i)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(s){if(!s[rf]){s[rf]=!0,da.forEach(function(a){a!=="selectionchange"&&(mf.has(a)||qf(a,!1,s),qf(a,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[rf]||(i[rf]=!0,qf("selectionchange",!1,i))}}function pf(s,i,a,d){switch(jd(i)){case 1:var g=ed;break;case 4:g=gd;break;default:g=fd}a=g.bind(null,i,a,s),g=void 0,!Lb||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(g=!0),d?g!==void 0?s.addEventListener(i,a,{capture:!0,passive:g}):s.addEventListener(i,a,!0):g!==void 0?s.addEventListener(i,a,{passive:g}):s.addEventListener(i,a,!1)}function hd(s,i,a,d,g){var b=d;if(!(i&1)&&!(i&2)&&d!==null)e:for(;;){if(d===null)return;var $=d.tag;if($===3||$===4){var tt=d.stateNode.containerInfo;if(tt===g||tt.nodeType===8&&tt.parentNode===g)break;if($===4)for($=d.return;$!==null;){var it=$.tag;if((it===3||it===4)&&(it=$.stateNode.containerInfo,it===g||it.nodeType===8&&it.parentNode===g))return;$=$.return}for(;tt!==null;){if($=Wc(tt),$===null)return;if(it=$.tag,it===5||it===6){d=b=$;continue e}tt=tt.parentNode}}d=d.return}Jb(function(){var rt=b,ot=xb(a),lt=[];e:{var ut=df.get(s);if(ut!==void 0){var pt=td,_t=s;switch(s){case"keypress":if(od(a)===0)break e;case"keydown":case"keyup":pt=Rd;break;case"focusin":_t="focus",pt=Fd;break;case"focusout":_t="blur",pt=Fd;break;case"beforeblur":case"afterblur":pt=Fd;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=Vd;break;case $e:case af:case bf:pt=Hd;break;case cf:pt=Xd;break;case"scroll":pt=vd;break;case"wheel":pt=Zd;break;case"copy":case"cut":case"paste":pt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=Td}var wt=(i&4)!==0,vt=!wt&&s==="scroll",ht=wt?ut!==null?ut+"Capture":null:ut;wt=[];for(var ft=rt,mt;ft!==null;){mt=ft;var bt=mt.stateNode;if(mt.tag===5&&bt!==null&&(mt=bt,ht!==null&&(bt=Kb(ft,ht),bt!=null&&wt.push(tf(ft,bt,mt)))),vt)break;ft=ft.return}0<wt.length&&(ut=new pt(ut,_t,null,a,ot),lt.push({event:ut,listeners:wt}))}}if(!(i&7)){e:{if(ut=s==="mouseover"||s==="pointerover",pt=s==="mouseout"||s==="pointerout",ut&&a!==wb&&(_t=a.relatedTarget||a.fromElement)&&(Wc(_t)||_t[uf]))break e;if((pt||ut)&&(ut=ot.window===ot?ot:(ut=ot.ownerDocument)?ut.defaultView||ut.parentWindow:window,pt?(_t=a.relatedTarget||a.toElement,pt=rt,_t=_t?Wc(_t):null,_t!==null&&(vt=Vb(_t),_t!==vt||_t.tag!==5&&_t.tag!==6)&&(_t=null)):(pt=null,_t=rt),pt!==_t)){if(wt=Bd,bt="onMouseLeave",ht="onMouseEnter",ft="mouse",(s==="pointerout"||s==="pointerover")&&(wt=Td,bt="onPointerLeave",ht="onPointerEnter",ft="pointer"),vt=pt==null?ut:ue(pt),mt=_t==null?ut:ue(_t),ut=new wt(bt,ft+"leave",pt,a,ot),ut.target=vt,ut.relatedTarget=mt,bt=null,Wc(ot)===rt&&(wt=new wt(ht,ft+"enter",_t,a,ot),wt.target=mt,wt.relatedTarget=vt,bt=wt),vt=bt,pt&&_t)t:{for(wt=pt,ht=_t,ft=0,mt=wt;mt;mt=vf(mt))ft++;for(mt=0,bt=ht;bt;bt=vf(bt))mt++;for(;0<ft-mt;)wt=vf(wt),ft--;for(;0<mt-ft;)ht=vf(ht),mt--;for(;ft--;){if(wt===ht||ht!==null&&wt===ht.alternate)break t;wt=vf(wt),ht=vf(ht)}wt=null}else wt=null;pt!==null&&wf(lt,ut,pt,wt,!1),_t!==null&&vt!==null&&wf(lt,vt,_t,wt,!0)}}e:{if(ut=rt?ue(rt):window,pt=ut.nodeName&&ut.nodeName.toLowerCase(),pt==="select"||pt==="input"&&ut.type==="file")var Et=ve;else if(me(ut))if(we)Et=Fe;else{Et=De;var It=Ce}else(pt=ut.nodeName)&&pt.toLowerCase()==="input"&&(ut.type==="checkbox"||ut.type==="radio")&&(Et=Ee);if(Et&&(Et=Et(s,rt))){ne(lt,Et,a,ot);break e}It&&It(s,ut,rt),s==="focusout"&&(It=ut._wrapperState)&&It.controlled&&ut.type==="number"&&cb(ut,"number",ut.value)}switch(It=rt?ue(rt):window,s){case"focusin":(me(It)||It.contentEditable==="true")&&(Qe=It,Re=rt,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(lt,a,ot);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(lt,a,ot)}var Ot;if(ae)e:{switch(s){case"compositionstart":var jt="onCompositionStart";break e;case"compositionend":jt="onCompositionEnd";break e;case"compositionupdate":jt="onCompositionUpdate";break e}jt=void 0}else ie?ge(s,a)&&(jt="onCompositionEnd"):s==="keydown"&&a.keyCode===229&&(jt="onCompositionStart");jt&&(de&&a.locale!=="ko"&&(ie||jt!=="onCompositionStart"?jt==="onCompositionEnd"&&ie&&(Ot=nd()):(kd=ot,ld="value"in kd?kd.value:kd.textContent,ie=!0)),It=oe(rt,jt),0<It.length&&(jt=new Ld(jt,s,null,a,ot),lt.push({event:jt,listeners:It}),Ot?jt.data=Ot:(Ot=he(a),Ot!==null&&(jt.data=Ot)))),(Ot=ce?je(s,a):ke(s,a))&&(rt=oe(rt,"onBeforeInput"),0<rt.length&&(ot=new Ld("onBeforeInput","beforeinput",null,a,ot),lt.push({event:ot,listeners:rt}),ot.data=Ot))}se(lt,i)})}function tf(s,i,a){return{instance:s,listener:i,currentTarget:a}}function oe(s,i){for(var a=i+"Capture",d=[];s!==null;){var g=s,b=g.stateNode;g.tag===5&&b!==null&&(g=b,b=Kb(s,a),b!=null&&d.unshift(tf(s,b,g)),b=Kb(s,i),b!=null&&d.push(tf(s,b,g))),s=s.return}return d}function vf(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function wf(s,i,a,d,g){for(var b=i._reactName,$=[];a!==null&&a!==d;){var tt=a,it=tt.alternate,rt=tt.stateNode;if(it!==null&&it===d)break;tt.tag===5&&rt!==null&&(tt=rt,g?(it=Kb(a,b),it!=null&&$.unshift(tf(a,it,tt))):g||(it=Kb(a,b),it!=null&&$.push(tf(a,it,tt)))),a=a.return}$.length!==0&&s.push({event:i,listeners:$})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(s){return(typeof s=="string"?s:""+s).replace(xf,`
`).replace(yf,"")}function Af(s,i,a){if(i=zf(i),zf(s)!==i&&a)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(s){return Hf.resolve(null).then(s).catch(If)}:Ff;function If(s){setTimeout(function(){throw s})}function Kf(s,i){var a=i,d=0;do{var g=a.nextSibling;if(s.removeChild(a),g&&g.nodeType===8)if(a=g.data,a==="/$"){if(d===0){s.removeChild(g),bd(i);return}d--}else a!=="$"&&a!=="$?"&&a!=="$!"||d++;a=g}while(a);bd(i)}function Lf(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function Mf(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var a=s.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return s;i--}else a==="/$"&&i++}s=s.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(s){var i=s[Of];if(i)return i;for(var a=s.parentNode;a;){if(i=a[uf]||a[Of]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(s=Mf(s);s!==null;){if(a=s[Of])return a;s=Mf(s)}return i}s=a,a=s.parentNode}return null}function Cb(s){return s=s[Of]||s[uf],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function ue(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(p(33))}function Db(s){return s[Pf]||null}var Sf=[],Tf=-1;function Uf(s){return{current:s}}function E(s){0>Tf||(s.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(s,i){Tf++,Sf[Tf]=s.current,s.current=i}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(s,i){var a=s.type.contextTypes;if(!a)return Vf;var d=s.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===i)return d.__reactInternalMemoizedMaskedChildContext;var g={},b;for(b in a)g[b]=i[b];return d&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=g),g}function Zf(s){return s=s.childContextTypes,s!=null}function $f(){E(Wf),E(H)}function ag(s,i,a){if(H.current!==Vf)throw Error(p(168));G(H,i),G(Wf,a)}function bg(s,i,a){var d=s.stateNode;if(i=i.childContextTypes,typeof d.getChildContext!="function")return a;d=d.getChildContext();for(var g in d)if(!(g in i))throw Error(p(108,Ra(s)||"Unknown",g));return A({},a,d)}function cg(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,s),G(Wf,Wf.current),!0}function dg(s,i,a){var d=s.stateNode;if(!d)throw Error(p(169));a?(s=bg(s,i,Xf),d.__reactInternalMemoizedMergedChildContext=s,E(Wf),E(H),G(H,s)):E(Wf),G(Wf,a)}var eg=null,fg=!1,gg=!1;function hg(s){eg===null?eg=[s]:eg.push(s)}function ig(s){fg=!0,hg(s)}function jg(){if(!gg&&eg!==null){gg=!0;var s=0,i=C;try{var a=eg;for(C=1;s<a.length;s++){var d=a[s];do d=d(!0);while(d!==null)}eg=null,fg=!1}catch(g){throw eg!==null&&(eg=eg.slice(s+1)),ac(fc,jg),g}finally{C=i,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(s,i){kg[lg++]=ng,kg[lg++]=mg,mg=s,ng=i}function ug(s,i,a){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=s;var d=rg;s=sg;var g=32-oc(d)-1;d&=~(1<<g),a+=1;var b=32-oc(i)+g;if(30<b){var $=g-g%5;b=(d&(1<<$)-1).toString(32),d>>=$,g-=$,rg=1<<32-oc(i)+g|a<<g|d,sg=b+s}else rg=1<<b|a<<g|d,sg=s}function vg(s){s.return!==null&&(tg(s,1),ug(s,1,0))}function wg(s){for(;s===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;s===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(s,i){var a=Bg(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=s,i=s.deletions,i===null?(s.deletions=[a],s.flags|=16):i.push(a)}function Cg(s,i){switch(s.tag){case 5:var a=s.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,xg=s,yg=Lf(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,xg=s,yg=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=qg!==null?{id:rg,overflow:sg}:null,s.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=Bg(18,null,null,0),a.stateNode=i,a.return=s,s.child=a,xg=s,yg=null,!0):!1;default:return!1}}function Dg(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Eg(s){if(I){var i=yg;if(i){var a=i;if(!Cg(s,i)){if(Dg(s))throw Error(p(418));i=Lf(a.nextSibling);var d=xg;i&&Cg(s,i)?Ag(d,a):(s.flags=s.flags&-4097|2,I=!1,xg=s)}}else{if(Dg(s))throw Error(p(418));s.flags=s.flags&-4097|2,I=!1,xg=s}}}function Fg(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;xg=s}function Gg(s){if(s!==xg)return!1;if(!I)return Fg(s),I=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!Ef(s.type,s.memoizedProps)),i&&(i=yg)){if(Dg(s))throw Hg(),Error(p(418));for(;i;)Ag(s,i),i=Lf(i.nextSibling)}if(Fg(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(p(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var a=s.data;if(a==="/$"){if(i===0){yg=Lf(s.nextSibling);break e}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}s=s.nextSibling}yg=null}}else yg=xg?Lf(s.stateNode.nextSibling):null;return!0}function Hg(){for(var s=yg;s;)s=Lf(s.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(s){zg===null?zg=[s]:zg.push(s)}var Kg=ua.ReactCurrentBatchConfig;function Lg(s,i,a){if(s=a.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(p(309));var d=a.stateNode}if(!d)throw Error(p(147,s));var g=d,b=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===b?i.ref:(i=function($){var tt=g.refs;$===null?delete tt[b]:tt[b]=$},i._stringRef=b,i)}if(typeof s!="string")throw Error(p(284));if(!a._owner)throw Error(p(290,s))}return s}function Mg(s,i){throw s=Object.prototype.toString.call(i),Error(p(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function Ng(s){var i=s._init;return i(s._payload)}function Og(s){function i(ht,ft){if(s){var mt=ht.deletions;mt===null?(ht.deletions=[ft],ht.flags|=16):mt.push(ft)}}function a(ht,ft){if(!s)return null;for(;ft!==null;)i(ht,ft),ft=ft.sibling;return null}function d(ht,ft){for(ht=new Map;ft!==null;)ft.key!==null?ht.set(ft.key,ft):ht.set(ft.index,ft),ft=ft.sibling;return ht}function g(ht,ft){return ht=Pg(ht,ft),ht.index=0,ht.sibling=null,ht}function b(ht,ft,mt){return ht.index=mt,s?(mt=ht.alternate,mt!==null?(mt=mt.index,mt<ft?(ht.flags|=2,ft):mt):(ht.flags|=2,ft)):(ht.flags|=1048576,ft)}function $(ht){return s&&ht.alternate===null&&(ht.flags|=2),ht}function tt(ht,ft,mt,bt){return ft===null||ft.tag!==6?(ft=Qg(mt,ht.mode,bt),ft.return=ht,ft):(ft=g(ft,mt),ft.return=ht,ft)}function it(ht,ft,mt,bt){var Et=mt.type;return Et===ya?ot(ht,ft,mt.props.children,bt,mt.key):ft!==null&&(ft.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===Ha&&Ng(Et)===ft.type)?(bt=g(ft,mt.props),bt.ref=Lg(ht,ft,mt),bt.return=ht,bt):(bt=Rg(mt.type,mt.key,mt.props,null,ht.mode,bt),bt.ref=Lg(ht,ft,mt),bt.return=ht,bt)}function rt(ht,ft,mt,bt){return ft===null||ft.tag!==4||ft.stateNode.containerInfo!==mt.containerInfo||ft.stateNode.implementation!==mt.implementation?(ft=Sg(mt,ht.mode,bt),ft.return=ht,ft):(ft=g(ft,mt.children||[]),ft.return=ht,ft)}function ot(ht,ft,mt,bt,Et){return ft===null||ft.tag!==7?(ft=Tg(mt,ht.mode,bt,Et),ft.return=ht,ft):(ft=g(ft,mt),ft.return=ht,ft)}function lt(ht,ft,mt){if(typeof ft=="string"&&ft!==""||typeof ft=="number")return ft=Qg(""+ft,ht.mode,mt),ft.return=ht,ft;if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case va:return mt=Rg(ft.type,ft.key,ft.props,null,ht.mode,mt),mt.ref=Lg(ht,null,ft),mt.return=ht,mt;case wa:return ft=Sg(ft,ht.mode,mt),ft.return=ht,ft;case Ha:var bt=ft._init;return lt(ht,bt(ft._payload),mt)}if(eb(ft)||Ka(ft))return ft=Tg(ft,ht.mode,mt,null),ft.return=ht,ft;Mg(ht,ft)}return null}function ut(ht,ft,mt,bt){var Et=ft!==null?ft.key:null;if(typeof mt=="string"&&mt!==""||typeof mt=="number")return Et!==null?null:tt(ht,ft,""+mt,bt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:return mt.key===Et?it(ht,ft,mt,bt):null;case wa:return mt.key===Et?rt(ht,ft,mt,bt):null;case Ha:return Et=mt._init,ut(ht,ft,Et(mt._payload),bt)}if(eb(mt)||Ka(mt))return Et!==null?null:ot(ht,ft,mt,bt,null);Mg(ht,mt)}return null}function pt(ht,ft,mt,bt,Et){if(typeof bt=="string"&&bt!==""||typeof bt=="number")return ht=ht.get(mt)||null,tt(ft,ht,""+bt,Et);if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case va:return ht=ht.get(bt.key===null?mt:bt.key)||null,it(ft,ht,bt,Et);case wa:return ht=ht.get(bt.key===null?mt:bt.key)||null,rt(ft,ht,bt,Et);case Ha:var It=bt._init;return pt(ht,ft,mt,It(bt._payload),Et)}if(eb(bt)||Ka(bt))return ht=ht.get(mt)||null,ot(ft,ht,bt,Et,null);Mg(ft,bt)}return null}function _t(ht,ft,mt,bt){for(var Et=null,It=null,Ot=ft,jt=ft=0,xt=null;Ot!==null&&jt<mt.length;jt++){Ot.index>jt?(xt=Ot,Ot=null):xt=Ot.sibling;var Lt=ut(ht,Ot,mt[jt],bt);if(Lt===null){Ot===null&&(Ot=xt);break}s&&Ot&&Lt.alternate===null&&i(ht,Ot),ft=b(Lt,ft,jt),It===null?Et=Lt:It.sibling=Lt,It=Lt,Ot=xt}if(jt===mt.length)return a(ht,Ot),I&&tg(ht,jt),Et;if(Ot===null){for(;jt<mt.length;jt++)Ot=lt(ht,mt[jt],bt),Ot!==null&&(ft=b(Ot,ft,jt),It===null?Et=Ot:It.sibling=Ot,It=Ot);return I&&tg(ht,jt),Et}for(Ot=d(ht,Ot);jt<mt.length;jt++)xt=pt(Ot,ht,jt,mt[jt],bt),xt!==null&&(s&&xt.alternate!==null&&Ot.delete(xt.key===null?jt:xt.key),ft=b(xt,ft,jt),It===null?Et=xt:It.sibling=xt,It=xt);return s&&Ot.forEach(function(qt){return i(ht,qt)}),I&&tg(ht,jt),Et}function wt(ht,ft,mt,bt){var Et=Ka(mt);if(typeof Et!="function")throw Error(p(150));if(mt=Et.call(mt),mt==null)throw Error(p(151));for(var It=Et=null,Ot=ft,jt=ft=0,xt=null,Lt=mt.next();Ot!==null&&!Lt.done;jt++,Lt=mt.next()){Ot.index>jt?(xt=Ot,Ot=null):xt=Ot.sibling;var qt=ut(ht,Ot,Lt.value,bt);if(qt===null){Ot===null&&(Ot=xt);break}s&&Ot&&qt.alternate===null&&i(ht,Ot),ft=b(qt,ft,jt),It===null?Et=qt:It.sibling=qt,It=qt,Ot=xt}if(Lt.done)return a(ht,Ot),I&&tg(ht,jt),Et;if(Ot===null){for(;!Lt.done;jt++,Lt=mt.next())Lt=lt(ht,Lt.value,bt),Lt!==null&&(ft=b(Lt,ft,jt),It===null?Et=Lt:It.sibling=Lt,It=Lt);return I&&tg(ht,jt),Et}for(Ot=d(ht,Ot);!Lt.done;jt++,Lt=mt.next())Lt=pt(Ot,ht,jt,Lt.value,bt),Lt!==null&&(s&&Lt.alternate!==null&&Ot.delete(Lt.key===null?jt:Lt.key),ft=b(Lt,ft,jt),It===null?Et=Lt:It.sibling=Lt,It=Lt);return s&&Ot.forEach(function(Yt){return i(ht,Yt)}),I&&tg(ht,jt),Et}function vt(ht,ft,mt,bt){if(typeof mt=="object"&&mt!==null&&mt.type===ya&&mt.key===null&&(mt=mt.props.children),typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:e:{for(var Et=mt.key,It=ft;It!==null;){if(It.key===Et){if(Et=mt.type,Et===ya){if(It.tag===7){a(ht,It.sibling),ft=g(It,mt.props.children),ft.return=ht,ht=ft;break e}}else if(It.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===Ha&&Ng(Et)===It.type){a(ht,It.sibling),ft=g(It,mt.props),ft.ref=Lg(ht,It,mt),ft.return=ht,ht=ft;break e}a(ht,It);break}else i(ht,It);It=It.sibling}mt.type===ya?(ft=Tg(mt.props.children,ht.mode,bt,mt.key),ft.return=ht,ht=ft):(bt=Rg(mt.type,mt.key,mt.props,null,ht.mode,bt),bt.ref=Lg(ht,ft,mt),bt.return=ht,ht=bt)}return $(ht);case wa:e:{for(It=mt.key;ft!==null;){if(ft.key===It)if(ft.tag===4&&ft.stateNode.containerInfo===mt.containerInfo&&ft.stateNode.implementation===mt.implementation){a(ht,ft.sibling),ft=g(ft,mt.children||[]),ft.return=ht,ht=ft;break e}else{a(ht,ft);break}else i(ht,ft);ft=ft.sibling}ft=Sg(mt,ht.mode,bt),ft.return=ht,ht=ft}return $(ht);case Ha:return It=mt._init,vt(ht,ft,It(mt._payload),bt)}if(eb(mt))return _t(ht,ft,mt,bt);if(Ka(mt))return wt(ht,ft,mt,bt);Mg(ht,mt)}return typeof mt=="string"&&mt!==""||typeof mt=="number"?(mt=""+mt,ft!==null&&ft.tag===6?(a(ht,ft.sibling),ft=g(ft,mt),ft.return=ht,ht=ft):(a(ht,ft),ft=Qg(mt,ht.mode,bt),ft.return=ht,ht=ft),$(ht)):a(ht,ft)}return vt}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(s){var i=Wg.current;E(Wg),s._currentValue=i}function bh(s,i,a){for(;s!==null;){var d=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),s===a)break;s=s.return}}function ch(s,i){Xg=s,Zg=Yg=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&i&&(dh=!0),s.firstContext=null)}function eh(s){var i=s._currentValue;if(Zg!==s)if(s={context:s,memoizedValue:i,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=s,Xg.dependencies={lanes:0,firstContext:s}}else Yg=Yg.next=s;return i}var fh=null;function gh(s){fh===null?fh=[s]:fh.push(s)}function hh(s,i,a,d){var g=i.interleaved;return g===null?(a.next=a,gh(i)):(a.next=g.next,g.next=a),i.interleaved=a,ih(s,d)}function ih(s,i){s.lanes|=i;var a=s.alternate;for(a!==null&&(a.lanes|=i),a=s,s=s.return;s!==null;)s.childLanes|=i,a=s.alternate,a!==null&&(a.childLanes|=i),a=s,s=s.return;return a.tag===3?a.stateNode:null}var jh=!1;function kh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function mh(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function nh(s,i,a){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,K&2){var g=d.pending;return g===null?i.next=i:(i.next=g.next,g.next=i),d.pending=i,ih(s,a)}return g=d.interleaved,g===null?(i.next=i,gh(d)):(i.next=g.next,g.next=i),d.interleaved=i,ih(s,a)}function oh(s,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var d=i.lanes;d&=s.pendingLanes,a|=d,i.lanes=a,Cc(s,a)}}function ph(s,i){var a=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,a===d)){var g=null,b=null;if(a=a.firstBaseUpdate,a!==null){do{var $={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};b===null?g=b=$:b=b.next=$,a=a.next}while(a!==null);b===null?g=b=i:b=b.next=i}else g=b=i;a={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:b,shared:d.shared,effects:d.effects},s.updateQueue=a;return}s=a.lastBaseUpdate,s===null?a.firstBaseUpdate=i:s.next=i,a.lastBaseUpdate=i}function qh(s,i,a,d){var g=s.updateQueue;jh=!1;var b=g.firstBaseUpdate,$=g.lastBaseUpdate,tt=g.shared.pending;if(tt!==null){g.shared.pending=null;var it=tt,rt=it.next;it.next=null,$===null?b=rt:$.next=rt,$=it;var ot=s.alternate;ot!==null&&(ot=ot.updateQueue,tt=ot.lastBaseUpdate,tt!==$&&(tt===null?ot.firstBaseUpdate=rt:tt.next=rt,ot.lastBaseUpdate=it))}if(b!==null){var lt=g.baseState;$=0,ot=rt=it=null,tt=b;do{var ut=tt.lane,pt=tt.eventTime;if((d&ut)===ut){ot!==null&&(ot=ot.next={eventTime:pt,lane:0,tag:tt.tag,payload:tt.payload,callback:tt.callback,next:null});e:{var _t=s,wt=tt;switch(ut=i,pt=a,wt.tag){case 1:if(_t=wt.payload,typeof _t=="function"){lt=_t.call(pt,lt,ut);break e}lt=_t;break e;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=wt.payload,ut=typeof _t=="function"?_t.call(pt,lt,ut):_t,ut==null)break e;lt=A({},lt,ut);break e;case 2:jh=!0}}tt.callback!==null&&tt.lane!==0&&(s.flags|=64,ut=g.effects,ut===null?g.effects=[tt]:ut.push(tt))}else pt={eventTime:pt,lane:ut,tag:tt.tag,payload:tt.payload,callback:tt.callback,next:null},ot===null?(rt=ot=pt,it=lt):ot=ot.next=pt,$|=ut;if(tt=tt.next,tt===null){if(tt=g.shared.pending,tt===null)break;ut=tt,tt=ut.next,ut.next=null,g.lastBaseUpdate=ut,g.shared.pending=null}}while(!0);if(ot===null&&(it=lt),g.baseState=it,g.firstBaseUpdate=rt,g.lastBaseUpdate=ot,i=g.shared.interleaved,i!==null){g=i;do $|=g.lane,g=g.next;while(g!==i)}else b===null&&(g.shared.lanes=0);rh|=$,s.lanes=$,s.memoizedState=lt}}function sh(s,i,a){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var d=s[i],g=d.callback;if(g!==null){if(d.callback=null,d=a,typeof g!="function")throw Error(p(191,g));g.call(d)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(s){if(s===th)throw Error(p(174));return s}function yh(s,i){switch(G(wh,i),G(vh,s),G(uh,th),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:lb(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=lb(i,s)}E(uh),G(uh,i)}function zh(){E(uh),E(vh),E(wh)}function Ah(s){xh(wh.current);var i=xh(uh.current),a=lb(i,s.type);i!==a&&(G(vh,s),G(uh,a))}function Bh(s){vh.current===s&&(E(uh),E(vh))}var L=Uf(0);function Ch(s){for(var i=s;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Dh=[];function Eh(){for(var s=0;s<Dh.length;s++)Dh[s]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(s,i){if(i===null)return!1;for(var a=0;a<i.length&&a<s.length;a++)if(!He(s[a],i[a]))return!1;return!0}function Nh(s,i,a,d,g,b){if(Hh=b,M=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Fh.current=s===null||s.memoizedState===null?Oh:Ph,s=a(d,g),Jh){b=0;do{if(Jh=!1,Kh=0,25<=b)throw Error(p(301));b+=1,O=N=null,i.updateQueue=null,Fh.current=Qh,s=a(d,g)}while(Jh)}if(Fh.current=Rh,i=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,i)throw Error(p(300));return s}function Sh(){var s=Kh!==0;return Kh=0,s}function Th(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=s:O=O.next=s,O}function Uh(){if(N===null){var s=M.alternate;s=s!==null?s.memoizedState:null}else s=N.next;var i=O===null?M.memoizedState:O.next;if(i!==null)O=i,N=s;else{if(s===null)throw Error(p(310));N=s,s={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=s:O=O.next=s}return O}function Vh(s,i){return typeof i=="function"?i(s):i}function Wh(s){var i=Uh(),a=i.queue;if(a===null)throw Error(p(311));a.lastRenderedReducer=s;var d=N,g=d.baseQueue,b=a.pending;if(b!==null){if(g!==null){var $=g.next;g.next=b.next,b.next=$}d.baseQueue=g=b,a.pending=null}if(g!==null){b=g.next,d=d.baseState;var tt=$=null,it=null,rt=b;do{var ot=rt.lane;if((Hh&ot)===ot)it!==null&&(it=it.next={lane:0,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null}),d=rt.hasEagerState?rt.eagerState:s(d,rt.action);else{var lt={lane:ot,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null};it===null?(tt=it=lt,$=d):it=it.next=lt,M.lanes|=ot,rh|=ot}rt=rt.next}while(rt!==null&&rt!==b);it===null?$=d:it.next=tt,He(d,i.memoizedState)||(dh=!0),i.memoizedState=d,i.baseState=$,i.baseQueue=it,a.lastRenderedState=d}if(s=a.interleaved,s!==null){g=s;do b=g.lane,M.lanes|=b,rh|=b,g=g.next;while(g!==s)}else g===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function Xh(s){var i=Uh(),a=i.queue;if(a===null)throw Error(p(311));a.lastRenderedReducer=s;var d=a.dispatch,g=a.pending,b=i.memoizedState;if(g!==null){a.pending=null;var $=g=g.next;do b=s(b,$.action),$=$.next;while($!==g);He(b,i.memoizedState)||(dh=!0),i.memoizedState=b,i.baseQueue===null&&(i.baseState=b),a.lastRenderedState=b}return[b,d]}function Yh(){}function Zh(s,i){var a=M,d=Uh(),g=i(),b=!He(d.memoizedState,g);if(b&&(d.memoizedState=g,dh=!0),d=d.queue,$h(ai.bind(null,a,d,s),[s]),d.getSnapshot!==i||b||O!==null&&O.memoizedState.tag&1){if(a.flags|=2048,bi(9,ci.bind(null,a,d,g,i),void 0,null),Q===null)throw Error(p(349));Hh&30||di(a,i,g)}return g}function di(s,i,a){s.flags|=16384,s={getSnapshot:i,value:a},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.stores=[s]):(a=i.stores,a===null?i.stores=[s]:a.push(s))}function ci(s,i,a,d){i.value=a,i.getSnapshot=d,ei(i)&&fi(s)}function ai(s,i,a){return a(function(){ei(i)&&fi(s)})}function ei(s){var i=s.getSnapshot;s=s.value;try{var a=i();return!He(s,a)}catch{return!0}}function fi(s){var i=ih(s,1);i!==null&&gi(i,s,1,-1)}function hi(s){var i=Th();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:s},i.queue=s,s=s.dispatch=ii.bind(null,M,s),[i.memoizedState,s]}function bi(s,i,a,d){return s={tag:s,create:i,destroy:a,deps:d,next:null},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.lastEffect=s.next=s):(a=i.lastEffect,a===null?i.lastEffect=s.next=s:(d=a.next,a.next=s,s.next=d,i.lastEffect=s)),s}function ji(){return Uh().memoizedState}function ki(s,i,a,d){var g=Th();M.flags|=s,g.memoizedState=bi(1|i,a,void 0,d===void 0?null:d)}function li(s,i,a,d){var g=Uh();d=d===void 0?null:d;var b=void 0;if(N!==null){var $=N.memoizedState;if(b=$.destroy,d!==null&&Mh(d,$.deps)){g.memoizedState=bi(i,a,b,d);return}}M.flags|=s,g.memoizedState=bi(1|i,a,b,d)}function mi(s,i){return ki(8390656,8,s,i)}function $h(s,i){return li(2048,8,s,i)}function ni(s,i){return li(4,2,s,i)}function oi(s,i){return li(4,4,s,i)}function pi(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function qi(s,i,a){return a=a!=null?a.concat([s]):null,li(4,4,pi.bind(null,i,s),a)}function ri(){}function si(s,i){var a=Uh();i=i===void 0?null:i;var d=a.memoizedState;return d!==null&&i!==null&&Mh(i,d[1])?d[0]:(a.memoizedState=[s,i],s)}function ti(s,i){var a=Uh();i=i===void 0?null:i;var d=a.memoizedState;return d!==null&&i!==null&&Mh(i,d[1])?d[0]:(s=s(),a.memoizedState=[s,i],s)}function ui(s,i,a){return Hh&21?(He(a,i)||(a=yc(),M.lanes|=a,rh|=a,s.baseState=!0),i):(s.baseState&&(s.baseState=!1,dh=!0),s.memoizedState=a)}function vi(s,i){var a=C;C=a!==0&&4>a?a:4,s(!0);var d=Gh.transition;Gh.transition={};try{s(!1),i()}finally{C=a,Gh.transition=d}}function wi(){return Uh().memoizedState}function xi(s,i,a){var d=yi(s);if(a={lane:d,action:a,hasEagerState:!1,eagerState:null,next:null},zi(s))Ai(i,a);else if(a=hh(s,i,a,d),a!==null){var g=R();gi(a,s,d,g),Bi(a,i,d)}}function ii(s,i,a){var d=yi(s),g={lane:d,action:a,hasEagerState:!1,eagerState:null,next:null};if(zi(s))Ai(i,g);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=i.lastRenderedReducer,b!==null))try{var $=i.lastRenderedState,tt=b($,a);if(g.hasEagerState=!0,g.eagerState=tt,He(tt,$)){var it=i.interleaved;it===null?(g.next=g,gh(i)):(g.next=it.next,it.next=g),i.interleaved=g;return}}catch{}finally{}a=hh(s,i,g,d),a!==null&&(g=R(),gi(a,s,d,g),Bi(a,i,d))}}function zi(s){var i=s.alternate;return s===M||i!==null&&i===M}function Ai(s,i){Jh=Ih=!0;var a=s.pending;a===null?i.next=i:(i.next=a.next,a.next=i),s.pending=i}function Bi(s,i,a){if(a&4194240){var d=i.lanes;d&=s.pendingLanes,a|=d,i.lanes=a,Cc(s,a)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(s,i){return Th().memoizedState=[s,i===void 0?null:i],s},useContext:eh,useEffect:mi,useImperativeHandle:function(s,i,a){return a=a!=null?a.concat([s]):null,ki(4194308,4,pi.bind(null,i,s),a)},useLayoutEffect:function(s,i){return ki(4194308,4,s,i)},useInsertionEffect:function(s,i){return ki(4,2,s,i)},useMemo:function(s,i){var a=Th();return i=i===void 0?null:i,s=s(),a.memoizedState=[s,i],s},useReducer:function(s,i,a){var d=Th();return i=a!==void 0?a(i):i,d.memoizedState=d.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},d.queue=s,s=s.dispatch=xi.bind(null,M,s),[d.memoizedState,s]},useRef:function(s){var i=Th();return s={current:s},i.memoizedState=s},useState:hi,useDebugValue:ri,useDeferredValue:function(s){return Th().memoizedState=s},useTransition:function(){var s=hi(!1),i=s[0];return s=vi.bind(null,s[1]),Th().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,a){var d=M,g=Th();if(I){if(a===void 0)throw Error(p(407));a=a()}else{if(a=i(),Q===null)throw Error(p(349));Hh&30||di(d,i,a)}g.memoizedState=a;var b={value:a,getSnapshot:i};return g.queue=b,mi(ai.bind(null,d,b,s),[s]),d.flags|=2048,bi(9,ci.bind(null,d,b,a,i),void 0,null),a},useId:function(){var s=Th(),i=Q.identifierPrefix;if(I){var a=sg,d=rg;a=(d&~(1<<32-oc(d)-1)).toString(32)+a,i=":"+i+"R"+a,a=Kh++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=Lh++,i=":"+i+"r"+a.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var i=Uh();return ui(i,N.memoizedState,s)},useTransition:function(){var s=Wh(Vh)[0],i=Uh().memoizedState;return[s,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var i=Uh();return N===null?i.memoizedState=s:ui(i,N.memoizedState,s)},useTransition:function(){var s=Xh(Vh)[0],i=Uh().memoizedState;return[s,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(s,i){if(s&&s.defaultProps){i=A({},i),s=s.defaultProps;for(var a in s)i[a]===void 0&&(i[a]=s[a]);return i}return i}function Di(s,i,a,d){i=s.memoizedState,a=a(d,i),a=a==null?i:A({},i,a),s.memoizedState=a,s.lanes===0&&(s.updateQueue.baseState=a)}var Ei={isMounted:function(s){return(s=s._reactInternals)?Vb(s)===s:!1},enqueueSetState:function(s,i,a){s=s._reactInternals;var d=R(),g=yi(s),b=mh(d,g);b.payload=i,a!=null&&(b.callback=a),i=nh(s,b,g),i!==null&&(gi(i,s,g,d),oh(i,s,g))},enqueueReplaceState:function(s,i,a){s=s._reactInternals;var d=R(),g=yi(s),b=mh(d,g);b.tag=1,b.payload=i,a!=null&&(b.callback=a),i=nh(s,b,g),i!==null&&(gi(i,s,g,d),oh(i,s,g))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var a=R(),d=yi(s),g=mh(a,d);g.tag=2,i!=null&&(g.callback=i),i=nh(s,g,d),i!==null&&(gi(i,s,d,a),oh(i,s,d))}};function Fi(s,i,a,d,g,b,$){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,b,$):i.prototype&&i.prototype.isPureReactComponent?!Ie(a,d)||!Ie(g,b):!0}function Gi(s,i,a){var d=!1,g=Vf,b=i.contextType;return typeof b=="object"&&b!==null?b=eh(b):(g=Zf(i)?Xf:H.current,d=i.contextTypes,b=(d=d!=null)?Yf(s,g):Vf),i=new i(a,b),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ei,s.stateNode=i,i._reactInternals=s,d&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=g,s.__reactInternalMemoizedMaskedChildContext=b),i}function Hi(s,i,a,d){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,d),i.state!==s&&Ei.enqueueReplaceState(i,i.state,null)}function Ii(s,i,a,d){var g=s.stateNode;g.props=a,g.state=s.memoizedState,g.refs={},kh(s);var b=i.contextType;typeof b=="object"&&b!==null?g.context=eh(b):(b=Zf(i)?Xf:H.current,g.context=Yf(s,b)),g.state=s.memoizedState,b=i.getDerivedStateFromProps,typeof b=="function"&&(Di(s,i,b,a),g.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(i=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),i!==g.state&&Ei.enqueueReplaceState(g,g.state,null),qh(s,a,g,d),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308)}function Ji(s,i){try{var a="",d=i;do a+=Pa(d),d=d.return;while(d);var g=a}catch(b){g=`
Error generating stack: `+b.message+`
`+b.stack}return{value:s,source:i,stack:g,digest:null}}function Ki(s,i,a){return{value:s,source:null,stack:a??null,digest:i??null}}function Li(s,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(s,i,a){a=mh(-1,a),a.tag=3,a.payload={element:null};var d=i.value;return a.callback=function(){Oi||(Oi=!0,Pi=d),Li(s,i)},a}function Qi(s,i,a){a=mh(-1,a),a.tag=3;var d=s.type.getDerivedStateFromError;if(typeof d=="function"){var g=i.value;a.payload=function(){return d(g)},a.callback=function(){Li(s,i)}}var b=s.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(a.callback=function(){Li(s,i),typeof d!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var $=i.stack;this.componentDidCatch(i.value,{componentStack:$!==null?$:""})}),a}function Si(s,i,a){var d=s.pingCache;if(d===null){d=s.pingCache=new Mi;var g=new Set;d.set(i,g)}else g=d.get(i),g===void 0&&(g=new Set,d.set(i,g));g.has(a)||(g.add(a),s=Ti.bind(null,s,i,a),i.then(s,s))}function Ui(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Vi(s,i,a,d,g){return s.mode&1?(s.flags|=65536,s.lanes=g,s):(s===i?s.flags|=65536:(s.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=mh(-1,1),i.tag=2,nh(a,i,1))),a.lanes|=1),s)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(s,i,a,d){i.child=s===null?Vg(i,null,a,d):Ug(i,s.child,a,d)}function Yi(s,i,a,d,g){a=a.render;var b=i.ref;return ch(i,g),d=Nh(s,i,a,d,b,g),a=Sh(),s!==null&&!dh?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~g,Zi(s,i,g)):(I&&a&&vg(i),i.flags|=1,Xi(s,i,d,g),i.child)}function $i(s,i,a,d,g){if(s===null){var b=a.type;return typeof b=="function"&&!aj(b)&&b.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=b,bj(s,i,b,d,g)):(s=Rg(a.type,null,d,i,i.mode,g),s.ref=i.ref,s.return=i,i.child=s)}if(b=s.child,!(s.lanes&g)){var $=b.memoizedProps;if(a=a.compare,a=a!==null?a:Ie,a($,d)&&s.ref===i.ref)return Zi(s,i,g)}return i.flags|=1,s=Pg(b,d),s.ref=i.ref,s.return=i,i.child=s}function bj(s,i,a,d,g){if(s!==null){var b=s.memoizedProps;if(Ie(b,d)&&s.ref===i.ref)if(dh=!1,i.pendingProps=d=b,(s.lanes&g)!==0)s.flags&131072&&(dh=!0);else return i.lanes=s.lanes,Zi(s,i,g)}return cj(s,i,a,d,g)}function dj(s,i,a){var d=i.pendingProps,g=d.children,b=s!==null?s.memoizedState:null;if(d.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=a;else{if(!(a&1073741824))return s=b!==null?b.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,G(ej,fj),fj|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=b!==null?b.baseLanes:a,G(ej,fj),fj|=d}else b!==null?(d=b.baseLanes|a,i.memoizedState=null):d=a,G(ej,fj),fj|=d;return Xi(s,i,g,a),i.child}function gj(s,i){var a=i.ref;(s===null&&a!==null||s!==null&&s.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function cj(s,i,a,d,g){var b=Zf(a)?Xf:H.current;return b=Yf(i,b),ch(i,g),a=Nh(s,i,a,d,b,g),d=Sh(),s!==null&&!dh?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~g,Zi(s,i,g)):(I&&d&&vg(i),i.flags|=1,Xi(s,i,a,g),i.child)}function hj(s,i,a,d,g){if(Zf(a)){var b=!0;cg(i)}else b=!1;if(ch(i,g),i.stateNode===null)ij(s,i),Gi(i,a,d),Ii(i,a,d,g),d=!0;else if(s===null){var $=i.stateNode,tt=i.memoizedProps;$.props=tt;var it=$.context,rt=a.contextType;typeof rt=="object"&&rt!==null?rt=eh(rt):(rt=Zf(a)?Xf:H.current,rt=Yf(i,rt));var ot=a.getDerivedStateFromProps,lt=typeof ot=="function"||typeof $.getSnapshotBeforeUpdate=="function";lt||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(tt!==d||it!==rt)&&Hi(i,$,d,rt),jh=!1;var ut=i.memoizedState;$.state=ut,qh(i,d,$,g),it=i.memoizedState,tt!==d||ut!==it||Wf.current||jh?(typeof ot=="function"&&(Di(i,a,ot,d),it=i.memoizedState),(tt=jh||Fi(i,a,tt,d,ut,it,rt))?(lt||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(i.flags|=4194308)):(typeof $.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=it),$.props=d,$.state=it,$.context=rt,d=tt):(typeof $.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{$=i.stateNode,lh(s,i),tt=i.memoizedProps,rt=i.type===i.elementType?tt:Ci(i.type,tt),$.props=rt,lt=i.pendingProps,ut=$.context,it=a.contextType,typeof it=="object"&&it!==null?it=eh(it):(it=Zf(a)?Xf:H.current,it=Yf(i,it));var pt=a.getDerivedStateFromProps;(ot=typeof pt=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(tt!==lt||ut!==it)&&Hi(i,$,d,it),jh=!1,ut=i.memoizedState,$.state=ut,qh(i,d,$,g);var _t=i.memoizedState;tt!==lt||ut!==_t||Wf.current||jh?(typeof pt=="function"&&(Di(i,a,pt,d),_t=i.memoizedState),(rt=jh||Fi(i,a,rt,d,ut,_t,it)||!1)?(ot||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(d,_t,it),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(d,_t,it)),typeof $.componentDidUpdate=="function"&&(i.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof $.componentDidUpdate!="function"||tt===s.memoizedProps&&ut===s.memoizedState||(i.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||tt===s.memoizedProps&&ut===s.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=_t),$.props=d,$.state=_t,$.context=it,d=rt):(typeof $.componentDidUpdate!="function"||tt===s.memoizedProps&&ut===s.memoizedState||(i.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||tt===s.memoizedProps&&ut===s.memoizedState||(i.flags|=1024),d=!1)}return jj(s,i,a,d,b,g)}function jj(s,i,a,d,g,b){gj(s,i);var $=(i.flags&128)!==0;if(!d&&!$)return g&&dg(i,a,!1),Zi(s,i,b);d=i.stateNode,Wi.current=i;var tt=$&&typeof a.getDerivedStateFromError!="function"?null:d.render();return i.flags|=1,s!==null&&$?(i.child=Ug(i,s.child,null,b),i.child=Ug(i,null,tt,b)):Xi(s,i,tt,b),i.memoizedState=d.state,g&&dg(i,a,!0),i.child}function kj(s){var i=s.stateNode;i.pendingContext?ag(s,i.pendingContext,i.pendingContext!==i.context):i.context&&ag(s,i.context,!1),yh(s,i.containerInfo)}function lj(s,i,a,d,g){return Ig(),Jg(g),i.flags|=256,Xi(s,i,a,d),i.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(s){return{baseLanes:s,cachePool:null,transitions:null}}function oj(s,i,a){var d=i.pendingProps,g=L.current,b=!1,$=(i.flags&128)!==0,tt;if((tt=$)||(tt=s!==null&&s.memoizedState===null?!1:(g&2)!==0),tt?(b=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(g|=1),G(L,g&1),s===null)return Eg(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(i.mode&1?s.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):($=d.children,s=d.fallback,b?(d=i.mode,b=i.child,$={mode:"hidden",children:$},!(d&1)&&b!==null?(b.childLanes=0,b.pendingProps=$):b=pj($,d,0,null),s=Tg(s,d,a,null),b.return=i,s.return=i,b.sibling=s,i.child=b,i.child.memoizedState=nj(a),i.memoizedState=mj,s):qj(i,$));if(g=s.memoizedState,g!==null&&(tt=g.dehydrated,tt!==null))return rj(s,i,$,d,tt,g,a);if(b){b=d.fallback,$=i.mode,g=s.child,tt=g.sibling;var it={mode:"hidden",children:d.children};return!($&1)&&i.child!==g?(d=i.child,d.childLanes=0,d.pendingProps=it,i.deletions=null):(d=Pg(g,it),d.subtreeFlags=g.subtreeFlags&14680064),tt!==null?b=Pg(tt,b):(b=Tg(b,$,a,null),b.flags|=2),b.return=i,d.return=i,d.sibling=b,i.child=d,d=b,b=i.child,$=s.child.memoizedState,$=$===null?nj(a):{baseLanes:$.baseLanes|a,cachePool:null,transitions:$.transitions},b.memoizedState=$,b.childLanes=s.childLanes&~a,i.memoizedState=mj,d}return b=s.child,s=b.sibling,d=Pg(b,{mode:"visible",children:d.children}),!(i.mode&1)&&(d.lanes=a),d.return=i,d.sibling=null,s!==null&&(a=i.deletions,a===null?(i.deletions=[s],i.flags|=16):a.push(s)),i.child=d,i.memoizedState=null,d}function qj(s,i){return i=pj({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function sj(s,i,a,d){return d!==null&&Jg(d),Ug(i,s.child,null,a),s=qj(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function rj(s,i,a,d,g,b,$){if(a)return i.flags&256?(i.flags&=-257,d=Ki(Error(p(422))),sj(s,i,$,d)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(b=d.fallback,g=i.mode,d=pj({mode:"visible",children:d.children},g,0,null),b=Tg(b,g,$,null),b.flags|=2,d.return=i,b.return=i,d.sibling=b,i.child=d,i.mode&1&&Ug(i,s.child,null,$),i.child.memoizedState=nj($),i.memoizedState=mj,b);if(!(i.mode&1))return sj(s,i,$,null);if(g.data==="$!"){if(d=g.nextSibling&&g.nextSibling.dataset,d)var tt=d.dgst;return d=tt,b=Error(p(419)),d=Ki(b,d,void 0),sj(s,i,$,d)}if(tt=($&s.childLanes)!==0,dh||tt){if(d=Q,d!==null){switch($&-$){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=g&(d.suspendedLanes|$)?0:g,g!==0&&g!==b.retryLane&&(b.retryLane=g,ih(s,g),gi(d,s,g,-1))}return tj(),d=Ki(Error(p(421))),sj(s,i,$,d)}return g.data==="$?"?(i.flags|=128,i.child=s.child,i=uj.bind(null,s),g._reactRetry=i,null):(s=b.treeContext,yg=Lf(g.nextSibling),xg=i,I=!0,zg=null,s!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=s.id,sg=s.overflow,qg=i),i=qj(i,d.children),i.flags|=4096,i)}function vj(s,i,a){s.lanes|=i;var d=s.alternate;d!==null&&(d.lanes|=i),bh(s.return,i,a)}function wj(s,i,a,d,g){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:a,tailMode:g}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=d,b.tail=a,b.tailMode=g)}function xj(s,i,a){var d=i.pendingProps,g=d.revealOrder,b=d.tail;if(Xi(s,i,d.children,a),d=L.current,d&2)d=d&1|2,i.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&vj(s,a,i);else if(s.tag===19)vj(s,a,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}d&=1}if(G(L,d),!(i.mode&1))i.memoizedState=null;else switch(g){case"forwards":for(a=i.child,g=null;a!==null;)s=a.alternate,s!==null&&Ch(s)===null&&(g=a),a=a.sibling;a=g,a===null?(g=i.child,i.child=null):(g=a.sibling,a.sibling=null),wj(i,!1,g,a,b);break;case"backwards":for(a=null,g=i.child,i.child=null;g!==null;){if(s=g.alternate,s!==null&&Ch(s)===null){i.child=g;break}s=g.sibling,g.sibling=a,a=g,g=s}wj(i,!0,a,null,b);break;case"together":wj(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ij(s,i){!(i.mode&1)&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Zi(s,i,a){if(s!==null&&(i.dependencies=s.dependencies),rh|=i.lanes,!(a&i.childLanes))return null;if(s!==null&&i.child!==s.child)throw Error(p(153));if(i.child!==null){for(s=i.child,a=Pg(s,s.pendingProps),i.child=a,a.return=i;s.sibling!==null;)s=s.sibling,a=a.sibling=Pg(s,s.pendingProps),a.return=i;a.sibling=null}return i.child}function yj(s,i,a){switch(i.tag){case 3:kj(i),Ig();break;case 5:Ah(i);break;case 1:Zf(i.type)&&cg(i);break;case 4:yh(i,i.stateNode.containerInfo);break;case 10:var d=i.type._context,g=i.memoizedProps.value;G(Wg,d._currentValue),d._currentValue=g;break;case 13:if(d=i.memoizedState,d!==null)return d.dehydrated!==null?(G(L,L.current&1),i.flags|=128,null):a&i.child.childLanes?oj(s,i,a):(G(L,L.current&1),s=Zi(s,i,a),s!==null?s.sibling:null);G(L,L.current&1);break;case 19:if(d=(a&i.childLanes)!==0,s.flags&128){if(d)return xj(s,i,a);i.flags|=128}if(g=i.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),G(L,L.current),d)break;return null;case 22:case 23:return i.lanes=0,dj(s,i,a)}return Zi(s,i,a)}var zj,Aj,Bj,Cj;zj=function(s,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)s.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};Aj=function(){};Bj=function(s,i,a,d){var g=s.memoizedProps;if(g!==d){s=i.stateNode,xh(uh.current);var b=null;switch(a){case"input":g=Ya(s,g),d=Ya(s,d),b=[];break;case"select":g=A({},g,{value:void 0}),d=A({},d,{value:void 0}),b=[];break;case"textarea":g=gb(s,g),d=gb(s,d),b=[];break;default:typeof g.onClick!="function"&&typeof d.onClick=="function"&&(s.onclick=Bf)}ub(a,d);var $;a=null;for(rt in g)if(!d.hasOwnProperty(rt)&&g.hasOwnProperty(rt)&&g[rt]!=null)if(rt==="style"){var tt=g[rt];for($ in tt)tt.hasOwnProperty($)&&(a||(a={}),a[$]="")}else rt!=="dangerouslySetInnerHTML"&&rt!=="children"&&rt!=="suppressContentEditableWarning"&&rt!=="suppressHydrationWarning"&&rt!=="autoFocus"&&(ea.hasOwnProperty(rt)?b||(b=[]):(b=b||[]).push(rt,null));for(rt in d){var it=d[rt];if(tt=g!=null?g[rt]:void 0,d.hasOwnProperty(rt)&&it!==tt&&(it!=null||tt!=null))if(rt==="style")if(tt){for($ in tt)!tt.hasOwnProperty($)||it&&it.hasOwnProperty($)||(a||(a={}),a[$]="");for($ in it)it.hasOwnProperty($)&&tt[$]!==it[$]&&(a||(a={}),a[$]=it[$])}else a||(b||(b=[]),b.push(rt,a)),a=it;else rt==="dangerouslySetInnerHTML"?(it=it?it.__html:void 0,tt=tt?tt.__html:void 0,it!=null&&tt!==it&&(b=b||[]).push(rt,it)):rt==="children"?typeof it!="string"&&typeof it!="number"||(b=b||[]).push(rt,""+it):rt!=="suppressContentEditableWarning"&&rt!=="suppressHydrationWarning"&&(ea.hasOwnProperty(rt)?(it!=null&&rt==="onScroll"&&D("scroll",s),b||tt===it||(b=[])):(b=b||[]).push(rt,it))}a&&(b=b||[]).push("style",a);var rt=b;(i.updateQueue=rt)&&(i.flags|=4)}};Cj=function(s,i,a,d){a!==d&&(i.flags|=4)};function Dj(s,i){if(!I)switch(s.tailMode){case"hidden":i=s.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?s.tail=null:a.sibling=null;break;case"collapsed":a=s.tail;for(var d=null;a!==null;)a.alternate!==null&&(d=a),a=a.sibling;d===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function S(s){var i=s.alternate!==null&&s.alternate.child===s.child,a=0,d=0;if(i)for(var g=s.child;g!==null;)a|=g.lanes|g.childLanes,d|=g.subtreeFlags&14680064,d|=g.flags&14680064,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)a|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=d,s.childLanes=a,i}function Ej(s,i,a){var d=i.pendingProps;switch(wg(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(i),null;case 1:return Zf(i.type)&&$f(),S(i),null;case 3:return d=i.stateNode,zh(),E(Wf),E(H),Eh(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(s===null||s.child===null)&&(Gg(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(s,i),S(i),null;case 5:Bh(i);var g=xh(wh.current);if(a=i.type,s!==null&&i.stateNode!=null)Bj(s,i,a,d,g),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!d){if(i.stateNode===null)throw Error(p(166));return S(i),null}if(s=xh(uh.current),Gg(i)){d=i.stateNode,a=i.type;var b=i.memoizedProps;switch(d[Of]=i,d[Pf]=b,s=(i.mode&1)!==0,a){case"dialog":D("cancel",d),D("close",d);break;case"iframe":case"object":case"embed":D("load",d);break;case"video":case"audio":for(g=0;g<lf.length;g++)D(lf[g],d);break;case"source":D("error",d);break;case"img":case"image":case"link":D("error",d),D("load",d);break;case"details":D("toggle",d);break;case"input":Za(d,b),D("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!b.multiple},D("invalid",d);break;case"textarea":hb(d,b),D("invalid",d)}ub(a,b),g=null;for(var $ in b)if(b.hasOwnProperty($)){var tt=b[$];$==="children"?typeof tt=="string"?d.textContent!==tt&&(b.suppressHydrationWarning!==!0&&Af(d.textContent,tt,s),g=["children",tt]):typeof tt=="number"&&d.textContent!==""+tt&&(b.suppressHydrationWarning!==!0&&Af(d.textContent,tt,s),g=["children",""+tt]):ea.hasOwnProperty($)&&tt!=null&&$==="onScroll"&&D("scroll",d)}switch(a){case"input":Va(d),db$1(d,b,!0);break;case"textarea":Va(d),jb(d);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(d.onclick=Bf)}d=g,i.updateQueue=d,d!==null&&(i.flags|=4)}else{$=g.nodeType===9?g:g.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=kb(a)),s==="http://www.w3.org/1999/xhtml"?a==="script"?(s=$.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof d.is=="string"?s=$.createElement(a,{is:d.is}):(s=$.createElement(a),a==="select"&&($=s,d.multiple?$.multiple=!0:d.size&&($.size=d.size))):s=$.createElementNS(s,a),s[Of]=i,s[Pf]=d,zj(s,i,!1,!1),i.stateNode=s;e:{switch($=vb(a,d),a){case"dialog":D("cancel",s),D("close",s),g=d;break;case"iframe":case"object":case"embed":D("load",s),g=d;break;case"video":case"audio":for(g=0;g<lf.length;g++)D(lf[g],s);g=d;break;case"source":D("error",s),g=d;break;case"img":case"image":case"link":D("error",s),D("load",s),g=d;break;case"details":D("toggle",s),g=d;break;case"input":Za(s,d),g=Ya(s,d),D("invalid",s);break;case"option":g=d;break;case"select":s._wrapperState={wasMultiple:!!d.multiple},g=A({},d,{value:void 0}),D("invalid",s);break;case"textarea":hb(s,d),g=gb(s,d),D("invalid",s);break;default:g=d}ub(a,g),tt=g;for(b in tt)if(tt.hasOwnProperty(b)){var it=tt[b];b==="style"?sb(s,it):b==="dangerouslySetInnerHTML"?(it=it?it.__html:void 0,it!=null&&nb(s,it)):b==="children"?typeof it=="string"?(a!=="textarea"||it!=="")&&ob(s,it):typeof it=="number"&&ob(s,""+it):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(ea.hasOwnProperty(b)?it!=null&&b==="onScroll"&&D("scroll",s):it!=null&&ta(s,b,it,$))}switch(a){case"input":Va(s),db$1(s,d,!1);break;case"textarea":Va(s),jb(s);break;case"option":d.value!=null&&s.setAttribute("value",""+Sa(d.value));break;case"select":s.multiple=!!d.multiple,b=d.value,b!=null?fb(s,!!d.multiple,b,!1):d.defaultValue!=null&&fb(s,!!d.multiple,d.defaultValue,!0);break;default:typeof g.onClick=="function"&&(s.onclick=Bf)}switch(a){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return S(i),null;case 6:if(s&&i.stateNode!=null)Cj(s,i,s.memoizedProps,d);else{if(typeof d!="string"&&i.stateNode===null)throw Error(p(166));if(a=xh(wh.current),xh(uh.current),Gg(i)){if(d=i.stateNode,a=i.memoizedProps,d[Of]=i,(b=d.nodeValue!==a)&&(s=xg,s!==null))switch(s.tag){case 3:Af(d.nodeValue,a,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Af(d.nodeValue,a,(s.mode&1)!==0)}b&&(i.flags|=4)}else d=(a.nodeType===9?a:a.ownerDocument).createTextNode(d),d[Of]=i,i.stateNode=d}return S(i),null;case 13:if(E(L),d=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(I&&yg!==null&&i.mode&1&&!(i.flags&128))Hg(),Ig(),i.flags|=98560,b=!1;else if(b=Gg(i),d!==null&&d.dehydrated!==null){if(s===null){if(!b)throw Error(p(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(p(317));b[Of]=i}else Ig(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;S(i),b=!1}else zg!==null&&(Fj(zg),zg=null),b=!0;if(!b)return i.flags&65536?i:null}return i.flags&128?(i.lanes=a,i):(d=d!==null,d!==(s!==null&&s.memoizedState!==null)&&d&&(i.child.flags|=8192,i.mode&1&&(s===null||L.current&1?T===0&&(T=3):tj())),i.updateQueue!==null&&(i.flags|=4),S(i),null);case 4:return zh(),Aj(s,i),s===null&&sf(i.stateNode.containerInfo),S(i),null;case 10:return ah(i.type._context),S(i),null;case 17:return Zf(i.type)&&$f(),S(i),null;case 19:if(E(L),b=i.memoizedState,b===null)return S(i),null;if(d=(i.flags&128)!==0,$=b.rendering,$===null)if(d)Dj(b,!1);else{if(T!==0||s!==null&&s.flags&128)for(s=i.child;s!==null;){if($=Ch(s),$!==null){for(i.flags|=128,Dj(b,!1),d=$.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),i.subtreeFlags=0,d=a,a=i.child;a!==null;)b=a,s=d,b.flags&=14680066,$=b.alternate,$===null?(b.childLanes=0,b.lanes=s,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=$.childLanes,b.lanes=$.lanes,b.child=$.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=$.memoizedProps,b.memoizedState=$.memoizedState,b.updateQueue=$.updateQueue,b.type=$.type,s=$.dependencies,b.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a=a.sibling;return G(L,L.current&1|2),i.child}s=s.sibling}b.tail!==null&&B()>Gj&&(i.flags|=128,d=!0,Dj(b,!1),i.lanes=4194304)}else{if(!d)if(s=Ch($),s!==null){if(i.flags|=128,d=!0,a=s.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),Dj(b,!0),b.tail===null&&b.tailMode==="hidden"&&!$.alternate&&!I)return S(i),null}else 2*B()-b.renderingStartTime>Gj&&a!==1073741824&&(i.flags|=128,d=!0,Dj(b,!1),i.lanes=4194304);b.isBackwards?($.sibling=i.child,i.child=$):(a=b.last,a!==null?a.sibling=$:i.child=$,b.last=$)}return b.tail!==null?(i=b.tail,b.rendering=i,b.tail=i.sibling,b.renderingStartTime=B(),i.sibling=null,a=L.current,G(L,d?a&1|2:a&1),i):(S(i),null);case 22:case 23:return Hj(),d=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==d&&(i.flags|=8192),d&&i.mode&1?fj&1073741824&&(S(i),i.subtreeFlags&6&&(i.flags|=8192)):S(i),null;case 24:return null;case 25:return null}throw Error(p(156,i.tag))}function Ij(s,i){switch(wg(i),i.tag){case 1:return Zf(i.type)&&$f(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return zh(),E(Wf),E(H),Eh(),s=i.flags,s&65536&&!(s&128)?(i.flags=s&-65537|128,i):null;case 5:return Bh(i),null;case 13:if(E(L),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(p(340));Ig()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(i.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(s,i){var a=s.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(d){W(s,i,d)}else a.current=null}function Mj(s,i,a){try{a()}catch(d){W(s,i,d)}}var Nj=!1;function Oj(s,i){if(Cf=dd,s=Me(),Ne(s)){if("selectionStart"in s)var a={start:s.selectionStart,end:s.selectionEnd};else e:{a=(a=s.ownerDocument)&&a.defaultView||window;var d=a.getSelection&&a.getSelection();if(d&&d.rangeCount!==0){a=d.anchorNode;var g=d.anchorOffset,b=d.focusNode;d=d.focusOffset;try{a.nodeType,b.nodeType}catch{a=null;break e}var $=0,tt=-1,it=-1,rt=0,ot=0,lt=s,ut=null;t:for(;;){for(var pt;lt!==a||g!==0&&lt.nodeType!==3||(tt=$+g),lt!==b||d!==0&&lt.nodeType!==3||(it=$+d),lt.nodeType===3&&($+=lt.nodeValue.length),(pt=lt.firstChild)!==null;)ut=lt,lt=pt;for(;;){if(lt===s)break t;if(ut===a&&++rt===g&&(tt=$),ut===b&&++ot===d&&(it=$),(pt=lt.nextSibling)!==null)break;lt=ut,ut=lt.parentNode}lt=pt}a=tt===-1||it===-1?null:{start:tt,end:it}}else a=null}a=a||{start:0,end:0}}else a=null;for(Df={focusedElem:s,selectionRange:a},dd=!1,V=i;V!==null;)if(i=V,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,V=s;else for(;V!==null;){i=V;try{var _t=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(_t!==null){var wt=_t.memoizedProps,vt=_t.memoizedState,ht=i.stateNode,ft=ht.getSnapshotBeforeUpdate(i.elementType===i.type?wt:Ci(i.type,wt),vt);ht.__reactInternalSnapshotBeforeUpdate=ft}break;case 3:var mt=i.stateNode.containerInfo;mt.nodeType===1?mt.textContent="":mt.nodeType===9&&mt.documentElement&&mt.removeChild(mt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(bt){W(i,i.return,bt)}if(s=i.sibling,s!==null){s.return=i.return,V=s;break}V=i.return}return _t=Nj,Nj=!1,_t}function Pj(s,i,a){var d=i.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var g=d=d.next;do{if((g.tag&s)===s){var b=g.destroy;g.destroy=void 0,b!==void 0&&Mj(i,a,b)}g=g.next}while(g!==d)}}function Qj(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&s)===s){var d=a.create;a.destroy=d()}a=a.next}while(a!==i)}}function Rj(s){var i=s.ref;if(i!==null){var a=s.stateNode;switch(s.tag){case 5:s=a;break;default:s=a}typeof i=="function"?i(s):i.current=s}}function Sj(s){var i=s.alternate;i!==null&&(s.alternate=null,Sj(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[Of],delete i[Pf],delete i[of],delete i[Qf],delete i[Rf])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Tj(s){return s.tag===5||s.tag===3||s.tag===4}function Uj(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Tj(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vj(s,i,a){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(s,i):a.insertBefore(s,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(s,a)):(i=a,i.appendChild(s)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=Bf));else if(d!==4&&(s=s.child,s!==null))for(Vj(s,i,a),s=s.sibling;s!==null;)Vj(s,i,a),s=s.sibling}function Wj(s,i,a){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?a.insertBefore(s,i):a.appendChild(s);else if(d!==4&&(s=s.child,s!==null))for(Wj(s,i,a),s=s.sibling;s!==null;)Wj(s,i,a),s=s.sibling}var X=null,Xj=!1;function Yj(s,i,a){for(a=a.child;a!==null;)Zj(s,i,a),a=a.sibling}function Zj(s,i,a){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,a)}catch{}switch(a.tag){case 5:U||Lj(a,i);case 6:var d=X,g=Xj;X=null,Yj(s,i,a),X=d,Xj=g,X!==null&&(Xj?(s=X,a=a.stateNode,s.nodeType===8?s.parentNode.removeChild(a):s.removeChild(a)):X.removeChild(a.stateNode));break;case 18:X!==null&&(Xj?(s=X,a=a.stateNode,s.nodeType===8?Kf(s.parentNode,a):s.nodeType===1&&Kf(s,a),bd(s)):Kf(X,a.stateNode));break;case 4:d=X,g=Xj,X=a.stateNode.containerInfo,Xj=!0,Yj(s,i,a),X=d,Xj=g;break;case 0:case 11:case 14:case 15:if(!U&&(d=a.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){g=d=d.next;do{var b=g,$=b.destroy;b=b.tag,$!==void 0&&(b&2||b&4)&&Mj(a,i,$),g=g.next}while(g!==d)}Yj(s,i,a);break;case 1:if(!U&&(Lj(a,i),d=a.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=a.memoizedProps,d.state=a.memoizedState,d.componentWillUnmount()}catch(tt){W(a,i,tt)}Yj(s,i,a);break;case 21:Yj(s,i,a);break;case 22:a.mode&1?(U=(d=U)||a.memoizedState!==null,Yj(s,i,a),U=d):Yj(s,i,a);break;default:Yj(s,i,a)}}function ak(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var a=s.stateNode;a===null&&(a=s.stateNode=new Kj),i.forEach(function(d){var g=bk.bind(null,s,d);a.has(d)||(a.add(d),d.then(g,g))})}}function ck(s,i){var a=i.deletions;if(a!==null)for(var d=0;d<a.length;d++){var g=a[d];try{var b=s,$=i,tt=$;e:for(;tt!==null;){switch(tt.tag){case 5:X=tt.stateNode,Xj=!1;break e;case 3:X=tt.stateNode.containerInfo,Xj=!0;break e;case 4:X=tt.stateNode.containerInfo,Xj=!0;break e}tt=tt.return}if(X===null)throw Error(p(160));Zj(b,$,g),X=null,Xj=!1;var it=g.alternate;it!==null&&(it.return=null),g.return=null}catch(rt){W(g,i,rt)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)dk(i,s),i=i.sibling}function dk(s,i){var a=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(ck(i,s),ek(s),d&4){try{Pj(3,s,s.return),Qj(3,s)}catch(wt){W(s,s.return,wt)}try{Pj(5,s,s.return)}catch(wt){W(s,s.return,wt)}}break;case 1:ck(i,s),ek(s),d&512&&a!==null&&Lj(a,a.return);break;case 5:if(ck(i,s),ek(s),d&512&&a!==null&&Lj(a,a.return),s.flags&32){var g=s.stateNode;try{ob(g,"")}catch(wt){W(s,s.return,wt)}}if(d&4&&(g=s.stateNode,g!=null)){var b=s.memoizedProps,$=a!==null?a.memoizedProps:b,tt=s.type,it=s.updateQueue;if(s.updateQueue=null,it!==null)try{tt==="input"&&b.type==="radio"&&b.name!=null&&ab(g,b),vb(tt,$);var rt=vb(tt,b);for($=0;$<it.length;$+=2){var ot=it[$],lt=it[$+1];ot==="style"?sb(g,lt):ot==="dangerouslySetInnerHTML"?nb(g,lt):ot==="children"?ob(g,lt):ta(g,ot,lt,rt)}switch(tt){case"input":bb(g,b);break;case"textarea":ib(g,b);break;case"select":var ut=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!b.multiple;var pt=b.value;pt!=null?fb(g,!!b.multiple,pt,!1):ut!==!!b.multiple&&(b.defaultValue!=null?fb(g,!!b.multiple,b.defaultValue,!0):fb(g,!!b.multiple,b.multiple?[]:"",!1))}g[Pf]=b}catch(wt){W(s,s.return,wt)}}break;case 6:if(ck(i,s),ek(s),d&4){if(s.stateNode===null)throw Error(p(162));g=s.stateNode,b=s.memoizedProps;try{g.nodeValue=b}catch(wt){W(s,s.return,wt)}}break;case 3:if(ck(i,s),ek(s),d&4&&a!==null&&a.memoizedState.isDehydrated)try{bd(i.containerInfo)}catch(wt){W(s,s.return,wt)}break;case 4:ck(i,s),ek(s);break;case 13:ck(i,s),ek(s),g=s.child,g.flags&8192&&(b=g.memoizedState!==null,g.stateNode.isHidden=b,!b||g.alternate!==null&&g.alternate.memoizedState!==null||(fk=B())),d&4&&ak(s);break;case 22:if(ot=a!==null&&a.memoizedState!==null,s.mode&1?(U=(rt=U)||ot,ck(i,s),U=rt):ck(i,s),ek(s),d&8192){if(rt=s.memoizedState!==null,(s.stateNode.isHidden=rt)&&!ot&&s.mode&1)for(V=s,ot=s.child;ot!==null;){for(lt=V=ot;V!==null;){switch(ut=V,pt=ut.child,ut.tag){case 0:case 11:case 14:case 15:Pj(4,ut,ut.return);break;case 1:Lj(ut,ut.return);var _t=ut.stateNode;if(typeof _t.componentWillUnmount=="function"){d=ut,a=ut.return;try{i=d,_t.props=i.memoizedProps,_t.state=i.memoizedState,_t.componentWillUnmount()}catch(wt){W(d,a,wt)}}break;case 5:Lj(ut,ut.return);break;case 22:if(ut.memoizedState!==null){gk(lt);continue}}pt!==null?(pt.return=ut,V=pt):gk(lt)}ot=ot.sibling}e:for(ot=null,lt=s;;){if(lt.tag===5){if(ot===null){ot=lt;try{g=lt.stateNode,rt?(b=g.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(tt=lt.stateNode,it=lt.memoizedProps.style,$=it!=null&&it.hasOwnProperty("display")?it.display:null,tt.style.display=rb("display",$))}catch(wt){W(s,s.return,wt)}}}else if(lt.tag===6){if(ot===null)try{lt.stateNode.nodeValue=rt?"":lt.memoizedProps}catch(wt){W(s,s.return,wt)}}else if((lt.tag!==22&&lt.tag!==23||lt.memoizedState===null||lt===s)&&lt.child!==null){lt.child.return=lt,lt=lt.child;continue}if(lt===s)break e;for(;lt.sibling===null;){if(lt.return===null||lt.return===s)break e;ot===lt&&(ot=null),lt=lt.return}ot===lt&&(ot=null),lt.sibling.return=lt.return,lt=lt.sibling}}break;case 19:ck(i,s),ek(s),d&4&&ak(s);break;case 21:break;default:ck(i,s),ek(s)}}function ek(s){var i=s.flags;if(i&2){try{e:{for(var a=s.return;a!==null;){if(Tj(a)){var d=a;break e}a=a.return}throw Error(p(160))}switch(d.tag){case 5:var g=d.stateNode;d.flags&32&&(ob(g,""),d.flags&=-33);var b=Uj(s);Wj(s,b,g);break;case 3:case 4:var $=d.stateNode.containerInfo,tt=Uj(s);Vj(s,tt,$);break;default:throw Error(p(161))}}catch(it){W(s,s.return,it)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function hk(s,i,a){V=s,ik(s)}function ik(s,i,a){for(var d=(s.mode&1)!==0;V!==null;){var g=V,b=g.child;if(g.tag===22&&d){var $=g.memoizedState!==null||Jj;if(!$){var tt=g.alternate,it=tt!==null&&tt.memoizedState!==null||U;tt=Jj;var rt=U;if(Jj=$,(U=it)&&!rt)for(V=g;V!==null;)$=V,it=$.child,$.tag===22&&$.memoizedState!==null?jk(g):it!==null?(it.return=$,V=it):jk(g);for(;b!==null;)V=b,ik(b),b=b.sibling;V=g,Jj=tt,U=rt}kk(s)}else g.subtreeFlags&8772&&b!==null?(b.return=g,V=b):kk(s)}}function kk(s){for(;V!==null;){var i=V;if(i.flags&8772){var a=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:U||Qj(5,i);break;case 1:var d=i.stateNode;if(i.flags&4&&!U)if(a===null)d.componentDidMount();else{var g=i.elementType===i.type?a.memoizedProps:Ci(i.type,a.memoizedProps);d.componentDidUpdate(g,a.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var b=i.updateQueue;b!==null&&sh(i,b,d);break;case 3:var $=i.updateQueue;if($!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}sh(i,$,a)}break;case 5:var tt=i.stateNode;if(a===null&&i.flags&4){a=tt;var it=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":it.autoFocus&&a.focus();break;case"img":it.src&&(a.src=it.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var rt=i.alternate;if(rt!==null){var ot=rt.memoizedState;if(ot!==null){var lt=ot.dehydrated;lt!==null&&bd(lt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||i.flags&512&&Rj(i)}catch(ut){W(i,i.return,ut)}}if(i===s){V=null;break}if(a=i.sibling,a!==null){a.return=i.return,V=a;break}V=i.return}}function gk(s){for(;V!==null;){var i=V;if(i===s){V=null;break}var a=i.sibling;if(a!==null){a.return=i.return,V=a;break}V=i.return}}function jk(s){for(;V!==null;){var i=V;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{Qj(4,i)}catch(it){W(i,a,it)}break;case 1:var d=i.stateNode;if(typeof d.componentDidMount=="function"){var g=i.return;try{d.componentDidMount()}catch(it){W(i,g,it)}}var b=i.return;try{Rj(i)}catch(it){W(i,b,it)}break;case 5:var $=i.return;try{Rj(i)}catch(it){W(i,$,it)}}}catch(it){W(i,i.return,it)}if(i===s){V=null;break}var tt=i.sibling;if(tt!==null){tt.return=i.return,V=tt;break}V=i.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(s){return s.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(s=C,s!==0||(s=window.event,s=s===void 0?16:jd(s.type)),s):1}function gi(s,i,a,d){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(s,a,d),(!(K&2)||s!==Q)&&(s===Q&&(!(K&2)&&(qk|=a),T===4&&Ck(s,Z)),Dk(s,d),a===1&&K===0&&!(i.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(s,i){var a=s.callbackNode;wc(s,i);var d=uc(s,s===Q?Z:0);if(d===0)a!==null&&bc(a),s.callbackNode=null,s.callbackPriority=0;else if(i=d&-d,s.callbackPriority!==i){if(a!=null&&bc(a),i===1)s.tag===0?ig(Ek.bind(null,s)):hg(Ek.bind(null,s)),Jf(function(){!(K&6)&&jg()}),a=null;else{switch(Dc(d)){case 1:a=fc;break;case 4:a=gc;break;case 16:a=hc;break;case 536870912:a=jc;break;default:a=hc}a=Fk(a,Gk.bind(null,s))}s.callbackPriority=i,s.callbackNode=a}}function Gk(s,i){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var a=s.callbackNode;if(Hk()&&s.callbackNode!==a)return null;var d=uc(s,s===Q?Z:0);if(d===0)return null;if(d&30||d&s.expiredLanes||i)i=Ik(s,d);else{i=d;var g=K;K|=2;var b=Jk();(Q!==s||Z!==i)&&(uk=null,Gj=B()+500,Kk(s,i));do try{Lk();break}catch(tt){Mk(s,tt)}while(!0);$g(),mk.current=b,K=g,Y!==null?i=0:(Q=null,Z=0,i=T)}if(i!==0){if(i===2&&(g=xc(s),g!==0&&(d=g,i=Nk(s,g))),i===1)throw a=pk,Kk(s,0),Ck(s,d),Dk(s,B()),a;if(i===6)Ck(s,d);else{if(g=s.current.alternate,!(d&30)&&!Ok(g)&&(i=Ik(s,d),i===2&&(b=xc(s),b!==0&&(d=b,i=Nk(s,b))),i===1))throw a=pk,Kk(s,0),Ck(s,d),Dk(s,B()),a;switch(s.finishedWork=g,s.finishedLanes=d,i){case 0:case 1:throw Error(p(345));case 2:Pk(s,tk,uk);break;case 3:if(Ck(s,d),(d&130023424)===d&&(i=fk+500-B(),10<i)){if(uc(s,0)!==0)break;if(g=s.suspendedLanes,(g&d)!==d){R(),s.pingedLanes|=s.suspendedLanes&g;break}s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),i);break}Pk(s,tk,uk);break;case 4:if(Ck(s,d),(d&4194240)===d)break;for(i=s.eventTimes,g=-1;0<d;){var $=31-oc(d);b=1<<$,$=i[$],$>g&&(g=$),d&=~b}if(d=g,d=B()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*lk(d/1960))-d,10<d){s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),d);break}Pk(s,tk,uk);break;case 5:Pk(s,tk,uk);break;default:throw Error(p(329))}}}return Dk(s,B()),s.callbackNode===a?Gk.bind(null,s):null}function Nk(s,i){var a=sk;return s.current.memoizedState.isDehydrated&&(Kk(s,i).flags|=256),s=Ik(s,i),s!==2&&(i=tk,tk=a,i!==null&&Fj(i)),s}function Fj(s){tk===null?tk=s:tk.push.apply(tk,s)}function Ok(s){for(var i=s;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var d=0;d<a.length;d++){var g=a[d],b=g.getSnapshot;g=g.value;try{if(!He(b(),g))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ck(s,i){for(i&=~rk,i&=~qk,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var a=31-oc(i),d=1<<a;s[a]=-1,i&=~d}}function Ek(s){if(K&6)throw Error(p(327));Hk();var i=uc(s,0);if(!(i&1))return Dk(s,B()),null;var a=Ik(s,i);if(s.tag!==0&&a===2){var d=xc(s);d!==0&&(i=d,a=Nk(s,d))}if(a===1)throw a=pk,Kk(s,0),Ck(s,i),Dk(s,B()),a;if(a===6)throw Error(p(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,Pk(s,tk,uk),Dk(s,B()),null}function Qk(s,i){var a=K;K|=1;try{return s(i)}finally{K=a,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(s){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var i=K;K|=1;var a=ok.transition,d=C;try{if(ok.transition=null,C=1,s)return s()}finally{C=d,ok.transition=a,K=i,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(s,i){s.finishedWork=null,s.finishedLanes=0;var a=s.timeoutHandle;if(a!==-1&&(s.timeoutHandle=-1,Gf(a)),Y!==null)for(a=Y.return;a!==null;){var d=a;switch(wg(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(d);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(d.type._context);break;case 22:case 23:Hj()}a=a.return}if(Q=s,Y=s=Pg(s.current,null),Z=fj=i,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(i=0;i<fh.length;i++)if(a=fh[i],d=a.interleaved,d!==null){a.interleaved=null;var g=d.next,b=a.pending;if(b!==null){var $=b.next;b.next=g,d.next=$}a.pending=d}fh=null}return s}function Mk(s,i){do{var a=Y;try{if($g(),Fh.current=Rh,Ih){for(var d=M.memoizedState;d!==null;){var g=d.queue;g!==null&&(g.pending=null),d=d.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,a===null||a.return===null){T=1,pk=i,Y=null;break}e:{var b=s,$=a.return,tt=a,it=i;if(i=Z,tt.flags|=32768,it!==null&&typeof it=="object"&&typeof it.then=="function"){var rt=it,ot=tt,lt=ot.tag;if(!(ot.mode&1)&&(lt===0||lt===11||lt===15)){var ut=ot.alternate;ut?(ot.updateQueue=ut.updateQueue,ot.memoizedState=ut.memoizedState,ot.lanes=ut.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var pt=Ui($);if(pt!==null){pt.flags&=-257,Vi(pt,$,tt,b,i),pt.mode&1&&Si(b,rt,i),i=pt,it=rt;var _t=i.updateQueue;if(_t===null){var wt=new Set;wt.add(it),i.updateQueue=wt}else _t.add(it);break e}else{if(!(i&1)){Si(b,rt,i),tj();break e}it=Error(p(426))}}else if(I&&tt.mode&1){var vt=Ui($);if(vt!==null){!(vt.flags&65536)&&(vt.flags|=256),Vi(vt,$,tt,b,i),Jg(Ji(it,tt));break e}}b=it=Ji(it,tt),T!==4&&(T=2),sk===null?sk=[b]:sk.push(b),b=$;do{switch(b.tag){case 3:b.flags|=65536,i&=-i,b.lanes|=i;var ht=Ni(b,it,i);ph(b,ht);break e;case 1:tt=it;var ft=b.type,mt=b.stateNode;if(!(b.flags&128)&&(typeof ft.getDerivedStateFromError=="function"||mt!==null&&typeof mt.componentDidCatch=="function"&&(Ri===null||!Ri.has(mt)))){b.flags|=65536,i&=-i,b.lanes|=i;var bt=Qi(b,tt,i);ph(b,bt);break e}}b=b.return}while(b!==null)}Sk(a)}catch(Et){i=Et,Y===a&&a!==null&&(Y=a=a.return);continue}break}while(!0)}function Jk(){var s=mk.current;return mk.current=Rh,s===null?Rh:s}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(s,i){var a=K;K|=2;var d=Jk();(Q!==s||Z!==i)&&(uk=null,Kk(s,i));do try{Tk();break}catch(g){Mk(s,g)}while(!0);if($g(),K=a,mk.current=d,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(s){var i=Vk(s.alternate,s,fj);s.memoizedProps=s.pendingProps,i===null?Sk(s):Y=i,nk.current=null}function Sk(s){var i=s;do{var a=i.alternate;if(s=i.return,i.flags&32768){if(a=Ij(a,i),a!==null){a.flags&=32767,Y=a;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{T=6,Y=null;return}}else if(a=Ej(a,i,fj),a!==null){Y=a;return}if(i=i.sibling,i!==null){Y=i;return}Y=i=s}while(i!==null);T===0&&(T=5)}function Pk(s,i,a){var d=C,g=ok.transition;try{ok.transition=null,C=1,Wk(s,i,a,d)}finally{ok.transition=g,C=d}return null}function Wk(s,i,a,d){do Hk();while(wk!==null);if(K&6)throw Error(p(327));a=s.finishedWork;var g=s.finishedLanes;if(a===null)return null;if(s.finishedWork=null,s.finishedLanes=0,a===s.current)throw Error(p(177));s.callbackNode=null,s.callbackPriority=0;var b=a.lanes|a.childLanes;if(Bc(s,b),s===Q&&(Y=Q=null,Z=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),b=(a.flags&15990)!==0,a.subtreeFlags&15990||b){b=ok.transition,ok.transition=null;var $=C;C=1;var tt=K;K|=4,nk.current=null,Oj(s,a),dk(a,s),Oe(Df),dd=!!Cf,Df=Cf=null,s.current=a,hk(a),dc(),K=tt,C=$,ok.transition=b}else s.current=a;if(vk&&(vk=!1,wk=s,xk=g),b=s.pendingLanes,b===0&&(Ri=null),mc(a.stateNode),Dk(s,B()),i!==null)for(d=s.onRecoverableError,a=0;a<i.length;a++)g=i[a],d(g.value,{componentStack:g.stack,digest:g.digest});if(Oi)throw Oi=!1,s=Pi,Pi=null,s;return xk&1&&s.tag!==0&&Hk(),b=s.pendingLanes,b&1?s===zk?yk++:(yk=0,zk=s):yk=0,jg(),null}function Hk(){if(wk!==null){var s=Dc(xk),i=ok.transition,a=C;try{if(ok.transition=null,C=16>s?16:s,wk===null)var d=!1;else{if(s=wk,wk=null,xk=0,K&6)throw Error(p(331));var g=K;for(K|=4,V=s.current;V!==null;){var b=V,$=b.child;if(V.flags&16){var tt=b.deletions;if(tt!==null){for(var it=0;it<tt.length;it++){var rt=tt[it];for(V=rt;V!==null;){var ot=V;switch(ot.tag){case 0:case 11:case 15:Pj(8,ot,b)}var lt=ot.child;if(lt!==null)lt.return=ot,V=lt;else for(;V!==null;){ot=V;var ut=ot.sibling,pt=ot.return;if(Sj(ot),ot===rt){V=null;break}if(ut!==null){ut.return=pt,V=ut;break}V=pt}}}var _t=b.alternate;if(_t!==null){var wt=_t.child;if(wt!==null){_t.child=null;do{var vt=wt.sibling;wt.sibling=null,wt=vt}while(wt!==null)}}V=b}}if(b.subtreeFlags&2064&&$!==null)$.return=b,V=$;else e:for(;V!==null;){if(b=V,b.flags&2048)switch(b.tag){case 0:case 11:case 15:Pj(9,b,b.return)}var ht=b.sibling;if(ht!==null){ht.return=b.return,V=ht;break e}V=b.return}}var ft=s.current;for(V=ft;V!==null;){$=V;var mt=$.child;if($.subtreeFlags&2064&&mt!==null)mt.return=$,V=mt;else e:for($=ft;V!==null;){if(tt=V,tt.flags&2048)try{switch(tt.tag){case 0:case 11:case 15:Qj(9,tt)}}catch(Et){W(tt,tt.return,Et)}if(tt===$){V=null;break e}var bt=tt.sibling;if(bt!==null){bt.return=tt.return,V=bt;break e}V=tt.return}}if(K=g,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,s)}catch{}d=!0}return d}finally{C=a,ok.transition=i}}return!1}function Xk(s,i,a){i=Ji(a,i),i=Ni(s,i,1),s=nh(s,i,1),i=R(),s!==null&&(Ac(s,1,i),Dk(s,i))}function W(s,i,a){if(s.tag===3)Xk(s,s,a);else for(;i!==null;){if(i.tag===3){Xk(i,s,a);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Ri===null||!Ri.has(d))){s=Ji(a,s),s=Qi(i,s,1),i=nh(i,s,1),s=R(),i!==null&&(Ac(i,1,s),Dk(i,s));break}}i=i.return}}function Ti(s,i,a){var d=s.pingCache;d!==null&&d.delete(i),i=R(),s.pingedLanes|=s.suspendedLanes&a,Q===s&&(Z&a)===a&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(s,0):rk|=a),Dk(s,i)}function Yk(s,i){i===0&&(s.mode&1?(i=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):i=1);var a=R();s=ih(s,i),s!==null&&(Ac(s,i,a),Dk(s,a))}function uj(s){var i=s.memoizedState,a=0;i!==null&&(a=i.retryLane),Yk(s,a)}function bk(s,i){var a=0;switch(s.tag){case 13:var d=s.stateNode,g=s.memoizedState;g!==null&&(a=g.retryLane);break;case 19:d=s.stateNode;break;default:throw Error(p(314))}d!==null&&d.delete(i),Yk(s,a)}var Vk;Vk=function(s,i,a){if(s!==null)if(s.memoizedProps!==i.pendingProps||Wf.current)dh=!0;else{if(!(s.lanes&a)&&!(i.flags&128))return dh=!1,yj(s,i,a);dh=!!(s.flags&131072)}else dh=!1,I&&i.flags&1048576&&ug(i,ng,i.index);switch(i.lanes=0,i.tag){case 2:var d=i.type;ij(s,i),s=i.pendingProps;var g=Yf(i,H.current);ch(i,a),g=Nh(null,i,d,s,g,a);var b=Sh();return i.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Zf(d)?(b=!0,cg(i)):b=!1,i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,kh(i),g.updater=Ei,i.stateNode=g,g._reactInternals=i,Ii(i,d,s,a),i=jj(null,i,d,!0,b,a)):(i.tag=0,I&&b&&vg(i),Xi(null,i,g,a),i=i.child),i;case 16:d=i.elementType;e:{switch(ij(s,i),s=i.pendingProps,g=d._init,d=g(d._payload),i.type=d,g=i.tag=Zk(d),s=Ci(d,s),g){case 0:i=cj(null,i,d,s,a);break e;case 1:i=hj(null,i,d,s,a);break e;case 11:i=Yi(null,i,d,s,a);break e;case 14:i=$i(null,i,d,Ci(d.type,s),a);break e}throw Error(p(306,d,""))}return i;case 0:return d=i.type,g=i.pendingProps,g=i.elementType===d?g:Ci(d,g),cj(s,i,d,g,a);case 1:return d=i.type,g=i.pendingProps,g=i.elementType===d?g:Ci(d,g),hj(s,i,d,g,a);case 3:e:{if(kj(i),s===null)throw Error(p(387));d=i.pendingProps,b=i.memoizedState,g=b.element,lh(s,i),qh(i,d,null,a);var $=i.memoizedState;if(d=$.element,b.isDehydrated)if(b={element:d,isDehydrated:!1,cache:$.cache,pendingSuspenseBoundaries:$.pendingSuspenseBoundaries,transitions:$.transitions},i.updateQueue.baseState=b,i.memoizedState=b,i.flags&256){g=Ji(Error(p(423)),i),i=lj(s,i,d,a,g);break e}else if(d!==g){g=Ji(Error(p(424)),i),i=lj(s,i,d,a,g);break e}else for(yg=Lf(i.stateNode.containerInfo.firstChild),xg=i,I=!0,zg=null,a=Vg(i,null,d,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Ig(),d===g){i=Zi(s,i,a);break e}Xi(s,i,d,a)}i=i.child}return i;case 5:return Ah(i),s===null&&Eg(i),d=i.type,g=i.pendingProps,b=s!==null?s.memoizedProps:null,$=g.children,Ef(d,g)?$=null:b!==null&&Ef(d,b)&&(i.flags|=32),gj(s,i),Xi(s,i,$,a),i.child;case 6:return s===null&&Eg(i),null;case 13:return oj(s,i,a);case 4:return yh(i,i.stateNode.containerInfo),d=i.pendingProps,s===null?i.child=Ug(i,null,d,a):Xi(s,i,d,a),i.child;case 11:return d=i.type,g=i.pendingProps,g=i.elementType===d?g:Ci(d,g),Yi(s,i,d,g,a);case 7:return Xi(s,i,i.pendingProps,a),i.child;case 8:return Xi(s,i,i.pendingProps.children,a),i.child;case 12:return Xi(s,i,i.pendingProps.children,a),i.child;case 10:e:{if(d=i.type._context,g=i.pendingProps,b=i.memoizedProps,$=g.value,G(Wg,d._currentValue),d._currentValue=$,b!==null)if(He(b.value,$)){if(b.children===g.children&&!Wf.current){i=Zi(s,i,a);break e}}else for(b=i.child,b!==null&&(b.return=i);b!==null;){var tt=b.dependencies;if(tt!==null){$=b.child;for(var it=tt.firstContext;it!==null;){if(it.context===d){if(b.tag===1){it=mh(-1,a&-a),it.tag=2;var rt=b.updateQueue;if(rt!==null){rt=rt.shared;var ot=rt.pending;ot===null?it.next=it:(it.next=ot.next,ot.next=it),rt.pending=it}}b.lanes|=a,it=b.alternate,it!==null&&(it.lanes|=a),bh(b.return,a,i),tt.lanes|=a;break}it=it.next}}else if(b.tag===10)$=b.type===i.type?null:b.child;else if(b.tag===18){if($=b.return,$===null)throw Error(p(341));$.lanes|=a,tt=$.alternate,tt!==null&&(tt.lanes|=a),bh($,a,i),$=b.sibling}else $=b.child;if($!==null)$.return=b;else for($=b;$!==null;){if($===i){$=null;break}if(b=$.sibling,b!==null){b.return=$.return,$=b;break}$=$.return}b=$}Xi(s,i,g.children,a),i=i.child}return i;case 9:return g=i.type,d=i.pendingProps.children,ch(i,a),g=eh(g),d=d(g),i.flags|=1,Xi(s,i,d,a),i.child;case 14:return d=i.type,g=Ci(d,i.pendingProps),g=Ci(d.type,g),$i(s,i,d,g,a);case 15:return bj(s,i,i.type,i.pendingProps,a);case 17:return d=i.type,g=i.pendingProps,g=i.elementType===d?g:Ci(d,g),ij(s,i),i.tag=1,Zf(d)?(s=!0,cg(i)):s=!1,ch(i,a),Gi(i,d,g),Ii(i,d,g,a),jj(null,i,d,!0,s,a);case 19:return xj(s,i,a);case 22:return dj(s,i,a)}throw Error(p(156,i.tag))};function Fk(s,i){return ac(s,i)}function $k(s,i,a,d){this.tag=s,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(s,i,a,d){return new $k(s,i,a,d)}function aj(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Zk(s){if(typeof s=="function")return aj(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Da)return 11;if(s===Ga)return 14}return 2}function Pg(s,i){var a=s.alternate;return a===null?(a=Bg(s.tag,i,s.key,s.mode),a.elementType=s.elementType,a.type=s.type,a.stateNode=s.stateNode,a.alternate=s,s.alternate=a):(a.pendingProps=i,a.type=s.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=s.flags&14680064,a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,i=s.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=s.sibling,a.index=s.index,a.ref=s.ref,a}function Rg(s,i,a,d,g,b){var $=2;if(d=s,typeof s=="function")aj(s)&&($=1);else if(typeof s=="string")$=5;else e:switch(s){case ya:return Tg(a.children,g,b,i);case za:$=8,g|=8;break;case Aa:return s=Bg(12,a,i,g|2),s.elementType=Aa,s.lanes=b,s;case Ea:return s=Bg(13,a,i,g),s.elementType=Ea,s.lanes=b,s;case Fa:return s=Bg(19,a,i,g),s.elementType=Fa,s.lanes=b,s;case Ia:return pj(a,g,b,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Ba:$=10;break e;case Ca:$=9;break e;case Da:$=11;break e;case Ga:$=14;break e;case Ha:$=16,d=null;break e}throw Error(p(130,s==null?s:typeof s,""))}return i=Bg($,a,i,g),i.elementType=s,i.type=d,i.lanes=b,i}function Tg(s,i,a,d){return s=Bg(7,s,d,i),s.lanes=a,s}function pj(s,i,a,d){return s=Bg(22,s,d,i),s.elementType=Ia,s.lanes=a,s.stateNode={isHidden:!1},s}function Qg(s,i,a){return s=Bg(6,s,null,i),s.lanes=a,s}function Sg(s,i,a){return i=Bg(4,s.children!==null?s.children:[],s.key,i),i.lanes=a,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function al(s,i,a,d,g){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=d,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function bl(s,i,a,d,g,b,$,tt,it){return s=new al(s,i,a,tt,it),i===1?(i=1,b===!0&&(i|=8)):i=0,b=Bg(3,null,null,i),s.current=b,b.stateNode=s,b.memoizedState={element:d,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(b),s}function cl(s,i,a){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:d==null?null:""+d,children:s,containerInfo:i,implementation:a}}function dl(s){if(!s)return Vf;s=s._reactInternals;e:{if(Vb(s)!==s||s.tag!==1)throw Error(p(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Zf(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(p(171))}if(s.tag===1){var a=s.type;if(Zf(a))return bg(s,a,i)}return i}function el(s,i,a,d,g,b,$,tt,it){return s=bl(a,d,!0,s,g,b,$,tt,it),s.context=dl(null),a=s.current,d=R(),g=yi(a),b=mh(d,g),b.callback=i??null,nh(a,b,g),s.current.lanes=g,Ac(s,g,d),Dk(s,d),s}function fl(s,i,a,d){var g=i.current,b=R(),$=yi(g);return a=dl(a),i.context===null?i.context=a:i.pendingContext=a,i=mh(b,$),i.payload={element:s},d=d===void 0?null:d,d!==null&&(i.callback=d),s=nh(g,i,$),s!==null&&(gi(s,g,$,b),oh(s,g,$)),$}function gl(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function hl(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var a=s.retryLane;s.retryLane=a!==0&&a<i?a:i}}function il(s,i){hl(s,i),(s=s.alternate)&&hl(s,i)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(s){console.error(s)};function ll(s){this._internalRoot=s}ml.prototype.render=ll.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(p(409));fl(s,i,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Rk(function(){fl(null,s,null,null)}),i[uf]=null}};function ml(s){this._internalRoot=s}ml.prototype.unstable_scheduleHydration=function(s){if(s){var i=Hc();s={blockedOn:null,target:s,priority:i};for(var a=0;a<Qc.length&&i!==0&&i<Qc[a].priority;a++);Qc.splice(a,0,s),a===0&&Vc(s)}};function nl(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function ol(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(s,i,a,d,g){if(g){if(typeof d=="function"){var b=d;d=function(){var rt=gl($);b.call(rt)}}var $=el(i,d,s,0,null,!1,!1,"",pl);return s._reactRootContainer=$,s[uf]=$.current,sf(s.nodeType===8?s.parentNode:s),Rk(),$}for(;g=s.lastChild;)s.removeChild(g);if(typeof d=="function"){var tt=d;d=function(){var rt=gl(it);tt.call(rt)}}var it=bl(s,0,!1,null,null,!1,!1,"",pl);return s._reactRootContainer=it,s[uf]=it.current,sf(s.nodeType===8?s.parentNode:s),Rk(function(){fl(i,it,a,d)}),it}function rl(s,i,a,d,g){var b=a._reactRootContainer;if(b){var $=b;if(typeof g=="function"){var tt=g;g=function(){var it=gl($);tt.call(it)}}fl(i,$,s,g)}else $=ql(a,i,s,g,d);return gl($)}Ec=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var a=tc(i.pendingLanes);a!==0&&(Cc(i,a|1),Dk(i,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var d=ih(s,1);if(d!==null){var g=R();gi(d,s,1,g)}}),il(s,1)}};Fc=function(s){if(s.tag===13){var i=ih(s,134217728);if(i!==null){var a=R();gi(i,s,134217728,a)}il(s,134217728)}};Gc=function(s){if(s.tag===13){var i=yi(s),a=ih(s,i);if(a!==null){var d=R();gi(a,s,i,d)}il(s,i)}};Hc=function(){return C};Ic=function(s,i){var a=C;try{return C=s,i()}finally{C=a}};yb=function(s,i,a){switch(i){case"input":if(bb(s,a),i=a.name,a.type==="radio"&&i!=null){for(a=s;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var d=a[i];if(d!==s&&d.form===s.form){var g=Db(d);if(!g)throw Error(p(90));Wa(d),bb(d,g)}}}break;case"textarea":ib(s,a);break;case"select":i=a.value,i!=null&&fb(s,!!a.multiple,i,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Zb(s),s===null?null:s.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(s,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(i))throw Error(p(200));return cl(s,i,null,a)};reactDom_production_min.createRoot=function(s,i){if(!nl(s))throw Error(p(299));var a=!1,d="",g=kl;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onRecoverableError!==void 0&&(g=i.onRecoverableError)),i=bl(s,1,!1,null,null,a,!1,d,g),s[uf]=i.current,sf(s.nodeType===8?s.parentNode:s),new ll(i)};reactDom_production_min.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(p(188)):(s=Object.keys(s).join(","),Error(p(268,s)));return s=Zb(i),s=s===null?null:s.stateNode,s};reactDom_production_min.flushSync=function(s){return Rk(s)};reactDom_production_min.hydrate=function(s,i,a){if(!ol(i))throw Error(p(200));return rl(null,s,i,!0,a)};reactDom_production_min.hydrateRoot=function(s,i,a){if(!nl(s))throw Error(p(405));var d=a!=null&&a.hydratedSources||null,g=!1,b="",$=kl;if(a!=null&&(a.unstable_strictMode===!0&&(g=!0),a.identifierPrefix!==void 0&&(b=a.identifierPrefix),a.onRecoverableError!==void 0&&($=a.onRecoverableError)),i=el(i,null,s,1,a??null,g,!1,b,$),s[uf]=i.current,sf(s),d)for(s=0;s<d.length;s++)a=d[s],g=a._getVersion,g=g(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,g]:i.mutableSourceEagerHydrationData.push(a,g);return new ml(i)};reactDom_production_min.render=function(s,i,a){if(!ol(i))throw Error(p(200));return rl(null,s,i,!1,a)};reactDom_production_min.unmountComponentAtNode=function(s){if(!ol(s))throw Error(p(40));return s._reactRootContainer?(Rk(function(){rl(null,null,s,!1,function(){s._reactRootContainer=null,s[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(s,i,a,d){if(!ol(a))throw Error(p(200));if(s==null||s._reactInternals===void 0)throw Error(p(38));return rl(s,i,a,!1,d)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(s){console.error(s)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;/**
 * @remix-run/router v1.16.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(s){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(s[d]=a[d])}return s},_extends$2.apply(this,arguments)}var Action;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(s){s===void 0&&(s={});function i(d,g){let{pathname:b,search:$,hash:tt}=d.location;return createLocation("",{pathname:b,search:$,hash:tt},g.state&&g.state.usr||null,g.state&&g.state.key||"default")}function a(d,g){return typeof g=="string"?g:createPath(g)}return getUrlBasedHistory(i,a,null,s)}function invariant(s,i){if(s===!1||s===null||typeof s>"u")throw new Error(i)}function warning(s,i){if(!s){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(s,i){return{usr:s.state,key:s.key,idx:i}}function createLocation(s,i,a,d){return a===void 0&&(a=null),_extends$2({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof i=="string"?parsePath(i):i,{state:a,key:i&&i.key||d||createKey()})}function createPath(s){let{pathname:i="/",search:a="",hash:d=""}=s;return a&&a!=="?"&&(i+=a.charAt(0)==="?"?a:"?"+a),d&&d!=="#"&&(i+=d.charAt(0)==="#"?d:"#"+d),i}function parsePath(s){let i={};if(s){let a=s.indexOf("#");a>=0&&(i.hash=s.substr(a),s=s.substr(0,a));let d=s.indexOf("?");d>=0&&(i.search=s.substr(d),s=s.substr(0,d)),s&&(i.pathname=s)}return i}function getUrlBasedHistory(s,i,a,d){d===void 0&&(d={});let{window:g=document.defaultView,v5Compat:b=!1}=d,$=g.history,tt=Action.Pop,it=null,rt=ot();rt==null&&(rt=0,$.replaceState(_extends$2({},$.state,{idx:rt}),""));function ot(){return($.state||{idx:null}).idx}function lt(){tt=Action.Pop;let vt=ot(),ht=vt==null?null:vt-rt;rt=vt,it&&it({action:tt,location:wt.location,delta:ht})}function ut(vt,ht){tt=Action.Push;let ft=createLocation(wt.location,vt,ht);rt=ot()+1;let mt=getHistoryState(ft,rt),bt=wt.createHref(ft);try{$.pushState(mt,"",bt)}catch(Et){if(Et instanceof DOMException&&Et.name==="DataCloneError")throw Et;g.location.assign(bt)}b&&it&&it({action:tt,location:wt.location,delta:1})}function pt(vt,ht){tt=Action.Replace;let ft=createLocation(wt.location,vt,ht);rt=ot();let mt=getHistoryState(ft,rt),bt=wt.createHref(ft);$.replaceState(mt,"",bt),b&&it&&it({action:tt,location:wt.location,delta:0})}function _t(vt){let ht=g.location.origin!=="null"?g.location.origin:g.location.href,ft=typeof vt=="string"?vt:createPath(vt);return ft=ft.replace(/ $/,"%20"),invariant(ht,"No window.location.(origin|href) available to create URL for href: "+ft),new URL(ft,ht)}let wt={get action(){return tt},get location(){return s(g,$)},listen(vt){if(it)throw new Error("A history only accepts one active listener");return g.addEventListener(PopStateEventType,lt),it=vt,()=>{g.removeEventListener(PopStateEventType,lt),it=null}},createHref(vt){return i(g,vt)},createURL:_t,encodeLocation(vt){let ht=_t(vt);return{pathname:ht.pathname,search:ht.search,hash:ht.hash}},push:ut,replace:pt,go(vt){return $.go(vt)}};return wt}var ResultType;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(ResultType||(ResultType={}));function matchRoutes(s,i,a){a===void 0&&(a="/");let d=typeof i=="string"?parsePath(i):i,g=stripBasename(d.pathname||"/",a);if(g==null)return null;let b=flattenRoutes(s);rankRouteBranches(b);let $=null;for(let tt=0;$==null&&tt<b.length;++tt){let it=decodePath$1(g);$=matchRouteBranch(b[tt],it)}return $}function flattenRoutes(s,i,a,d){i===void 0&&(i=[]),a===void 0&&(a=[]),d===void 0&&(d="");let g=(b,$,tt)=>{let it={relativePath:tt===void 0?b.path||"":tt,caseSensitive:b.caseSensitive===!0,childrenIndex:$,route:b};it.relativePath.startsWith("/")&&(invariant(it.relativePath.startsWith(d),'Absolute route path "'+it.relativePath+'" nested under path '+('"'+d+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),it.relativePath=it.relativePath.slice(d.length));let rt=joinPaths([d,it.relativePath]),ot=a.concat(it);b.children&&b.children.length>0&&(invariant(b.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+rt+'".')),flattenRoutes(b.children,i,ot,rt)),!(b.path==null&&!b.index)&&i.push({path:rt,score:computeScore(rt,b.index),routesMeta:ot})};return s.forEach((b,$)=>{var tt;if(b.path===""||!((tt=b.path)!=null&&tt.includes("?")))g(b,$);else for(let it of explodeOptionalSegments(b.path))g(b,$,it)}),i}function explodeOptionalSegments(s){let i=s.split("/");if(i.length===0)return[];let[a,...d]=i,g=a.endsWith("?"),b=a.replace(/\?$/,"");if(d.length===0)return g?[b,""]:[b];let $=explodeOptionalSegments(d.join("/")),tt=[];return tt.push(...$.map(it=>it===""?b:[b,it].join("/"))),g&&tt.push(...$),tt.map(it=>s.startsWith("/")&&it===""?"/":it)}function rankRouteBranches(s){s.sort((i,a)=>i.score!==a.score?a.score-i.score:compareIndexes(i.routesMeta.map(d=>d.childrenIndex),a.routesMeta.map(d=>d.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=s=>s==="*";function computeScore(s,i){let a=s.split("/"),d=a.length;return a.some(isSplat)&&(d+=splatPenalty),i&&(d+=indexRouteValue),a.filter(g=>!isSplat(g)).reduce((g,b)=>g+(paramRe.test(b)?dynamicSegmentValue:b===""?emptySegmentValue:staticSegmentValue),d)}function compareIndexes(s,i){return s.length===i.length&&s.slice(0,-1).every((d,g)=>d===i[g])?s[s.length-1]-i[i.length-1]:0}function matchRouteBranch(s,i){let{routesMeta:a}=s,d={},g="/",b=[];for(let $=0;$<a.length;++$){let tt=a[$],it=$===a.length-1,rt=g==="/"?i:i.slice(g.length)||"/",ot=matchPath({path:tt.relativePath,caseSensitive:tt.caseSensitive,end:it},rt);if(!ot)return null;Object.assign(d,ot.params);let lt=tt.route;b.push({params:d,pathname:joinPaths([g,ot.pathname]),pathnameBase:normalizePathname(joinPaths([g,ot.pathnameBase])),route:lt}),ot.pathnameBase!=="/"&&(g=joinPaths([g,ot.pathnameBase]))}return b}function matchPath(s,i){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[a,d]=compilePath(s.path,s.caseSensitive,s.end),g=i.match(a);if(!g)return null;let b=g[0],$=b.replace(/(.)\/+$/,"$1"),tt=g.slice(1);return{params:d.reduce((rt,ot,lt)=>{let{paramName:ut,isOptional:pt}=ot;if(ut==="*"){let wt=tt[lt]||"";$=b.slice(0,b.length-wt.length).replace(/(.)\/+$/,"$1")}const _t=tt[lt];return pt&&!_t?rt[ut]=void 0:rt[ut]=(_t||"").replace(/%2F/g,"/"),rt},{}),pathname:b,pathnameBase:$,pattern:s}}function compilePath(s,i,a){i===void 0&&(i=!1),a===void 0&&(a=!0),warning(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let d=[],g="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,($,tt,it)=>(d.push({paramName:tt,isOptional:it!=null}),it?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(d.push({paramName:"*"}),g+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?g+="\\/*$":s!==""&&s!=="/"&&(g+="(?:(?=\\/|$))"),[new RegExp(g,i?void 0:"i"),d]}function decodePath$1(s){try{return s.split("/").map(i=>decodeURIComponent(i).replace(/\//g,"%2F")).join("/")}catch(i){return warning(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+i+").")),s}}function stripBasename(s,i){if(i==="/")return s;if(!s.toLowerCase().startsWith(i.toLowerCase()))return null;let a=i.endsWith("/")?i.length-1:i.length,d=s.charAt(a);return d&&d!=="/"?null:s.slice(a)||"/"}function resolvePath(s,i){i===void 0&&(i="/");let{pathname:a,search:d="",hash:g=""}=typeof s=="string"?parsePath(s):s;return{pathname:a?a.startsWith("/")?a:resolvePathname(a,i):i,search:normalizeSearch(d),hash:normalizeHash(g)}}function resolvePathname(s,i){let a=i.replace(/\/+$/,"").split("/");return s.split("/").forEach(g=>{g===".."?a.length>1&&a.pop():g!=="."&&a.push(g)}),a.length>1?a.join("/"):"/"}function getInvalidPathError(s,i,a,d){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+i+"` field ["+JSON.stringify(d)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(s){return s.filter((i,a)=>a===0||i.route.path&&i.route.path.length>0)}function getResolveToMatches(s,i){let a=getPathContributingMatches(s);return i?a.map((d,g)=>g===s.length-1?d.pathname:d.pathnameBase):a.map(d=>d.pathnameBase)}function resolveTo(s,i,a,d){d===void 0&&(d=!1);let g;typeof s=="string"?g=parsePath(s):(g=_extends$2({},s),invariant(!g.pathname||!g.pathname.includes("?"),getInvalidPathError("?","pathname","search",g)),invariant(!g.pathname||!g.pathname.includes("#"),getInvalidPathError("#","pathname","hash",g)),invariant(!g.search||!g.search.includes("#"),getInvalidPathError("#","search","hash",g)));let b=s===""||g.pathname==="",$=b?"/":g.pathname,tt;if($==null)tt=a;else{let lt=i.length-1;if(!d&&$.startsWith("..")){let ut=$.split("/");for(;ut[0]==="..";)ut.shift(),lt-=1;g.pathname=ut.join("/")}tt=lt>=0?i[lt]:"/"}let it=resolvePath(g,tt),rt=$&&$!=="/"&&$.endsWith("/"),ot=(b||$===".")&&a.endsWith("/");return!it.pathname.endsWith("/")&&(rt||ot)&&(it.pathname+="/"),it}const joinPaths=s=>s.join("/").replace(/\/\/+/g,"/"),normalizePathname=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,normalizeHash=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function isRouteErrorResponse(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(s){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(s[d]=a[d])}return s},_extends$1.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(s,i){let{relative:a}=i===void 0?{}:i;useInRouterContext()||invariant(!1);let{basename:d,navigator:g}=reactExports.useContext(NavigationContext),{hash:b,pathname:$,search:tt}=useResolvedPath(s,{relative:a}),it=$;return d!=="/"&&(it=$==="/"?d:joinPaths([d,$])),g.createHref({pathname:it,search:tt,hash:b})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect(s){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(s)}function useNavigate(){let{isDataRoute:s}=reactExports.useContext(RouteContext);return s?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let s=reactExports.useContext(DataRouterContext),{basename:i,future:a,navigator:d}=reactExports.useContext(NavigationContext),{matches:g}=reactExports.useContext(RouteContext),{pathname:b}=useLocation(),$=JSON.stringify(getResolveToMatches(g,a.v7_relativeSplatPath)),tt=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{tt.current=!0}),reactExports.useCallback(function(rt,ot){if(ot===void 0&&(ot={}),!tt.current)return;if(typeof rt=="number"){d.go(rt);return}let lt=resolveTo(rt,JSON.parse($),b,ot.relative==="path");s==null&&i!=="/"&&(lt.pathname=lt.pathname==="/"?i:joinPaths([i,lt.pathname])),(ot.replace?d.replace:d.push)(lt,ot.state,ot)},[i,d,$,b,s])}function useResolvedPath(s,i){let{relative:a}=i===void 0?{}:i,{future:d}=reactExports.useContext(NavigationContext),{matches:g}=reactExports.useContext(RouteContext),{pathname:b}=useLocation(),$=JSON.stringify(getResolveToMatches(g,d.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(s,JSON.parse($),b,a==="path"),[s,$,b,a])}function useRoutes(s,i){return useRoutesImpl(s,i)}function useRoutesImpl(s,i,a,d){useInRouterContext()||invariant(!1);let{navigator:g}=reactExports.useContext(NavigationContext),{matches:b}=reactExports.useContext(RouteContext),$=b[b.length-1],tt=$?$.params:{};$&&$.pathname;let it=$?$.pathnameBase:"/";$&&$.route;let rt=useLocation(),ot;if(i){var lt;let vt=typeof i=="string"?parsePath(i):i;it==="/"||(lt=vt.pathname)!=null&&lt.startsWith(it)||invariant(!1),ot=vt}else ot=rt;let ut=ot.pathname||"/",pt=ut;if(it!=="/"){let vt=it.replace(/^\//,"").split("/");pt="/"+ut.replace(/^\//,"").split("/").slice(vt.length).join("/")}let _t=matchRoutes(s,{pathname:pt}),wt=_renderMatches(_t&&_t.map(vt=>Object.assign({},vt,{params:Object.assign({},tt,vt.params),pathname:joinPaths([it,g.encodeLocation?g.encodeLocation(vt.pathname).pathname:vt.pathname]),pathnameBase:vt.pathnameBase==="/"?it:joinPaths([it,g.encodeLocation?g.encodeLocation(vt.pathnameBase).pathname:vt.pathnameBase])})),b,a,d);return i&&wt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},ot),navigationType:Action.Pop}},wt):wt}function DefaultErrorComponent(){let s=useRouteError(),i=isRouteErrorResponse(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),a=s instanceof Error?s.stack:null,g={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},i),a?reactExports.createElement("pre",{style:g},a):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,a){return a.location!==i.location||a.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:a.error,location:a.location,revalidation:i.revalidation||a.revalidation}}componentDidCatch(i,a){console.error("React Router caught the following error during render",i,a)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(s){let{routeContext:i,match:a,children:d}=s,g=reactExports.useContext(DataRouterContext);return g&&g.static&&g.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(g.staticContext._deepestRenderedBoundaryId=a.route.id),reactExports.createElement(RouteContext.Provider,{value:i},d)}function _renderMatches(s,i,a,d){var g;if(i===void 0&&(i=[]),a===void 0&&(a=null),d===void 0&&(d=null),s==null){var b;if((b=a)!=null&&b.errors)s=a.matches;else return null}let $=s,tt=(g=a)==null?void 0:g.errors;if(tt!=null){let ot=$.findIndex(lt=>lt.route.id&&(tt==null?void 0:tt[lt.route.id])!==void 0);ot>=0||invariant(!1),$=$.slice(0,Math.min($.length,ot+1))}let it=!1,rt=-1;if(a&&d&&d.v7_partialHydration)for(let ot=0;ot<$.length;ot++){let lt=$[ot];if((lt.route.HydrateFallback||lt.route.hydrateFallbackElement)&&(rt=ot),lt.route.id){let{loaderData:ut,errors:pt}=a,_t=lt.route.loader&&ut[lt.route.id]===void 0&&(!pt||pt[lt.route.id]===void 0);if(lt.route.lazy||_t){it=!0,rt>=0?$=$.slice(0,rt+1):$=[$[0]];break}}}return $.reduceRight((ot,lt,ut)=>{let pt,_t=!1,wt=null,vt=null;a&&(pt=tt&&lt.route.id?tt[lt.route.id]:void 0,wt=lt.route.errorElement||defaultErrorElement,it&&(rt<0&&ut===0?(_t=!0,vt=null):rt===ut&&(_t=!0,vt=lt.route.hydrateFallbackElement||null)));let ht=i.concat($.slice(0,ut+1)),ft=()=>{let mt;return pt?mt=wt:_t?mt=vt:lt.route.Component?mt=reactExports.createElement(lt.route.Component,null):lt.route.element?mt=lt.route.element:mt=ot,reactExports.createElement(RenderedRoute,{match:lt,routeContext:{outlet:ot,matches:ht,isDataRoute:a!=null},children:mt})};return a&&(lt.route.ErrorBoundary||lt.route.errorElement||ut===0)?reactExports.createElement(RenderErrorBoundary,{location:a.location,revalidation:a.revalidation,component:wt,error:pt,children:ft(),routeContext:{outlet:null,matches:ht,isDataRoute:!0}}):ft()},null)}var DataRouterHook$1=function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s}(DataRouterHook$1||{}),DataRouterStateHook$1=function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s}(DataRouterStateHook$1||{});function useDataRouterContext$1(s){let i=reactExports.useContext(DataRouterContext);return i||invariant(!1),i}function useDataRouterState(s){let i=reactExports.useContext(DataRouterStateContext);return i||invariant(!1),i}function useRouteContext(s){let i=reactExports.useContext(RouteContext);return i||invariant(!1),i}function useCurrentRouteId(s){let i=useRouteContext(),a=i.matches[i.matches.length-1];return a.route.id||invariant(!1),a.route.id}function useRouteError(){var s;let i=reactExports.useContext(RouteErrorContext),a=useDataRouterState(DataRouterStateHook$1.UseRouteError),d=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return i!==void 0?i:(s=a.errors)==null?void 0:s[d]}function useNavigateStable(){let{router:s}=useDataRouterContext$1(DataRouterHook$1.UseNavigateStable),i=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),a=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{a.current=!0}),reactExports.useCallback(function(g,b){b===void 0&&(b={}),a.current&&(typeof g=="number"?s.navigate(g):s.navigate(g,_extends$1({fromRouteId:i},b)))},[s,i])}function Route(s){invariant(!1)}function Router(s){let{basename:i="/",children:a=null,location:d,navigationType:g=Action.Pop,navigator:b,static:$=!1,future:tt}=s;useInRouterContext()&&invariant(!1);let it=i.replace(/^\/*/,"/"),rt=reactExports.useMemo(()=>({basename:it,navigator:b,static:$,future:_extends$1({v7_relativeSplatPath:!1},tt)}),[it,tt,b,$]);typeof d=="string"&&(d=parsePath(d));let{pathname:ot="/",search:lt="",hash:ut="",state:pt=null,key:_t="default"}=d,wt=reactExports.useMemo(()=>{let vt=stripBasename(ot,it);return vt==null?null:{location:{pathname:vt,search:lt,hash:ut,state:pt,key:_t},navigationType:g}},[it,ot,lt,ut,pt,_t,g]);return wt==null?null:reactExports.createElement(NavigationContext.Provider,{value:rt},reactExports.createElement(LocationContext.Provider,{children:a,value:wt}))}function Routes(s){let{children:i,location:a}=s;return useRoutes(createRoutesFromChildren(i),a)}new Promise(()=>{});function createRoutesFromChildren(s,i){i===void 0&&(i=[]);let a=[];return reactExports.Children.forEach(s,(d,g)=>{if(!reactExports.isValidElement(d))return;let b=[...i,g];if(d.type===reactExports.Fragment){a.push.apply(a,createRoutesFromChildren(d.props.children,b));return}d.type!==Route&&invariant(!1),!d.props.index||!d.props.children||invariant(!1);let $={id:d.props.id||b.join("-"),caseSensitive:d.props.caseSensitive,element:d.props.element,Component:d.props.Component,index:d.props.index,path:d.props.path,loader:d.props.loader,action:d.props.action,errorElement:d.props.errorElement,ErrorBoundary:d.props.ErrorBoundary,hasErrorBoundary:d.props.ErrorBoundary!=null||d.props.errorElement!=null,shouldRevalidate:d.props.shouldRevalidate,handle:d.props.handle,lazy:d.props.lazy};d.props.children&&($.children=createRoutesFromChildren(d.props.children,b)),a.push($)}),a}/**
 * React Router DOM v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(s){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(s[d]=a[d])}return s},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(s,i){if(s==null)return{};var a={},d=Object.keys(s),g,b;for(b=0;b<d.length;b++)g=d[b],!(i.indexOf(g)>=0)&&(a[g]=s[g]);return a}function isModifiedEvent(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function shouldProcessLinkClick(s,i){return s.button===0&&(!i||i==="_self")&&!isModifiedEvent(s)}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],_excluded2=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const ViewTransitionContext=reactExports.createContext({isTransitioning:!1}),START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function BrowserRouter(s){let{basename:i,children:a,future:d,window:g}=s,b=reactExports.useRef();b.current==null&&(b.current=createBrowserHistory({window:g,v5Compat:!0}));let $=b.current,[tt,it]=reactExports.useState({action:$.action,location:$.location}),{v7_startTransition:rt}=d||{},ot=reactExports.useCallback(lt=>{rt&&startTransitionImpl?startTransitionImpl(()=>it(lt)):it(lt)},[it,rt]);return reactExports.useLayoutEffect(()=>$.listen(ot),[$,ot]),reactExports.createElement(Router,{basename:i,children:a,location:tt.location,navigationType:tt.action,navigator:$,future:d})}const isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(i,a){let{onClick:d,relative:g,reloadDocument:b,replace:$,state:tt,target:it,to:rt,preventScrollReset:ot,unstable_viewTransition:lt}=i,ut=_objectWithoutPropertiesLoose(i,_excluded),{basename:pt}=reactExports.useContext(NavigationContext),_t,wt=!1;if(typeof rt=="string"&&ABSOLUTE_URL_REGEX.test(rt)&&(_t=rt,isBrowser$1))try{let mt=new URL(window.location.href),bt=rt.startsWith("//")?new URL(mt.protocol+rt):new URL(rt),Et=stripBasename(bt.pathname,pt);bt.origin===mt.origin&&Et!=null?rt=Et+bt.search+bt.hash:wt=!0}catch{}let vt=useHref(rt,{relative:g}),ht=useLinkClickHandler(rt,{replace:$,state:tt,target:it,preventScrollReset:ot,relative:g,unstable_viewTransition:lt});function ft(mt){d&&d(mt),mt.defaultPrevented||ht(mt)}return reactExports.createElement("a",_extends({},ut,{href:_t||vt,onClick:wt||b?d:ft,ref:a,target:it}))}),NavLink=reactExports.forwardRef(function(i,a){let{"aria-current":d="page",caseSensitive:g=!1,className:b="",end:$=!1,style:tt,to:it,unstable_viewTransition:rt,children:ot}=i,lt=_objectWithoutPropertiesLoose(i,_excluded2),ut=useResolvedPath(it,{relative:lt.relative}),pt=useLocation(),_t=reactExports.useContext(DataRouterStateContext),{navigator:wt,basename:vt}=reactExports.useContext(NavigationContext),ht=_t!=null&&useViewTransitionState(ut)&&rt===!0,ft=wt.encodeLocation?wt.encodeLocation(ut).pathname:ut.pathname,mt=pt.pathname,bt=_t&&_t.navigation&&_t.navigation.location?_t.navigation.location.pathname:null;g||(mt=mt.toLowerCase(),bt=bt?bt.toLowerCase():null,ft=ft.toLowerCase()),bt&&vt&&(bt=stripBasename(bt,vt)||bt);const Et=ft!=="/"&&ft.endsWith("/")?ft.length-1:ft.length;let It=mt===ft||!$&&mt.startsWith(ft)&&mt.charAt(Et)==="/",Ot=bt!=null&&(bt===ft||!$&&bt.startsWith(ft)&&bt.charAt(ft.length)==="/"),jt={isActive:It,isPending:Ot,isTransitioning:ht},xt=It?d:void 0,Lt;typeof b=="function"?Lt=b(jt):Lt=[b,It?"active":null,Ot?"pending":null,ht?"transitioning":null].filter(Boolean).join(" ");let qt=typeof tt=="function"?tt(jt):tt;return reactExports.createElement(Link,_extends({},lt,{"aria-current":xt,className:Lt,ref:a,style:qt,to:it,unstable_viewTransition:rt}),typeof ot=="function"?ot(jt):ot)});var DataRouterHook;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useDataRouterContext(s){let i=reactExports.useContext(DataRouterContext);return i||invariant(!1),i}function useLinkClickHandler(s,i){let{target:a,replace:d,state:g,preventScrollReset:b,relative:$,unstable_viewTransition:tt}=i===void 0?{}:i,it=useNavigate(),rt=useLocation(),ot=useResolvedPath(s,{relative:$});return reactExports.useCallback(lt=>{if(shouldProcessLinkClick(lt,a)){lt.preventDefault();let ut=d!==void 0?d:createPath(rt)===createPath(ot);it(s,{replace:ut,state:g,preventScrollReset:b,relative:$,unstable_viewTransition:tt})}},[rt,it,ot,d,g,a,s,b,$,tt])}function useViewTransitionState(s,i){i===void 0&&(i={});let a=reactExports.useContext(ViewTransitionContext);a==null&&invariant(!1);let{basename:d}=useDataRouterContext(DataRouterHook.useViewTransitionState),g=useResolvedPath(s,{relative:i.relative});if(!a.isTransitioning)return!1;let b=stripBasename(a.currentLocation.pathname,d)||a.currentLocation.pathname,$=stripBasename(a.nextLocation.pathname,d)||a.nextLocation.pathname;return matchPath(g.pathname,$)!=null||matchPath(g.pathname,b)!=null}function Navbar(){const s=useNavigate();return jsxRuntimeExports.jsx("div",{className:"mx-2",children:jsxRuntimeExports.jsxs("div",{className:"navbar bg-base-100",children:[jsxRuntimeExports.jsx("div",{className:"flex-1",children:jsxRuntimeExports.jsx(NavLink,{onClick:i=>{i.preventDefault(),s(-1)},className:"btn btn-ghost text-sm sm:text-xl",children:"<-- SCI-MCQ-Question Upload"})}),jsxRuntimeExports.jsx("div",{className:"flex-none",children:jsxRuntimeExports.jsxs("details",{role:"button",className:"dropdown dropdown-end mr-8",children:[jsxRuntimeExports.jsx("summary",{className:"m-1 ",children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})})}),jsxRuntimeExports.jsxs("ul",{className:"p-2 shadow menu dropdown-content z-[1] bg-base-100 rounded-box w-52",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(NavLink,{to:"/",children:"Exam"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(NavLink,{to:"/year",children:"Year"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(NavLink,{to:"/questions",children:"Questions"})})]})]})})]})})}var dist={exports:{}},propTypes={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=s,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var s=requireReactPropTypesSecret();function i(){}function a(){}return a.resetWarningCache=i,factoryWithThrowingShims=function(){function d($,tt,it,rt,ot,lt){if(lt!==s){var ut=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw ut.name="Invariant Violation",ut}}d.isRequired=d;function g(){return d}var b={array:d,bigint:d,bool:d,func:d,number:d,object:d,string:d,symbol:d,any:d,arrayOf:g,element:d,elementType:d,instanceOf:g,node:d,objectOf:g,oneOf:g,oneOfType:g,shape:g,exact:g,checkPropTypes:a,resetWarningCache:i};return b.PropTypes=b,b},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes.exports=requireFactoryWithThrowingShims()()),propTypes.exports}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Watchdog{constructor(i){if(this.crashes=[],this.state="initializing",this._now=Date.now,this.crashes=[],this._crashNumberLimit=typeof i.crashNumberLimit=="number"?i.crashNumberLimit:3,this._minimumNonErrorTimePeriod=typeof i.minimumNonErrorTimePeriod=="number"?i.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=a=>{const d="error"in a?a.error:a.reason;d instanceof Error&&this._handleError(d,a)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(i,a){this._listeners[i]||(this._listeners[i]=[]),this._listeners[i].push(a)}off(i,a){this._listeners[i]=this._listeners[i].filter(d=>d!==a)}_fire(i,...a){const d=this._listeners[i]||[];for(const g of d)g.apply(this,[null,...a])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(i,a){if(this._shouldReactToError(i)){this.crashes.push({message:i.message,stack:i.stack,filename:a instanceof ErrorEvent?a.filename:void 0,lineno:a instanceof ErrorEvent?a.lineno:void 0,colno:a instanceof ErrorEvent?a.colno:void 0,date:this._now()});const d=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:i,causesRestart:d}),d?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(i){return i.is&&i.is("CKEditorError")&&i.context!==void 0&&i.context!==null&&this.state==="ready"&&this._isErrorComingFromThisItem(i)}_shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;const i=this.crashes[this.crashes.length-1].date,a=this.crashes[this.crashes.length-1-this._crashNumberLimit].date;return(i-a)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function getSubNodes(s,i=new Set){const a=[s],d=new Set;let g=0;for(;a.length>g;){const b=a[g++];if(!(d.has(b)||!shouldNodeBeIncluded(b)||i.has(b)))if(d.add(b),Symbol.iterator in b)try{for(const $ of b)a.push($)}catch{}else for(const $ in b)$!=="defaultValue"&&a.push(b[$])}return d}function shouldNodeBeIncluded(s){const i=Object.prototype.toString.call(s),a=typeof s;return!(a==="number"||a==="boolean"||a==="string"||a==="symbol"||a==="function"||i==="[object Date]"||i==="[object RegExp]"||i==="[object Module]"||s===void 0||s===null||s._watchdogExcluded||s instanceof EventTarget||s instanceof Event)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function areConnectedThroughProperties(s,i,a=new Set){if(s===i&&isObject$2(s))return!0;const d=getSubNodes(s,a),g=getSubNodes(i,a);for(const b of d)if(g.has(b))return!0;return!1}function isObject$2(s){return typeof s=="object"&&s!==null}var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root.Symbol,objectProto$d=Object.prototype,hasOwnProperty$a=objectProto$d.hasOwnProperty,nativeObjectToString$1=objectProto$d.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(s){var i=hasOwnProperty$a.call(s,symToStringTag$1),a=s[symToStringTag$1];try{s[symToStringTag$1]=void 0;var d=!0}catch{}var g=nativeObjectToString$1.call(s);return d&&(i?s[symToStringTag$1]=a:delete s[symToStringTag$1]),g}var objectProto$c=Object.prototype,nativeObjectToString=objectProto$c.toString;function objectToString(s){return nativeObjectToString.call(s)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(s){return s==null?s===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(s)?getRawTag(s):objectToString(s)}function isObjectLike(s){return s!=null&&typeof s=="object"}var symbolTag$2="[object Symbol]";function isSymbol(s){return typeof s=="symbol"||isObjectLike(s)&&baseGetTag(s)==symbolTag$2}var isArray=Array.isArray,reWhitespace=/\s/;function trimmedEndIndex(s){for(var i=s.length;i--&&reWhitespace.test(s.charAt(i)););return i}var reTrimStart=/^\s+/;function baseTrim(s){return s&&s.slice(0,trimmedEndIndex(s)+1).replace(reTrimStart,"")}function isObject$1(s){var i=typeof s;return s!=null&&(i=="object"||i=="function")}var NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber$1(s){if(typeof s=="number")return s;if(isSymbol(s))return NAN;if(isObject$1(s)){var i=typeof s.valueOf=="function"?s.valueOf():s;s=isObject$1(i)?i+"":i}if(typeof s!="string")return s===0?s:+s;s=baseTrim(s);var a=reIsBinary.test(s);return a||reIsOctal.test(s)?freeParseInt(s.slice(2),a?2:8):reIsBadHex.test(s)?NAN:+s}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(s){if(!isObject$1(s))return!1;var i=baseGetTag(s);return i==funcTag$2||i==genTag$1||i==asyncTag||i==proxyTag}var coreJsData=root["__core-js_shared__"],maskSrcKey=function(){var s=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function isMasked(s){return!!maskSrcKey&&maskSrcKey in s}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(s){if(s!=null){try{return funcToString$2.call(s)}catch{}try{return s+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$b=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$9=objectProto$b.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$9).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(s){if(!isObject$1(s)||isMasked(s))return!1;var i=isFunction(s)?reIsNative:reIsHostCtor;return i.test(toSource(s))}function getValue(s,i){return s==null?void 0:s[i]}function getNative(s,i){var a=getValue(s,i);return baseIsNative(a)?a:void 0}var WeakMap$1=getNative(root,"WeakMap"),objectCreate=Object.create,baseCreate=function(){function s(){}return function(i){if(!isObject$1(i))return{};if(objectCreate)return objectCreate(i);s.prototype=i;var a=new s;return s.prototype=void 0,a}}();function copyArray(s,i){var a=-1,d=s.length;for(i||(i=Array(d));++a<d;)i[a]=s[a];return i}var defineProperty=function(){try{var s=getNative(Object,"defineProperty");return s({},"",{}),s}catch{}}();function arrayEach(s,i){for(var a=-1,d=s==null?0:s.length;++a<d&&i(s[a],a,s)!==!1;);return s}var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(s,i){var a=typeof s;return i=i??MAX_SAFE_INTEGER$1,!!i&&(a=="number"||a!="symbol"&&reIsUint.test(s))&&s>-1&&s%1==0&&s<i}function baseAssignValue(s,i,a){i=="__proto__"&&defineProperty?defineProperty(s,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):s[i]=a}function eq(s,i){return s===i||s!==s&&i!==i}var objectProto$a=Object.prototype,hasOwnProperty$8=objectProto$a.hasOwnProperty;function assignValue(s,i,a){var d=s[i];(!(hasOwnProperty$8.call(s,i)&&eq(d,a))||a===void 0&&!(i in s))&&baseAssignValue(s,i,a)}function copyObject(s,i,a,d){var g=!a;a||(a={});for(var b=-1,$=i.length;++b<$;){var tt=i[b],it=void 0;it===void 0&&(it=s[tt]),g?baseAssignValue(a,tt,it):assignValue(a,tt,it)}return a}var MAX_SAFE_INTEGER=9007199254740991;function isLength(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=MAX_SAFE_INTEGER}function isArrayLike(s){return s!=null&&isLength(s.length)&&!isFunction(s)}var objectProto$9=Object.prototype;function isPrototype(s){var i=s&&s.constructor,a=typeof i=="function"&&i.prototype||objectProto$9;return s===a}function baseTimes(s,i){for(var a=-1,d=Array(s);++a<s;)d[a]=i(a);return d}var argsTag$2="[object Arguments]";function baseIsArguments(s){return isObjectLike(s)&&baseGetTag(s)==argsTag$2}var objectProto$8=Object.prototype,hasOwnProperty$7=objectProto$8.hasOwnProperty,propertyIsEnumerable$1=objectProto$8.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(s){return isObjectLike(s)&&hasOwnProperty$7.call(s,"callee")&&!propertyIsEnumerable$1.call(s,"callee")};function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",funcTag$1="[object Function]",mapTag$4="[object Map]",numberTag$2="[object Number]",objectTag$3="[object Object]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0;typedArrayTags[argsTag$1]=typedArrayTags[arrayTag$1]=typedArrayTags[arrayBufferTag$2]=typedArrayTags[boolTag$2]=typedArrayTags[dataViewTag$3]=typedArrayTags[dateTag$2]=typedArrayTags[errorTag$1]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$4]=typedArrayTags[numberTag$2]=typedArrayTags[objectTag$3]=typedArrayTags[regexpTag$2]=typedArrayTags[setTag$4]=typedArrayTags[stringTag$2]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(s){return isObjectLike(s)&&isLength(s.length)&&!!typedArrayTags[baseGetTag(s)]}function baseUnary(s){return function(i){return s(i)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{var s=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return s||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty;function arrayLikeKeys(s,i){var a=isArray(s),d=!a&&isArguments(s),g=!a&&!d&&isBuffer(s),b=!a&&!d&&!g&&isTypedArray(s),$=a||d||g||b,tt=$?baseTimes(s.length,String):[],it=tt.length;for(var rt in s)(i||hasOwnProperty$6.call(s,rt))&&!($&&(rt=="length"||g&&(rt=="offset"||rt=="parent")||b&&(rt=="buffer"||rt=="byteLength"||rt=="byteOffset")||isIndex(rt,it)))&&tt.push(rt);return tt}function overArg(s,i){return function(a){return s(i(a))}}var nativeKeys=overArg(Object.keys,Object),objectProto$6=Object.prototype,hasOwnProperty$5=objectProto$6.hasOwnProperty;function baseKeys(s){if(!isPrototype(s))return nativeKeys(s);var i=[];for(var a in Object(s))hasOwnProperty$5.call(s,a)&&a!="constructor"&&i.push(a);return i}function keys(s){return isArrayLike(s)?arrayLikeKeys(s):baseKeys(s)}function nativeKeysIn(s){var i=[];if(s!=null)for(var a in Object(s))i.push(a);return i}var objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty;function baseKeysIn(s){if(!isObject$1(s))return nativeKeysIn(s);var i=isPrototype(s),a=[];for(var d in s)d=="constructor"&&(i||!hasOwnProperty$4.call(s,d))||a.push(d);return a}function keysIn$1(s){return isArrayLike(s)?arrayLikeKeys(s,!0):baseKeysIn(s)}var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(s){var i=this.has(s)&&delete this.__data__[s];return this.size-=i?1:0,i}var HASH_UNDEFINED$1="__lodash_hash_undefined__",objectProto$4=Object.prototype,hasOwnProperty$3=objectProto$4.hasOwnProperty;function hashGet(s){var i=this.__data__;if(nativeCreate){var a=i[s];return a===HASH_UNDEFINED$1?void 0:a}return hasOwnProperty$3.call(i,s)?i[s]:void 0}var objectProto$3=Object.prototype,hasOwnProperty$2=objectProto$3.hasOwnProperty;function hashHas(s){var i=this.__data__;return nativeCreate?i[s]!==void 0:hasOwnProperty$2.call(i,s)}var HASH_UNDEFINED="__lodash_hash_undefined__";function hashSet(s,i){var a=this.__data__;return this.size+=this.has(s)?0:1,a[s]=nativeCreate&&i===void 0?HASH_UNDEFINED:i,this}function Hash(s){var i=-1,a=s==null?0:s.length;for(this.clear();++i<a;){var d=s[i];this.set(d[0],d[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(s,i){for(var a=s.length;a--;)if(eq(s[a][0],i))return a;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(s){var i=this.__data__,a=assocIndexOf(i,s);if(a<0)return!1;var d=i.length-1;return a==d?i.pop():splice.call(i,a,1),--this.size,!0}function listCacheGet(s){var i=this.__data__,a=assocIndexOf(i,s);return a<0?void 0:i[a][1]}function listCacheHas(s){return assocIndexOf(this.__data__,s)>-1}function listCacheSet(s,i){var a=this.__data__,d=assocIndexOf(a,s);return d<0?(++this.size,a.push([s,i])):a[d][1]=i,this}function ListCache(s){var i=-1,a=s==null?0:s.length;for(this.clear();++i<a;){var d=s[i];this.set(d[0],d[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root,"Map");function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(s){var i=typeof s;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?s!=="__proto__":s===null}function getMapData(s,i){var a=s.__data__;return isKeyable(i)?a[typeof i=="string"?"string":"hash"]:a.map}function mapCacheDelete(s){var i=getMapData(this,s).delete(s);return this.size-=i?1:0,i}function mapCacheGet(s){return getMapData(this,s).get(s)}function mapCacheHas(s){return getMapData(this,s).has(s)}function mapCacheSet(s,i){var a=getMapData(this,s),d=a.size;return a.set(s,i),this.size+=a.size==d?0:1,this}function MapCache(s){var i=-1,a=s==null?0:s.length;for(this.clear();++i<a;){var d=s[i];this.set(d[0],d[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;function arrayPush(s,i){for(var a=-1,d=i.length,g=s.length;++a<d;)s[g+a]=i[a];return s}var getPrototype=overArg(Object.getPrototypeOf,Object),objectTag$2="[object Object]",funcProto=Function.prototype,objectProto$2=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$1=objectProto$2.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject(s){if(!isObjectLike(s)||baseGetTag(s)!=objectTag$2)return!1;var i=getPrototype(s);if(i===null)return!0;var a=hasOwnProperty$1.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&funcToString.call(a)==objectCtorString}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(s){var i=this.__data__,a=i.delete(s);return this.size=i.size,a}function stackGet(s){return this.__data__.get(s)}function stackHas(s){return this.__data__.has(s)}var LARGE_ARRAY_SIZE=200;function stackSet(s,i){var a=this.__data__;if(a instanceof ListCache){var d=a.__data__;if(!Map$1||d.length<LARGE_ARRAY_SIZE-1)return d.push([s,i]),this.size=++a.size,this;a=this.__data__=new MapCache(d)}return a.set(s,i),this.size=a.size,this}function Stack(s){var i=this.__data__=new ListCache(s);this.size=i.size}Stack.prototype.clear=stackClear;Stack.prototype.delete=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(s,i){return s&&copyObject(i,keys(i),s)}function baseAssignIn(s,i){return s&&copyObject(i,keysIn$1(i),s)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;function cloneBuffer(s,i){if(i)return s.slice();var a=s.length,d=allocUnsafe?allocUnsafe(a):new s.constructor(a);return s.copy(d),d}function arrayFilter(s,i){for(var a=-1,d=s==null?0:s.length,g=0,b=[];++a<d;){var $=s[a];i($,a,s)&&(b[g++]=$)}return b}function stubArray(){return[]}var objectProto$1=Object.prototype,propertyIsEnumerable=objectProto$1.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(s){return s==null?[]:(s=Object(s),arrayFilter(nativeGetSymbols$1(s),function(i){return propertyIsEnumerable.call(s,i)}))}:stubArray;function copySymbols(s,i){return copyObject(s,getSymbols(s),i)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(s){for(var i=[];s;)arrayPush(i,getSymbols(s)),s=getPrototype(s);return i}:stubArray;function copySymbolsIn(s,i){return copyObject(s,getSymbolsIn(s),i)}function baseGetAllKeys(s,i,a){var d=i(s);return isArray(s)?d:arrayPush(d,a(s))}function getAllKeys(s){return baseGetAllKeys(s,keys,getSymbols)}function getAllKeysIn(s){return baseGetAllKeys(s,keysIn$1,getSymbolsIn)}var DataView$1=getNative(root,"DataView"),Promise$1=getNative(root,"Promise"),Set$1=getNative(root,"Set"),mapTag$3="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$3="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$2="[object DataView]",dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1),getTag=baseGetTag;(DataView$1&&getTag(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$2||Map$1&&getTag(new Map$1)!=mapTag$3||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set$1&&getTag(new Set$1)!=setTag$3||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag$1)&&(getTag=function(s){var i=baseGetTag(s),a=i==objectTag$1?s.constructor:void 0,d=a?toSource(a):"";if(d)switch(d){case dataViewCtorString:return dataViewTag$2;case mapCtorString:return mapTag$3;case promiseCtorString:return promiseTag;case setCtorString:return setTag$3;case weakMapCtorString:return weakMapTag$1}return i});var objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function initCloneArray(s){var i=s.length,a=new s.constructor(i);return i&&typeof s[0]=="string"&&hasOwnProperty.call(s,"index")&&(a.index=s.index,a.input=s.input),a}var Uint8Array$1=root.Uint8Array;function cloneArrayBuffer(s){var i=new s.constructor(s.byteLength);return new Uint8Array$1(i).set(new Uint8Array$1(s)),i}function cloneDataView(s,i){var a=i?cloneArrayBuffer(s.buffer):s.buffer;return new s.constructor(a,s.byteOffset,s.byteLength)}var reFlags=/\w*$/;function cloneRegExp(s){var i=new s.constructor(s.source,reFlags.exec(s));return i.lastIndex=s.lastIndex,i}var symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function cloneSymbol(s){return symbolValueOf?Object(symbolValueOf.call(s)):{}}function cloneTypedArray(s,i){var a=i?cloneArrayBuffer(s.buffer):s.buffer;return new s.constructor(a,s.byteOffset,s.length)}var boolTag$1="[object Boolean]",dateTag$1="[object Date]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(s,i,a){var d=s.constructor;switch(i){case arrayBufferTag$1:return cloneArrayBuffer(s);case boolTag$1:case dateTag$1:return new d(+s);case dataViewTag$1:return cloneDataView(s,a);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(s,a);case mapTag$2:return new d;case numberTag$1:case stringTag$1:return new d(s);case regexpTag$1:return cloneRegExp(s);case setTag$2:return new d;case symbolTag$1:return cloneSymbol(s)}}function initCloneObject(s){return typeof s.constructor=="function"&&!isPrototype(s)?baseCreate(getPrototype(s)):{}}var mapTag$1="[object Map]";function baseIsMap(s){return isObjectLike(s)&&getTag(s)==mapTag$1}var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,setTag$1="[object Set]";function baseIsSet(s){return isObjectLike(s)&&getTag(s)==setTag$1}var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$1=4,argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0;cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(s,i,a,d,g,b){var $,tt=i&CLONE_DEEP_FLAG$1,it=i&CLONE_FLAT_FLAG,rt=i&CLONE_SYMBOLS_FLAG$1;if(a&&($=g?a(s,d,g,b):a(s)),$!==void 0)return $;if(!isObject$1(s))return s;var ot=isArray(s);if(ot){if($=initCloneArray(s),!tt)return copyArray(s,$)}else{var lt=getTag(s),ut=lt==funcTag||lt==genTag;if(isBuffer(s))return cloneBuffer(s,tt);if(lt==objectTag||lt==argsTag||ut&&!g){if($=it||ut?{}:initCloneObject(s),!tt)return it?copySymbolsIn(s,baseAssignIn($,s)):copySymbols(s,baseAssign($,s))}else{if(!cloneableTags[lt])return g?s:{};$=initCloneByTag(s,lt,tt)}}b||(b=new Stack);var pt=b.get(s);if(pt)return pt;b.set(s,$),isSet(s)?s.forEach(function(vt){$.add(baseClone(vt,i,a,vt,s,b))}):isMap(s)&&s.forEach(function(vt,ht){$.set(ht,baseClone(vt,i,a,ht,s,b))});var _t=rt?it?getAllKeysIn:getAllKeys:it?keysIn$1:keys,wt=ot?void 0:_t(s);return arrayEach(wt||s,function(vt,ht){wt&&(ht=vt,vt=s[ht]),assignValue($,ht,baseClone(vt,i,a,ht,s,b))}),$}var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeepWith(s,i){return i=typeof i=="function"?i:void 0,baseClone(s,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG,i)}var now=function(){return root.Date.now()},FUNC_ERROR_TEXT$1="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce(s,i,a){var d,g,b,$,tt,it,rt=0,ot=!1,lt=!1,ut=!0;if(typeof s!="function")throw new TypeError(FUNC_ERROR_TEXT$1);i=toNumber$1(i)||0,isObject$1(a)&&(ot=!!a.leading,lt="maxWait"in a,b=lt?nativeMax(toNumber$1(a.maxWait)||0,i):b,ut="trailing"in a?!!a.trailing:ut);function pt(It){var Ot=d,jt=g;return d=g=void 0,rt=It,$=s.apply(jt,Ot),$}function _t(It){return rt=It,tt=setTimeout(ht,i),ot?pt(It):$}function wt(It){var Ot=It-it,jt=It-rt,xt=i-Ot;return lt?nativeMin(xt,b-jt):xt}function vt(It){var Ot=It-it,jt=It-rt;return it===void 0||Ot>=i||Ot<0||lt&&jt>=b}function ht(){var It=now();if(vt(It))return ft(It);tt=setTimeout(ht,wt(It))}function ft(It){return tt=void 0,ut&&d?pt(It):(d=g=void 0,$)}function mt(){tt!==void 0&&clearTimeout(tt),rt=0,d=it=g=tt=void 0}function bt(){return tt===void 0?$:ft(now())}function Et(){var It=now(),Ot=vt(It);if(d=arguments,g=this,it=It,Ot){if(tt===void 0)return _t(it);if(lt)return clearTimeout(tt),tt=setTimeout(ht,i),pt(it)}return tt===void 0&&(tt=setTimeout(ht,i)),$}return Et.cancel=mt,Et.flush=bt,Et}function isElement(s){return isObjectLike(s)&&s.nodeType===1&&!isPlainObject(s)}var FUNC_ERROR_TEXT="Expected a function";function throttle(s,i,a){var d=!0,g=!0;if(typeof s!="function")throw new TypeError(FUNC_ERROR_TEXT);return isObject$1(a)&&(d="leading"in a?!!a.leading:d,g="trailing"in a?!!a.trailing:g),debounce(s,i,{leading:d,maxWait:i,trailing:g})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class EditorWatchdog extends Watchdog{constructor(i,a={}){super(a),this._editor=null,this._lifecyclePromise=null,this._initUsingData=!0,this._editables={},this._throttledSave=throttle(this._save.bind(this),typeof a.saveInterval=="number"?a.saveInterval:5e3),i&&(this._creator=(d,g)=>i.create(d,g)),this._destructor=d=>d.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(i){this._creator=i}setDestructor(i){this._destructor=i}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(i=>{console.error("An error happened during the editor destroying.",i)}).then(()=>{const i={},a=[],d=this._config.rootsAttributes||{},g={};for(const[$,tt]of Object.entries(this._data.roots))tt.isLoaded?(i[$]="",g[$]=d[$]||{}):a.push($);const b={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:a,rootsAttributes:g,_watchdogInitialData:this._data};return delete b.initialData,b.extraPlugins.push(EditorWatchdogInitPlugin),this._initUsingData?this.create(i,b,b.context):isElement(this._elementOrData)?this.create(this._elementOrData,b,b.context):this.create(this._editables,b,b.context)}).then(()=>{this._fire("restart")})}create(i=this._elementOrData,a=this._config,d){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=i,this._initUsingData=typeof i=="string"||Object.keys(i).length>0&&typeof Object.values(i)[0]=="string",this._config=this._cloneEditorConfiguration(a)||{},this._config.context=d,this._creator(i,this._config))).then(g=>{this._editor=g,g.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=g.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const i=this._editor;return this._editor=null,i.model.document.off("change:data",this._throttledSave),this._destructor(i)})}_save(){const i=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=i}catch(a){console.error(a,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(i){this._excludedProps=i}_getData(){const i=this._editor,a=i.model.document.roots.filter(tt=>tt.isAttached()&&tt.rootName!="$graveyard"),{plugins:d}=i,g=d.has("CommentsRepository")&&d.get("CommentsRepository"),b=d.has("TrackChanges")&&d.get("TrackChanges"),$={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};a.forEach(tt=>{$.roots[tt.rootName]={content:JSON.stringify(Array.from(tt.getChildren())),attributes:JSON.stringify(Array.from(tt.getAttributes())),isLoaded:tt._isLoaded}});for(const tt of i.model.markers)tt._affectsData&&($.markers[tt.name]={rangeJSON:tt.getRange().toJSON(),usingOperation:tt._managedUsingOperations,affectsData:tt._affectsData});return g&&($.commentThreads=JSON.stringify(g.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),b&&($.suggestions=JSON.stringify(b.getSuggestions({toJSON:!0,skipNotAttached:!0}))),$}_getEditables(){const i={};for(const a of this.editor.model.document.getRootNames()){const d=this.editor.ui.getEditableElement(a);d&&(i[a]=d)}return i}_isErrorComingFromThisItem(i){return areConnectedThroughProperties(this._editor,i.context,this._excludedProps)}_cloneEditorConfiguration(i){return cloneDeepWith(i,(a,d)=>{if(isElement(a)||d==="context")return a})}}class EditorWatchdogInitPlugin{constructor(i){this.editor=i,this._data=i.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",i=>{i.stop(),this.editor.model.enqueueChange({isUndoable:!1},a=>{this._restoreCollaborationData(),this._restoreEditorData(a)}),this.editor.data.fire("ready")},{priority:999})}_createNode(i,a){if("name"in a){const d=i.createElement(a.name,a.attributes);if(a.children)for(const g of a.children)d._appendChild(this._createNode(i,g));return d}else return i.createText(a.data,a.attributes)}_restoreEditorData(i){const a=this.editor;Object.entries(this._data.roots).forEach(([d,{content:g,attributes:b}])=>{const $=JSON.parse(g),tt=JSON.parse(b),it=a.model.document.getRoot(d);for(const[rt,ot]of tt)i.setAttribute(rt,ot,it);for(const rt of $){const ot=this._createNode(i,rt);i.insert(ot,it,"end")}}),Object.entries(this._data.markers).forEach(([d,g])=>{const{document:b}=a.model,{rangeJSON:{start:$,end:tt},...it}=g,rt=b.getRoot($.root),ot=i.createPositionFromPath(rt,$.path,$.stickiness),lt=i.createPositionFromPath(rt,tt.path,tt.stickiness),ut=i.createRange(ot,lt);i.addMarker(d,{range:ut,...it})})}_restoreCollaborationData(){const i=JSON.parse(this._data.commentThreads),a=JSON.parse(this._data.suggestions);i.forEach(d=>{const g=this.editor.config.get("collaboration.channelId"),b=this.editor.plugins.get("CommentsRepository");b.hasCommentThread(d.threadId)&&b.getCommentThread(d.threadId).remove(),b.addCommentThread({channelId:g,...d})}),a.forEach(d=>{const g=this.editor.plugins.get("TrackChangesEditing");if(g.hasSuggestion(d.id)){const b=g.getSuggestion(d.id);b.attributes=d.attributes}else g.addSuggestionData(d)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const mainQueueId=Symbol("MainQueueId");class ContextWatchdog extends Watchdog{constructor(i,a={}){super(a),this._watchdogs=new Map,this._context=null,this._contextProps=new Set,this._actionQueues=new ActionQueues,this._watchdogConfig=a,this._creator=d=>i.create(d),this._destructor=d=>d.destroy(),this._actionQueues.onEmpty(()=>{this.state==="initializing"&&(this.state="ready",this._fire("stateChange"))})}setCreator(i){this._creator=i}setDestructor(i){this._destructor=i}get context(){return this._context}create(i={}){return this._actionQueues.enqueue(mainQueueId,()=>(this._contextConfig=i,this._create()))}getItem(i){return this._getWatchdog(i)._item}getItemState(i){return this._getWatchdog(i).state}add(i){const a=toArray$1(i);return Promise.all(a.map(d=>this._actionQueues.enqueue(d.id,()=>{if(this.state==="destroyed")throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");let g;if(this._watchdogs.has(d.id))throw new Error(`Item with the given id is already added: '${d.id}'.`);if(d.type==="editor")return g=new EditorWatchdog(null,this._watchdogConfig),g.setCreator(d.creator),g._setExcludedProperties(this._contextProps),d.destructor&&g.setDestructor(d.destructor),this._watchdogs.set(d.id,g),g.on("error",(b,{error:$,causesRestart:tt})=>{this._fire("itemError",{itemId:d.id,error:$}),tt&&this._actionQueues.enqueue(d.id,()=>new Promise(it=>{const rt=()=>{g.off("restart",rt),this._fire("itemRestart",{itemId:d.id}),it()};g.on("restart",rt)}))}),g.create(d.sourceElementOrData,d.config,this._context);throw new Error(`Not supported item type: '${d.type}'.`)})))}remove(i){const a=toArray$1(i);return Promise.all(a.map(d=>this._actionQueues.enqueue(d,()=>{const g=this._getWatchdog(d);return this._watchdogs.delete(d),g.destroy()})))}destroy(){return this._actionQueues.enqueue(mainQueueId,()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_restart(){return this._actionQueues.enqueue(mainQueueId,()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch(i=>{console.error("An error happened during destroying the context or items.",i)}).then(()=>this._create()).then(()=>this._fire("restart"))))}_create(){return Promise.resolve().then(()=>(this._startErrorHandling(),this._creator(this._contextConfig))).then(i=>(this._context=i,this._contextProps=getSubNodes(this._context),Promise.all(Array.from(this._watchdogs.values()).map(a=>(a._setExcludedProperties(this._contextProps),a.create(void 0,void 0,this._context))))))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling();const i=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map(a=>a.destroy())).then(()=>this._destructor(i))})}_getWatchdog(i){const a=this._watchdogs.get(i);if(!a)throw new Error(`Item with the given id was not registered: ${i}.`);return a}_isErrorComingFromThisItem(i){for(const a of this._watchdogs.values())if(a._isErrorComingFromThisItem(i))return!1;return areConnectedThroughProperties(this._context,i.context)}}class ActionQueues{constructor(){this._onEmptyCallbacks=[],this._queues=new Map,this._activeActions=0}onEmpty(i){this._onEmptyCallbacks.push(i)}enqueue(i,a){const d=i===mainQueueId;this._activeActions++,this._queues.get(i)||this._queues.set(i,Promise.resolve());const b=(d?Promise.all(this._queues.values()):Promise.all([this._queues.get(mainQueueId),this._queues.get(i)])).then(a),$=b.catch(()=>{});return this._queues.set(i,$),b.finally(()=>{this._activeActions--,this._queues.get(i)===$&&this._activeActions===0&&this._onEmptyCallbacks.forEach(tt=>tt())})}}function toArray$1(s){return Array.isArray(s)?s:[s]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const src=Object.freeze(Object.defineProperty({__proto__:null,ContextWatchdog,EditorWatchdog,Watchdog},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(src);/*!
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */(function(s,i){(function(a,d){s.exports=d(reactExports,requirePropTypes(),require$$2)})(self,(a,d,g)=>(()=>{var b={546:rt=>{rt.exports=g},949:rt=>{rt.exports=d},155:rt=>{rt.exports=a}},$={};function tt(rt){var ot=$[rt];if(ot!==void 0)return ot.exports;var lt=$[rt]={exports:{}};return b[rt](lt,lt.exports,tt),lt.exports}tt.n=rt=>{var ot=rt&&rt.__esModule?()=>rt.default:()=>rt;return tt.d(ot,{a:ot}),ot},tt.d=(rt,ot)=>{for(var lt in ot)tt.o(ot,lt)&&!tt.o(rt,lt)&&Object.defineProperty(rt,lt,{enumerable:!0,get:ot[lt]})},tt.o=(rt,ot)=>Object.prototype.hasOwnProperty.call(rt,ot),tt.r=rt=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(rt,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(rt,"__esModule",{value:!0})};var it={};return(()=>{tt.r(it),tt.d(it,{CKEditor:()=>mt,CKEditorContext:()=>vt,useMultiRootEditor:()=>$n});var rt=tt(155),ot=tt.n(rt),lt=tt(949),ut=tt.n(lt);const pt=new Array(256).fill("").map(($t,Rt)=>("0"+Rt.toString(16)).slice(-2));var _t=tt(546);const wt=ot().createContext("contextWatchdog");class vt extends ot().Component{constructor(Rt,Dt){super(Rt,Dt),this.contextWatchdog=null,this.props.isLayoutReady&&this._initializeContextWatchdog(this.props.config)}shouldComponentUpdate(Rt){return this._shouldComponentUpdate(Rt)}async _shouldComponentUpdate(Rt){return Rt.id!==this.props.id&&(this.contextWatchdog&&await this.contextWatchdog.destroy(),await this._initializeContextWatchdog(Rt.config)),Rt.isLayoutReady&&!this.contextWatchdog?(await this._initializeContextWatchdog(Rt.config),!0):this.props.children!==Rt.children}render(){return ot().createElement(wt.Provider,{value:this.contextWatchdog},this.props.children)}componentWillUnmount(){this._destroyContext()}async _initializeContextWatchdog(Rt){this.contextWatchdog=new _t.ContextWatchdog(this.props.context,this.props.watchdogConfig),this.contextWatchdog.on("error",(Dt,Vt)=>{this.props.onError(Vt.error,{phase:"runtime",willContextRestart:Vt.causesRestart})}),this.contextWatchdog.on("stateChange",()=>{this.contextWatchdog.state==="ready"&&this.props.onReady&&this.props.onReady(this.contextWatchdog.context)}),await this.contextWatchdog.create(Rt).catch(Dt=>{this.props.onError(Dt,{phase:"initialization",willContextRestart:!1})})}async _destroyContext(){this.contextWatchdog&&(await this.contextWatchdog.destroy(),this.contextWatchdog=null)}}vt.defaultProps={isLayoutReady:!0,onError:($t,Rt)=>console.error($t,Rt)},vt.propTypes={id:ut().string,isLayoutReady:ut().bool,context:ut().func,watchdogConfig:ut().object,config:ut().object,onReady:ut().func,onError:ut().func};class ht{constructor(Rt,Dt){this._releaseLock=null,this._value=null,this._afterMountCallbacks=[],this._state={destroyedBeforeInitialization:!1,mountingInProgress:null},this.release=function(Vt){let St=null;return(...Bt)=>(St||(St={current:Vt(...Bt)}),St.current)}(()=>{const{_releaseLock:Vt,_state:St,_element:Bt,_lifecycle:Pt}=this;St.mountingInProgress?St.mountingInProgress.then(()=>Pt.unmount({element:Bt,mountResult:this.value})).catch(Gt=>{console.error("Semaphore unmounting error:",Gt)}).then(Vt.resolve).then(()=>{this._value=null}):(St.destroyedBeforeInitialization=!0,Vt.resolve())}),this._element=Rt,this._lifecycle=Dt,this._lock()}get value(){return this._value}unsafeSetValue(Rt){this._value=Rt,this._afterMountCallbacks.forEach(Dt=>Dt(Rt)),this._afterMountCallbacks=[]}runAfterMount(Rt){const{_value:Dt,_afterMountCallbacks:Vt}=this;Dt?Rt(Dt):Vt.push(Rt)}_lock(){const{_semaphores:Rt}=ht,{_state:Dt,_element:Vt,_lifecycle:St}=this,Bt=Rt.get(Vt)||Promise.resolve(null),Pt=function(){const Qt={resolve:null,promise:null};return Qt.promise=new Promise(On=>{Qt.resolve=On}),Qt}();this._releaseLock=Pt;const Gt=Bt.then(()=>Dt.destroyedBeforeInitialization?Promise.resolve(void 0):(Dt.mountingInProgress=St.mount().then(Qt=>(Qt&&this.unsafeSetValue(Qt),Qt)),Dt.mountingInProgress)).then(async Qt=>{Qt&&St.afterMount&&await St.afterMount({element:Vt,mountResult:Qt})}).then(()=>Pt.promise).catch(Qt=>{console.error("Semaphore mounting error:",Qt)}).then(()=>{Rt.get(Vt)===Gt&&Rt.delete(Vt)});Rt.set(Vt,Gt)}}ht._semaphores=new Map;const ft="Lock from React integration (@ckeditor/ckeditor5-react)";class mt extends ot().Component{constructor(Rt){super(Rt),this.domContainer=ot().createRef(),this.editorSemaphore=null;const{CKEDITOR_VERSION:Dt}=window;if(Dt){const[Vt]=Dt.split(".").map(Number);Vt<37&&console.warn("The <CKEditor> component requires using CKEditor 5 in version 37 or higher.")}else console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.')}get _semaphoreValue(){const{editorSemaphore:Rt}=this;return Rt?Rt.value:null}get watchdog(){const{_semaphoreValue:Rt}=this;return Rt?Rt.watchdog:null}get editor(){const{_semaphoreValue:Rt}=this;return Rt?Rt.instance:null}shouldComponentUpdate(Rt){const{props:Dt,editorSemaphore:Vt}=this;return Rt.id!==Dt.id||Rt.disableWatchdog!==Dt.disableWatchdog||(Vt&&(Vt.runAfterMount(({instance:St})=>{this._shouldUpdateEditorData(Dt,Rt,St)&&St.data.set(Rt.data)}),"disabled"in Rt&&Vt.runAfterMount(({instance:St})=>{Rt.disabled?St.enableReadOnlyMode(ft):St.disableReadOnlyMode(ft)})),!1)}componentDidMount(){this._initLifeCycleSemaphore()}componentDidUpdate(){this._initLifeCycleSemaphore()}componentWillUnmount(){this._unlockLifeCycleSemaphore()}_unlockLifeCycleSemaphore(){this.editorSemaphore&&(this.editorSemaphore.release(),this.editorSemaphore=null)}_initLifeCycleSemaphore(){this._unlockLifeCycleSemaphore(),this.editorSemaphore=new ht(this.domContainer.current,{mount:async()=>this._initializeEditor(),afterMount:({mountResult:Rt})=>{const{onReady:Dt}=this.props;Dt&&this.domContainer.current!==null&&Dt(Rt.instance)},unmount:async({element:Rt,mountResult:Dt})=>{const{onAfterDestroy:Vt}=this.props;try{await this._destroyEditor(Dt),Rt.innerHTML=""}finally{Vt&&Vt(Dt.instance)}}})}render(){return ot().createElement("div",{ref:this.domContainer})}async _initializeEditor(){if(this.props.disableWatchdog)return{instance:await this._createEditor(this.domContainer.current,this._getConfig()),watchdog:null};const Rt=this.context instanceof _t.ContextWatchdog?new bt(this.context):new mt._EditorWatchdog(this.props.editor,this.props.watchdogConfig),Dt={current:0};return Rt.setCreator(async(Vt,St)=>{const{editorSemaphore:Bt}=this,{onAfterDestroy:Pt}=this.props;Dt.current>0&&Pt&&Bt&&Bt.value&&Bt.value.instance&&Pt(Bt.value.instance);const Gt=await this._createEditor(Vt,St);return Dt.current>0&&(Bt.unsafeSetValue({instance:Gt,watchdog:Rt}),setTimeout(()=>{this.props.onReady&&this.props.onReady(Rt.editor)})),Dt.current++,Gt}),Rt.on("error",(Vt,{error:St,causesRestart:Bt})=>{(this.props.onError||console.error)(St,{phase:"runtime",willEditorRestart:Bt})}),await Rt.create(this.domContainer.current,this._getConfig()).catch(Vt=>{(this.props.onError||console.error)(Vt,{phase:"initialization",willEditorRestart:!1})}),{watchdog:Rt,instance:Rt.editor}}_createEditor(Rt,Dt){return this.props.editor.create(Rt,Dt).then(Vt=>{"disabled"in this.props&&this.props.disabled&&Vt.enableReadOnlyMode(ft);const St=Vt.model.document,Bt=Vt.editing.view.document;return St.on("change:data",Pt=>{this.props.onChange&&this.props.onChange(Pt,Vt)}),Bt.on("focus",Pt=>{this.props.onFocus&&this.props.onFocus(Pt,Vt)}),Bt.on("blur",Pt=>{this.props.onBlur&&this.props.onBlur(Pt,Vt)}),Vt})}async _destroyEditor(Rt){const{watchdog:Dt,instance:Vt}=Rt;return new Promise((St,Bt)=>{setTimeout(async()=>{try{if(Dt)return await Dt.destroy(),St();if(Vt)return await Vt.destroy(),St();St()}catch(Pt){console.error(Pt),Bt(Pt)}})})}_shouldUpdateEditorData(Rt,Dt,Vt){return Rt.data!==Dt.data&&Vt.data.get()!==Dt.data}_getConfig(){const Rt=this.props.config||{};return this.props.data&&Rt.initialData&&console.warn("Editor data should be provided either using `config.initialData` or `content` property. The config value takes precedence over `content` property and will be used when both are specified."),{...Rt,initialData:Rt.initialData||this.props.data||""}}}mt.contextType=wt,mt.propTypes={editor:ut().func.isRequired,data:ut().string,config:ut().object,disableWatchdog:ut().bool,watchdogConfig:ut().object,onChange:ut().func,onReady:ut().func,onFocus:ut().func,onBlur:ut().func,onError:ut().func,disabled:ut().bool,id:ut().any},mt._EditorWatchdog=_t.EditorWatchdog;class bt{constructor(Rt){this._contextWatchdog=Rt,this._id=function(){const Dt=4294967296*Math.random()>>>0,Vt=4294967296*Math.random()>>>0,St=4294967296*Math.random()>>>0,Bt=4294967296*Math.random()>>>0;return"e"+pt[255&Dt]+pt[Dt>>8&255]+pt[Dt>>16&255]+pt[Dt>>24&255]+pt[255&Vt]+pt[Vt>>8&255]+pt[Vt>>16&255]+pt[Vt>>24&255]+pt[255&St]+pt[St>>8&255]+pt[St>>16&255]+pt[St>>24&255]+pt[255&Bt]+pt[Bt>>8&255]+pt[Bt>>16&255]+pt[Bt>>24&255]}()}setCreator(Rt){this._creator=Rt}create(Rt,Dt){return this._contextWatchdog.add({sourceElementOrData:Rt,config:Dt,creator:this._creator,id:this._id,type:"editor"})}on(Rt,Dt){this._contextWatchdog.on("itemError",(Vt,{itemId:St,error:Bt})=>{St===this._id&&Dt(null,{error:Bt,causesRestart:void 0})})}destroy(){return this._contextWatchdog.state==="ready"?this._contextWatchdog.remove(this._id):Promise.resolve()}get editor(){return this._contextWatchdog.getItem(this._id)}}function Et(...$t){return Rt=>{$t.forEach(Dt=>{typeof Dt=="function"?Dt(Rt):Dt!=null&&(Dt.current=Rt)})}}function It($t,Rt){for(const Dt of Object.getOwnPropertyNames(Rt))delete Rt[Dt];for(const[Dt,Vt]of Object.entries($t))Vt!==Rt&&Dt!=="prototype"&&Dt!=="__proto__"&&(Rt[Dt]=Vt);return Rt}const Ot=$t=>{const Rt=(0,rt.useRef)();return Rt.current=$t,(0,rt.useCallback)((...Dt)=>Rt.current(...Dt),[])};function jt($t,Rt){return Rt.length=0,Rt.push(...$t),Rt}const xt=($t,Rt,Dt)=>{((Vt,St)=>{const Bt=(0,rt.useRef)(null);((Pt,Gt)=>{if(Pt===Gt)return!0;if(!Pt||!Gt)return!1;for(let Qt=0;Qt<Pt.length;++Qt)if(Pt[Qt]!==Gt[Qt])return!1;return!0})(Bt.current,St)||(Bt.current=[...St],Vt())})(()=>{$t&&$t.runAfterMount(Rt)},[$t,...Dt])},Lt="Lock from React integration (@ckeditor/ckeditor5-react)",qt=(0,rt.memo)((0,rt.forwardRef)(({id:$t,semaphore:Rt,rootName:Dt},Vt)=>{const St=(0,rt.useRef)(null);return(0,rt.useEffect)(()=>{let Bt,Pt;return Rt.runAfterMount(({instance:Gt})=>{St.current&&(Pt=Gt,Bt=Gt.ui.view.createEditable(Dt,St.current),Gt.ui.addEditable(Bt),Gt.editing.view.forceRender())}),()=>{Bt&&St.current&&Pt&&Pt.state!=="destroyed"&&Pt.ui.removeEditable(Bt)}},[Rt.revision]),ot().createElement("div",{key:Rt.revision,id:$t,ref:Et(Vt,St)})}));qt.displayName="EditorEditable";const Yt=(0,rt.forwardRef)(({editor:$t},Rt)=>{const Dt=(0,rt.useRef)(null);return(0,rt.useEffect)(()=>{const Vt=Dt.current;if(!$t||!Vt)return;const St=$t.ui.view.toolbar.element;return Vt&&Vt.appendChild(St),()=>{Vt&&Vt.removeChild(St)}},[$t&&$t.id]),ot().createElement("div",{ref:Et(Dt,Rt)})});Yt.displayName="EditorToolbarWrapper";const $n=$t=>{const Rt=(0,rt.useRef)($t.semaphoreElement||null),Dt=(()=>{const Ht=(0,rt.useRef)(null),[Tn,Xt]=(0,rt.useState)(()=>Date.now()),rn=()=>{Xt(Date.now())},dn=(ln=!0)=>{Ht.current&&(Ht.current.release(),Ht.current=null),ln&&Xt(Date.now())},on=ln=>{Ht.current&&Ht.current.runAfterMount(ln)};return{get current(){return Ht.current},revision:Tn,createAttributeRef:ln=>({get current(){return Ht.current&&Ht.current.value?Ht.current.value[ln]:null}}),unsafeSetValue:ln=>{var Xn;(Xn=Ht.current)===null||Xn===void 0||Xn.unsafeSetValue(ln),rn()},release:dn,replace:ln=>{dn(!1),Ht.current=ln(),rn(),on(rn)},runAfterMount:on}})(),Vt={watchdog:Dt.createAttributeRef("watchdog"),instance:Dt.createAttributeRef("instance")},St=(0,rt.useContext)(wt),[Bt,Pt]=(0,rt.useState)(()=>Object.keys($t.data)),[Gt,Qt]=(0,rt.useState)({...$t.data}),[On,Dn]=(0,rt.useState)({...$t.rootsAttributes}),vr=(0,rt.useRef)(!0);(0,rt.useEffect)(()=>{const Ht=Rt.current;if(Ht&&$t.isLayoutReady!==!1)return Dt.replace(()=>new ht(Ht,{mount:ga,afterMount:({mountResult:Tn})=>{const{onReady:Xt}=$t;Xt&&Rt.current!==null&&Xt(Tn.instance)},unmount:async({element:Tn,mountResult:Xt})=>{const{onAfterDestroy:rn}=$t;try{await na(Xt),Tn.innerHTML=""}finally{rn&&rn(Xt.instance)}}})),()=>{Dt.release(!1)}},[$t.id,$t.isLayoutReady]);const sr=()=>{const Ht=$t.config||{};return $t.data&&Ht.initialData&&console.warn("Editor data should be provided either using `config.initialData` or `data` property. The config value takes precedence over `data` property and will be used when both are specified."),{...Ht,rootsAttributes:On}},jr=Ot((Ht,Tn)=>{const Xt=Ht.model.document;if(!$t.disableTwoWayDataBinding){const rn={},dn={};Xt.differ.getChanges().forEach(on=>{let ln;if(ln=on.type=="insert"||on.type=="remove"?on.position.root:on.range.root,!ln.isAttached())return;const{rootName:Xn}=ln;rn[Xn]=Ht.getData({rootName:Xn})}),Xt.differ.getChangedRoots().forEach(on=>{if(on.state)return void(rn[on.name]!==void 0&&delete rn[on.name]);const ln=on.name;dn[ln]=Ht.getRootAttributes(ln)}),Object.keys(rn).length&&Qt(on=>({...on,...rn})),Object.keys(dn).length&&Dn(on=>({...on,...dn}))}$t.onChange&&$t.onChange(Tn,Ht)}),Xo=Ot((Ht,Tn,Xt)=>{const rn=Xt.rootName;$t.disableTwoWayDataBinding||(Qt(dn=>({...dn,[rn]:Ht.getData({rootName:rn})})),Dn(dn=>({...dn,[rn]:Ht.getRootAttributes(rn)}))),Pt(dn=>{return on=[...dn,Xt.rootName],Array.from(new Set(on));var on})}),Zo=Ot((Ht,Tn,Xt)=>{const rn=Xt.rootName;$t.disableTwoWayDataBinding||(Qt(dn=>{const{[rn]:on,...ln}=dn;return{...ln}}),Dn(dn=>{const{[rn]:on,...ln}=dn;return{...ln}})),Pt(dn=>dn.filter(on=>on!==rn))}),to=Ot((Ht,Tn)=>(It({...$t.rootsAttributes},On),It({...$t.data},Gt),jt(Object.keys($t.data),Bt),$t.editor.create(Ht,Tn).then(Xt=>{const rn=Xt.getFullData();It({...rn},Gt),It({...Xt.getRootsAttributes()},On),jt(Object.keys(rn),Bt),$t.disabled&&Xt.enableReadOnlyMode(Lt);const dn=Xt.model.document,on=Xt.editing.view.document;return dn.on("change:data",ln=>jr(Xt,ln)),Xt.on("addRoot",(ln,Xn)=>Xo(Xt,ln,Xn)),Xt.on("detachRoot",(ln,Xn)=>Zo(Xt,ln,Xn)),on.on("focus",ln=>{$t.onFocus&&$t.onFocus(ln,Xt)}),on.on("blur",ln=>{$t.onBlur&&$t.onBlur(ln,Xt)}),Xt}))),na=Ht=>{const{watchdog:Tn,instance:Xt}=Ht;return new Promise((rn,dn)=>{setTimeout(async()=>{try{if(Tn)return await Tn.destroy(),rn();if(Xt)return await Xt.destroy(),rn();rn()}catch(on){console.error(on),dn(on)}})})},ga=async()=>{if($t.disableWatchdog)return{instance:await to($t.data,sr()),watchdog:null};const Ht=St instanceof _t.ContextWatchdog?new bt(St):new _t.EditorWatchdog($t.editor,$t.watchdogConfig),Tn={current:0};return Ht.setCreator(async(Xt,rn)=>{const{onAfterDestroy:dn}=$t;Tn.current>0&&dn&&Vt.instance.current&&dn(Vt.instance.current);const on=await to(Xt,rn);return Tn.current>0&&(Dt.unsafeSetValue({instance:on,watchdog:Ht}),setTimeout(()=>{$t.onReady&&$t.onReady(Ht.editor)})),Tn.current++,on}),Ht.on("error",(Xt,{error:rn,causesRestart:dn})=>{($t.onError||console.error)(rn,{phase:"runtime",willEditorRestart:dn})}),await Ht.create(Gt,sr()).catch(Xt=>{throw($t.onError||console.error)(Xt,{phase:"initialization",willEditorRestart:!1}),Xt}),{watchdog:Ht,instance:Ht.editor}},_a=(0,rt.useCallback)(Ht=>{Dt.runAfterMount(()=>{vr.current=!0,Qt(Ht)})},[Qt]),ba=(0,rt.useCallback)(Ht=>{Dt.runAfterMount(()=>{vr.current=!0,Dn(Ht)})},[Dn]),Lr=ot().createElement(Yt,{ref:Rt,editor:Vt.instance.current});xt(Dt.current,({instance:Ht})=>{$t.disabled?Ht.enableReadOnlyMode(Lt):Ht.disableReadOnlyMode(Lt)},[$t.disabled]),xt(Dt.current,({instance:Ht})=>{if(vr.current){vr.current=!1;const Tn=Object.keys(Gt),Xt=Object.keys(On);if(!Tn.every(Pn=>Xt.includes(Pn)))throw console.error("`data` and `attributes` objects must have the same keys (roots)."),new Error("`data` and `attributes` objects must have the same keys (roots).");const rn=Ht.getFullData(),dn=Ht.getRootsAttributes(),{addedKeys:on,removedKeys:ln}=((Pn,dr)=>{const qn=Object.keys(Pn),os=Object.keys(dr);return{addedKeys:os.filter(Kr=>!qn.includes(Kr)),removedKeys:qn.filter(Kr=>!os.includes(Kr))}})(rn,Gt||{}),Xn=Tn.some(Pn=>rn[Pn]!==void 0&&JSON.stringify(rn[Pn])!==JSON.stringify(Gt[Pn])),no=Xt.filter(Pn=>JSON.stringify(dn[Pn])!==JSON.stringify(On[Pn])),In=Pn=>{Pn.forEach(dr=>{Ht.addRoot(dr,{data:Gt[dr]||"",attributes:(On==null?void 0:On[dr])||{},isUndoable:!0})})},xa=Pn=>{Pn.forEach(dr=>{Ht.detachRoot(dr,!0)})},$a=()=>{Ht.data.set(Gt,{suppressErrorInCollaboration:!0})},_l=(Pn,dr)=>{dr.forEach(qn=>{Object.keys(On[qn]).forEach(os=>{Ht.registerRootAttribute(os)}),Pn.clearAttributes(Ht.model.document.getRoot(qn)),Pn.setAttributes(On[qn],Ht.model.document.getRoot(qn))})};setTimeout(()=>{Ht.model.change(Pn=>{In(on),xa(ln),Xn&&$a(),no.length&&_l(Pn,no)})})}},[Gt,On]);const ss=Bt.map(Ht=>ot().createElement(qt,{key:Ht,id:Ht,rootName:Ht,semaphore:Dt}));return{editor:Vt.instance.current,editableElements:ss,toolbarElement:Lr,data:Gt,setData:_a,attributes:On,setAttributes:ba}}})(),it})())})(dist);var distExports=dist.exports,ckeditor={exports:{}};/*!
 * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */(function(module,exports){(function(s){s.fr=Object.assign(s.fr||{},{a:"Envoi du fichier chou :",b:"Barre d'outils des images",c:"Barre d'outils des tableaux",d:"Citation",e:"Insrer une image ou un fichier",f:"Choisir l'en-tte",g:"En-tte",h:"Augmenter le retrait",i:"Diminuer le retrait",j:"Lien",k:"Liste numrote",l:"Liste  puces",m:"widget mdia",n:"Insrer un mdia",o:"L'URL ne doit pas tre vide.",p:"Cette URL de mdia n'est pas supporte.",q:"Insrer un tableau",r:"Colonne d'entte",s:"Insrer une colonne  gauche",t:"Insrer une colonne  droite",u:"Supprimer la colonne",v:"Colonne",w:"Ligne d'entte",x:"Insrer une ligne en-dessous",y:"Insrer une ligne au-dessus",z:"Supprimer la ligne",aa:"Ligne",ab:"Fusionner la cellule au-dessus",ac:"Fusionner la cellule  droite",ad:"Fusionner la cellule en-dessous",ae:"Fusionner la cellule  gauche",af:"Scinder la cellule verticalement",ag:"Scinder la cellule horizontalement",ah:"Fusionner les cellules",ai:"Gras",aj:"Italique",ak:"Objet image",al:"Saisir la lgende de limage",am:"Image taille relle",an:"Image latrale",ao:"Image aligne  gauche",ap:"Image centre",aq:"Image aligne  droite",ar:"Insrer une image",as:"chec de l'envoi",at:"Tlchargement en cours",au:"Barre d'outils du widget",av:"Impossible d'obtenir l'image redimensionne",aw:"La slection de l'image redimensionne a chou.",ax:"Impossible d'insrer l'image  la position courante.",ay:"L'insertion d'image a chou.",az:"Changer le texte alternatif  limage",ba:"diteur de texte enrichi",bb:"Annuler",bc:"Restaurer",bd:"Enregistrer",be:"Annuler",bf:"Texte alternatif",bg:"%0 sur %1",bh:"Prcedent",bi:"Suivant",bj:"Barre d'outils de l'diteur",bk:"Montrer plus d'lments",bl:"Barre d'outils dans un menu droulant",bm:"Coller l'URL du mdia",bn:"Astuce : Copier l'URL du mdia dans le contenu pour l'insrer plus rapidement",bo:"URL de mdia",bp:"Ouvrir dans un nouvel onglet",bq:"Fichier tlchargeable",br:"Supprimer le lien",bs:"Modifier le lien",bt:"Ouvrir le lien dans un nouvel onglet",bu:"Ce lien n'a pas d'URL",bv:"URL du lien",bw:"Paragraphe",bx:"Titre 1",by:"Titre 2",bz:"Titre 3",ca:"Titre 4",cb:"Titre 5",cc:"Titre 6",cd:"diteur de texte enrichi, %0"})})(window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={})),function(i,a){module.exports=a()}(window,function(){return function(s){var i={};function a(d){if(i[d])return i[d].exports;var g=i[d]={i:d,l:!1,exports:{}};return s[d].call(g.exports,g,g.exports,a),g.l=!0,g.exports}return a.m=s,a.c=i,a.d=function(d,g,b){a.o(d,g)||Object.defineProperty(d,g,{enumerable:!0,get:b})},a.r=function(d){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(d,"__esModule",{value:!0})},a.t=function(d,g){if(g&1&&(d=a(d)),g&8||g&4&&typeof d=="object"&&d&&d.__esModule)return d;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:d}),g&2&&typeof d!="string")for(var $ in d)a.d(b,$,(function(tt){return d[tt]}).bind(null,$));return b},a.n=function(d){var g=d&&d.__esModule?function(){return d.default}:function(){return d};return a.d(g,"a",g),g},a.o=function(d,g){return Object.prototype.hasOwnProperty.call(d,g)},a.p="",a(a.s=96)}([function(s,i,a){a.d(i,"b",function(){return g}),a.d(i,"a",function(){return b});const d="https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html";class g extends Error{constructor(tt,it,rt){tt=b(tt),rt&&(tt+=" "+JSON.stringify(rt)),super(tt),this.name="CKEditorError",this.context=it,this.data=rt}is(tt){return tt==="CKEditorError"}static rethrowUnexpectedError(tt,it){if(tt.is&&tt.is("CKEditorError"))throw tt;const rt=new g(tt.message,it);throw rt.stack=tt.stack,rt}}function b($){const tt=$.match(/^([^:]+):/);return tt?$+` Read more: ${d}#error-${tt[1]}
`:$}},function(s,i,a){var d=function(){var ht;return function(){return typeof ht>"u"&&(ht=!!(window&&document&&document.all&&!window.atob)),ht}}(),g=function(){var ht={};return function(mt){if(typeof ht[mt]>"u"){var bt=document.querySelector(mt);if(window.HTMLIFrameElement&&bt instanceof window.HTMLIFrameElement)try{bt=bt.contentDocument.head}catch{bt=null}ht[mt]=bt}return ht[mt]}}(),b=[];function $(vt){for(var ht=-1,ft=0;ft<b.length;ft++)if(b[ft].identifier===vt){ht=ft;break}return ht}function tt(vt,ht){for(var ft={},mt=[],bt=0;bt<vt.length;bt++){var Et=vt[bt],It=ht.base?Et[0]+ht.base:Et[0],Ot=ft[It]||0,jt="".concat(It," ").concat(Ot);ft[It]=Ot+1;var xt=$(jt),Lt={css:Et[1],media:Et[2],sourceMap:Et[3]};xt!==-1?(b[xt].references++,b[xt].updater(Lt)):b.push({identifier:jt,updater:wt(Lt,ht),references:1}),mt.push(jt)}return mt}function it(vt){var ht=document.createElement("style"),ft=vt.attributes||{};if(typeof ft.nonce>"u"){var mt=a.nc;mt&&(ft.nonce=mt)}if(Object.keys(ft).forEach(function(Et){ht.setAttribute(Et,ft[Et])}),typeof vt.insert=="function")vt.insert(ht);else{var bt=g(vt.insert||"head");if(!bt)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");bt.appendChild(ht)}return ht}function rt(vt){if(vt.parentNode===null)return!1;vt.parentNode.removeChild(vt)}var ot=function(){var ht=[];return function(mt,bt){return ht[mt]=bt,ht.filter(Boolean).join(`
`)}}();function lt(vt,ht,ft,mt){var bt=ft?"":mt.media?"@media ".concat(mt.media," {").concat(mt.css,"}"):mt.css;if(vt.styleSheet)vt.styleSheet.cssText=ot(ht,bt);else{var Et=document.createTextNode(bt),It=vt.childNodes;It[ht]&&vt.removeChild(It[ht]),It.length?vt.insertBefore(Et,It[ht]):vt.appendChild(Et)}}function ut(vt,ht,ft){var mt=ft.css,bt=ft.media,Et=ft.sourceMap;if(bt?vt.setAttribute("media",bt):vt.removeAttribute("media"),Et&&btoa&&(mt+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(Et))))," */")),vt.styleSheet)vt.styleSheet.cssText=mt;else{for(;vt.firstChild;)vt.removeChild(vt.firstChild);vt.appendChild(document.createTextNode(mt))}}var pt=null,_t=0;function wt(vt,ht){var ft,mt,bt;if(ht.singleton){var Et=_t++;ft=pt||(pt=it(ht)),mt=lt.bind(null,ft,Et,!1),bt=lt.bind(null,ft,Et,!0)}else ft=it(ht),mt=ut.bind(null,ft,ht),bt=function(){rt(ft)};return mt(vt),function(Ot){if(Ot){if(Ot.css===vt.css&&Ot.media===vt.media&&Ot.sourceMap===vt.sourceMap)return;mt(vt=Ot)}else bt()}}s.exports=function(vt,ht){ht=ht||{},!ht.singleton&&typeof ht.singleton!="boolean"&&(ht.singleton=d()),vt=vt||[];var ft=tt(vt,ht);return function(bt){if(bt=bt||[],Object.prototype.toString.call(bt)==="[object Array]"){for(var Et=0;Et<ft.length;Et++){var It=ft[Et],Ot=$(It);b[Ot].references--}for(var jt=tt(bt,ht),xt=0;xt<ft.length;xt++){var Lt=ft[xt],qt=$(Lt);b[qt].references===0&&(b[qt].updater(),b.splice(qt,1))}ft=jt}}}},,function(s,i,a){var d=a(7),g=typeof self=="object"&&self&&self.Object===Object&&self,b=d.a||g||Function("return this")();i.a=b},function(s,i,a){(function(d){var g=a(3),b=a(12),$=exports&&!exports.nodeType&&exports,tt=$&&typeof d=="object"&&d&&!d.nodeType&&d,it=tt&&tt.exports===$,rt=it?g.a.Buffer:void 0,ot=rt?rt.isBuffer:void 0,lt=ot||b.a;i.a=lt}).call(this,a(9)(s))},function(s,i,a){(function(d){var g=a(7),b=exports&&!exports.nodeType&&exports,$=b&&typeof d=="object"&&d&&!d.nodeType&&d,tt=$&&$.exports===b,it=tt&&g.a.process,rt=function(){try{var ot=$&&$.require&&$.require("util").types;return ot||it&&it.binding&&it.binding("util")}catch{}}();i.a=rt}).call(this,a(9)(s))},function(s,i,a){(function(d){var g=a(0);const b="18.0.0",$=typeof window=="object"?window:d;if($.CKEDITOR_VERSION)throw new g.b("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);$.CKEDITOR_VERSION=b}).call(this,a(10))},function(s,i,a){(function(d){var g=typeof d=="object"&&d&&d.Object===Object&&d;i.a=g}).call(this,a(10))},function(s,i,a){(function(d){var g=a(3),b=exports&&!exports.nodeType&&exports,$=b&&typeof d=="object"&&d&&!d.nodeType&&d,tt=$&&$.exports===b,it=tt?g.a.Buffer:void 0,rt=it?it.allocUnsafe:void 0;function ot(lt,ut){if(ut)return lt.slice();var pt=lt.length,_t=rt?rt(pt):new lt.constructor(pt);return lt.copy(_t),_t}i.a=ot}).call(this,a(9)(s))},function(s,i){s.exports=function(a){if(!a.webpackPolyfill){var d=Object.create(a);d.children||(d.children=[]),Object.defineProperty(d,"loaded",{enumerable:!0,get:function(){return d.l}}),Object.defineProperty(d,"id",{enumerable:!0,get:function(){return d.i}}),Object.defineProperty(d,"exports",{enumerable:!0}),d.webpackPolyfill=1}return d}},function(s,i){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch{typeof window=="object"&&(a=window)}s.exports=a},function(s,i,a){var d=a(1),g=a(48);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i,a){function d(){return!1}i.a=d},function(s){s.exports=JSON.parse('{"ar":{"latex":"LaTeX","cancel":"","accept":"?","manual":"","insert_math":"   - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"ca":{"latex":"LaTeX","cancel":"Cancellar","accept":"Acceptar","manual":"Manual","insert_math":"Inserir frmula matemtica - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"cs":{"latex":"LaTeX","cancel":"Storno","accept":"OK","manual":"Pru?ka","insert_math":"Vloit matematick vzorec - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"da":{"latex":"LaTeX","cancel":"Annuller","accept":"OK","manual":"Brugervejledning","insert_math":"Indst matematisk formel - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"de":{"latex":"LaTeX","cancel":"Abbrechen","accept":"OK","manual":"Handbuch","insert_math":"Mathematische Formel einfgen - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"en":{"latex":"LaTeX","cancel":"Cancel","accept":"OK","manual":"Manual","insert_math":"Insert a math equation - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"es":{"latex":"LaTeX","cancel":"Cancelar","accept":"Aceptar","manual":"Manual","insert_math":"Insertar frmula matemtica - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"et":{"latex":"LaTeX","cancel":"Loobu","accept":"OK","manual":"Ksiraamat","insert_math":"Lisa matemaatiline valem  WIRIS","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"eu":{"latex":"LaTeX","cancel":"Ezeztatu","accept":"Onartu","manual":"Gida","insert_math":"Txertatu matematikako formula - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"fi":{"latex":"LaTeX","cancel":"Peruuta","accept":"OK","manual":"Manual","insert_math":"Liit matemaattinen kaava - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"fr":{"latex":"LaTeX","cancel":"Annuler","accept":"OK","manual":"Manuel","insert_math":"Insrer une formule mathmatique - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"gl":{"latex":"LaTeX","cancel":"Cancelar","accept":"Aceptar","manual":"Manual","insert_math":"Inserir frmula matemtica - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"he":{"latex":"LaTeX","cancel":"","accept":"?","manual":"","insert_math":"   - MathType","insert_chem":"   - ChemType","minimize":"","maximize":"","fullscreen":" ?","exit_fullscreen":"?   ?","close":"","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"?? ?? ? ?  .","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" ? ","exception_invalid_date_format":" ? ?  : ","exception_casting":"?   ","exception_casting_to":"  "},"hr":{"latex":"LaTeX","cancel":"Poniti","accept":"U redu","manual":"Priru?nik","insert_math":"Umetnite matemati?ku formulu - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"hu":{"latex":"LaTeX","cancel":"Mgsem","accept":"OK","manual":"Kziknyv","insert_math":"Matematikai kplet beszrsa - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"it":{"latex":"LaTeX","cancel":"Annulla","accept":"Accetta","manual":"Manuale","insert_math":"Inserisci una formula matematica - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"ja":{"latex":"LaTeX","cancel":"","accept":"OK","manual":"","insert_math":"? - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"ko":{"latex":"LaTeX","cancel":"","accept":"?","manual":"","insert_math":" ?  - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"nl":{"latex":"LaTeX","cancel":"Annuleren","accept":"OK","manual":"Handleiding","insert_math":"Wiskundige formule invoegen - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"no":{"latex":"LaTeX","cancel":"Avbryt","accept":"OK","manual":"Hndbok","insert_math":"Sett inn matematikkformel - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"pl":{"latex":"LaTeX","cancel":"Anuluj","accept":"OK","manual":"Instrukcja","insert_math":"Wstaw formu matematyczn - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"pt":{"latex":"LaTeX","cancel":"Cancelar","accept":"OK","manual":"Manual","insert_math":"Inserir frmula matemtica - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"pt_br":{"latex":"LaTeX","cancel":"Cancelar","accept":"OK","manual":"Manual","insert_math":"Inserir frmula matemtica - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"ru":{"latex":"LaTeX","cancel":"","accept":"OK","manual":"","insert_math":"? ? : WIRIS","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"sv":{"latex":"LaTeX","cancel":"Avbryt","accept":"OK","manual":"Bruksanvisning","insert_math":"Infoga matematisk formel - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"tr":{"latex":"LaTeX","cancel":"Vazge","accept":"Tamam","manual":"Klavuz","insert_math":"Matematik forml ekle - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"zh":{"latex":"LaTeX","cancel":"?","accept":"","manual":"","insert_math":"?? - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"el":{"latex":"LaTeX","cancel":"?","accept":"","manual":"?","insert_math":" ? ? - MathType","insert_chem":"Insert a chemistry formula - ChemType","minimize":"Minimize","maximize":"Maximize","fullscreen":"Full-screen","exit_fullscreen":"Exit full-screen","close":"Close","mathtype":"MathType","title_modalwindow":"MathType modal window","close_modal_warning":"Are you sure you want to leave? The changes you made will be lost.","latex_name_label":"Latex Formula","browser_no_compatible":"Your browser is not compatible with AJAX technology. Please, use the latest version of Mozilla Firefox.","error_convert_accessibility":"Error converting from MathML to accessible text.","exception_cross_site":"Cross site scripting is only allowed for HTTP.","exception_high_surrogate":"High surrogate not followed by low surrogate in fixedCharCodeAt()","exception_string_length":"Invalid string. Length must be a multiple of 4","exception_key_nonobject":"Object.keys called on non-object","exception_null_or_undefined":" this is null or not defined","exception_not_function":" is not a function","exception_invalid_date_format":"Invalid date format : ","exception_casting":"Cannot cast ","exception_casting_to":" to "},"":{}}')},function(s,i,a){var d=a(1),g=a(15);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-placeholder:before,.ck .ck-placeholder:before{content:attr(data-placeholder);pointer-events:none}.ck.ck-read-only .ck-placeholder:before{display:none}.ck.ck-placeholder:before,.ck .ck-placeholder:before{cursor:text;color:var(--ck-color-engine-placeholder-text)}"},function(s,i,a){var d=a(1),g=a(17);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck-hidden{display:none!important}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{box-sizing:border-box;width:auto;height:auto;position:static}:root{--ck-z-default:1;--ck-z-modal:calc(var(--ck-z-default) + 999);--ck-color-base-foreground:#fafafa;--ck-color-base-background:#fff;--ck-color-base-border:#c4c4c4;--ck-color-base-action:#61b045;--ck-color-base-focus:#6cb5f9;--ck-color-base-text:#333;--ck-color-base-active:#198cf0;--ck-color-base-active-focus:#0e7fe1;--ck-color-base-error:#db3700;--ck-color-focus-border:#1f89e5;--ck-color-focus-outer-shadow:#bcdefb;--ck-color-focus-disabled-shadow:rgba(119,186,248,0.3);--ck-color-focus-error-shadow:rgba(255,64,31,0.3);--ck-color-text:var(--ck-color-base-text);--ck-color-shadow-drop:rgba(0,0,0,0.15);--ck-color-shadow-drop-active:rgba(0,0,0,0.2);--ck-color-shadow-inner:rgba(0,0,0,0.1);--ck-color-button-default-background:transparent;--ck-color-button-default-hover-background:#e6e6e6;--ck-color-button-default-active-background:#d9d9d9;--ck-color-button-default-active-shadow:#bfbfbf;--ck-color-button-default-disabled-background:transparent;--ck-color-button-on-background:#dedede;--ck-color-button-on-hover-background:#c4c4c4;--ck-color-button-on-active-background:#bababa;--ck-color-button-on-active-shadow:#a1a1a1;--ck-color-button-on-disabled-background:#dedede;--ck-color-button-action-background:var(--ck-color-base-action);--ck-color-button-action-hover-background:#579e3d;--ck-color-button-action-active-background:#53973b;--ck-color-button-action-active-shadow:#498433;--ck-color-button-action-disabled-background:#7ec365;--ck-color-button-action-text:var(--ck-color-base-background);--ck-color-button-save:#008a00;--ck-color-button-cancel:#db3700;--ck-color-switch-button-off-background:#b0b0b0;--ck-color-switch-button-off-hover-background:#a3a3a3;--ck-color-switch-button-on-background:var(--ck-color-button-action-background);--ck-color-switch-button-on-hover-background:#579e3d;--ck-color-switch-button-inner-background:var(--ck-color-base-background);--ck-color-switch-button-inner-shadow:rgba(0,0,0,0.1);--ck-color-dropdown-panel-background:var(--ck-color-base-background);--ck-color-dropdown-panel-border:var(--ck-color-base-border);--ck-color-input-background:var(--ck-color-base-background);--ck-color-input-border:#c7c7c7;--ck-color-input-error-border:var(--ck-color-base-error);--ck-color-input-text:var(--ck-color-base-text);--ck-color-input-disabled-background:#f2f2f2;--ck-color-input-disabled-border:#c7c7c7;--ck-color-input-disabled-text:#5c5c5c;--ck-color-list-background:var(--ck-color-base-background);--ck-color-list-button-hover-background:var(--ck-color-button-default-hover-background);--ck-color-list-button-on-background:var(--ck-color-base-active);--ck-color-list-button-on-background-focus:var(--ck-color-base-active-focus);--ck-color-list-button-on-text:var(--ck-color-base-background);--ck-color-panel-background:var(--ck-color-base-background);--ck-color-panel-border:var(--ck-color-base-border);--ck-color-toolbar-background:var(--ck-color-base-foreground);--ck-color-toolbar-border:var(--ck-color-base-border);--ck-color-tooltip-background:var(--ck-color-base-text);--ck-color-tooltip-text:var(--ck-color-base-background);--ck-color-engine-placeholder-text:#707070;--ck-color-upload-bar-background:#6cb5f9;--ck-color-link-default:#0000f0;--ck-color-link-selected-background:rgba(31,177,255,0.1);--ck-disabled-opacity:.5;--ck-focus-outer-shadow-geometry:0 0 0 3px;--ck-focus-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-outer-shadow);--ck-focus-disabled-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-disabled-shadow);--ck-focus-error-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-error-shadow);--ck-focus-ring:1px solid var(--ck-color-focus-border);--ck-font-size-base:13px;--ck-line-height-base:1.84615;--ck-font-face:Helvetica,Arial,Tahoma,Verdana,Sans-Serif;--ck-font-size-tiny:0.7em;--ck-font-size-small:0.75em;--ck-font-size-normal:1em;--ck-font-size-big:1.4em;--ck-font-size-large:1.8em;--ck-ui-component-min-height:2.3em}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{margin:0;padding:0;border:0;background:transparent;text-decoration:none;vertical-align:middle;transition:none;word-wrap:break-word}.ck.ck-reset_all,.ck.ck-reset_all *{border-collapse:collapse;font:normal normal normal var(--ck-font-size-base)/var(--ck-line-height-base) var(--ck-font-face);color:var(--ck-color-text);text-align:left;white-space:nowrap;cursor:auto;float:none}.ck.ck-reset_all .ck-rtl *{text-align:right}.ck.ck-reset_all iframe{vertical-align:inherit}.ck.ck-reset_all textarea{white-space:pre-wrap}.ck.ck-reset_all input[type=password],.ck.ck-reset_all input[type=text],.ck.ck-reset_all textarea{cursor:text}.ck.ck-reset_all input[type=password][disabled],.ck.ck-reset_all input[type=text][disabled],.ck.ck-reset_all textarea[disabled]{cursor:default}.ck.ck-reset_all fieldset{padding:10px;border:2px groove #dfdee3}.ck.ck-reset_all button::-moz-focus-inner{padding:0;border:0}.ck[dir=rtl],.ck[dir=rtl] .ck{text-align:right}:root{--ck-border-radius:2px;--ck-inner-shadow:2px 2px 3px var(--ck-color-shadow-inner) inset;--ck-drop-shadow:0 1px 2px 1px var(--ck-color-shadow-drop);--ck-drop-shadow-active:0 3px 6px 1px var(--ck-color-shadow-drop-active);--ck-spacing-unit:0.6em;--ck-spacing-large:calc(var(--ck-spacing-unit)*1.5);--ck-spacing-standard:var(--ck-spacing-unit);--ck-spacing-medium:calc(var(--ck-spacing-unit)*0.8);--ck-spacing-small:calc(var(--ck-spacing-unit)*0.5);--ck-spacing-tiny:calc(var(--ck-spacing-unit)*0.3);--ck-spacing-extra-tiny:calc(var(--ck-spacing-unit)*0.16)}"},function(s,i,a){var d=a(1),g=a(19);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-editor__editable:not(.ck-editor__nested-editable){border-radius:0}.ck-rounded-corners .ck.ck-editor__editable:not(.ck-editor__nested-editable),.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-focused{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0}.ck.ck-editor__editable_inline{overflow:auto;padding:0 var(--ck-spacing-standard);border:1px solid transparent}.ck.ck-editor__editable_inline[dir=ltr]{text-align:left}.ck.ck-editor__editable_inline[dir=rtl]{text-align:right}.ck.ck-editor__editable_inline>:first-child{margin-top:var(--ck-spacing-large)}.ck.ck-editor__editable_inline>:last-child{margin-bottom:var(--ck-spacing-large)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_n]:after{border-bottom-color:var(--ck-color-base-foreground)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_s]:after{border-top-color:var(--ck-color-base-foreground)}"},function(s,i,a){var d=a(1),g=a(21);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-label{display:block}.ck.ck-voice-label{display:none}.ck.ck-label{font-weight:700}"},function(s,i,a){var d=a(1),g=a(23);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-sticky-panel .ck-sticky-panel__content_sticky{z-index:var(--ck-z-modal);position:fixed;top:0}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky_bottom-limit{top:auto;position:absolute}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky{box-shadow:var(--ck-drop-shadow),0 0;border-width:0 1px 1px;border-top-left-radius:0;border-top-right-radius:0}"},function(s,i,a){var d=a(1),g=a(25);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-dropdown{display:inline-block;position:relative}.ck.ck-dropdown .ck-dropdown__arrow{pointer-events:none;z-index:var(--ck-z-default)}.ck.ck-dropdown .ck-button.ck-dropdown__button{width:100%}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on .ck-tooltip{display:none}.ck.ck-dropdown .ck-dropdown__panel{-webkit-backface-visibility:hidden;display:none;z-index:var(--ck-z-modal);position:absolute}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel-visible{display:inline-block}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw{bottom:100%}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{top:100%;bottom:auto}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se{left:0}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{right:0}:root{--ck-dropdown-arrow-size:calc(0.5*var(--ck-icon-size))}.ck.ck-dropdown{font-size:inherit}.ck.ck-dropdown .ck-dropdown__arrow{width:var(--ck-dropdown-arrow-size)}[dir=ltr] .ck.ck-dropdown .ck-dropdown__arrow{right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-small)}[dir=rtl] .ck.ck-dropdown .ck-dropdown__arrow{left:var(--ck-spacing-standard);margin-right:var(--ck-spacing-small)}.ck.ck-dropdown.ck-disabled .ck-dropdown__arrow{opacity:var(--ck-disabled-opacity)}[dir=ltr] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-left:var(--ck-spacing-small)}[dir=rtl] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-right:var(--ck-spacing-small)}.ck.ck-dropdown .ck-button.ck-dropdown__button .ck-button__label{width:7em;overflow:hidden;text-overflow:ellipsis}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on{border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown__panel{border-radius:0}.ck-rounded-corners .ck.ck-dropdown__panel,.ck.ck-dropdown__panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-dropdown__panel{box-shadow:var(--ck-drop-shadow),0 0;background:var(--ck-color-dropdown-panel-background);border:1px solid var(--ck-color-dropdown-panel-border);bottom:0;min-width:100%}.ck.ck-dropdown__panel.ck-dropdown__panel_se{border-top-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_sw{border-top-right-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_ne{border-bottom-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_nw{border-bottom-right-radius:0}"},function(s,i,a){var d=a(1),g=a(27);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-icon{vertical-align:middle}:root{--ck-icon-size:calc(var(--ck-line-height-base)*var(--ck-font-size-normal))}.ck.ck-icon{width:var(--ck-icon-size);height:var(--ck-icon-size);font-size:.8333350694em;will-change:transform}.ck.ck-icon,.ck.ck-icon *{color:inherit;cursor:inherit}.ck.ck-icon :not([fill]){fill:currentColor}"},function(s,i,a){var d=a(1),g=a(29);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports='.ck.ck-tooltip,.ck.ck-tooltip .ck-tooltip__text:after{position:absolute;pointer-events:none;-webkit-backface-visibility:hidden}.ck.ck-tooltip{visibility:hidden;opacity:0;display:none;z-index:var(--ck-z-modal)}.ck.ck-tooltip .ck-tooltip__text{display:inline-block}.ck.ck-tooltip .ck-tooltip__text:after{content:"";width:0;height:0}:root{--ck-tooltip-arrow-size:5px}.ck.ck-tooltip{left:50%;top:0;transition:opacity .2s ease-in-out .2s}.ck.ck-tooltip .ck-tooltip__text{border-radius:0}.ck-rounded-corners .ck.ck-tooltip .ck-tooltip__text,.ck.ck-tooltip .ck-tooltip__text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-tooltip .ck-tooltip__text{font-size:.9em;line-height:1.5;color:var(--ck-color-tooltip-text);padding:var(--ck-spacing-small) var(--ck-spacing-medium);background:var(--ck-color-tooltip-background);position:relative;left:-50%}.ck.ck-tooltip .ck-tooltip__text:after{transition:opacity .2s ease-in-out .2s;border-style:solid;left:50%}.ck.ck-tooltip.ck-tooltip_s{bottom:calc(-1*var(--ck-tooltip-arrow-size));transform:translateY(100%)}.ck.ck-tooltip.ck-tooltip_s .ck-tooltip__text:after{top:calc(-1*var(--ck-tooltip-arrow-size));transform:translateX(-50%);border-left-color:transparent;border-bottom-color:var(--ck-color-tooltip-background);border-right-color:transparent;border-top-color:transparent;border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:var(--ck-tooltip-arrow-size);border-top-width:0}.ck.ck-tooltip.ck-tooltip_n{top:calc(-1*var(--ck-tooltip-arrow-size));transform:translateY(-100%)}.ck.ck-tooltip.ck-tooltip_n .ck-tooltip__text:after{bottom:calc(-1*var(--ck-tooltip-arrow-size));transform:translateX(-50%);border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;border-top-color:var(--ck-color-tooltip-background);border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:0;border-right-width:var(--ck-tooltip-arrow-size);border-top-width:var(--ck-tooltip-arrow-size)}'},function(s,i,a){var d=a(1),g=a(31);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-button,a.ck.ck-button{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:block}@media (hover:none){.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:none}}.ck.ck-button,a.ck.ck-button{position:relative;display:inline-flex;align-items:center;justify-content:left}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{display:none}.ck.ck-button.ck-button_with-text .ck-button__label,a.ck.ck-button.ck-button_with-text .ck-button__label{display:inline-block}.ck.ck-button:not(.ck-button_with-text),a.ck.ck-button:not(.ck-button_with-text){justify-content:center}.ck.ck-button:hover .ck-tooltip,a.ck.ck-button:hover .ck-tooltip{visibility:visible;opacity:1}.ck.ck-button:focus:not(:hover) .ck-tooltip,a.ck.ck-button:focus:not(:hover) .ck-tooltip{display:none}.ck.ck-button,a.ck.ck-button{background:var(--ck-color-button-default-background)}.ck.ck-button:not(.ck-disabled):hover,a.ck.ck-button:not(.ck-disabled):hover{background:var(--ck-color-button-default-hover-background)}.ck.ck-button:not(.ck-disabled):active,a.ck.ck-button:not(.ck-disabled):active{background:var(--ck-color-button-default-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-default-active-shadow)}.ck.ck-button.ck-disabled,a.ck.ck-button.ck-disabled{background:var(--ck-color-button-default-disabled-background)}.ck.ck-button,a.ck.ck-button{border-radius:0}.ck-rounded-corners .ck.ck-button,.ck-rounded-corners a.ck.ck-button,.ck.ck-button.ck-rounded-corners,a.ck.ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-button,a.ck.ck-button{white-space:nowrap;cursor:default;vertical-align:middle;padding:var(--ck-spacing-tiny);text-align:center;min-width:var(--ck-ui-component-min-height);min-height:var(--ck-ui-component-min-height);line-height:1;font-size:inherit;border:1px solid transparent;transition:box-shadow .2s ease-in-out,border .2s ease-in-out;-webkit-appearance:none}.ck.ck-button:active,.ck.ck-button:focus,a.ck.ck-button:active,a.ck.ck-button:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-button .ck-button__icon use,.ck.ck-button .ck-button__icon use *,a.ck.ck-button .ck-button__icon use,a.ck.ck-button .ck-button__icon use *{color:inherit}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{font-size:inherit;font-weight:inherit;color:inherit;cursor:inherit;vertical-align:middle}[dir=ltr] .ck.ck-button .ck-button__label,[dir=ltr] a.ck.ck-button .ck-button__label{text-align:left}[dir=rtl] .ck.ck-button .ck-button__label,[dir=rtl] a.ck.ck-button .ck-button__label{text-align:right}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{color:inherit}[dir=ltr] .ck.ck-button .ck-button__keystroke,[dir=ltr] a.ck.ck-button .ck-button__keystroke{margin-left:var(--ck-spacing-large)}[dir=rtl] .ck.ck-button .ck-button__keystroke,[dir=rtl] a.ck.ck-button .ck-button__keystroke{margin-right:var(--ck-spacing-large)}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{font-weight:700;opacity:.7}.ck.ck-button.ck-disabled:active,.ck.ck-button.ck-disabled:focus,a.ck.ck-button.ck-disabled:active,a.ck.ck-button.ck-disabled:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),0 0}.ck.ck-button.ck-disabled .ck-button__icon,a.ck.ck-button.ck-disabled .ck-button__icon{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__label,a.ck.ck-button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__keystroke,a.ck.ck-button.ck-disabled .ck-button__keystroke{opacity:.3}.ck.ck-button.ck-button_with-text,a.ck.ck-button.ck-button_with-text{padding:var(--ck-spacing-tiny) var(--ck-spacing-standard)}[dir=ltr] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=ltr] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-left:calc(-1*var(--ck-spacing-small));margin-right:var(--ck-spacing-small)}[dir=rtl] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=rtl] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-right:calc(-1*var(--ck-spacing-small));margin-left:var(--ck-spacing-small)}.ck.ck-button.ck-button_with-keystroke .ck-button__label,a.ck.ck-button.ck-button_with-keystroke .ck-button__label{flex-grow:1}.ck.ck-button.ck-on,a.ck.ck-button.ck-on{background:var(--ck-color-button-on-background)}.ck.ck-button.ck-on:not(.ck-disabled):hover,a.ck.ck-button.ck-on:not(.ck-disabled):hover{background:var(--ck-color-button-on-hover-background)}.ck.ck-button.ck-on:not(.ck-disabled):active,a.ck.ck-button.ck-on:not(.ck-disabled):active{background:var(--ck-color-button-on-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-on-active-shadow)}.ck.ck-button.ck-on.ck-disabled,a.ck.ck-button.ck-on.ck-disabled{background:var(--ck-color-button-on-disabled-background)}.ck.ck-button.ck-button-save,a.ck.ck-button.ck-button-save{color:var(--ck-color-button-save)}.ck.ck-button.ck-button-cancel,a.ck.ck-button.ck-button-cancel{color:var(--ck-color-button-cancel)}.ck.ck-button-action,a.ck.ck-button-action{background:var(--ck-color-button-action-background)}.ck.ck-button-action:not(.ck-disabled):hover,a.ck.ck-button-action:not(.ck-disabled):hover{background:var(--ck-color-button-action-hover-background)}.ck.ck-button-action:not(.ck-disabled):active,a.ck.ck-button-action:not(.ck-disabled):active{background:var(--ck-color-button-action-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-action-active-shadow)}.ck.ck-button-action.ck-disabled,a.ck.ck-button-action.ck-disabled{background:var(--ck-color-button-action-disabled-background)}.ck.ck-button-action,a.ck.ck-button-action{color:var(--ck-color-button-action-text)}.ck.ck-button-bold,a.ck.ck-button-bold{font-weight:700}"},function(s,i,a){var d=a(1),g=a(33);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-list{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-direction:column}.ck.ck-list .ck-list__item,.ck.ck-list .ck-list__separator{display:block}.ck.ck-list .ck-list__item>:focus{position:relative;z-index:var(--ck-z-default)}.ck.ck-list{border-radius:0}.ck-rounded-corners .ck.ck-list,.ck.ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-list{list-style-type:none;background:var(--ck-color-list-background)}.ck.ck-list__item{cursor:default;min-width:12em}.ck.ck-list__item .ck-button{min-height:unset;width:100%;text-align:left;border-radius:0;padding:calc(0.2*var(--ck-line-height-base)*var(--ck-font-size-base)) calc(0.4*var(--ck-line-height-base)*var(--ck-font-size-base))}.ck.ck-list__item .ck-button .ck-button__label{line-height:calc(1.2*var(--ck-line-height-base)*var(--ck-font-size-base))}.ck.ck-list__item .ck-button:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on{background:var(--ck-color-list-button-on-background);color:var(--ck-color-list-button-on-text)}.ck.ck-list__item .ck-button.ck-on:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-on-background-focus)}.ck.ck-list__item .ck-button.ck-on:focus:not(.ck-disabled){border-color:var(--ck-color-base-background)}.ck.ck-list__item .ck-button:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background)}.ck.ck-list__item .ck-switchbutton.ck-on{background:var(--ck-color-list-background);color:inherit}.ck.ck-list__item .ck-switchbutton.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background);color:inherit}.ck.ck-list__separator{height:1px;width:100%;background:var(--ck-color-base-border)}"},function(s,i,a){var d=a(1),g=a(35);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{display:block}:root{--ck-switch-button-toggle-width:2.6153846154em;--ck-switch-button-toggle-inner-size:1.0769230769em;--ck-switch-button-toggle-spacing:1px;--ck-switch-button-translation:1.3846153847em}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__label{margin-right:calc(2*var(--ck-spacing-large))}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__label{margin-left:calc(2*var(--ck-spacing-large))}.ck.ck-button.ck-switchbutton .ck-button__toggle{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle.ck-rounded-corners{border-radius:var(--ck-border-radius)}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-left:auto}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-right:auto}.ck.ck-button.ck-switchbutton .ck-button__toggle{transition:background .4s ease;width:var(--ck-switch-button-toggle-width);background:var(--ck-color-switch-button-off-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:calc(0.5*var(--ck-border-radius))}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{margin:var(--ck-switch-button-toggle-spacing);width:var(--ck-switch-button-toggle-inner-size);height:var(--ck-switch-button-toggle-inner-size);background:var(--ck-color-switch-button-inner-background);transition:all .3s ease}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover{background:var(--ck-color-switch-button-off-hover-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover .ck-button__toggle__inner{box-shadow:0 0 0 5px var(--ck-color-switch-button-inner-shadow)}.ck.ck-button.ck-switchbutton.ck-disabled .ck-button__toggle{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle{background:var(--ck-color-switch-button-on-background)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle:hover{background:var(--ck-color-switch-button-on-hover-background)}[dir=ltr] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(var(--ck-switch-button-translation))}[dir=rtl] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(calc(-1*var(--ck-switch-button-translation)))}"},function(s,i,a){var d=a(1),g=a(37);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-toolbar-dropdown .ck.ck-toolbar .ck.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar-dropdown .ck-dropdown__panel .ck-button:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-toolbar-dropdown .ck-toolbar{border:0}"},function(s,i,a){var d=a(1),g=a(39);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-dropdown .ck-dropdown__panel .ck-list{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list,.ck.ck-dropdown .ck-dropdown__panel .ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}"},function(s,i,a){var d=a(1),g=a(41);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-toolbar{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-flow:row nowrap;align-items:center}.ck.ck-toolbar>.ck-toolbar__items{display:flex;flex-flow:row wrap;align-items:center;flex-grow:1}.ck.ck-toolbar .ck.ck-toolbar__separator{display:inline-block}.ck.ck-toolbar .ck.ck-toolbar__separator:first-child,.ck.ck-toolbar .ck.ck-toolbar__separator:last-child{display:none}.ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items{flex-direction:column}.ck.ck-toolbar.ck-toolbar_floating>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck-dropdown__button .ck-dropdown__arrow{display:none}.ck.ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-toolbar,.ck.ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-toolbar{background:var(--ck-color-toolbar-background);padding:0 var(--ck-spacing-small);border:1px solid var(--ck-color-toolbar-border)}.ck.ck-toolbar .ck.ck-toolbar__separator{align-self:stretch;width:1px;min-width:1px;margin-top:0;margin-bottom:0;background:var(--ck-color-toolbar-border)}.ck.ck-toolbar>.ck-toolbar__items>*{margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small);margin-right:var(--ck-spacing-small)}.ck.ck-toolbar>.ck-toolbar__items:empty+.ck.ck-toolbar__separator{display:none}.ck.ck-toolbar>.ck-toolbar__items>*,.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown{margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck.ck-toolbar.ck-toolbar_vertical{padding:0}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items>.ck{width:100%;margin:0;border-radius:0;border:0}.ck.ck-toolbar.ck-toolbar_compact{padding:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>*{margin:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>:not(:first-child):not(:last-child){border-radius:0}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck.ck-button.ck-dropdown__button{padding-left:var(--ck-spacing-tiny)}.ck-toolbar-container .ck.ck-toolbar{border:0}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck{margin-right:0}.ck.ck-toolbar[dir=rtl]:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-left:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=rtl]>.ck.ck-toolbar__separator,[dir=rtl] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=rtl] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr]>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-right:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=ltr]>.ck.ck-toolbar__separator,[dir=ltr] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-right:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=ltr] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-right:var(--ck-spacing-small)}"},function(s,i,a){var d=a(1),g=a(43);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-editor{position:relative}.ck.ck-editor .ck-editor__top .ck-sticky-panel .ck-toolbar{z-index:var(--ck-z-modal)}.ck.ck-editor__top .ck-sticky-panel .ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-editor__top .ck-sticky-panel .ck-toolbar,.ck.ck-editor__top .ck-sticky-panel .ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius);border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-editor__top .ck-sticky-panel .ck-toolbar{border-bottom-width:0}.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar{border-bottom-width:1px;border-radius:0}.ck-rounded-corners .ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar,.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:0}.ck.ck-editor__main>.ck-editor__editable{background:var(--ck-color-base-background);border-radius:0}.ck-rounded-corners .ck.ck-editor__main>.ck-editor__editable,.ck.ck-editor__main>.ck-editor__editable.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}.ck.ck-editor__main>.ck-editor__editable:not(.ck-focused){border-color:var(--ck-color-base-border)}"},function(s,i,a){var d=a(1),g=a(45);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck-content blockquote{overflow:hidden;padding-right:1.5em;padding-left:1.5em;margin-left:0;margin-right:0;font-style:italic;border-left:5px solid #ccc}.ck-content[dir=rtl] blockquote{border-left:0;border-right:5px solid #ccc}"},function(s,i,a){var d=a(1),g=a(47);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck .ck-link_selected{background:var(--ck-color-link-selected-background)}"},function(s,i){s.exports=".ck.ck-heading_heading1{font-size:20px}.ck.ck-heading_heading2{font-size:17px}.ck.ck-heading_heading3{font-size:14px}.ck[class*=ck-heading_heading]{font-weight:700}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__button .ck-button__label{width:8em}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__panel .ck-list__item{min-width:18em}"},function(s,i,a){var d=a(1),g=a(50);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=":root{--ck-color-resizer:var(--ck-color-focus-border);--ck-resizer-size:10px;--ck-resizer-border-width:1px;--ck-resizer-border-radius:2px;--ck-resizer-offset:calc(var(--ck-resizer-size)/-2 - 2px);--ck-resizer-tooltip-offset:10px;--ck-color-resizer-tooltip-background:#262626;--ck-color-resizer-tooltip-text:#f2f2f2}.ck .ck-widget.ck-widget_with-selection-handle{position:relative}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{position:absolute}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{display:block}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle:hover .ck-widget__selection-handle{visibility:visible}.ck .ck-size-view{background:var(--ck-color-resizer-tooltip-background);color:var(--ck-color-resizer-tooltip-text);border:1px solid var(--ck-color-resizer-tooltip-text);border-radius:var(--ck-resizer-border-radius);font-size:var(--ck-font-size-tiny);display:block;padding:var(--ck-spacing-small)}.ck .ck-size-view.ck-orientation-bottom-left,.ck .ck-size-view.ck-orientation-bottom-right,.ck .ck-size-view.ck-orientation-top-left,.ck .ck-size-view.ck-orientation-top-right{position:absolute}.ck .ck-size-view.ck-orientation-top-left{top:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-top-right{top:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-right{bottom:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-left{bottom:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}:root{--ck-widget-outline-thickness:3px;--ck-widget-handler-icon-size:16px;--ck-widget-handler-animation-duration:200ms;--ck-widget-handler-animation-curve:ease;--ck-color-widget-blurred-border:#dedede;--ck-color-widget-hover-border:#ffc83d;--ck-color-widget-editable-focus-background:var(--ck-color-base-background);--ck-color-widget-drag-handler-icon-color:var(--ck-color-base-background)}.ck .ck-widget{outline-width:var(--ck-widget-outline-thickness);outline-style:solid;outline-color:transparent;transition:outline-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_selected,.ck .ck-widget.ck-widget_selected:hover{outline:var(--ck-widget-outline-thickness) solid var(--ck-color-focus-border)}.ck .ck-widget:hover{outline-color:var(--ck-color-widget-hover-border)}.ck .ck-editor__nested-editable{border:1px solid transparent}.ck .ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck .ck-editor__nested-editable:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0;background-color:var(--ck-color-widget-editable-focus-background)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{padding:4px;box-sizing:border-box;background-color:transparent;opacity:0;transition:background-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),visibility var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);border-radius:var(--ck-border-radius) var(--ck-border-radius) 0 0;transform:translateY(-100%);left:calc(0px - var(--ck-widget-outline-thickness))}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{width:var(--ck-widget-handler-icon-size);height:var(--ck-widget-handler-icon-size);color:var(--ck-color-widget-drag-handler-icon-color)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:0;transition:opacity .3s var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle:hover .ck-icon .ck-icon__selected-indicator{opacity:1}.ck .ck-widget.ck-widget_with-selection-handle:hover .ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-widget-hover-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover .ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-focus-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:1}.ck-editor__editable>.ck-widget.ck-widget_with-selection-handle:first-child,.ck-editor__editable blockquote>.ck-widget.ck-widget_with-selection-handle:first-child{margin-top:calc(1em + var(--ck-widget-handler-icon-size))}.ck[dir=rtl] .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{left:auto;right:calc(0px - var(--ck-widget-outline-thickness))}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover{outline-color:var(--ck-color-widget-blurred-border)}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle .ck-widget__selection-handle:hover,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle .ck-widget__selection-handle:hover{background:var(--ck-color-widget-blurred-border)}.ck-editor__editable.ck-read-only .ck-widget{--ck-widget-outline-thickness:0}"},function(s,i,a){var d=a(1),g=a(52);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-labeled-input .ck-labeled-input__status{font-size:var(--ck-font-size-small);margin-top:var(--ck-spacing-small);white-space:normal}.ck.ck-labeled-input .ck-labeled-input__status_error{color:var(--ck-color-base-error)}"},function(s,i,a){var d=a(1),g=a(54);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=":root{--ck-input-text-width:18em}.ck.ck-input-text{border-radius:0}.ck-rounded-corners .ck.ck-input-text,.ck.ck-input-text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-input-text{box-shadow:var(--ck-inner-shadow),0 0;background:var(--ck-color-input-background);border:1px solid var(--ck-color-input-border);padding:var(--ck-spacing-extra-tiny) var(--ck-spacing-medium);min-width:var(--ck-input-text-width);min-height:var(--ck-ui-component-min-height);transition:box-shadow .2s ease-in-out,border .2s ease-in-out}.ck.ck-input-text:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),var(--ck-inner-shadow)}.ck.ck-input-text[readonly]{border:1px solid var(--ck-color-input-disabled-border);background:var(--ck-color-input-disabled-background);color:var(--ck-color-input-disabled-text)}.ck.ck-input-text[readonly]:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),var(--ck-inner-shadow)}.ck.ck-input-text.ck-error{border-color:var(--ck-color-input-error-border);animation:ck-text-input-shake .3s ease both}.ck.ck-input-text.ck-error:focus{box-shadow:var(--ck-focus-error-outer-shadow),var(--ck-inner-shadow)}@keyframes ck-text-input-shake{20%{transform:translateX(-2px)}40%{transform:translateX(2px)}60%{transform:translateX(-1px)}80%{transform:translateX(1px)}}"},function(s,i,a){var d=a(1),g=a(56);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-text-alternative-form{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-text-alternative-form .ck-labeled-input{display:inline-block}.ck.ck-text-alternative-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-text-alternative-form{flex-wrap:wrap}.ck.ck-text-alternative-form .ck-labeled-input{flex-basis:100%}.ck.ck-text-alternative-form .ck-button{flex-basis:50%}}.ck.ck-text-alternative-form{padding:var(--ck-spacing-standard)}.ck.ck-text-alternative-form:focus{outline:none}[dir=ltr] .ck.ck-text-alternative-form>:not(:first-child),[dir=rtl] .ck.ck-text-alternative-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-text-alternative-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-text-alternative-form .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-text-alternative-form .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-text-alternative-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-text-alternative-form .ck-button{margin-left:0}[dir=ltr] .ck.ck-text-alternative-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-text-alternative-form .ck-button{margin-left:0}[dir=rtl] .ck.ck-text-alternative-form .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}}"},function(s,i,a){var d=a(1),g=a(58);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=':root{--ck-balloon-panel-arrow-z-index:calc(var(--ck-z-default) - 3)}.ck.ck-balloon-panel{display:none;position:absolute;z-index:var(--ck-z-modal)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{content:"";position:absolute}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_n]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_n]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_s]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_s]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel.ck-balloon-panel_visible{display:block}:root{--ck-balloon-arrow-offset:2px;--ck-balloon-arrow-height:10px;--ck-balloon-arrow-half-width:8px}.ck.ck-balloon-panel{border-radius:0}.ck-rounded-corners .ck.ck-balloon-panel,.ck.ck-balloon-panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-balloon-panel{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{width:0;height:0;border-style:solid}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:var(--ck-balloon-arrow-height);border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:0}.ck.ck-balloon-panel[class*=arrow_n]:before{border-bottom-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-color:transparent;border-right-color:transparent;border-top-color:transparent}.ck.ck-balloon-panel[class*=arrow_n]:after{border-bottom-color:var(--ck-color-panel-background);margin-top:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:0;border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:var(--ck-balloon-arrow-height)}.ck.ck-balloon-panel[class*=arrow_s]:before{border-top-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent}.ck.ck-balloon-panel[class*=arrow_s]:after{border-top-color:var(--ck-color-panel-background);margin-bottom:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:before{left:50%;margin-left:calc(-1*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:before{left:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:before{right:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:before{left:50%;margin-left:calc(-1*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:before{left:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:before{right:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:before{right:25%;margin-right:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:before{left:25%;margin-left:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:before{right:25%;margin-right:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:before{left:25%;margin-left:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}'},function(s,i,a){var d=a(1),g=a(60);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck .ck-balloon-rotator__navigation{display:flex;align-items:center;justify-content:center}.ck .ck-balloon-rotator__content .ck-toolbar{justify-content:center}.ck .ck-balloon-rotator__navigation{background:var(--ck-color-toolbar-background);border-bottom:1px solid var(--ck-color-toolbar-border);padding:0 var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation>*{margin-right:var(--ck-spacing-small);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation .ck-balloon-rotator__counter{margin-right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-small)}.ck .ck-balloon-rotator__content .ck.ck-annotation-wrapper{box-shadow:none}"},function(s,i,a){var d=a(1),g=a(62);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck .ck-fake-panel{position:absolute;z-index:calc(var(--ck-z-modal) - 1)}.ck .ck-fake-panel div{position:absolute}.ck .ck-fake-panel div:first-child{z-index:2}.ck .ck-fake-panel div:nth-child(2){z-index:1}:root{--ck-balloon-fake-panel-offset-horizontal:6px;--ck-balloon-fake-panel-offset-vertical:6px}.ck .ck-fake-panel div{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border);border-radius:var(--ck-border-radius);width:100%;height:100%}.ck .ck-fake-panel div:first-child{margin-left:var(--ck-balloon-fake-panel-offset-horizontal);margin-top:var(--ck-balloon-fake-panel-offset-vertical)}.ck .ck-fake-panel div:nth-child(2){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*2);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*2)}.ck .ck-fake-panel div:nth-child(3){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*3);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*3)}.ck .ck-balloon-panel_arrow_s+.ck-fake-panel,.ck .ck-balloon-panel_arrow_se+.ck-fake-panel,.ck .ck-balloon-panel_arrow_sw+.ck-fake-panel{--ck-balloon-fake-panel-offset-vertical:-6px}"},function(s,i,a){var d=a(1),g=a(64);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck-content .image{display:table;clear:both;text-align:center;margin:1em auto}.ck-content .image>img{display:block;margin:0 auto;max-width:100%;min-width:50px}"},function(s,i,a){var d=a(1),g=a(66);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck-content .image>figcaption{display:table-caption;caption-side:bottom;word-break:break-word;color:#333;background-color:#f7f7f7;padding:.6em;font-size:.75em;outline-offset:-1px}"},function(s,i,a){var d=a(1),g=a(68);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=":root{--ck-image-style-spacing:1.5em}.ck-content .image-style-align-center,.ck-content .image-style-align-left,.ck-content .image-style-align-right,.ck-content .image-style-side{max-width:50%}.ck-content .image-style-side{float:right;margin-left:var(--ck-image-style-spacing)}.ck-content .image-style-align-left{float:left;margin-right:var(--ck-image-style-spacing)}.ck-content .image-style-align-center{margin-left:auto;margin-right:auto}.ck-content .image-style-align-right{float:right;margin-left:var(--ck-image-style-spacing)}"},function(s,i,a){var d=a(1),g=a(70);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-editor__editable .image{position:relative}.ck.ck-editor__editable .image .ck-progress-bar{position:absolute;top:0;left:0}.ck.ck-editor__editable .image.ck-appear{animation:fadeIn .7s}.ck.ck-editor__editable .image .ck-progress-bar{height:2px;width:0;background:var(--ck-color-upload-bar-background);transition:width .1s}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}"},function(s,i,a){var d=a(1),g=a(72);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports='.ck-image-upload-complete-icon{display:block;position:absolute;top:10px;right:10px;border-radius:50%}.ck-image-upload-complete-icon:after{content:"";position:absolute}:root{--ck-color-image-upload-icon:#fff;--ck-color-image-upload-icon-background:#008a00;--ck-image-upload-icon-size:20px;--ck-image-upload-icon-width:2px}.ck-image-upload-complete-icon{width:var(--ck-image-upload-icon-size);height:var(--ck-image-upload-icon-size);opacity:0;background:var(--ck-color-image-upload-icon-background);animation-name:ck-upload-complete-icon-show,ck-upload-complete-icon-hide;animation-fill-mode:forwards,forwards;animation-duration:.5s,.5s;font-size:var(--ck-image-upload-icon-size);animation-delay:0ms,3s}.ck-image-upload-complete-icon:after{left:25%;top:50%;opacity:0;height:0;width:0;transform:scaleX(-1) rotate(135deg);transform-origin:left top;border-top:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);border-right:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);animation-name:ck-upload-complete-icon-check;animation-duration:.5s;animation-delay:.5s;animation-fill-mode:forwards;box-sizing:border-box}@keyframes ck-upload-complete-icon-show{0%{opacity:0}to{opacity:1}}@keyframes ck-upload-complete-icon-hide{0%{opacity:1}to{opacity:0}}@keyframes ck-upload-complete-icon-check{0%{opacity:1;width:0;height:0}33%{width:.3em;height:0}to{opacity:1;width:.3em;height:.45em}}'},function(s,i,a){var d=a(1),g=a(74);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports='.ck .ck-upload-placeholder-loader{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0}.ck .ck-upload-placeholder-loader:before{content:"";position:relative}:root{--ck-color-upload-placeholder-loader:#b3b3b3;--ck-upload-placeholder-loader-size:32px}.ck .ck-image-upload-placeholder{width:100%;margin:0}.ck .ck-upload-placeholder-loader{width:100%;height:100%}.ck .ck-upload-placeholder-loader:before{width:var(--ck-upload-placeholder-loader-size);height:var(--ck-upload-placeholder-loader-size);border-radius:50%;border-top:3px solid var(--ck-color-upload-placeholder-loader);border-right:2px solid transparent;animation:ck-upload-placeholder-loader 1s linear infinite}@keyframes ck-upload-placeholder-loader{to{transform:rotate(1turn)}}'},function(s,i,a){var d=a(1),g=a(76);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-link-form{display:flex}.ck.ck-link-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-link-form{flex-wrap:wrap}.ck.ck-link-form .ck-labeled-input{flex-basis:100%}.ck.ck-link-form .ck-button{flex-basis:50%}}.ck.ck-link-form_layout-vertical{display:block}.ck.ck-link-form{padding:var(--ck-spacing-standard)}.ck.ck-link-form:focus{outline:none}[dir=ltr] .ck.ck-link-form>:not(:first-child),[dir=rtl] .ck.ck-link-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-link-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-link-form .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-link-form .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-link-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-link-form .ck-button{margin-left:0}[dir=ltr] .ck.ck-link-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-link-form .ck-button{margin-left:0}[dir=rtl] .ck.ck-link-form .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}}.ck.ck-link-form_layout-vertical{padding:0;min-width:var(--ck-input-text-width)}.ck.ck-link-form_layout-vertical .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) var(--ck-spacing-small)}.ck.ck-link-form_layout-vertical .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-link-form_layout-vertical .ck-button{padding:var(--ck-spacing-standard);margin:0;border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border);width:50%}[dir=ltr] .ck.ck-link-form_layout-vertical .ck-button{margin-left:0}[dir=ltr] .ck.ck-link-form_layout-vertical .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button{margin-left:0}[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}.ck.ck-link-form_layout-vertical .ck.ck-list{margin-left:0}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton{border:0;width:100%}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton:hover{background:none}"},function(s,i,a){var d=a(1),g=a(78);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-link-actions{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-link-actions .ck-link-actions__preview{display:inline-block}.ck.ck-link-actions .ck-link-actions__preview .ck-button__label{overflow:hidden}@media screen and (max-width:600px){.ck.ck-link-actions{flex-wrap:wrap}.ck.ck-link-actions .ck-link-actions__preview{flex-basis:100%}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){flex-basis:50%}}.ck.ck-link-actions{padding:var(--ck-spacing-standard)}.ck.ck-link-actions .ck-button.ck-link-actions__preview{padding-left:0;padding-right:0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{padding:0 var(--ck-spacing-medium);color:var(--ck-color-link-default);text-overflow:ellipsis;cursor:pointer;max-width:var(--ck-input-text-width);min-width:3em;text-align:center}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label:hover{text-decoration:underline}.ck.ck-link-actions .ck-button.ck-link-actions__preview,.ck.ck-link-actions .ck-button.ck-link-actions__preview:active,.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus,.ck.ck-link-actions .ck-button.ck-link-actions__preview:hover{background:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:active{box-shadow:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus .ck-button__label{text-decoration:underline}.ck.ck-link-actions:focus{outline:none}[dir=ltr] .ck.ck-link-actions .ck-button:not(:first-child),[dir=rtl] .ck.ck-link-actions .ck-button:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-link-actions{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-link-actions .ck-button.ck-link-actions__preview{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{min-width:0;max-width:100%}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){margin-left:0}[dir=ltr] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview):first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){margin-left:0}[dir=rtl] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview):last-of-type{border-right:1px solid var(--ck-color-base-border)}}"},function(s,i,a){var d=a(1),g=a(80);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports='.ck-media__wrapper .ck-media__placeholder{display:flex;flex-direction:column;align-items:center}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:block}@media (hover:none){.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:none}}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url{max-width:100%;position:relative}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url:hover .ck-tooltip{visibility:visible;opacity:1}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-media__placeholder__url__text{overflow:hidden;display:block}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck-media__placeholder__icon *{display:none}.ck-editor__editable:not(.ck-read-only) .ck-media__wrapper>:not(.ck-media__placeholder),.ck-editor__editable:not(.ck-read-only) .ck-widget:not(.ck-widget_selected) .ck-media__placeholder{pointer-events:none}:root{--ck-media-embed-placeholder-icon-size:3em;--ck-color-media-embed-placeholder-url-text:#757575;--ck-color-media-embed-placeholder-url-text-hover:var(--ck-color-base-text)}.ck-media__wrapper{margin:0 auto}.ck-media__wrapper .ck-media__placeholder{padding:calc(3*var(--ck-spacing-standard));background:var(--ck-color-base-foreground)}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon{min-width:var(--ck-media-embed-placeholder-icon-size);height:var(--ck-media-embed-placeholder-icon-size);margin-bottom:var(--ck-spacing-large);background-position:50%;background-size:cover}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon .ck-icon{width:100%;height:100%}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text{color:var(--ck-color-media-embed-placeholder-url-text);white-space:nowrap;text-align:center;font-style:italic;text-overflow:ellipsis}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:var(--ck-color-media-embed-placeholder-url-text-hover);cursor:pointer;text-decoration:underline}.ck-media__wrapper[data-oembed-url*="open.spotify.com"]{max-width:300px;max-height:380px}.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTAuMzc4IiBoZWlnaHQ9IjI1NC4xNjciIHZpZXdCb3g9IjAgMCA2Ni4yNDYgNjcuMjQ4Ij48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTcyLjUzMSAtMjE4LjQ1NSkgc2NhbGUoLjk4MDEyKSI+PHJlY3Qgcnk9IjUuMjM4IiByeD0iNS4yMzgiIHk9IjIzMS4zOTkiIHg9IjE3Ni4wMzEiIGhlaWdodD0iNjAuMDk5IiB3aWR0aD0iNjAuMDk5IiBmaWxsPSIjMzRhNjY4IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0yMDYuNDc3IDI2MC45bC0yOC45ODcgMjguOTg3YTUuMjE4IDUuMjE4IDAgMDAzLjc4IDEuNjFoNDkuNjIxYzEuNjk0IDAgMy4xOS0uNzk4IDQuMTQ2LTIuMDM3eiIgZmlsbD0iIzVjODhjNSIvPjxwYXRoIGQ9Ik0yMjYuNzQyIDIyMi45ODhjLTkuMjY2IDAtMTYuNzc3IDcuMTctMTYuNzc3IDE2LjAxNC4wMDcgMi43NjIuNjYzIDUuNDc0IDIuMDkzIDcuODc1LjQzLjcwMy44MyAxLjQwOCAxLjE5IDIuMTA3LjMzMy41MDIuNjUgMS4wMDUuOTUgMS41MDguMzQzLjQ3Ny42NzMuOTU3Ljk4OCAxLjQ0IDEuMzEgMS43NjkgMi41IDMuNTAyIDMuNjM3IDUuMTY4Ljc5MyAxLjI3NSAxLjY4MyAyLjY0IDIuNDY2IDMuOTkgMi4zNjMgNC4wOTQgNC4wMDcgOC4wOTIgNC42IDEzLjkxNHYuMDEyYy4xODIuNDEyLjUxNi42NjYuODc5LjY2Ny40MDMtLjAwMS43NjgtLjMxNC45My0uNzk5LjYwMy01Ljc1NiAyLjIzOC05LjcyOSA0LjU4NS0xMy43OTQuNzgyLTEuMzUgMS42NzMtMi43MTUgMi40NjUtMy45OSAxLjEzNy0xLjY2NiAyLjMyOC0zLjQgMy42MzgtNS4xNjkuMzE1LS40ODIuNjQ1LS45NjIuOTg4LTEuNDM5LjMtLjUwMy42MTctMS4wMDYuOTUtMS41MDguMzU5LS43Ljc2LTEuNDA0IDEuMTktMi4xMDcgMS40MjYtMi40MDIgMi01LjExNCAyLjAwNC03Ljg3NSAwLTguODQ0LTcuNTExLTE2LjAxNC0xNi43NzYtMTYuMDE0eiIgZmlsbD0iI2RkNGIzZSIgcGFpbnQtb3JkZXI9Im1hcmtlcnMgc3Ryb2tlIGZpbGwiLz48ZWxsaXBzZSByeT0iNS41NjQiIHJ4PSI1LjgyOCIgY3k9IjIzOS4wMDIiIGN4PSIyMjYuNzQyIiBmaWxsPSIjODAyZDI3IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0xOTAuMzAxIDIzNy4yODNjLTQuNjcgMC04LjQ1NyAzLjg1My04LjQ1NyA4LjYwNnMzLjc4NiA4LjYwNyA4LjQ1NyA4LjYwN2MzLjA0MyAwIDQuODA2LS45NTggNi4zMzctMi41MTYgMS41My0xLjU1NyAyLjA4Ny0zLjkxMyAyLjA4Ny02LjI5IDAtLjM2Mi0uMDIzLS43MjItLjA2NC0xLjA3OWgtOC4yNTd2My4wNDNoNC44NWMtLjE5Ny43NTktLjUzMSAxLjQ1LTEuMDU4IDEuOTg2LS45NDIuOTU4LTIuMDI4IDEuNTQ4LTMuOTAxIDEuNTQ4LTIuODc2IDAtNS4yMDgtMi4zNzItNS4yMDgtNS4yOTkgMC0yLjkyNiAyLjMzMi01LjI5OSA1LjIwOC01LjI5OSAxLjM5OSAwIDIuNjE4LjQwNyAzLjU4NCAxLjI5M2wyLjM4MS0yLjM4YzAtLjAwMi0uMDAzLS4wMDQtLjAwNC0uMDA1LTEuNTg4LTEuNTI0LTMuNjItMi4yMTUtNS45NTUtMi4yMTV6bTQuNDMgNS42NmwuMDAzLjAwNnYtLjAwM3oiIGZpbGw9IiNmZmYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxNS4xODQgMjUxLjkyOWwtNy45OCA3Ljk3OSAyOC40NzcgMjguNDc1YTUuMjMzIDUuMjMzIDAgMDAuNDQ5LTIuMTIzdi0zMS4xNjVjLS40NjkuNjc1LS45MzQgMS4zNDktMS4zODIgMi4wMDUtLjc5MiAxLjI3NS0xLjY4MiAyLjY0LTIuNDY1IDMuOTktMi4zNDcgNC4wNjUtMy45ODIgOC4wMzgtNC41ODUgMTMuNzk0LS4xNjIuNDg1LS41MjcuNzk4LS45My43OTktLjM2My0uMDAxLS42OTctLjI1NS0uODc5LS42Njd2LS4wMTJjLS41OTMtNS44MjItMi4yMzctOS44Mi00LjYtMTMuOTE0LS43ODMtMS4zNS0xLjY3My0yLjcxNS0yLjQ2Ni0zLjk5LTEuMTM3LTEuNjY2LTIuMzI3LTMuNC0zLjYzNy01LjE2OWwtLjAwMi0uMDAzeiIgZmlsbD0iI2MzYzNjMyIvPjxwYXRoIGQ9Ik0yMTIuOTgzIDI0OC40OTVsLTM2Ljk1MiAzNi45NTN2LjgxMmE1LjIyNyA1LjIyNyAwIDAwNS4yMzggNS4yMzhoMS4wMTVsMzUuNjY2LTM1LjY2NmExMzYuMjc1IDEzNi4yNzUgMCAwMC0yLjc2NC0zLjkgMzcuNTc1IDM3LjU3NSAwIDAwLS45ODktMS40NCAzNS4xMjcgMzUuMTI3IDAgMDAtLjk1LTEuNTA4Yy0uMDgzLS4xNjItLjE3Ni0uMzI2LS4yNjQtLjQ4OXoiIGZpbGw9IiNmZGRjNGYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxMS45OTggMjYxLjA4M2wtNi4xNTIgNi4xNTEgMjQuMjY0IDI0LjI2NGguNzgxYTUuMjI3IDUuMjI3IDAgMDA1LjIzOS01LjIzOHYtMS4wNDV6IiBmaWxsPSIjZmZmIiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjwvZz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder{background:#4268b3}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAyNCIgaGVpZ2h0PSIxMDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik05NjcuNDg0IDBINTYuNTE3QzI1LjMwNCAwIDAgMjUuMzA0IDAgNTYuNTE3djkxMC45NjZDMCA5OTguNjk0IDI1LjI5NyAxMDI0IDU2LjUyMiAxMDI0SDU0N1Y2MjhINDE0VjQ3M2gxMzNWMzU5LjAyOWMwLTEzMi4yNjIgODAuNzczLTIwNC4yODIgMTk4Ljc1Ni0yMDQuMjgyIDU2LjUxMyAwIDEwNS4wODYgNC4yMDggMTE5LjI0NCA2LjA4OVYyOTlsLTgxLjYxNi4wMzdjLTYzLjk5MyAwLTc2LjM4NCAzMC40OTItNzYuMzg0IDc1LjIzNlY0NzNoMTUzLjQ4N2wtMTkuOTg2IDE1NUg3MDd2Mzk2aDI2MC40ODRjMzEuMjEzIDAgNTYuNTE2LTI1LjMwMyA1Ni41MTYtNTYuNTE2VjU2LjUxNUMxMDI0IDI1LjMwMyA5OTguNjk3IDAgOTY3LjQ4NCAwIiBmaWxsPSIjRkZGRkZFIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#cdf}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder{background:linear-gradient(-135deg,#1400c8,#b900b4,#f50000)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTA0IiBoZWlnaHQ9IjUwNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0wIC4xNTloNTAzLjg0MVY1MDMuOTRIMHoiLz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48cGF0aCBkPSJNMjUxLjkyMS4xNTljLTY4LjQxOCAwLTc2Ljk5Ny4yOS0xMDMuODY3IDEuNTE2LTI2LjgxNCAxLjIyMy00NS4xMjcgNS40ODItNjEuMTUxIDExLjcxLTE2LjU2NiA2LjQzNy0zMC42MTUgMTUuMDUxLTQ0LjYyMSAyOS4wNTYtMTQuMDA1IDE0LjAwNi0yMi42MTkgMjguMDU1LTI5LjA1NiA0NC42MjEtNi4yMjggMTYuMDI0LTEwLjQ4NyAzNC4zMzctMTEuNzEgNjEuMTUxQy4yOSAxNzUuMDgzIDAgMTgzLjY2MiAwIDI1Mi4wOGMwIDY4LjQxNy4yOSA3Ni45OTYgMS41MTYgMTAzLjg2NiAxLjIyMyAyNi44MTQgNS40ODIgNDUuMTI3IDExLjcxIDYxLjE1MSA2LjQzNyAxNi41NjYgMTUuMDUxIDMwLjYxNSAyOS4wNTYgNDQuNjIxIDE0LjAwNiAxNC4wMDUgMjguMDU1IDIyLjYxOSA0NC42MjEgMjkuMDU3IDE2LjAyNCA2LjIyNyAzNC4zMzcgMTAuNDg2IDYxLjE1MSAxMS43MDkgMjYuODcgMS4yMjYgMzUuNDQ5IDEuNTE2IDEwMy44NjcgMS41MTYgNjguNDE3IDAgNzYuOTk2LS4yOSAxMDMuODY2LTEuNTE2IDI2LjgxNC0xLjIyMyA0NS4xMjctNS40ODIgNjEuMTUxLTExLjcwOSAxNi41NjYtNi40MzggMzAuNjE1LTE1LjA1MiA0NC42MjEtMjkuMDU3IDE0LjAwNS0xNC4wMDYgMjIuNjE5LTI4LjA1NSAyOS4wNTctNDQuNjIxIDYuMjI3LTE2LjAyNCAxMC40ODYtMzQuMzM3IDExLjcwOS02MS4xNTEgMS4yMjYtMjYuODcgMS41MTYtMzUuNDQ5IDEuNTE2LTEwMy44NjYgMC02OC40MTgtLjI5LTc2Ljk5Ny0xLjUxNi0xMDMuODY3LTEuMjIzLTI2LjgxNC01LjQ4Mi00NS4xMjctMTEuNzA5LTYxLjE1MS02LjQzOC0xNi41NjYtMTUuMDUyLTMwLjYxNS0yOS4wNTctNDQuNjIxLTE0LjAwNi0xNC4wMDUtMjguMDU1LTIyLjYxOS00NC42MjEtMjkuMDU2LTE2LjAyNC02LjIyOC0zNC4zMzctMTAuNDg3LTYxLjE1MS0xMS43MUMzMjguOTE3LjQ0OSAzMjAuMzM4LjE1OSAyNTEuOTIxLjE1OXptMCA0NS4zOTFjNjcuMjY1IDAgNzUuMjMzLjI1NyAxMDEuNzk3IDEuNDY5IDI0LjU2MiAxLjEyIDM3LjkwMSA1LjIyNCA0Ni43NzggOC42NzQgMTEuNzU5IDQuNTcgMjAuMTUxIDEwLjAyOSAyOC45NjYgMTguODQ1IDguODE2IDguODE1IDE0LjI3NSAxNy4yMDcgMTguODQ1IDI4Ljk2NiAzLjQ1IDguODc3IDcuNTU0IDIyLjIxNiA4LjY3NCA0Ni43NzggMS4yMTIgMjYuNTY0IDEuNDY5IDM0LjUzMiAxLjQ2OSAxMDEuNzk4IDAgNjcuMjY1LS4yNTcgNzUuMjMzLTEuNDY5IDEwMS43OTctMS4xMiAyNC41NjItNS4yMjQgMzcuOTAxLTguNjc0IDQ2Ljc3OC00LjU3IDExLjc1OS0xMC4wMjkgMjAuMTUxLTE4Ljg0NSAyOC45NjYtOC44MTUgOC44MTYtMTcuMjA3IDE0LjI3NS0yOC45NjYgMTguODQ1LTguODc3IDMuNDUtMjIuMjE2IDcuNTU0LTQ2Ljc3OCA4LjY3NC0yNi41NiAxLjIxMi0zNC41MjcgMS40NjktMTAxLjc5NyAxLjQ2OS02Ny4yNzEgMC03NS4yMzctLjI1Ny0xMDEuNzk4LTEuNDY5LTI0LjU2Mi0xLjEyLTM3LjkwMS01LjIyNC00Ni43NzgtOC42NzQtMTEuNzU5LTQuNTctMjAuMTUxLTEwLjAyOS0yOC45NjYtMTguODQ1LTguODE1LTguODE1LTE0LjI3NS0xNy4yMDctMTguODQ1LTI4Ljk2Ni0zLjQ1LTguODc3LTcuNTU0LTIyLjIxNi04LjY3NC00Ni43NzgtMS4yMTItMjYuNTY0LTEuNDY5LTM0LjUzMi0xLjQ2OS0xMDEuNzk3IDAtNjcuMjY2LjI1Ny03NS4yMzQgMS40NjktMTAxLjc5OCAxLjEyLTI0LjU2MiA1LjIyNC0zNy45MDEgOC42NzQtNDYuNzc4IDQuNTctMTEuNzU5IDEwLjAyOS0yMC4xNTEgMTguODQ1LTI4Ljk2NiA4LjgxNS04LjgxNiAxNy4yMDctMTQuMjc1IDI4Ljk2Ni0xOC44NDUgOC44NzctMy40NSAyMi4yMTYtNy41NTQgNDYuNzc4LTguNjc0IDI2LjU2NC0xLjIxMiAzNC41MzItMS40NjkgMTAxLjc5OC0xLjQ2OXoiIGZpbGw9IiNGRkYiIG1hc2s9InVybCgjYikiLz48cGF0aCBkPSJNMjUxLjkyMSAzMzYuMDUzYy00Ni4zNzggMC04My45NzQtMzcuNTk2LTgzLjk3NC04My45NzMgMC00Ni4zNzggMzcuNTk2LTgzLjk3NCA4My45NzQtODMuOTc0IDQ2LjM3NyAwIDgzLjk3MyAzNy41OTYgODMuOTczIDgzLjk3NCAwIDQ2LjM3Ny0zNy41OTYgODMuOTczLTgzLjk3MyA4My45NzN6bTAtMjEzLjMzOGMtNzEuNDQ3IDAtMTI5LjM2NSA1Ny45MTgtMTI5LjM2NSAxMjkuMzY1IDAgNzEuNDQ2IDU3LjkxOCAxMjkuMzY0IDEyOS4zNjUgMTI5LjM2NCA3MS40NDYgMCAxMjkuMzY0LTU3LjkxOCAxMjkuMzY0LTEyOS4zNjQgMC03MS40NDctNTcuOTE4LTEyOS4zNjUtMTI5LjM2NC0xMjkuMzY1ek00MTYuNjI3IDExNy42MDRjMCAxNi42OTYtMTMuNTM1IDMwLjIzLTMwLjIzMSAzMC4yMy0xNi42OTUgMC0zMC4yMy0xMy41MzQtMzAuMjMtMzAuMjMgMC0xNi42OTYgMTMuNTM1LTMwLjIzMSAzMC4yMy0zMC4yMzEgMTYuNjk2IDAgMzAuMjMxIDEzLjUzNSAzMC4yMzEgMzAuMjMxIiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPg==)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#ffe0fe}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder{background:linear-gradient(90deg,#71c6f4,#0d70a5)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0MDAgNDAwIj48cGF0aCBkPSJNNDAwIDIwMGMwIDExMC41LTg5LjUgMjAwLTIwMCAyMDBTMCAzMTAuNSAwIDIwMCA4OS41IDAgMjAwIDBzMjAwIDg5LjUgMjAwIDIwMHpNMTYzLjQgMzA1LjVjODguNyAwIDEzNy4yLTczLjUgMTM3LjItMTM3LjIgMC0yLjEgMC00LjItLjEtNi4yIDkuNC02LjggMTcuNi0xNS4zIDI0LjEtMjUtOC42IDMuOC0xNy45IDYuNC0yNy43IDcuNiAxMC02IDE3LjYtMTUuNCAyMS4yLTI2LjctOS4zIDUuNS0xOS42IDkuNS0zMC42IDExLjctOC44LTkuNC0yMS4zLTE1LjItMzUuMi0xNS4yLTI2LjYgMC00OC4yIDIxLjYtNDguMiA0OC4yIDAgMy44LjQgNy41IDEuMyAxMS00MC4xLTItNzUuNi0yMS4yLTk5LjQtNTAuNC00LjEgNy4xLTYuNSAxNS40LTYuNSAyNC4yIDAgMTYuNyA4LjUgMzEuNSAyMS41IDQwLjEtNy45LS4yLTE1LjMtMi40LTIxLjgtNnYuNmMwIDIzLjQgMTYuNiA0Mi44IDM4LjcgNDcuMy00IDEuMS04LjMgMS43LTEyLjcgMS43LTMuMSAwLTYuMS0uMy05LjEtLjkgNi4xIDE5LjIgMjMuOSAzMy4xIDQ1IDMzLjUtMTYuNSAxMi45LTM3LjMgMjAuNi01OS45IDIwLjYtMy45IDAtNy43LS4yLTExLjUtLjcgMjEuMSAxMy44IDQ2LjUgMjEuOCA3My43IDIxLjgiIGZpbGw9IiNmZmYiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text{color:#b8e6ff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}'},function(s,i,a){var d=a(1),g=a(82);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck.ck-media-form{display:flex;align-items:flex-start;flex-direction:row;flex-wrap:nowrap}.ck.ck-media-form .ck-labeled-input{display:inline-block}.ck.ck-media-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-media-form{flex-wrap:wrap}.ck.ck-media-form .ck-labeled-input{flex-basis:100%}.ck.ck-media-form .ck-button{flex-basis:50%}}.ck.ck-media-form{padding:var(--ck-spacing-standard)}.ck.ck-media-form:focus{outline:none}[dir=ltr] .ck.ck-media-form>:not(:first-child),[dir=rtl] .ck.ck-media-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-media-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-media-form .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-media-form .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-media-form .ck-labeled-input .ck-labeled-input__error{white-space:normal}.ck.ck-media-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-media-form .ck-button{margin-left:0}[dir=ltr] .ck.ck-media-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-media-form .ck-button{margin-left:0}[dir=rtl] .ck.ck-media-form .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}}"},function(s,i,a){var d=a(1),g=a(84);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck-content .media{clear:both;margin:1em 0;display:block;min-width:15em}"},function(s,i,a){var d=a(1),g=a(86);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=":root{--ck-color-table-focused-cell-background:rgba(158,207,250,0.3)}.ck-widget.table td.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table td.ck-editor__nested-editable:focus,.ck-widget.table th.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table th.ck-editor__nested-editable:focus{background:var(--ck-color-table-focused-cell-background);border-style:none;outline:1px solid var(--ck-color-focus-border);outline-offset:-1px}"},function(s,i,a){var d=a(1),g=a(88);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck .ck-insert-table-dropdown__grid{display:flex;flex-direction:row;flex-wrap:wrap}:root{--ck-insert-table-dropdown-padding:10px;--ck-insert-table-dropdown-box-height:11px;--ck-insert-table-dropdown-box-width:12px;--ck-insert-table-dropdown-box-margin:1px}.ck .ck-insert-table-dropdown__grid{width:calc(var(--ck-insert-table-dropdown-box-width)*10 + var(--ck-insert-table-dropdown-box-margin)*20 + var(--ck-insert-table-dropdown-padding)*2);padding:var(--ck-insert-table-dropdown-padding) var(--ck-insert-table-dropdown-padding) 0}.ck .ck-insert-table-dropdown__label{text-align:center}.ck .ck-insert-table-dropdown-grid-box{width:var(--ck-insert-table-dropdown-box-width);height:var(--ck-insert-table-dropdown-box-height);margin:var(--ck-insert-table-dropdown-box-margin);border:1px solid var(--ck-color-base-border);border-radius:1px}.ck .ck-insert-table-dropdown-grid-box.ck-on{border-color:var(--ck-color-focus-border);background:var(--ck-color-focus-outer-shadow)}"},function(s,i,a){var d=a(1),g=a(90);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=":root{--ck-table-selected-cell-background:#cee5fd}.ck.ck-editor__editable .table table td.ck-editor__editable_selected,.ck.ck-editor__editable .table table th.ck-editor__editable_selected{background-color:var(--ck-table-selected-cell-background)!important;caret-color:transparent;outline:unset;box-shadow:unset}.ck.ck-editor__editable .table table td.ck-editor__editable_selected ::selection,.ck.ck-editor__editable .table table th.ck-editor__editable_selected ::selection{background-color:transparent}.ck.ck-editor__editable .table table td.ck-editor__editable_selected .ck-widget_selected,.ck.ck-editor__editable .table table th.ck-editor__editable_selected .ck-widget_selected{outline:unset}"},function(s,i,a){var d=a(1),g=a(92);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".ck-content .table{margin:1em auto;display:table}.ck-content .table table{border-collapse:collapse;border-spacing:0;width:100%;height:100%;border:1px double #b3b3b3}.ck-content .table table td,.ck-content .table table th{min-width:2em;padding:.4em;border-color:#bfbfbf}.ck-content .table table th{font-weight:700;background:hsla(0,0%,0%,5%)}"},function(module,__webpack_exports__,__webpack_require__){(function(){var HxOverrides=function(){};HxOverrides.__name__=!0,HxOverrides.dateStr=function(s){var i=s.getMonth()+1,a=s.getDate(),d=s.getHours(),g=s.getMinutes(),b=s.getSeconds();return s.getFullYear()+"-"+(i<10?"0"+i:""+i)+"-"+(a<10?"0"+a:""+a)+" "+(d<10?"0"+d:""+d)+":"+(g<10?"0"+g:""+g)+":"+(b<10?"0"+b:""+b)},HxOverrides.strDate=function(s){switch(s.length){case 8:var a=s.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(a[0]),i.setUTCMinutes(a[1]),i.setUTCSeconds(a[2]),i;case 10:var a=s.split("-");return new Date(a[0],a[1]-1,a[2],0,0,0);case 19:var a=s.split(" "),d=a[0].split("-"),g=a[1].split(":");return new Date(d[0],d[1]-1,d[2],g[0],g[1],g[2]);default:throw"Invalid date format : "+s}},HxOverrides.cca=function(s,i){var a=s.charCodeAt(i);if(a==a)return a},HxOverrides.substr=function(s,i,a){return i!=null&&i!=0&&a!=null&&a<0?"":(a==null&&(a=s.length),i<0?(i=s.length+i,i<0&&(i=0)):a<0&&(a=s.length+a-i),s.substr(i,a))},HxOverrides.remove=function(s,i){for(var a=0,d=s.length;a<d;){if(s[a]==i)return s.splice(a,1),!0;a++}return!1},HxOverrides.iter=function(s){return{cur:0,arr:s,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var IntIter=function(s,i){this.min=s,this.max=i};IntIter.__name__=!0,IntIter.prototype={next:function(){return this.min++},hasNext:function(){return this.min<this.max},__class__:IntIter};var Std=function(){};Std.__name__=!0,Std.is=function(s,i){return js.Boot.__instanceof(s,i)},Std.string=function(s){return js.Boot.__string_rec(s,"")},Std.int=function(s){return s|0},Std.parseInt=function(s){var i=parseInt(s,10);return i==0&&(HxOverrides.cca(s,1)==120||HxOverrides.cca(s,1)==88)&&(i=parseInt(s)),isNaN(i)?null:i},Std.parseFloat=function(s){return parseFloat(s)},Std.random=function(s){return Math.floor(Math.random()*s)};var com=com||{};com.wiris||(com.wiris={}),com.wiris.js||(com.wiris.js={}),com.wiris.js.JsPluginTools=function(){this.tryReady()},com.wiris.js.JsPluginTools.__name__=!0,com.wiris.js.JsPluginTools.main=function(){var s;s=com.wiris.js.JsPluginTools.getInstance(),haxe.Timer.delay($bind(s,s.tryReady),100)},com.wiris.js.JsPluginTools.getInstance=function(){return com.wiris.js.JsPluginTools.instance==null&&(com.wiris.js.JsPluginTools.instance=new com.wiris.js.JsPluginTools),com.wiris.js.JsPluginTools.instance},com.wiris.js.JsPluginTools.bypassEncapsulation=function(){window.com==null&&(window.com={}),window.com.wiris==null&&(window.com.wiris={}),window.com.wiris.js==null&&(window.com.wiris.js={}),window.com.wiris.js.JsPluginTools==null&&(window.com.wiris.js.JsPluginTools=com.wiris.js.JsPluginTools.getInstance())},com.wiris.js.JsPluginTools.prototype={md5encode:function(s){return haxe.Md5.encode(s)},doLoad:function(){this.ready=!0,com.wiris.js.JsPluginTools.instance=this,com.wiris.js.JsPluginTools.bypassEncapsulation()},tryReady:function(){this.ready=!1,js.Lib.document.readyState&&(this.doLoad(),this.ready=!0),this.ready||haxe.Timer.delay($bind(this,this.tryReady),100)},__class__:com.wiris.js.JsPluginTools};var haxe=haxe||{};haxe.Log=function(){},haxe.Log.__name__=!0,haxe.Log.trace=function(s,i){js.Boot.__trace(s,i)},haxe.Log.clear=function(){js.Boot.__clear_trace()},haxe.Md5=function(){},haxe.Md5.__name__=!0,haxe.Md5.encode=function(s){return new haxe.Md5().doEncode(s)},haxe.Md5.prototype={doEncode:function(s){for(var i=this.str2blks(s),a=1732584193,d=-271733879,g=-1732584194,b=271733878,$=0;$<i.length;){var tt=a,it=d,rt=g,ot=b;a=this.ff(a,d,g,b,i[$],7,-680876936),b=this.ff(b,a,d,g,i[$+1],12,-389564586),g=this.ff(g,b,a,d,i[$+2],17,606105819),d=this.ff(d,g,b,a,i[$+3],22,-1044525330),a=this.ff(a,d,g,b,i[$+4],7,-176418897),b=this.ff(b,a,d,g,i[$+5],12,1200080426),g=this.ff(g,b,a,d,i[$+6],17,-1473231341),d=this.ff(d,g,b,a,i[$+7],22,-45705983),a=this.ff(a,d,g,b,i[$+8],7,1770035416),b=this.ff(b,a,d,g,i[$+9],12,-1958414417),g=this.ff(g,b,a,d,i[$+10],17,-42063),d=this.ff(d,g,b,a,i[$+11],22,-1990404162),a=this.ff(a,d,g,b,i[$+12],7,1804603682),b=this.ff(b,a,d,g,i[$+13],12,-40341101),g=this.ff(g,b,a,d,i[$+14],17,-1502002290),d=this.ff(d,g,b,a,i[$+15],22,1236535329),a=this.gg(a,d,g,b,i[$+1],5,-165796510),b=this.gg(b,a,d,g,i[$+6],9,-1069501632),g=this.gg(g,b,a,d,i[$+11],14,643717713),d=this.gg(d,g,b,a,i[$],20,-373897302),a=this.gg(a,d,g,b,i[$+5],5,-701558691),b=this.gg(b,a,d,g,i[$+10],9,38016083),g=this.gg(g,b,a,d,i[$+15],14,-660478335),d=this.gg(d,g,b,a,i[$+4],20,-405537848),a=this.gg(a,d,g,b,i[$+9],5,568446438),b=this.gg(b,a,d,g,i[$+14],9,-1019803690),g=this.gg(g,b,a,d,i[$+3],14,-187363961),d=this.gg(d,g,b,a,i[$+8],20,1163531501),a=this.gg(a,d,g,b,i[$+13],5,-1444681467),b=this.gg(b,a,d,g,i[$+2],9,-51403784),g=this.gg(g,b,a,d,i[$+7],14,1735328473),d=this.gg(d,g,b,a,i[$+12],20,-1926607734),a=this.hh(a,d,g,b,i[$+5],4,-378558),b=this.hh(b,a,d,g,i[$+8],11,-2022574463),g=this.hh(g,b,a,d,i[$+11],16,1839030562),d=this.hh(d,g,b,a,i[$+14],23,-35309556),a=this.hh(a,d,g,b,i[$+1],4,-1530992060),b=this.hh(b,a,d,g,i[$+4],11,1272893353),g=this.hh(g,b,a,d,i[$+7],16,-155497632),d=this.hh(d,g,b,a,i[$+10],23,-1094730640),a=this.hh(a,d,g,b,i[$+13],4,681279174),b=this.hh(b,a,d,g,i[$],11,-358537222),g=this.hh(g,b,a,d,i[$+3],16,-722521979),d=this.hh(d,g,b,a,i[$+6],23,76029189),a=this.hh(a,d,g,b,i[$+9],4,-640364487),b=this.hh(b,a,d,g,i[$+12],11,-421815835),g=this.hh(g,b,a,d,i[$+15],16,530742520),d=this.hh(d,g,b,a,i[$+2],23,-995338651),a=this.ii(a,d,g,b,i[$],6,-198630844),b=this.ii(b,a,d,g,i[$+7],10,1126891415),g=this.ii(g,b,a,d,i[$+14],15,-1416354905),d=this.ii(d,g,b,a,i[$+5],21,-57434055),a=this.ii(a,d,g,b,i[$+12],6,1700485571),b=this.ii(b,a,d,g,i[$+3],10,-1894986606),g=this.ii(g,b,a,d,i[$+10],15,-1051523),d=this.ii(d,g,b,a,i[$+1],21,-2054922799),a=this.ii(a,d,g,b,i[$+8],6,1873313359),b=this.ii(b,a,d,g,i[$+15],10,-30611744),g=this.ii(g,b,a,d,i[$+6],15,-1560198380),d=this.ii(d,g,b,a,i[$+13],21,1309151649),a=this.ii(a,d,g,b,i[$+4],6,-145523070),b=this.ii(b,a,d,g,i[$+11],10,-1120210379),g=this.ii(g,b,a,d,i[$+2],15,718787259),d=this.ii(d,g,b,a,i[$+9],21,-343485551),a=this.addme(a,tt),d=this.addme(d,it),g=this.addme(g,rt),b=this.addme(b,ot),$+=16}return this.rhex(a)+this.rhex(d)+this.rhex(g)+this.rhex(b)},ii:function(s,i,a,d,g,b,$){return this.cmn(this.bitXOR(a,this.bitOR(i,~d)),s,i,g,b,$)},hh:function(s,i,a,d,g,b,$){return this.cmn(this.bitXOR(this.bitXOR(i,a),d),s,i,g,b,$)},gg:function(s,i,a,d,g,b,$){return this.cmn(this.bitOR(this.bitAND(i,d),this.bitAND(a,~d)),s,i,g,b,$)},ff:function(s,i,a,d,g,b,$){return this.cmn(this.bitOR(this.bitAND(i,a),this.bitAND(~i,d)),s,i,g,b,$)},cmn:function(s,i,a,d,g,b){return this.addme(this.rol(this.addme(this.addme(i,s),this.addme(d,b)),g),a)},rol:function(s,i){return s<<i|s>>>32-i},str2blks:function(s){for(var i=(s.length+8>>6)+1,a=new Array,d=0,g=i*16;d<g;){var b=d++;a[b]=0}for(var b=0;b<s.length;)a[b>>2]|=HxOverrides.cca(s,b)<<(s.length*8+b)%4*8,b++;a[b>>2]|=128<<(s.length*8+b)%4*8;var $=s.length*8,tt=i*16-2;return a[tt]=$&255,a[tt]|=($>>>8&255)<<8,a[tt]|=($>>>16&255)<<16,a[tt]|=($>>>24&255)<<24,a},rhex:function(s){for(var i="",a="0123456789abcdef",d=0;d<4;){var g=d++;i+=a.charAt(s>>g*8+4&15)+a.charAt(s>>g*8&15)}return i},addme:function(s,i){var a=(s&65535)+(i&65535),d=(s>>16)+(i>>16)+(a>>16);return d<<16|a&65535},bitAND:function(s,i){var a=s&1&(i&1),d=s>>>1&i>>>1;return d<<1|a},bitXOR:function(s,i){var a=s&1^i&1,d=s>>>1^i>>>1;return d<<1|a},bitOR:function(s,i){var a=s&1|i&1,d=s>>>1|i>>>1;return d<<1|a},__class__:haxe.Md5},haxe.Timer=function(s){var i=this;this.id=window.setInterval(function(){i.run()},s)},haxe.Timer.__name__=!0,haxe.Timer.delay=function(s,i){var a=new haxe.Timer(i);return a.run=function(){a.stop(),s()},a},haxe.Timer.measure=function(s,i){var a=haxe.Timer.stamp(),d=s();return haxe.Log.trace(haxe.Timer.stamp()-a+"s",i),d},haxe.Timer.stamp=function(){return new Date().getTime()/1e3},haxe.Timer.prototype={run:function(){},stop:function(){this.id!=null&&(window.clearInterval(this.id),this.id=null)},__class__:haxe.Timer};var js=js||{};js.Boot=function(){},js.Boot.__name__=!0,js.Boot.__unhtml=function(s){return s.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},js.Boot.__trace=function(s,i){var a=i!=null?i.fileName+":"+i.lineNumber+": ":"";a+=js.Boot.__string_rec(s,"");var d;typeof document<"u"&&(d=document.getElementById("haxe:trace"))!=null?d.innerHTML+=js.Boot.__unhtml(a)+"<br/>":typeof console<"u"&&console.log!=null&&console.log(a)},js.Boot.__clear_trace=function(){var s=document.getElementById("haxe:trace");s!=null&&(s.innerHTML="")},js.Boot.isClass=function(s){return s.__name__},js.Boot.isEnum=function(s){return s.__ename__},js.Boot.getClass=function(s){return s.__class__},js.Boot.__string_rec=function(s,i){if(s==null)return"null";if(i.length>=5)return"<...>";var a=typeof s;switch(a=="function"&&(s.__name__||s.__ename__)&&(a="object"),a){case"object":if(s instanceof Array){if(s.__enum__){if(s.length==2)return s[0];var lt=s[0]+"(";i+="	";for(var d=2,$=s.length;d<$;){var b=d++;b!=2?lt+=","+js.Boot.__string_rec(s[b],i):lt+=js.Boot.__string_rec(s[b],i)}return lt+")"}var g=s.length,b,lt="[";i+="	";for(var $=0;$<g;){var tt=$++;lt+=(tt>0?",":"")+js.Boot.__string_rec(s[tt],i)}return lt+="]",lt}var it;try{it=s.toString}catch{return"???"}if(it!=null&&it!=Object.toString){var rt=s.toString();if(rt!="[object Object]")return rt}var ot=null,lt=`{
`;i+="	";var ut=s.hasOwnProperty!=null;for(var ot in s)ut&&!s.hasOwnProperty(ot)||ot=="prototype"||ot=="__class__"||ot=="__super__"||ot=="__interfaces__"||ot=="__properties__"||(lt.length!=2&&(lt+=`, 
`),lt+=i+ot+" : "+js.Boot.__string_rec(s[ot],i));return i=i.substring(1),lt+=`
`+i+"}",lt;case"function":return"<function>";case"string":return s;default:return String(s)}},js.Boot.__interfLoop=function(s,i){if(s==null)return!1;if(s==i)return!0;var a=s.__interfaces__;if(a!=null)for(var d=0,g=a.length;d<g;){var b=d++,$=a[b];if($==i||js.Boot.__interfLoop($,i))return!0}return js.Boot.__interfLoop(s.__super__,i)},js.Boot.__instanceof=function(s,i){try{if(s instanceof i)return i==Array?s.__enum__==null:!0;if(js.Boot.__interfLoop(s.__class__,i))return!0}catch{if(i==null)return!1}switch(i){case Int:return Math.ceil(s%2147483648)===s;case Float:return typeof s=="number";case Bool:return s===!0||s===!1;case String:return typeof s=="string";case Dynamic:return!0;default:return s==null?!1:i==Class&&s.__name__!=null||i==Enum&&s.__ename__!=null?!0:s.__enum__==i}},js.Boot.__cast=function(s,i){if(js.Boot.__instanceof(s,i))return s;throw"Cannot cast "+Std.string(s)+" to "+Std.string(i)},js.Lib=function(){},js.Lib.__name__=!0,js.Lib.debug=function(){debugger},js.Lib.alert=function(s){alert(js.Boot.__string_rec(s,""))},js.Lib.eval=function(code){return eval(code)},js.Lib.setErrorHandler=function(s){js.Lib.onerror=s};function $bind(s,i){var a=function(){return a.method.apply(a.scope,arguments)};return a.scope=s,a.method=i,a}Array.prototype.indexOf&&(HxOverrides.remove=function(s,i){var a=s.indexOf(i);return a==-1?!1:(s.splice(a,1),!0)}),Math.__name__=["Math"],Math.NaN=Number.NaN,Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Math.isFinite=function(s){return isFinite(s)},Math.isNaN=function(s){return isNaN(s)},String.prototype.__class__=String,String.__name__=!0,Array.prototype.__class__=Array,Array.__name__=!0,Date.prototype.__class__=Date,Date.__name__=["Date"];var Int={__name__:["Int"]},Dynamic={__name__:["Dynamic"]},Float=Number;Float.__name__=["Float"];var Bool=Boolean;Bool.__ename__=["Bool"];var Class={__name__:["Class"]},Enum={};typeof document<"u"&&(js.Lib.document=document),typeof window<"u"&&(js.Lib.window=window,js.Lib.window.onerror=function(s,i,a){var d=js.Lib.onerror;return d==null?!1:d(s,[i+":"+a])}),com.wiris.js.JsPluginTools.main(),delete Array.prototype.__class__})(),function(){var HxOverrides=function(){};HxOverrides.__name__=!0,HxOverrides.dateStr=function(s){var i=s.getMonth()+1,a=s.getDate(),d=s.getHours(),g=s.getMinutes(),b=s.getSeconds();return s.getFullYear()+"-"+(i<10?"0"+i:""+i)+"-"+(a<10?"0"+a:""+a)+" "+(d<10?"0"+d:""+d)+":"+(g<10?"0"+g:""+g)+":"+(b<10?"0"+b:""+b)},HxOverrides.strDate=function(s){switch(s.length){case 8:var a=s.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(a[0]),i.setUTCMinutes(a[1]),i.setUTCSeconds(a[2]),i;case 10:var a=s.split("-");return new Date(a[0],a[1]-1,a[2],0,0,0);case 19:var a=s.split(" "),d=a[0].split("-"),g=a[1].split(":");return new Date(d[0],d[1]-1,d[2],g[0],g[1],g[2]);default:throw"Invalid date format : "+s}},HxOverrides.cca=function(s,i){var a=s.charCodeAt(i);if(a==a)return a},HxOverrides.substr=function(s,i,a){return i!=null&&i!=0&&a!=null&&a<0?"":(a==null&&(a=s.length),i<0?(i=s.length+i,i<0&&(i=0)):a<0&&(a=s.length+a-i),s.substr(i,a))},HxOverrides.remove=function(s,i){for(var a=0,d=s.length;a<d;){if(s[a]==i)return s.splice(a,1),!0;a++}return!1},HxOverrides.iter=function(s){return{cur:0,arr:s,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var IntIter=function(s,i){this.min=s,this.max=i};IntIter.__name__=!0,IntIter.prototype={next:function(){return this.min++},hasNext:function(){return this.min<this.max},__class__:IntIter};var Std=function(){};Std.__name__=!0,Std.is=function(s,i){return js.Boot.__instanceof(s,i)},Std.string=function(s){return js.Boot.__string_rec(s,"")},Std.int=function(s){return s|0},Std.parseInt=function(s){var i=parseInt(s,10);return i==0&&(HxOverrides.cca(s,1)==120||HxOverrides.cca(s,1)==88)&&(i=parseInt(s)),isNaN(i)?null:i},Std.parseFloat=function(s){return parseFloat(s)},Std.random=function(s){return Math.floor(Math.random()*s)};var com=com||{};com.wiris||(com.wiris={}),com.wiris.js||(com.wiris.js={}),com.wiris.js.JsPluginTools=function(){this.tryReady()},com.wiris.js.JsPluginTools.__name__=!0,com.wiris.js.JsPluginTools.main=function(){var s;s=com.wiris.js.JsPluginTools.getInstance(),haxe.Timer.delay($bind(s,s.tryReady),100)},com.wiris.js.JsPluginTools.getInstance=function(){return com.wiris.js.JsPluginTools.instance==null&&(com.wiris.js.JsPluginTools.instance=new com.wiris.js.JsPluginTools),com.wiris.js.JsPluginTools.instance},com.wiris.js.JsPluginTools.bypassEncapsulation=function(){window.com==null&&(window.com={}),window.com.wiris==null&&(window.com.wiris={}),window.com.wiris.js==null&&(window.com.wiris.js={}),window.com.wiris.js.JsPluginTools==null&&(window.com.wiris.js.JsPluginTools=com.wiris.js.JsPluginTools.getInstance())},com.wiris.js.JsPluginTools.prototype={md5encode:function(s){return haxe.Md5.encode(s)},doLoad:function(){this.ready=!0,com.wiris.js.JsPluginTools.instance=this,com.wiris.js.JsPluginTools.bypassEncapsulation()},tryReady:function(){this.ready=!1,js.Lib.document.readyState&&(this.doLoad(),this.ready=!0),this.ready||haxe.Timer.delay($bind(this,this.tryReady),100)},__class__:com.wiris.js.JsPluginTools};var haxe=haxe||{};haxe.Log=function(){},haxe.Log.__name__=!0,haxe.Log.trace=function(s,i){js.Boot.__trace(s,i)},haxe.Log.clear=function(){js.Boot.__clear_trace()},haxe.Md5=function(){},haxe.Md5.__name__=!0,haxe.Md5.encode=function(s){return new haxe.Md5().doEncode(s)},haxe.Md5.prototype={doEncode:function(s){for(var i=this.str2blks(s),a=1732584193,d=-271733879,g=-1732584194,b=271733878,$=0;$<i.length;){var tt=a,it=d,rt=g,ot=b;a=this.ff(a,d,g,b,i[$],7,-680876936),b=this.ff(b,a,d,g,i[$+1],12,-389564586),g=this.ff(g,b,a,d,i[$+2],17,606105819),d=this.ff(d,g,b,a,i[$+3],22,-1044525330),a=this.ff(a,d,g,b,i[$+4],7,-176418897),b=this.ff(b,a,d,g,i[$+5],12,1200080426),g=this.ff(g,b,a,d,i[$+6],17,-1473231341),d=this.ff(d,g,b,a,i[$+7],22,-45705983),a=this.ff(a,d,g,b,i[$+8],7,1770035416),b=this.ff(b,a,d,g,i[$+9],12,-1958414417),g=this.ff(g,b,a,d,i[$+10],17,-42063),d=this.ff(d,g,b,a,i[$+11],22,-1990404162),a=this.ff(a,d,g,b,i[$+12],7,1804603682),b=this.ff(b,a,d,g,i[$+13],12,-40341101),g=this.ff(g,b,a,d,i[$+14],17,-1502002290),d=this.ff(d,g,b,a,i[$+15],22,1236535329),a=this.gg(a,d,g,b,i[$+1],5,-165796510),b=this.gg(b,a,d,g,i[$+6],9,-1069501632),g=this.gg(g,b,a,d,i[$+11],14,643717713),d=this.gg(d,g,b,a,i[$],20,-373897302),a=this.gg(a,d,g,b,i[$+5],5,-701558691),b=this.gg(b,a,d,g,i[$+10],9,38016083),g=this.gg(g,b,a,d,i[$+15],14,-660478335),d=this.gg(d,g,b,a,i[$+4],20,-405537848),a=this.gg(a,d,g,b,i[$+9],5,568446438),b=this.gg(b,a,d,g,i[$+14],9,-1019803690),g=this.gg(g,b,a,d,i[$+3],14,-187363961),d=this.gg(d,g,b,a,i[$+8],20,1163531501),a=this.gg(a,d,g,b,i[$+13],5,-1444681467),b=this.gg(b,a,d,g,i[$+2],9,-51403784),g=this.gg(g,b,a,d,i[$+7],14,1735328473),d=this.gg(d,g,b,a,i[$+12],20,-1926607734),a=this.hh(a,d,g,b,i[$+5],4,-378558),b=this.hh(b,a,d,g,i[$+8],11,-2022574463),g=this.hh(g,b,a,d,i[$+11],16,1839030562),d=this.hh(d,g,b,a,i[$+14],23,-35309556),a=this.hh(a,d,g,b,i[$+1],4,-1530992060),b=this.hh(b,a,d,g,i[$+4],11,1272893353),g=this.hh(g,b,a,d,i[$+7],16,-155497632),d=this.hh(d,g,b,a,i[$+10],23,-1094730640),a=this.hh(a,d,g,b,i[$+13],4,681279174),b=this.hh(b,a,d,g,i[$],11,-358537222),g=this.hh(g,b,a,d,i[$+3],16,-722521979),d=this.hh(d,g,b,a,i[$+6],23,76029189),a=this.hh(a,d,g,b,i[$+9],4,-640364487),b=this.hh(b,a,d,g,i[$+12],11,-421815835),g=this.hh(g,b,a,d,i[$+15],16,530742520),d=this.hh(d,g,b,a,i[$+2],23,-995338651),a=this.ii(a,d,g,b,i[$],6,-198630844),b=this.ii(b,a,d,g,i[$+7],10,1126891415),g=this.ii(g,b,a,d,i[$+14],15,-1416354905),d=this.ii(d,g,b,a,i[$+5],21,-57434055),a=this.ii(a,d,g,b,i[$+12],6,1700485571),b=this.ii(b,a,d,g,i[$+3],10,-1894986606),g=this.ii(g,b,a,d,i[$+10],15,-1051523),d=this.ii(d,g,b,a,i[$+1],21,-2054922799),a=this.ii(a,d,g,b,i[$+8],6,1873313359),b=this.ii(b,a,d,g,i[$+15],10,-30611744),g=this.ii(g,b,a,d,i[$+6],15,-1560198380),d=this.ii(d,g,b,a,i[$+13],21,1309151649),a=this.ii(a,d,g,b,i[$+4],6,-145523070),b=this.ii(b,a,d,g,i[$+11],10,-1120210379),g=this.ii(g,b,a,d,i[$+2],15,718787259),d=this.ii(d,g,b,a,i[$+9],21,-343485551),a=this.addme(a,tt),d=this.addme(d,it),g=this.addme(g,rt),b=this.addme(b,ot),$+=16}return this.rhex(a)+this.rhex(d)+this.rhex(g)+this.rhex(b)},ii:function(s,i,a,d,g,b,$){return this.cmn(this.bitXOR(a,this.bitOR(i,~d)),s,i,g,b,$)},hh:function(s,i,a,d,g,b,$){return this.cmn(this.bitXOR(this.bitXOR(i,a),d),s,i,g,b,$)},gg:function(s,i,a,d,g,b,$){return this.cmn(this.bitOR(this.bitAND(i,d),this.bitAND(a,~d)),s,i,g,b,$)},ff:function(s,i,a,d,g,b,$){return this.cmn(this.bitOR(this.bitAND(i,a),this.bitAND(~i,d)),s,i,g,b,$)},cmn:function(s,i,a,d,g,b){return this.addme(this.rol(this.addme(this.addme(i,s),this.addme(d,b)),g),a)},rol:function(s,i){return s<<i|s>>>32-i},str2blks:function(s){for(var i=(s.length+8>>6)+1,a=new Array,d=0,g=i*16;d<g;){var b=d++;a[b]=0}for(var b=0;b<s.length;)a[b>>2]|=HxOverrides.cca(s,b)<<(s.length*8+b)%4*8,b++;a[b>>2]|=128<<(s.length*8+b)%4*8;var $=s.length*8,tt=i*16-2;return a[tt]=$&255,a[tt]|=($>>>8&255)<<8,a[tt]|=($>>>16&255)<<16,a[tt]|=($>>>24&255)<<24,a},rhex:function(s){for(var i="",a="0123456789abcdef",d=0;d<4;){var g=d++;i+=a.charAt(s>>g*8+4&15)+a.charAt(s>>g*8&15)}return i},addme:function(s,i){var a=(s&65535)+(i&65535),d=(s>>16)+(i>>16)+(a>>16);return d<<16|a&65535},bitAND:function(s,i){var a=s&1&(i&1),d=s>>>1&i>>>1;return d<<1|a},bitXOR:function(s,i){var a=s&1^i&1,d=s>>>1^i>>>1;return d<<1|a},bitOR:function(s,i){var a=s&1|i&1,d=s>>>1|i>>>1;return d<<1|a},__class__:haxe.Md5},haxe.Timer=function(s){var i=this;this.id=window.setInterval(function(){i.run()},s)},haxe.Timer.__name__=!0,haxe.Timer.delay=function(s,i){var a=new haxe.Timer(i);return a.run=function(){a.stop(),s()},a},haxe.Timer.measure=function(s,i){var a=haxe.Timer.stamp(),d=s();return haxe.Log.trace(haxe.Timer.stamp()-a+"s",i),d},haxe.Timer.stamp=function(){return new Date().getTime()/1e3},haxe.Timer.prototype={run:function(){},stop:function(){this.id!=null&&(window.clearInterval(this.id),this.id=null)},__class__:haxe.Timer};var js=js||{};js.Boot=function(){},js.Boot.__name__=!0,js.Boot.__unhtml=function(s){return s.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},js.Boot.__trace=function(s,i){var a=i!=null?i.fileName+":"+i.lineNumber+": ":"";a+=js.Boot.__string_rec(s,"");var d;typeof document<"u"&&(d=document.getElementById("haxe:trace"))!=null?d.innerHTML+=js.Boot.__unhtml(a)+"<br/>":typeof console<"u"&&console.log!=null&&console.log(a)},js.Boot.__clear_trace=function(){var s=document.getElementById("haxe:trace");s!=null&&(s.innerHTML="")},js.Boot.isClass=function(s){return s.__name__},js.Boot.isEnum=function(s){return s.__ename__},js.Boot.getClass=function(s){return s.__class__},js.Boot.__string_rec=function(s,i){if(s==null)return"null";if(i.length>=5)return"<...>";var a=typeof s;switch(a=="function"&&(s.__name__||s.__ename__)&&(a="object"),a){case"object":if(s instanceof Array){if(s.__enum__){if(s.length==2)return s[0];var lt=s[0]+"(";i+="	";for(var d=2,$=s.length;d<$;){var b=d++;b!=2?lt+=","+js.Boot.__string_rec(s[b],i):lt+=js.Boot.__string_rec(s[b],i)}return lt+")"}var g=s.length,b,lt="[";i+="	";for(var $=0;$<g;){var tt=$++;lt+=(tt>0?",":"")+js.Boot.__string_rec(s[tt],i)}return lt+="]",lt}var it;try{it=s.toString}catch{return"???"}if(it!=null&&it!=Object.toString){var rt=s.toString();if(rt!="[object Object]")return rt}var ot=null,lt=`{
`;i+="	";var ut=s.hasOwnProperty!=null;for(var ot in s)ut&&!s.hasOwnProperty(ot)||ot=="prototype"||ot=="__class__"||ot=="__super__"||ot=="__interfaces__"||ot=="__properties__"||(lt.length!=2&&(lt+=`, 
`),lt+=i+ot+" : "+js.Boot.__string_rec(s[ot],i));return i=i.substring(1),lt+=`
`+i+"}",lt;case"function":return"<function>";case"string":return s;default:return String(s)}},js.Boot.__interfLoop=function(s,i){if(s==null)return!1;if(s==i)return!0;var a=s.__interfaces__;if(a!=null)for(var d=0,g=a.length;d<g;){var b=d++,$=a[b];if($==i||js.Boot.__interfLoop($,i))return!0}return js.Boot.__interfLoop(s.__super__,i)},js.Boot.__instanceof=function(s,i){try{if(s instanceof i)return i==Array?s.__enum__==null:!0;if(js.Boot.__interfLoop(s.__class__,i))return!0}catch{if(i==null)return!1}switch(i){case Int:return Math.ceil(s%2147483648)===s;case Float:return typeof s=="number";case Bool:return s===!0||s===!1;case String:return typeof s=="string";case Dynamic:return!0;default:return s==null?!1:i==Class&&s.__name__!=null||i==Enum&&s.__ename__!=null?!0:s.__enum__==i}},js.Boot.__cast=function(s,i){if(js.Boot.__instanceof(s,i))return s;throw"Cannot cast "+Std.string(s)+" to "+Std.string(i)},js.Lib=function(){},js.Lib.__name__=!0,js.Lib.debug=function(){debugger},js.Lib.alert=function(s){alert(js.Boot.__string_rec(s,""))},js.Lib.eval=function(code){return eval(code)},js.Lib.setErrorHandler=function(s){js.Lib.onerror=s};function $bind(s,i){var a=function(){return a.method.apply(a.scope,arguments)};return a.scope=s,a.method=i,a}Array.prototype.indexOf&&(HxOverrides.remove=function(s,i){var a=s.indexOf(i);return a==-1?!1:(s.splice(a,1),!0)}),Math.__name__=["Math"],Math.NaN=Number.NaN,Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Math.isFinite=function(s){return isFinite(s)},Math.isNaN=function(s){return isNaN(s)},String.prototype.__class__=String,String.__name__=!0,Array.prototype.__class__=Array,Array.__name__=!0,Date.prototype.__class__=Date,Date.__name__=["Date"];var Int={__name__:["Int"]},Dynamic={__name__:["Dynamic"]},Float=Number;Float.__name__=["Float"];var Bool=Boolean;Bool.__ename__=["Bool"];var Class={__name__:["Class"]},Enum={};typeof document<"u"&&(js.Lib.document=document),typeof window<"u"&&(js.Lib.window=window,js.Lib.window.onerror=function(s,i,a){var d=js.Lib.onerror;return d==null?!1:d(s,[i+":"+a])}),com.wiris.js.JsPluginTools.main()}(),delete Array.prototype.__class__},function(s,i,a){var d=a(1),g=a(95);g=g.__esModule?g.default:g,typeof g=="string"&&(g=[[s.i,g,""]]);var b={injectType:"singletonStyleTag"};b.insert="head",b.singleton=!0,d(g,b);var $=g.locals?g.locals:{};s.exports=$},function(s,i){s.exports=".wrs_modal_overlay{position:fixed;font-family:arial,sans-serif;top:0;right:0;left:0;bottom:0;background:rgba(0,0,0,.8);z-index:999998;opacity:.65;pointer-events:auto}.wrs_modal_overlay.wrs_modal_android,.wrs_modal_overlay.wrs_modal_ios{visibility:hidden;display:none}.wrs_modal_overlay.wrs_modal_ios.moodle{position:fixed}.wrs_modal_overlay.wrs_modal_desktop.wrs_stack{background:transparent;display:none}.wrs_modal_overlay.wrs_modal_desktop.wrs_maximized{background:rgba(0,0,0,.8)}.wrs_modal_overlay.wrs_modal_desktop.wrs_closed,.wrs_modal_overlay.wrs_modal_desktop.wrs_minimized{background:transparent;display:none}.wrs_modal_title{color:#fff;padding:5px 0 5px 10px;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;text-align:left}.wrs_modal_close_button{background-repeat:no-repeat}.wrs_modal_close_button,.wrs_modal_minimize_button{float:right;cursor:pointer;color:#fff;padding:5px 10px 5px 0;margin:10px 7px 0 0}.wrs_modal_minimize_button{top:inherit}.wrs_modal_stack_button{float:right;cursor:pointer;color:#fff;margin:10px 7px 0 0;padding:5px 10px 5px 0;top:inherit}.wrs_modal_stack_button.wrs_minimized,.wrs_modal_stack_button.wrs_stack{visibility:hidden;margin:0;padding:0}.wrs_modal_maximize_button{float:right;cursor:pointer;color:#fff;margin:10px 7px 0 0;padding:5px 10px 5px 0;top:inherit}.wrs_modal_maximize_button.wrs_maximized{visibility:hidden;margin:0;padding:0}.wrs_modal_wrapper{display:block}.wrs_modal_title_bar{display:block;background-color:#778e9a}.wrs_modal_dialogContainer{border:none;background:#fafafa;z-index:999999}.wrs_modal_dialogContainer.wrs_modal_desktop{font-size:14px}.wrs_modal_dialogContainer.wrs_modal_desktop.wrs_maximized{position:fixed}.wrs_modal_dialogContainer.wrs_modal_desktop.wrs_minimized{position:fixed;top:inherit;margin:0 10px 0 0}.wrs_modal_dialogContainer.wrs_closed{visibility:hidden;display:none;opacity:0}.wrs_modal_dialogContainer.wrs_modal_desktop.wrs_stack{position:fixed;bottom:0;right:0;box-shadow:0 2px 8px rgba(0,0,0,.5)}.wrs_modal_dialogContainer.wrs_drag,.wrs_modal_dialogContainer.wrs_modal_desktop.wrs_drag{box-shadow:0 2px 8px rgba(0,0,0,.5)}.wrs_modal_dialogContainer.wrs_modal_android{width:99%;height:99%}.wrs_modal_dialogContainer.wrs_modal_android,.wrs_modal_dialogContainer.wrs_modal_ios{margin:auto;overflow:hidden;transform:translate(50%,-50%);top:50%;right:50%!important;position:fixed}.wrs_modal_dialogContainer.wrs_modal_ios{width:100%;height:100%}.wrs_content_container.wrs_minimized{display:none}.wrs_content_container.wrs_modal_android{width:100%;flex-grow:1;display:flex;flex-direction:column}.wrs_content_container.wrs_modal_android>div:first-child,.wrs_content_container.wrs_modal_desktop>div:first-child,.wrs_content_container.wrs_modal_ios>div:first-child{flex-grow:1}.wrs_modal_wrapper.wrs_modal_android{margin:auto;display:flex;flex-direction:column;height:100%;width:100%}.wrs_content_container.wrs_modal_desktop,.wrs_content_container.wrs_modal_ios{width:100%;flex-grow:1;display:flex;flex-direction:column}.wrs_modal_wrapper.wrs_modal_ios{margin:auto;display:flex;flex-direction:column;height:100%;width:100%}.wrs_virtual_keyboard{height:100%;width:100%;top:0;left:50%;transform:translate(-50%)}@media (orientation:portrait){.wrs_modal_dialogContainer.wrs_modal_mobile{width:100vmin;height:100vmin;margin:auto;border-width:0}.wrs_modal_wrapper.wrs_modal_mobile{width:100vmin;height:100vmin;margin:auto}}@media (orientation:landscape){.wrs_modal_dialogContainer.wrs_modal_mobile{width:100vmin;height:100vmin;margin:auto;border-width:0}.wrs_modal_wrapper.wrs_modal_mobile{width:100vmin;height:100vmin;margin:auto}}.wrs_modal_dialogContainer.wrs_modal_badStock,.wrs_modal_wrapper.wrs_modal_badStock{width:100%;height:280px;margin:0 auto;border-width:0}.wrs_noselect{-khtml-user-select:none}.wrs_bottom_right_resizer,.wrs_noselect{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.wrs_bottom_right_resizer{width:10px;height:10px;color:#778e9a;position:absolute;right:4px;bottom:8px;cursor:se-resize}.wrs_bottom_left_resizer{width:15px;height:15px;color:#778e9a;position:absolute;left:0;top:0;cursor:se-resize}.wrs_modal_controls{height:42px;margin:3px 0;overflow:hidden;line-height:normal}.wrs_modal_links{margin:10px auto 0;font-family:arial,sans-serif;padding:6px;display:inline;float:right;text-align:right}.wrs_modal_links>a{text-decoration:none;color:#778e9a;font-size:16px}.wrs_modal_button_cancel,.wrs_modal_button_cancel:active,.wrs_modal_button_cancel:focus,.wrs_modal_button_cancel:hover,.wrs_modal_button_cancel:visited{min-width:80px;font-size:14px;border-radius:3px;border:1px solid #778e9a;padding:6px 8px;margin:10px auto 0 5px;cursor:pointer;font-family:arial,sans-serif;background-color:#ddd;height:32px}.wrs_modal_button_accept,.wrs_modal_button_accept:active,.wrs_modal_button_accept:focus,.wrs_modal_button_accept:hover,.wrs_modal_button_accept:visited{min-width:80px;font-size:14px;border-radius:3px;border:1px solid #778e9a;padding:6px 8px;margin:10px 5px 0 auto;color:#fff;background:#778e9a;cursor:pointer;font-family:arial,sans-serif;height:32px}.wrs_editor_vertical_bar{height:20px;float:right;background:none;width:20px;cursor:pointer}.wrs_modal_buttons_container{display:inline;float:left}.wrs_modal_buttons_container.wrs_modalAndroid{padding-left:6px}.wrs_modal_buttons_container.wrs_modalDesktop{padding-left:0}.wrs_modal_buttons_container>button{line-height:normal;background-image:none}.wrs_modal_wrapper{margin:6px;display:flex;flex-direction:column}.wrs_modal_wrapper.wrs_modal_desktop.wrs_minimized{display:none}@media only screen and (max-device-width:480px) and (orientation:portrait){#wrs_modal_wrapper{width:140%}}.wrs_popupmessage_overlay_envolture{display:none;width:100%}.wrs_popupmessage_overlay{position:absolute;width:100%;height:100%;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.5);z-index:4;cursor:pointer}.wrs_popupmessage_panel{top:50%;left:50%;transform:translate(-50%,-50%);position:absolute;background:#fff;max-width:500px;width:75%;border-radius:2px;padding:20px;font-family:sans-serif;font-size:15px;text-align:left;color:#2e2e2e;z-index:5;max-height:75%;overflow:auto}.wrs_popupmessage_button_area{margin:10px 0 0}.wrs_panelContainer *{border:0}.wrs_button_cancel,.wrs_button_cancel:active,.wrs_button_cancel:focus,.wrs_button_cancel:hover,.wrs_button_cancel:visited{min-width:80px;font-size:14px;border-radius:3px;border:1px solid #778e9a;padding:6px 8px;margin:10px auto 0 5px;cursor:pointer;font-family:arial,sans-serif;background-color:#ddd;background-image:none;height:32px}.wrs_button_accept,.wrs_button_accept:active,.wrs_button_accept:focus,.wrs_button_accept:hover,.wrs_button_accept:visited{min-width:80px;font-size:14px;border-radius:3px;border:1px solid #778e9a;padding:6px 8px;margin:10px 5px 0 auto;color:#fff;background:#778e9a;cursor:pointer;font-family:arial,sans-serif;height:32px}.wrs_editor button{box-shadow:none}.wrs_editor .wrs_header button{border-bottom:none;border-bottom-left-radius:0;border-bottom-right-radius:0}.wrs_modal_overlay.wrs_modal_desktop.wrs_stack.wrs_overlay_active{display:block}.wrs_toolbar tr:focus,.wrs_toolbar tr:hover{background:none}.wrs_modal_rtl .wrs_modal_button_cancel{margin-right:5px;margin-left:0}.wrs_modal_rtl .wrs_modal_button_accept{margin-right:0;margin-left:5px}.wrs_modal_rtl .wrs_button_cancel{margin-right:5px;margin-left:0}.wrs_modal_rtl .wrs_button_accept{margin-right:0;margin-left:5px}"},function(s,i,a){a.r(i),a.d(i,"default",function(){return Vy});var d=a(3),g=d.a.Symbol,b=g,$=Object.prototype,tt=$.hasOwnProperty,it=$.toString,rt=b?b.toStringTag:void 0;function ot(h){var e=tt.call(h,rt),o=h[rt];try{h[rt]=void 0;var c=!0}catch{}var _=it.call(h);return c&&(e?h[rt]=o:delete h[rt]),_}var lt=ot,ut=Object.prototype,pt=ut.toString;function _t(h){return pt.call(h)}var wt=_t,vt="[object Null]",ht="[object Undefined]",ft=b?b.toStringTag:void 0;function mt(h){return h==null?h===void 0?ht:vt:ft&&ft in Object(h)?lt(h):wt(h)}var bt=mt;function Et(h,e){return function(o){return h(e(o))}}var It=Et,Ot=It(Object.getPrototypeOf,Object),jt=Ot;function xt(h){return h!=null&&typeof h=="object"}var Lt=xt,qt="[object Object]",Yt=Function.prototype,$n=Object.prototype,$t=Yt.toString,Rt=$n.hasOwnProperty,Dt=$t.call(Object);function Vt(h){if(!Lt(h)||bt(h)!=qt)return!1;var e=jt(h);if(e===null)return!0;var o=Rt.call(e,"constructor")&&e.constructor;return typeof o=="function"&&o instanceof o&&$t.call(o)==Dt}var St=Vt;function Bt(){this.__data__=[],this.size=0}var Pt=Bt;function Gt(h,e){return h===e||h!==h&&e!==e}var Qt=Gt;function On(h,e){for(var o=h.length;o--;)if(Qt(h[o][0],e))return o;return-1}var Dn=On,vr=Array.prototype,sr=vr.splice;function jr(h){var e=this.__data__,o=Dn(e,h);if(o<0)return!1;var c=e.length-1;return o==c?e.pop():sr.call(e,o,1),--this.size,!0}var Xo=jr;function Zo(h){var e=this.__data__,o=Dn(e,h);return o<0?void 0:e[o][1]}var to=Zo;function na(h){return Dn(this.__data__,h)>-1}var ga=na;function _a(h,e){var o=this.__data__,c=Dn(o,h);return c<0?(++this.size,o.push([h,e])):o[c][1]=e,this}var ba=_a;function Lr(h){var e=-1,o=h==null?0:h.length;for(this.clear();++e<o;){var c=h[e];this.set(c[0],c[1])}}Lr.prototype.clear=Pt,Lr.prototype.delete=Xo,Lr.prototype.get=to,Lr.prototype.has=ga,Lr.prototype.set=ba;var ss=Lr;function Ht(){this.__data__=new ss,this.size=0}var Tn=Ht;function Xt(h){var e=this.__data__,o=e.delete(h);return this.size=e.size,o}var rn=Xt;function dn(h){return this.__data__.get(h)}var on=dn;function ln(h){return this.__data__.has(h)}var Xn=ln;function no(h){var e=typeof h;return h!=null&&(e=="object"||e=="function")}var In=no,xa="[object AsyncFunction]",$a="[object Function]",_l="[object GeneratorFunction]",Pn="[object Proxy]";function dr(h){if(!In(h))return!1;var e=bt(h);return e==$a||e==_l||e==xa||e==Pn}var qn=dr,os=d.a["__core-js_shared__"],Kr=os,hp=function(){var h=/[^.]+$/.exec(Kr&&Kr.keys&&Kr.keys.IE_PROTO||"");return h?"Symbol(src)_1."+h:""}();function Uy(h){return!!hp&&hp in h}var Wy=Uy,Hy=Function.prototype,Gy=Hy.toString;function qy(h){if(h!=null){try{return Gy.call(h)}catch{}try{return h+""}catch{}}return""}var Yr=qy,Ky=/[\\^$.*+?()[\]{}|]/g,Yy=/^\[object .+?Constructor\]$/,Qy=Function.prototype,Jy=Object.prototype,Xy=Qy.toString,Zy=Jy.hasOwnProperty,_k=RegExp("^"+Xy.call(Zy).replace(Ky,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function e0(h){if(!In(h)||Wy(h))return!1;var e=qn(h)?_k:Yy;return e.test(Yr(h))}var t0=e0;function n0(h,e){return h==null?void 0:h[e]}var i0=n0;function r0(h,e){var o=i0(h,e);return t0(o)?o:void 0}var Qr=r0,s0=Qr(d.a,"Map"),Ss=s0,o0=Qr(Object,"create"),Is=o0;function a0(){this.__data__=Is?Is(null):{},this.size=0}var l0=a0;function c0(h){var e=this.has(h)&&delete this.__data__[h];return this.size-=e?1:0,e}var u0=c0,d0="__lodash_hash_undefined__",h0=Object.prototype,f0=h0.hasOwnProperty;function p0(h){var e=this.__data__;if(Is){var o=e[h];return o===d0?void 0:o}return f0.call(e,h)?e[h]:void 0}var m0=p0,g0=Object.prototype,_0=g0.hasOwnProperty;function w0(h){var e=this.__data__;return Is?e[h]!==void 0:_0.call(e,h)}var v0=w0,b0="__lodash_hash_undefined__";function y0(h,e){var o=this.__data__;return this.size+=this.has(h)?0:1,o[h]=Is&&e===void 0?b0:e,this}var k0=y0;function as(h){var e=-1,o=h==null?0:h.length;for(this.clear();++e<o;){var c=h[e];this.set(c[0],c[1])}}as.prototype.clear=l0,as.prototype.delete=u0,as.prototype.get=m0,as.prototype.has=v0,as.prototype.set=k0;var fp=as;function x0(){this.size=0,this.__data__={hash:new fp,map:new(Ss||ss),string:new fp}}var E0=x0;function C0(h){var e=typeof h;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?h!=="__proto__":h===null}var T0=C0;function A0(h,e){var o=h.__data__;return T0(e)?o[typeof e=="string"?"string":"hash"]:o.map}var io=A0;function S0(h){var e=io(this,h).delete(h);return this.size-=e?1:0,e}var I0=S0;function P0(h){return io(this,h).get(h)}var R0=P0;function N0(h){return io(this,h).has(h)}var O0=N0;function M0(h,e){var o=io(this,h),c=o.size;return o.set(h,e),this.size+=o.size==c?0:1,this}var j0=M0;function ls(h){var e=-1,o=h==null?0:h.length;for(this.clear();++e<o;){var c=h[e];this.set(c[0],c[1])}}ls.prototype.clear=E0,ls.prototype.delete=I0,ls.prototype.get=R0,ls.prototype.has=O0,ls.prototype.set=j0;var ro=ls,L0=200;function D0(h,e){var o=this.__data__;if(o instanceof ss){var c=o.__data__;if(!Ss||c.length<L0-1)return c.push([h,e]),this.size=++o.size,this;o=this.__data__=new ro(c)}return o.set(h,e),this.size=o.size,this}var F0=D0;function cs(h){var e=this.__data__=new ss(h);this.size=e.size}cs.prototype.clear=Tn,cs.prototype.delete=rn,cs.prototype.get=on,cs.prototype.has=Xn,cs.prototype.set=F0;var Ps=cs;function B0(h,e){for(var o=-1,c=h==null?0:h.length;++o<c&&e(h[o],o,h)!==!1;);return h}var z0=B0,V0=function(){try{var h=Qr(Object,"defineProperty");return h({},"",{}),h}catch{}}(),so=V0;function $0(h,e,o){e=="__proto__"&&so?so(h,e,{configurable:!0,enumerable:!0,value:o,writable:!0}):h[e]=o}var wl=$0,U0=Object.prototype,W0=U0.hasOwnProperty;function H0(h,e,o){var c=h[e];(!(W0.call(h,e)&&Qt(c,o))||o===void 0&&!(e in h))&&wl(h,e,o)}var yl=H0;function G0(h,e,o,c){var _=!o;o||(o={});for(var j=-1,_e=e.length;++j<_e;){var et=e[j],nt=c?c(o[et],h[et],et,o,h):void 0;nt===void 0&&(nt=h[et]),_?wl(o,et,nt):yl(o,et,nt)}return o}var us=G0;function q0(h,e){for(var o=-1,c=Array(h);++o<h;)c[o]=e(o);return c}var K0=q0,Y0="[object Arguments]";function Q0(h){return Lt(h)&&bt(h)==Y0}var pp=Q0,mp=Object.prototype,J0=mp.hasOwnProperty,X0=mp.propertyIsEnumerable,Z0=pp(function(){return arguments}())?pp:function(h){return Lt(h)&&J0.call(h,"callee")&&!X0.call(h,"callee")},xl=Z0,ex=Array.isArray,Kn=ex,Rs=a(4),tx=9007199254740991,nx=/^(?:0|[1-9]\d*)$/;function ix(h,e){var o=typeof h;return e=e??tx,!!e&&(o=="number"||o!="symbol"&&nx.test(h))&&h>-1&&h%1==0&&h<e}var El=ix,rx=9007199254740991;function sx(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=rx}var gp=sx,ox="[object Arguments]",ax="[object Array]",lx="[object Boolean]",cx="[object Date]",ux="[object Error]",dx="[object Function]",hx="[object Map]",fx="[object Number]",px="[object Object]",mx="[object RegExp]",gx="[object Set]",_x="[object String]",wx="[object WeakMap]",vx="[object ArrayBuffer]",bx="[object DataView]",yx="[object Float32Array]",kx="[object Float64Array]",xx="[object Int8Array]",Ex="[object Int16Array]",Cx="[object Int32Array]",Tx="[object Uint8Array]",Ax="[object Uint8ClampedArray]",Sx="[object Uint16Array]",Ix="[object Uint32Array]",kn={};kn[yx]=kn[kx]=kn[xx]=kn[Ex]=kn[Cx]=kn[Tx]=kn[Ax]=kn[Sx]=kn[Ix]=!0,kn[ox]=kn[ax]=kn[vx]=kn[lx]=kn[bx]=kn[cx]=kn[ux]=kn[dx]=kn[hx]=kn[fx]=kn[px]=kn[mx]=kn[gx]=kn[_x]=kn[wx]=!1;function Px(h){return Lt(h)&&gp(h.length)&&!!kn[bt(h)]}var Rx=Px;function Nx(h){return function(e){return h(e)}}var Cl=Nx,ds=a(5),_p=ds.a&&ds.a.isTypedArray,Ox=_p?Cl(_p):Rx,Tl=Ox,Mx=Object.prototype,jx=Mx.hasOwnProperty;function Lx(h,e){var o=Kn(h),c=!o&&xl(h),_=!o&&!c&&Object(Rs.a)(h),j=!o&&!c&&!_&&Tl(h),_e=o||c||_||j,et=_e?K0(h.length,String):[],nt=et.length;for(var st in h)(e||jx.call(h,st))&&!(_e&&(st=="length"||_&&(st=="offset"||st=="parent")||j&&(st=="buffer"||st=="byteLength"||st=="byteOffset")||El(st,nt)))&&et.push(st);return et}var wp=Lx,Dx=Object.prototype;function Fx(h){var e=h&&h.constructor,o=typeof e=="function"&&e.prototype||Dx;return h===o}var Al=Fx,Bx=It(Object.keys,Object),zx=Bx,Vx=Object.prototype,$x=Vx.hasOwnProperty;function Ux(h){if(!Al(h))return zx(h);var e=[];for(var o in Object(h))$x.call(h,o)&&o!="constructor"&&e.push(o);return e}var Wx=Ux;function Hx(h){return h!=null&&gp(h.length)&&!qn(h)}var oo=Hx;function Gx(h){return oo(h)?wp(h):Wx(h)}var Sl=Gx;function qx(h,e){return h&&us(e,Sl(e),h)}var Kx=qx;function Yx(h){var e=[];if(h!=null)for(var o in Object(h))e.push(o);return e}var Qx=Yx,Jx=Object.prototype,Xx=Jx.hasOwnProperty;function Zx(h){if(!In(h))return Qx(h);var e=Al(h),o=[];for(var c in h)c=="constructor"&&(e||!Xx.call(h,c))||o.push(c);return o}var eE=Zx;function tE(h){return oo(h)?wp(h,!0):eE(h)}var Ns=tE;function nE(h,e){return h&&us(e,Ns(e),h)}var iE=nE,vp=a(8);function rE(h,e){var o=-1,c=h.length;for(e||(e=Array(c));++o<c;)e[o]=h[o];return e}var bp=rE;function sE(h,e){for(var o=-1,c=h==null?0:h.length,_=0,j=[];++o<c;){var _e=h[o];e(_e,o,h)&&(j[_++]=_e)}return j}var oE=sE;function aE(){return[]}var yp=aE,lE=Object.prototype,cE=lE.propertyIsEnumerable,kp=Object.getOwnPropertySymbols,uE=kp?function(h){return h==null?[]:(h=Object(h),oE(kp(h),function(e){return cE.call(h,e)}))}:yp,Il=uE;function dE(h,e){return us(h,Il(h),e)}var hE=dE;function fE(h,e){for(var o=-1,c=e.length,_=h.length;++o<c;)h[_+o]=e[o];return h}var xp=fE,pE=Object.getOwnPropertySymbols,mE=pE?function(h){for(var e=[];h;)xp(e,Il(h)),h=jt(h);return e}:yp,Ep=mE;function gE(h,e){return us(h,Ep(h),e)}var _E=gE;function wE(h,e,o){var c=e(h);return Kn(h)?c:xp(c,o(h))}var Cp=wE;function vE(h){return Cp(h,Sl,Il)}var Pl=vE;function bE(h){return Cp(h,Ns,Ep)}var yE=bE,kE=Qr(d.a,"DataView"),Rl=kE,xE=Qr(d.a,"Promise"),Nl=xE,EE=Qr(d.a,"Set"),Ol=EE,CE=Qr(d.a,"WeakMap"),Ml=CE,Tp="[object Map]",TE="[object Object]",Ap="[object Promise]",Sp="[object Set]",Ip="[object WeakMap]",Pp="[object DataView]",AE=Yr(Rl),SE=Yr(Ss),IE=Yr(Nl),PE=Yr(Ol),RE=Yr(Ml),Jr=bt;(Rl&&Jr(new Rl(new ArrayBuffer(1)))!=Pp||Ss&&Jr(new Ss)!=Tp||Nl&&Jr(Nl.resolve())!=Ap||Ol&&Jr(new Ol)!=Sp||Ml&&Jr(new Ml)!=Ip)&&(Jr=function(h){var e=bt(h),o=e==TE?h.constructor:void 0,c=o?Yr(o):"";if(c)switch(c){case AE:return Pp;case SE:return Tp;case IE:return Ap;case PE:return Sp;case RE:return Ip}return e});var Os=Jr,NE=Object.prototype,OE=NE.hasOwnProperty;function ME(h){var e=h.length,o=new h.constructor(e);return e&&typeof h[0]=="string"&&OE.call(h,"index")&&(o.index=h.index,o.input=h.input),o}var jE=ME,LE=d.a.Uint8Array,ao=LE;function DE(h){var e=new h.constructor(h.byteLength);return new ao(e).set(new ao(h)),e}var Ll=DE;function FE(h,e){var o=e?Ll(h.buffer):h.buffer;return new h.constructor(o,h.byteOffset,h.byteLength)}var BE=FE,zE=/\w*$/;function VE(h){var e=new h.constructor(h.source,zE.exec(h));return e.lastIndex=h.lastIndex,e}var $E=VE,Rp=b?b.prototype:void 0,Np=Rp?Rp.valueOf:void 0;function UE(h){return Np?Object(Np.call(h)):{}}var WE=UE;function HE(h,e){var o=e?Ll(h.buffer):h.buffer;return new h.constructor(o,h.byteOffset,h.length)}var Op=HE,GE="[object Boolean]",qE="[object Date]",KE="[object Map]",YE="[object Number]",QE="[object RegExp]",JE="[object Set]",XE="[object String]",ZE="[object Symbol]",eC="[object ArrayBuffer]",tC="[object DataView]",nC="[object Float32Array]",iC="[object Float64Array]",rC="[object Int8Array]",sC="[object Int16Array]",oC="[object Int32Array]",aC="[object Uint8Array]",lC="[object Uint8ClampedArray]",cC="[object Uint16Array]",uC="[object Uint32Array]";function dC(h,e,o){var c=h.constructor;switch(e){case eC:return Ll(h);case GE:case qE:return new c(+h);case tC:return BE(h,o);case nC:case iC:case rC:case sC:case oC:case aC:case lC:case cC:case uC:return Op(h,o);case KE:return new c;case YE:case XE:return new c(h);case QE:return $E(h);case JE:return new c;case ZE:return WE(h)}}var hC=dC,Mp=Object.create,fC=function(){function h(){}return function(e){if(!In(e))return{};if(Mp)return Mp(e);h.prototype=e;var o=new h;return h.prototype=void 0,o}}(),pC=fC;function mC(h){return typeof h.constructor=="function"&&!Al(h)?pC(jt(h)):{}}var jp=mC,gC="[object Map]";function _C(h){return Lt(h)&&Os(h)==gC}var wC=_C,Lp=ds.a&&ds.a.isMap,vC=Lp?Cl(Lp):wC,bC=vC,yC="[object Set]";function kC(h){return Lt(h)&&Os(h)==yC}var xC=kC,Dp=ds.a&&ds.a.isSet,EC=Dp?Cl(Dp):xC,CC=EC,TC=1,AC=2,SC=4,Fp="[object Arguments]",IC="[object Array]",PC="[object Boolean]",RC="[object Date]",NC="[object Error]",Bp="[object Function]",OC="[object GeneratorFunction]",MC="[object Map]",jC="[object Number]",zp="[object Object]",LC="[object RegExp]",DC="[object Set]",FC="[object String]",BC="[object Symbol]",zC="[object WeakMap]",VC="[object ArrayBuffer]",$C="[object DataView]",UC="[object Float32Array]",WC="[object Float64Array]",HC="[object Int8Array]",GC="[object Int16Array]",qC="[object Int32Array]",KC="[object Uint8Array]",YC="[object Uint8ClampedArray]",QC="[object Uint16Array]",JC="[object Uint32Array]",bn={};bn[Fp]=bn[IC]=bn[VC]=bn[$C]=bn[PC]=bn[RC]=bn[UC]=bn[WC]=bn[HC]=bn[GC]=bn[qC]=bn[MC]=bn[jC]=bn[zp]=bn[LC]=bn[DC]=bn[FC]=bn[BC]=bn[KC]=bn[YC]=bn[QC]=bn[JC]=!0,bn[NC]=bn[Bp]=bn[zC]=!1;function lo(h,e,o,c,_,j){var _e,et=e&TC,nt=e&AC,st=e&SC;if(o&&(_e=_?o(h,c,_,j):o(h)),_e!==void 0)return _e;if(!In(h))return h;var at=Kn(h);if(at){if(_e=jE(h),!et)return bp(h,_e)}else{var ct=Os(h),dt=ct==Bp||ct==OC;if(Object(Rs.a)(h))return Object(vp.a)(h,et);if(ct==zp||ct==Fp||dt&&!_){if(_e=nt||dt?{}:jp(h),!et)return nt?_E(h,iE(_e,h)):hE(h,Kx(_e,h))}else{if(!bn[ct])return _?h:{};_e=hC(h,ct,et)}}j||(j=new Ps);var gt=j.get(h);if(gt)return gt;j.set(h,_e),CC(h)?h.forEach(function(Nt){_e.add(lo(Nt,e,o,Nt,h,j))}):bC(h)&&h.forEach(function(Nt,Wt){_e.set(Wt,lo(Nt,e,o,Wt,h,j))});var kt=st?nt?yE:Pl:nt?keysIn:Sl,Ct=at?void 0:kt(h);return z0(Ct||h,function(Nt,Wt){Ct&&(Wt=Nt,Nt=h[Wt]),yl(_e,Wt,lo(Nt,e,o,Wt,h,j))}),_e}var Dl=lo,XC=1,ZC=4;function eT(h,e){return e=typeof e=="function"?e:void 0,Dl(h,XC|ZC,e)}var Vp=eT;function tT(h){return Lt(h)&&h.nodeType===1&&!St(h)}var Cr=tT;class $p{constructor(e,o){this._config={},o&&this.define(Up(o)),e&&this._setObjectToTarget(this._config,e)}set(e,o){this._setToTarget(this._config,e,o)}define(e,o){this._setToTarget(this._config,e,o,!0)}get(e){return this._getFromSource(this._config,e)}*names(){for(const e of Object.keys(this._config))yield e}_setToTarget(e,o,c,_=!1){if(St(o)){this._setObjectToTarget(e,o,_);return}const j=o.split(".");o=j.pop();for(const _e of j)St(e[_e])||(e[_e]={}),e=e[_e];if(St(c)){St(e[o])||(e[o]={}),e=e[o],this._setObjectToTarget(e,c,_);return}_&&typeof e[o]<"u"||(e[o]=c)}_getFromSource(e,o){const c=o.split(".");o=c.pop();for(const _ of c){if(!St(e[_])){e=null;break}e=e[_]}return e?Up(e[o]):void 0}_setObjectToTarget(e,o,c){Object.keys(o).forEach(_=>{this._setToTarget(e,_,o[_],c)})}}function Up(h){return Vp(h,nT)}function nT(h){return Cr(h)?h:void 0}function iT(){return function h(){h.called=!0}}var Wp=iT;class co{constructor(e,o){this.source=e,this.name=o,this.path=[],this.stop=Wp(),this.off=Wp()}}const Hn=new Array(256).fill().map((h,e)=>("0"+e.toString(16)).slice(-2));function Tr(){const h=Math.random()*4294967296>>>0,e=Math.random()*4294967296>>>0,o=Math.random()*4294967296>>>0,c=Math.random()*4294967296>>>0;return"e"+Hn[h>>0&255]+Hn[h>>8&255]+Hn[h>>16&255]+Hn[h>>24&255]+Hn[e>>0&255]+Hn[e>>8&255]+Hn[e>>16&255]+Hn[e>>24&255]+Hn[o>>0&255]+Hn[o>>8&255]+Hn[o>>16&255]+Hn[o>>24&255]+Hn[c>>0&255]+Hn[c>>8&255]+Hn[c>>16&255]+Hn[c>>24&255]}var Fl={get(h){return typeof h!="number"?this[h]||this.normal:h},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};a(6);var yt=a(0);const Dr=Symbol("listeningTo"),Bl=Symbol("emitterId");var xn={on(h,e,o={}){this.listenTo(this,h,e,o)},once(h,e,o){let c=!1;const _=function(j,..._e){c||(c=!0,j.off(),e.call(this,j,..._e))};this.listenTo(this,h,_,o)},off(h,e){this.stopListening(this,h,e)},listenTo(h,e,o,c={}){let _,j;this[Dr]||(this[Dr]={});const _e=this[Dr];zl(h)||Hp(h);const et=zl(h);(_=_e[et])||(_=_e[et]={emitter:h,callbacks:{}}),(j=_.callbacks[e])||(j=_.callbacks[e]=[]),j.push(o),oT(h,e);const nt=Vl(h,e),st=Fl.get(c.priority),at={callback:o,priority:st};for(const ct of nt){let dt=!1;for(let gt=0;gt<ct.length;gt++)if(ct[gt].priority<st){ct.splice(gt,0,at),dt=!0;break}dt||ct.push(at)}},stopListening(h,e,o){const c=this[Dr];let _=h&&zl(h);const j=c&&_&&c[_],_e=j&&e&&j.callbacks[e];if(!(!c||h&&!j||e&&!_e))if(o)$l(h,e,o);else if(_e){for(;o=_e.pop();)$l(h,e,o);delete j.callbacks[e]}else if(j){for(e in j.callbacks)this.stopListening(h,e);delete c[_]}else{for(_ in c)this.stopListening(c[_].emitter);delete this[Dr]}},fire(h,...e){try{const o=h instanceof co?h:new co(this,h),c=o.name;let _=qp(this,c);if(o.path.push(this),_){const j=[o,...e];_=Array.from(_);for(let _e=0;_e<_.length&&(_[_e].callback.apply(this,j),o.off.called&&(delete o.off.called,$l(this,c,_[_e].callback)),!o.stop.called);_e++);}if(this._delegations){const j=this._delegations.get(c),_e=this._delegations.get("*");j&&Kp(j,o,e),_e&&Kp(_e,o,e)}return o.return}catch(o){yt.b.rethrowUnexpectedError(o,this)}},delegate(...h){return{to:(e,o)=>{this._delegations||(this._delegations=new Map),h.forEach(c=>{const _=this._delegations.get(c);_?_.set(e,o):this._delegations.set(c,new Map([[e,o]]))})}}},stopDelegating(h,e){if(this._delegations)if(!h)this._delegations.clear();else if(!e)this._delegations.delete(h);else{const o=this._delegations.get(h);o&&o.delete(e)}}};function rT(h,e){return h[Dr]&&h[Dr][e]?h[Dr][e].emitter:null}function Hp(h,e){h[Bl]||(h[Bl]=e||Tr())}function zl(h){return h[Bl]}function Gp(h){return h._events||Object.defineProperty(h,"_events",{value:{}}),h._events}function sT(){return{callbacks:[],childEvents:[]}}function oT(h,e){const o=Gp(h);if(o[e])return;let c=e,_=null;const j=[];for(;c!==""&&!o[c];)o[c]=sT(),j.push(o[c]),_&&o[c].childEvents.push(_),_=c,c=c.substr(0,c.lastIndexOf(":"));if(c!==""){for(const _e of j)_e.callbacks=o[c].callbacks.slice();o[c].childEvents.push(_)}}function Vl(h,e){const o=Gp(h)[e];if(!o)return[];let c=[o.callbacks];for(let _=0;_<o.childEvents.length;_++){const j=Vl(h,o.childEvents[_]);c=c.concat(j)}return c}function qp(h,e){let o;return!h._events||!(o=h._events[e])||!o.callbacks.length?e.indexOf(":")>-1?qp(h,e.substr(0,e.lastIndexOf(":"))):null:o.callbacks}function Kp(h,e,o){for(let[c,_]of h){_?typeof _=="function"&&(_=_(e.name)):_=e.name;const j=new co(e.source,_);j.path=[...e.path],c.fire(j,...o)}}function $l(h,e,o){const c=Vl(h,e);for(const _ of c)for(let j=0;j<_.length;j++)_[j].callback==o&&(_.splice(j,1),j--)}function Zt(h,...e){e.forEach(o=>{Object.getOwnPropertyNames(o).concat(Object.getOwnPropertySymbols(o)).forEach(c=>{if(c in h.prototype)return;const _=Object.getOwnPropertyDescriptor(o,c);_.enumerable=!1,Object.defineProperty(h.prototype,c,_)})})}class or{constructor(e={}){this._items=[],this._itemMap=new Map,this._idProperty=e.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[]}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,o){let c;const _=this._idProperty;if(_ in e){if(c=e[_],typeof c!="string")throw new yt.b("collection-add-invalid-id",this);if(this.get(c))throw new yt.b("collection-add-item-already-exists",this)}else e[_]=c=Tr();if(o===void 0)o=this._items.length;else if(o>this._items.length||o<0)throw new yt.b("collection-add-item-invalid-index",this);return this._items.splice(o,0,e),this._itemMap.set(c,e),this.fire("add",e,o),this}get(e){let o;if(typeof e=="string")o=this._itemMap.get(e);else if(typeof e=="number")o=this._items[e];else throw new yt.b("collection-get-invalid-arg: Index or id must be given.",this);return o||null}has(e){if(typeof e=="string")return this._itemMap.has(e);{const o=this._idProperty,c=e[o];return this._itemMap.has(c)}}getIndex(e){let o;return typeof e=="string"?o=this._itemMap.get(e):o=e,this._items.indexOf(o)}remove(e){let o,c,_,j=!1;const _e=this._idProperty;if(typeof e=="string"?(c=e,_=this._itemMap.get(c),j=!_,_&&(o=this._items.indexOf(_))):typeof e=="number"?(o=e,_=this._items[o],j=!_,_&&(c=_[_e])):(_=e,c=_[_e],o=this._items.indexOf(_),j=o==-1||!this._itemMap.get(c)),j)throw new yt.b("collection-remove-404: Item not found.",this);this._items.splice(o,1),this._itemMap.delete(c);const et=this._bindToInternalToExternalMap.get(_);return this._bindToInternalToExternalMap.delete(_),this._bindToExternalToInternalMap.delete(et),this.fire("remove",_,o),_}map(e,o){return this._items.map(e,o)}find(e,o){return this._items.find(e,o)}filter(e,o){return this._items.filter(e,o)}clear(){for(this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);this.length;)this.remove(0)}bindTo(e){if(this._bindToCollection)throw new yt.b("collection-bind-to-rebind: The collection cannot be bound more than once.",this);return this._bindToCollection=e,{as:o=>{this._setUpBindToBinding(c=>new o(c))},using:o=>{typeof o=="function"?this._setUpBindToBinding(c=>o(c)):this._setUpBindToBinding(c=>c[o])}}}_setUpBindToBinding(e){const o=this._bindToCollection,c=(_,j,_e)=>{const et=o._bindToCollection==this,nt=o._bindToInternalToExternalMap.get(j);if(et&&nt)this._bindToExternalToInternalMap.set(j,nt),this._bindToInternalToExternalMap.set(nt,j);else{const st=e(j);if(!st){this._skippedIndexesFromExternal.push(_e);return}let at=_e;for(const ct of this._skippedIndexesFromExternal)_e>ct&&at--;for(const ct of o._skippedIndexesFromExternal)at>=ct&&at++;this._bindToExternalToInternalMap.set(j,st),this._bindToInternalToExternalMap.set(st,j),this.add(st,at);for(let ct=0;ct<o._skippedIndexesFromExternal.length;ct++)at<=o._skippedIndexesFromExternal[ct]&&o._skippedIndexesFromExternal[ct]++}};for(const _ of o)c(null,_,o.getIndex(_));this.listenTo(o,"add",c),this.listenTo(o,"remove",(_,j,_e)=>{const et=this._bindToExternalToInternalMap.get(j);et&&this.remove(et),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((nt,st)=>(_e<st&&nt.push(st-1),_e>st&&nt.push(st),nt),[])})}[Symbol.iterator](){return this._items[Symbol.iterator]()}}Zt(or,xn);class Ul{constructor(e,o=[],c=[]){this._context=e,this._plugins=new Map,this._availablePlugins=new Map;for(const _ of o)_.pluginName&&this._availablePlugins.set(_.pluginName,_);this._contextPlugins=new Map;for(const[_,j]of c)this._contextPlugins.set(_,j),this._contextPlugins.set(j,_),_.pluginName&&this._availablePlugins.set(_.pluginName,_)}*[Symbol.iterator](){for(const e of this._plugins)typeof e[0]=="function"&&(yield e)}get(e){const o=this._plugins.get(e);if(!o){const c="plugincollection-plugin-not-loaded: The requested plugin is not loaded.";let _=e;throw typeof e=="function"&&(_=e.pluginName||e.name),new yt.b(c,this._context,{plugin:_})}return o}has(e){return this._plugins.has(e)}init(e,o=[]){const c=this,_=this._context,j=new Set,_e=[],et=Ct(e),nt=Ct(o),st=kt(e);if(st){const Nt="plugincollection-plugin-not-found: Some plugins are not available and could not be loaded.";return console.error(Object(yt.a)(Nt),{plugins:st}),Promise.reject(new yt.b(Nt,_,{plugins:st}))}return Promise.all(et.map(at)).then(()=>ct(_e,"init")).then(()=>ct(_e,"afterInit")).then(()=>_e);function at(Nt){if(!nt.includes(Nt)&&!(c._plugins.has(Nt)||j.has(Nt)))return dt(Nt).catch(Wt=>{throw console.error(Object(yt.a)("plugincollection-load: It was not possible to load the plugin."),{plugin:Nt}),Wt})}function ct(Nt,Wt){return Nt.reduce((tn,nn)=>!nn[Wt]||c._contextPlugins.has(nn)?tn:tn.then(nn[Wt].bind(nn)),Promise.resolve())}function dt(Nt){return new Promise(Wt=>{j.add(Nt),Nt.requires&&Nt.requires.forEach(nn=>{const un=gt(nn);if(Nt.isContextPlugin&&!un.isContextPlugin)throw new yt.b("plugincollection-context-required: Context plugin can not require plugin which is not a context plugin",null,{plugin:un.name,requiredBy:Nt.name});if(o.includes(un))throw new yt.b("plugincollection-required: Cannot load a plugin because one of its dependencies is listed inthe `removePlugins` option.",_,{plugin:un.name,requiredBy:Nt.name});at(un)});const tn=c._contextPlugins.get(Nt)||new Nt(_);c._add(Nt,tn),_e.push(tn),Wt()})}function gt(Nt){return typeof Nt=="function"?Nt:c._availablePlugins.get(Nt)}function kt(Nt){const Wt=[];for(const tn of Nt)gt(tn)||Wt.push(tn);return Wt.length?Wt:null}function Ct(Nt){return Nt.map(Wt=>gt(Wt)).filter(Wt=>!!Wt)}}destroy(){const e=[];for(const[,o]of this)typeof o.destroy=="function"&&!this._contextPlugins.has(o)&&e.push(o.destroy());return Promise.all(e)}_add(e,o){this._plugins.set(e,o);const c=e.pluginName;if(c){if(this._plugins.has(c))throw new yt.b("plugincollection-plugin-name-conflict: Two plugins with the same name were loaded.",null,{pluginName:c,plugin1:this._plugins.get(c).constructor,plugin2:e});this._plugins.set(c,o)}}}Zt(Ul,xn),window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={});function aT(h,e){const o=cT();return o===1&&(h=Object.keys(window.CKEDITOR_TRANSLATIONS)[0]),o===0||!lT(h,e)?e.replace(/ \[context: [^\]]+\]$/,""):window.CKEDITOR_TRANSLATIONS[h][e].replace(/ \[context: [^\]]+\]$/,"")}function lT(h,e){return h in window.CKEDITOR_TRANSLATIONS&&e in window.CKEDITOR_TRANSLATIONS[h]}function cT(){return Object.keys(window.CKEDITOR_TRANSLATIONS).length}const uT=["ar","fa","he","ku","ug"];class dT{constructor(e={}){this.uiLanguage=e.uiLanguage||"en",this.contentLanguage=e.contentLanguage||this.uiLanguage,this.uiLanguageDirection=Yp(this.uiLanguage),this.contentLanguageDirection=Yp(this.contentLanguage),this.t=(...o)=>this._t(...o)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(e,o){let c=aT(this.uiLanguage,e);return o&&(c=c.replace(/%(\d+)/g,(_,j)=>j<o.length?o[j]:_)),c}}function Yp(h){return uT.includes(h)?"rtl":"ltr"}class hT{constructor(e){this.config=new $p(e,this.constructor.defaultConfig);const o=this.constructor.builtinPlugins;this.config.define("plugins",o),this.plugins=new Ul(this,o);const c=this.config.get("language")||{};this.locale=new dT({uiLanguage:typeof c=="string"?c:c.ui,contentLanguage:this.config.get("language.content")}),this.t=this.locale.t,this.editors=new or,this._contextOwner=null}initPlugins(){const e=this.config.get("plugins")||[];for(const o of e){if(typeof o!="function")throw new yt.b("context-initplugins-constructor-only: Only a constructor function is allowed as a context plugin.",null,{Plugin:o});if(o.isContextPlugin!==!0)throw new yt.b("context-initplugins-invalid-plugin: Only a plugin marked as a context plugin is allowed to be used with a context.",null,{Plugin:o})}return this.plugins.init(e)}destroy(){return Promise.all(Array.from(this.editors,e=>e.destroy())).then(()=>this.plugins.destroy())}_addEditor(e,o){if(this._contextOwner)throw new yt.b("context-addEditor-private-context: Cannot add multiple editors to the context which is created by the editor.");this.editors.add(e),o&&(this._contextOwner=e)}_removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve()}_getEditorConfig(){const e={};for(const o of this.config.names())["plugins","removePlugins","extraPlugins"].includes(o)||(e[o]=this.config.get(o));return e}static create(e){return new Promise(o=>{const c=new this(e);o(c.initPlugins().then(()=>c))})}}function Yn(h,e){const o=Math.min(h.length,e.length);for(let c=0;c<o;c++)if(h[c]!=e[c])return c;return h.length==e.length?"same":h.length<e.length?"prefix":"extension"}var fT=4;function pT(h){return Dl(h,fT)}var Qp=pT;class hs{constructor(e){this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))==-1)throw new yt.b("view-node-not-found-in-parent: The node's parent does not contain this node.",this);return e}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let o=this;for(;o.parent;)e.unshift(o.index),o=o.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const o=[];let c=e.includeSelf?this:this.parent;for(;c;)o[e.parentFirst?"push":"unshift"](c),c=c.parent;return o}getCommonAncestor(e,o={}){const c=this.getAncestors(o),_=e.getAncestors(o);let j=0;for(;c[j]==_[j]&&c[j];)j++;return j===0?null:c[j-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const o=this.getPath(),c=e.getPath(),_=Yn(o,c);switch(_){case"prefix":return!0;case"extension":return!1;default:return o[_]<c[_]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,o){this.fire("change:"+e,o),this.parent&&this.parent._fireChange(e,o)}toJSON(){const e=Qp(this);return delete e.parent,e}is(e){return e=="node"||e=="view:node"}}Zt(hs,xn);class wn extends hs{constructor(e,o){super(e),this._textData=o}is(e){return e=="text"||e=="view:text"||super.is(e)}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof wn?this===e||this.data===e.data:!1}_clone(){return new wn(this.document,this.data)}}class Ar{constructor(e,o,c){if(this.textNode=e,o<0||o>e.data.length)throw new yt.b("view-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(c<0||o+c>e.data.length)throw new yt.b("view-textproxy-wrong-length: Given length value is incorrect.",this);this.data=e.data.substring(o,o+c),this.offsetInText=o}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(e){return e=="textProxy"||e=="view:textProxy"}getAncestors(e={includeSelf:!1,parentFirst:!1}){const o=[];let c=e.includeSelf?this.textNode:this.parent;for(;c!==null;)o[e.parentFirst?"push":"unshift"](c),c=c.parent;return o}}function mT(h){const e=new Map;for(const o in h)e.set(o,h[o]);return e}function hr(h){return!!(h&&h[Symbol.iterator])}function Fr(h){return hr(h)?new Map(h):mT(h)}class Sr{constructor(...e){this._patterns=[],this.add(...e)}add(...e){for(let o of e)(typeof o=="string"||o instanceof RegExp)&&(o={name:o}),o.classes&&(typeof o.classes=="string"||o.classes instanceof RegExp)&&(o.classes=[o.classes]),this._patterns.push(o)}match(...e){for(const o of e)for(const c of this._patterns){const _=Jp(o,c);if(_)return{element:o,pattern:c,match:_}}return null}matchAll(...e){const o=[];for(const c of e)for(const _ of this._patterns){const j=Jp(c,_);j&&o.push({element:c,pattern:_,match:j})}return o.length>0?o:null}getElementName(){if(this._patterns.length!==1)return null;const e=this._patterns[0],o=e.name;return typeof e!="function"&&o&&!(o instanceof RegExp)?o:null}}function Jp(h,e){if(typeof e=="function")return e(h);const o={};return e.name&&(o.name=gT(e.name,h.name),!o.name)||e.attributes&&(o.attributes=_T(e.attributes,h),!o.attributes)?null:e.classes&&(o.classes=wT(e.classes,h),!o.classes)||e.styles&&(o.styles=vT(e.styles,h),!o.styles)?!1:o}function gT(h,e){return h instanceof RegExp?h.test(e):h===e}function _T(h,e){const o=[];for(const c in h){const _=h[c];if(e.hasAttribute(c)){const j=e.getAttribute(c);if(_===!0)o.push(c);else if(_ instanceof RegExp)if(_.test(j))o.push(c);else return null;else if(j===_)o.push(c);else return null}else return null}return o}function wT(h,e){const o=[];for(const c of h)if(c instanceof RegExp){const _=e.getClassNames();for(const j of _)c.test(j)&&o.push(j);if(o.length===0)return null}else if(e.hasClass(c))o.push(c);else return null;return o}function vT(h,e){const o=[];for(const c in h){const _=h[c];if(e.hasStyle(c)){const j=e.getStyle(c);if(_ instanceof RegExp)if(_.test(j))o.push(c);else return null;else if(j===_)o.push(c);else return null}else return null}return o}var bT="[object Symbol]";function yT(h){return typeof h=="symbol"||Lt(h)&&bt(h)==bT}var uo=yT,kT=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xT=/^\w*$/;function ET(h,e){if(Kn(h))return!1;var o=typeof h;return o=="number"||o=="symbol"||o=="boolean"||h==null||uo(h)?!0:xT.test(h)||!kT.test(h)||e!=null&&h in Object(e)}var CT=ET,TT="Expected a function";function Wl(h,e){if(typeof h!="function"||e!=null&&typeof e!="function")throw new TypeError(TT);var o=function(){var c=arguments,_=e?e.apply(this,c):c[0],j=o.cache;if(j.has(_))return j.get(_);var _e=h.apply(this,c);return o.cache=j.set(_,_e)||j,_e};return o.cache=new(Wl.Cache||ro),o}Wl.Cache=ro;var AT=Wl,ST=500;function IT(h){var e=AT(h,function(c){return o.size===ST&&o.clear(),c}),o=e.cache;return e}var PT=IT,RT=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,NT=/\\(\\)?/g,OT=PT(function(h){var e=[];return h.charCodeAt(0)===46&&e.push(""),h.replace(RT,function(o,c,_,j){e.push(_?j.replace(NT,"$1"):c||o)}),e}),MT=OT;function jT(h,e){for(var o=-1,c=h==null?0:h.length,_=Array(c);++o<c;)_[o]=e(h[o],o,h);return _}var LT=jT,DT=1/0,Xp=b?b.prototype:void 0,Zp=Xp?Xp.toString:void 0;function em(h){if(typeof h=="string")return h;if(Kn(h))return LT(h,em)+"";if(uo(h))return Zp?Zp.call(h):"";var e=h+"";return e=="0"&&1/h==-DT?"-0":e}var FT=em;function BT(h){return h==null?"":FT(h)}var tm=BT;function zT(h,e){return Kn(h)?h:CT(h,e)?[h]:MT(tm(h))}var Hl=zT;function VT(h){var e=h==null?0:h.length;return e?h[e-1]:void 0}var nm=VT,$T=1/0;function UT(h){if(typeof h=="string"||uo(h))return h;var e=h+"";return e=="0"&&1/h==-$T?"-0":e}var Gl=UT;function WT(h,e){e=Hl(e,h);for(var o=0,c=e.length;h!=null&&o<c;)h=h[Gl(e[o++])];return o&&o==c?h:void 0}var im=WT;function HT(h,e,o){var c=-1,_=h.length;e<0&&(e=-e>_?0:_+e),o=o>_?_:o,o<0&&(o+=_),_=e>o?0:o-e>>>0,e>>>=0;for(var j=Array(_);++c<_;)j[c]=h[c+e];return j}var rm=HT;function GT(h,e){return e.length<2?h:im(h,rm(e,0,-1))}var qT=GT;function KT(h,e){return e=Hl(e,h),h=qT(h,e),h==null||delete h[Gl(nm(e))]}var YT=KT;function QT(h,e){return h==null?!0:YT(h,e)}var JT=QT;function XT(h,e,o){var c=h==null?void 0:im(h,e);return c===void 0?o:c}var ho=XT;function ZT(h,e,o){(o!==void 0&&!Qt(h[e],o)||o===void 0&&!(e in h))&&wl(h,e,o)}var Kl=ZT;function e1(h){return function(e,o,c){for(var _=-1,j=Object(e),_e=c(e),et=_e.length;et--;){var nt=_e[h?et:++_];if(o(j[nt],nt,j)===!1)break}return e}}var t1=e1,n1=t1(),i1=n1;function r1(h){return Lt(h)&&oo(h)}var s1=r1;function o1(h,e){if(!(e==="constructor"&&typeof h[e]=="function")&&e!="__proto__")return h[e]}var Yl=o1;function a1(h){return us(h,Ns(h))}var l1=a1;function c1(h,e,o,c,_,j,_e){var et=Yl(h,o),nt=Yl(e,o),st=_e.get(nt);if(st){Kl(h,o,st);return}var at=j?j(et,nt,o+"",h,e,_e):void 0,ct=at===void 0;if(ct){var dt=Kn(nt),gt=!dt&&Object(Rs.a)(nt),kt=!dt&&!gt&&Tl(nt);at=nt,dt||gt||kt?Kn(et)?at=et:s1(et)?at=bp(et):gt?(ct=!1,at=Object(vp.a)(nt,!0)):kt?(ct=!1,at=Op(nt,!0)):at=[]:St(nt)||xl(nt)?(at=et,xl(et)?at=l1(et):(!In(et)||qn(et))&&(at=jp(nt))):ct=!1}ct&&(_e.set(nt,at),_(at,nt,c,j,_e),_e.delete(nt)),Kl(h,o,at)}var u1=c1;function sm(h,e,o,c,_){h!==e&&i1(e,function(j,_e){if(_||(_=new Ps),In(j))u1(h,e,_e,o,sm,c,_);else{var et=c?c(Yl(h,_e),j,_e+"",h,e,_):void 0;et===void 0&&(et=j),Kl(h,_e,et)}},Ns)}var d1=sm;function h1(h){return h}var om=h1;function f1(h,e,o){switch(o.length){case 0:return h.call(e);case 1:return h.call(e,o[0]);case 2:return h.call(e,o[0],o[1]);case 3:return h.call(e,o[0],o[1],o[2])}return h.apply(e,o)}var p1=f1,am=Math.max;function m1(h,e,o){return e=am(e===void 0?h.length-1:e,0),function(){for(var c=arguments,_=-1,j=am(c.length-e,0),_e=Array(j);++_<j;)_e[_]=c[e+_];_=-1;for(var et=Array(e+1);++_<e;)et[_]=c[_];return et[e]=o(_e),p1(h,this,et)}}var g1=m1;function _1(h){return function(){return h}}var w1=_1,v1=so?function(h,e){return so(h,"toString",{configurable:!0,enumerable:!1,value:w1(e),writable:!0})}:om,b1=v1,y1=800,k1=16,x1=Date.now;function E1(h){var e=0,o=0;return function(){var c=x1(),_=k1-(c-o);if(o=c,_>0){if(++e>=y1)return arguments[0]}else e=0;return h.apply(void 0,arguments)}}var C1=E1,T1=C1(b1),A1=T1;function S1(h,e){return A1(g1(h,e,om),h+"")}var I1=S1;function P1(h,e,o){if(!In(o))return!1;var c=typeof e;return(c=="number"?oo(o)&&El(e,o.length):c=="string"&&e in o)?Qt(o[e],h):!1}var R1=P1;function N1(h){return I1(function(e,o){var c=-1,_=o.length,j=_>1?o[_-1]:void 0,_e=_>2?o[2]:void 0;for(j=h.length>3&&typeof j=="function"?(_--,j):void 0,_e&&R1(o[0],o[1],_e)&&(j=_<3?void 0:j,_=1),e=Object(e);++c<_;){var et=o[c];et&&h(e,et,c,j)}return e})}var lm=N1,O1=lm(function(h,e,o){d1(h,e,o)}),cm=O1;function M1(h,e,o,c){if(!In(h))return h;e=Hl(e,h);for(var _=-1,j=e.length,_e=j-1,et=h;et!=null&&++_<j;){var nt=Gl(e[_]),st=o;if(_!=_e){var at=et[nt];st=c?c(at,nt,et):void 0,st===void 0&&(st=In(at)?at:El(e[_+1])?[]:{})}yl(et,nt,st),et=et[nt]}return h}var j1=M1;function L1(h,e,o){return h==null?h:j1(h,e,o)}var D1=L1;class F1{constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){const e=Object.entries(this._styles);return!Array.from(e).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const o=Array.from(B1(e).entries());for(const[c,_]of o)this._styleProcessor.toNormalizedForm(c,_,this._styles)}has(e){if(this.isEmpty)return!1;const c=this._styleProcessor.getReducedForm(e,this._styles).find(([_])=>_===e);return Array.isArray(c)}set(e,o){if(In(e))for(const[c,_]of Object.entries(e))this._styleProcessor.toNormalizedForm(c,_,this._styles);else this._styleProcessor.toNormalizedForm(e,o,this._styles)}remove(e){const o=Ql(e);JT(this._styles,o),delete this._styles[e],this._cleanEmptyObjectsOnPath(o)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(e=>e.join(":")).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!In(this._styles[e]))return this._styles[e];const c=this._styleProcessor.getReducedForm(e,this._styles).find(([_])=>_===e);if(Array.isArray(c))return c[1]}getStyleNames(){return this.isEmpty?[]:this._getStylesEntries().map(([o])=>o)}clear(){this._styles={}}_getStylesEntries(){const e=[],o=Object.keys(this._styles);for(const c of o)e.push(...this._styleProcessor.getReducedForm(c,this._styles));return e}_cleanEmptyObjectsOnPath(e){const o=e.split(".");if(!(o.length>1))return;const _=o.splice(0,o.length-1).join("."),j=ho(this._styles,_);if(!j)return;!Array.from(Object.keys(j)).length&&this.remove(_)}}class um{constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(e,o,c){if(In(o)){Jl(c,Ql(e),o);return}if(this._normalizers.has(e)){const _=this._normalizers.get(e),{path:j,value:_e}=_(o);Jl(c,j,_e)}else Jl(c,e,o)}getNormalized(e,o){if(!e)return cm({},o);if(o[e]!==void 0)return o[e];if(this._extractors.has(e)){const c=this._extractors.get(e);if(typeof c=="string")return ho(o,c);const _=c(e,o);if(_)return _}return ho(o,Ql(e))}getReducedForm(e,o){const c=this.getNormalized(e,o);return c===void 0?[]:this._reducers.has(e)?this._reducers.get(e)(c):[[e,c]]}getRelatedStyles(e){return this._consumables.get(e)||[]}setNormalizer(e,o){this._normalizers.set(e,o)}setExtractor(e,o){this._extractors.set(e,o)}setReducer(e,o){this._reducers.set(e,o)}setStyleRelation(e,o){this._mapStyleNames(e,o);for(const c of o)this._mapStyleNames(c,[e])}_mapStyleNames(e,o){this._consumables.has(e)||this._consumables.set(e,[]),this._consumables.get(e).push(...o)}}function B1(h){let e=null,o=0,c=0,_=null;const j=new Map;if(h==="")return j;h.charAt(h.length-1)!=";"&&(h=h+";");for(let _e=0;_e<h.length;_e++){const et=h.charAt(_e);if(e===null)switch(et){case":":_||(_=h.substr(o,_e-o),c=_e+1);break;case'"':case"'":e=et;break;case";":{const nt=h.substr(c,_e-c);_&&j.set(_.trim(),nt.trim()),_=null,o=_e+1;break}}else et===e&&(e=null)}return j}function Ql(h){return h.replace("-",".")}function Jl(h,e,o){let c=o;In(o)&&(c=cm({},ho(h,e),o)),D1(h,e,c)}class fr extends hs{constructor(e,o,c,_){if(super(e),this.name=o,this._attrs=z1(c),this._children=[],_&&this._insertChild(0,_),this._classes=new Set,this._attrs.has("class")){const j=this._attrs.get("class");dm(this._classes,j),this._attrs.delete("class")}this._styles=new F1(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map}get childCount(){return this._children.length}get isEmpty(){return this._children.length===0}is(e,o=null){const c=e.replace(/^view:/,"");return o?c=="element"&&o==this.name:c=="element"||c==this.name||super.is(e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(e){if(e=="class")return this._classes.size>0?[...this._classes].join(" "):void 0;if(e=="style"){const o=this._styles.toString();return o==""?void 0:o}return this._attrs.get(e)}hasAttribute(e){return e=="class"?this._classes.size>0:e=="style"?!this._styles.isEmpty:this._attrs.has(e)}isSimilar(e){if(!(e instanceof fr))return!1;if(this===e)return!0;if(this.name!=e.name||this._attrs.size!==e._attrs.size||this._classes.size!==e._classes.size||this._styles.size!==e._styles.size)return!1;for(const[o,c]of this._attrs)if(!e._attrs.has(o)||e._attrs.get(o)!==c)return!1;for(const o of this._classes)if(!e._classes.has(o))return!1;for(const o of this._styles.getStyleNames())if(!e._styles.has(o)||e._styles.getAsString(o)!==this._styles.getAsString(o))return!1;return!0}hasClass(...e){for(const o of e)if(!this._classes.has(o))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(e){return this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles.getNormalized(e)}getStyleNames(){return this._styles.getStyleNames()}hasStyle(...e){for(const o of e)if(!this._styles.has(o))return!1;return!0}findAncestor(...e){const o=new Sr(...e);let c=this.parent;for(;c;){if(o.match(c))return c;c=c.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=Array.from(this._classes).sort().join(","),o=this._styles.toString(),c=Array.from(this._attrs).map(_=>`${_[0]}="${_[1]}"`).sort().join(" ");return this.name+(e==""?"":` class="${e}"`)+(o?` style="${o}"`:"")+(c==""?"":` ${c}`)}_clone(e=!1){const o=[];if(e)for(const _ of this.getChildren())o.push(_._clone(e));const c=new this.constructor(this.document,this.name,this._attrs,o);return c._classes=new Set(this._classes),c._styles.set(this._styles.getNormalized()),c._customProperties=new Map(this._customProperties),c.getFillerOffset=this.getFillerOffset,c}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,o){this._fireChange("children",this);let c=0;const _=V1(this.document,o);for(const j of _)j.parent!==null&&j._remove(),j.parent=this,j.document=this.document,this._children.splice(e,0,j),e++,c++;return c}_removeChildren(e,o=1){this._fireChange("children",this);for(let c=e;c<e+o;c++)this._children[c].parent=null;return this._children.splice(e,o)}_setAttribute(e,o){o=String(o),this._fireChange("attributes",this),e=="class"?dm(this._classes,o):e=="style"?this._styles.setTo(o):this._attrs.set(e,o)}_removeAttribute(e){return this._fireChange("attributes",this),e=="class"?this._classes.size>0?(this._classes.clear(),!0):!1:e=="style"?this._styles.isEmpty?!1:(this._styles.clear(),!0):this._attrs.delete(e)}_addClass(e){this._fireChange("attributes",this),e=Array.isArray(e)?e:[e],e.forEach(o=>this._classes.add(o))}_removeClass(e){this._fireChange("attributes",this),e=Array.isArray(e)?e:[e],e.forEach(o=>this._classes.delete(o))}_setStyle(e,o){this._fireChange("attributes",this),this._styles.set(e,o)}_removeStyle(e){this._fireChange("attributes",this),e=Array.isArray(e)?e:[e],e.forEach(o=>this._styles.remove(o))}_setCustomProperty(e,o){this._customProperties.set(e,o)}_removeCustomProperty(e){return this._customProperties.delete(e)}}function z1(h){h=Fr(h);for(const[e,o]of h)o===null?h.delete(e):typeof o!="string"&&h.set(e,String(o));return h}function dm(h,e){const o=e.split(/\s+/);h.clear(),o.forEach(c=>h.add(c))}function V1(h,e){return typeof e=="string"?[new wn(h,e)]:(hr(e)||(e=[e]),Array.from(e).map(o=>typeof o=="string"?new wn(h,o):o instanceof Ar?new wn(h,o.data):o))}class fo extends fr{constructor(e,o,c,_){super(e,o,c,_),this.getFillerOffset=hm}is(e,o=null){const c=e&&e.replace(/^view:/,"");return o?c=="containerElement"&&o==this.name||super.is(e,o):c=="containerElement"||super.is(e)}}function hm(){const h=[...this.getChildren()],e=h[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const o of h)if(!o.is("uiElement"))return null;return this.childCount}var $1=lm(function(h,e){us(e,Ns(e),h)}),fs=$1;const po=Symbol("observableProperties"),mo=Symbol("boundObservables"),go=Symbol("boundProperties"),fm={set(h,e){if(In(h)){Object.keys(h).forEach(c=>{this.set(c,h[c])},this);return}pm(this);const o=this[po];if(h in this&&!o.has(h))throw new yt.b("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,h,{enumerable:!0,configurable:!0,get(){return o.get(h)},set(c){const _=o.get(h);let j=this.fire("set:"+h,h,c,_);j===void 0&&(j=c),(_!==j||!o.has(h))&&(o.set(h,j),this.fire("change:"+h,h,j,_))}}),this[h]=e},bind(...h){if(!h.length||!mm(h))throw new yt.b("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(h).size!==h.length)throw new yt.b("observable-bind-duplicate-properties: Properties must be unique.",this);pm(this);const e=this[go];h.forEach(c=>{if(e.has(c))throw new yt.b("observable-bind-rebind: Cannot bind the same property more than once.",this)});const o=new Map;return h.forEach(c=>{const _={property:c,to:[]};e.set(c,_),o.set(c,_)}),{to:U1,toMany:W1,_observable:this,_bindProperties:h,_to:[],_bindings:o}},unbind(...h){if(!(po in this))return;const e=this[go],o=this[mo];if(h.length){if(!mm(h))throw new yt.b("observable-unbind-wrong-properties: Properties must be strings.",this);h.forEach(c=>{const _=e.get(c);if(!_)return;let j,_e,et,nt;_.to.forEach(st=>{j=st[0],_e=st[1],et=o.get(j),nt=et[_e],nt.delete(_),nt.size||delete et[_e],Object.keys(et).length||(o.delete(j),this.stopListening(j,"change"))}),e.delete(c)})}else o.forEach((c,_)=>{this.stopListening(_,"change")}),o.clear(),e.clear()},decorate(h){const e=this[h];if(!e)throw new yt.b("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:h});this.on(h,(o,c)=>{o.return=e.apply(this,c)}),this[h]=function(...o){return this.fire(h,o)}}};fs(fm,xn);var Mn=fm;function pm(h){po in h||(Object.defineProperty(h,po,{value:new Map}),Object.defineProperty(h,mo,{value:new Map}),Object.defineProperty(h,go,{value:new Map}))}function U1(...h){const e=G1(...h),o=Array.from(this._bindings.keys()),c=o.length;if(!e.callback&&e.to.length>1)throw new yt.b("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(c>1&&e.callback)throw new yt.b("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);e.to.forEach(_=>{if(_.properties.length&&_.properties.length!==c)throw new yt.b("observable-bind-to-properties-length: The number of properties must match.",this);_.properties.length||(_.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(o[0]).callback=e.callback),Y1(this._observable,this._to),K1(this),this._bindProperties.forEach(_=>{gm(this._observable,_)})}function W1(h,e,o){if(this._bindings.size>1)throw new yt.b("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...H1(h,e),o)}function H1(h,e){const o=h.map(c=>[c,e]);return Array.prototype.concat.apply([],o)}function mm(h){return h.every(e=>typeof e=="string")}function G1(...h){if(!h.length)throw new yt.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const e={to:[]};let o;return typeof h[h.length-1]=="function"&&(e.callback=h.pop()),h.forEach(c=>{if(typeof c=="string")o.properties.push(c);else if(typeof c=="object")o={observable:c,properties:[]},e.to.push(o);else throw new yt.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null)}),e}function q1(h,e,o,c){const _=h[mo],j=_.get(o),_e=j||{};_e[c]||(_e[c]=new Set),_e[c].add(e),j||_.set(o,_e)}function K1(h){let e;h._bindings.forEach((o,c)=>{h._to.forEach(_=>{e=_.properties[o.callback?0:h._bindProperties.indexOf(c)],o.to.push([_.observable,e]),q1(h._observable,o,_.observable,e)})})}function gm(h,e){const c=h[go].get(e);let _;c.callback?_=c.callback.apply(h,c.to.map(j=>j[0][j[1]])):(_=c.to[0],_=_[0][_[1]]),h.hasOwnProperty(e)?h[e]=_:h.set(e,_)}function Y1(h,e){e.forEach(o=>{const c=h[mo];let _;c.get(o.observable)||h.listenTo(o.observable,"change",(j,_e)=>{_=c.get(o.observable)[_e],_&&_.forEach(et=>{gm(h,et.property)})})})}class _o extends fo{constructor(e,o,c,_){super(e,o,c,_),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",j=>j&&e.selection.editableElement==this),this.listenTo(e.selection,"change",()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this})}is(e,o=null){const c=e&&e.replace(/^view:/,"");return o?c=="editableElement"&&o==this.name||super.is(e,o):c=="editableElement"||super.is(e)}destroy(){this.stopListening()}}Zt(_o,Mn);const _m=Symbol("rootName");class Q1 extends _o{constructor(e,o){super(e,o),this.rootName="main"}is(e,o=null){const c=e.replace(/^view:/,"");return o?c=="rootElement"&&o==this.name||super.is(e,o):c=="rootElement"||super.is(e)}get rootName(){return this.getCustomProperty(_m)}set rootName(e){this._setCustomProperty(_m,e)}set _name(e){this.name=e}}class Xr{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new yt.b("view-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);if(e.direction&&e.direction!="forward"&&e.direction!="backward")throw new yt.b("view-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this.position=Ft._createAt(e.startPosition):this.position=Ft._createAt(e.boundaries[e.direction=="backward"?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(e){let o,c,_;do _=this.position,{done:o,value:c}=this.next();while(!o&&e(c));o||(this.position=_)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){let e=this.position.clone();const o=this.position,c=e.parent;if(c.parent===null&&e.offset===c.childCount)return{done:!0};if(c===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};let _;if(c instanceof wn){if(e.isAtEnd)return this.position=Ft._createAfter(c),this._next();_=c.data[e.offset]}else _=c.getChild(e.offset);if(_ instanceof fr)return this.shallow?e.offset++:e=new Ft(_,0),this.position=e,this._formatReturnValue("elementStart",_,o,e,1);if(_ instanceof wn){if(this.singleCharacters)return e=new Ft(_,0),this.position=e,this._next();{let j=_.data.length,_e;return _==this._boundaryEndParent?(j=this.boundaries.end.offset,_e=new Ar(_,0,j),e=Ft._createAfter(_e)):(_e=new Ar(_,0,_.data.length),e.offset++),this.position=e,this._formatReturnValue("text",_e,o,e,j)}}else if(typeof _=="string"){let j;this.singleCharacters?j=1:j=(c===this._boundaryEndParent?this.boundaries.end.offset:c.data.length)-e.offset;const _e=new Ar(c,e.offset,j);return e.offset+=j,this.position=e,this._formatReturnValue("text",_e,o,e,j)}else return e=Ft._createAfter(c),this.position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",c,o,e)}_previous(){let e=this.position.clone();const o=this.position,c=e.parent;if(c.parent===null&&e.offset===0)return{done:!0};if(c==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};let _;if(c instanceof wn){if(e.isAtStart)return this.position=Ft._createBefore(c),this._previous();_=c.data[e.offset-1]}else _=c.getChild(e.offset-1);if(_ instanceof fr)return this.shallow?(e.offset--,this.position=e,this._formatReturnValue("elementStart",_,o,e,1)):(e=new Ft(_,_.childCount),this.position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",_,o,e));if(_ instanceof wn){if(this.singleCharacters)return e=new Ft(_,_.data.length),this.position=e,this._previous();{let j=_.data.length,_e;if(_==this._boundaryStartParent){const et=this.boundaries.start.offset;_e=new Ar(_,et,_.data.length-et),j=_e.data.length,e=Ft._createBefore(_e)}else _e=new Ar(_,0,_.data.length),e.offset--;return this.position=e,this._formatReturnValue("text",_e,o,e,j)}}else if(typeof _=="string"){let j;if(this.singleCharacters)j=1;else{const et=c===this._boundaryStartParent?this.boundaries.start.offset:0;j=e.offset-et}e.offset-=j;const _e=new Ar(c,e.offset,j);return this.position=e,this._formatReturnValue("text",_e,o,e,j)}else return e=Ft._createBefore(c),this.position=e,this._formatReturnValue("elementStart",c,o,e,1)}_formatReturnValue(e,o,c,_,j){return o instanceof Ar&&(o.offsetInText+o.data.length==o.textNode.data.length&&(this.direction=="forward"&&!(this.boundaries&&this.boundaries.end.isEqual(this.position))?(_=Ft._createAfter(o.textNode),this.position=_):c=Ft._createAfter(o.textNode)),o.offsetInText===0&&(this.direction=="backward"&&!(this.boundaries&&this.boundaries.start.isEqual(this.position))?(_=Ft._createBefore(o.textNode),this.position=_):c=Ft._createBefore(o.textNode))),{done:!1,value:{type:e,item:o,previousPosition:c,nextPosition:_,length:j}}}}class Ft{constructor(e,o){this.parent=e,this.offset=o}get nodeAfter(){return this.parent.is("text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return this.offset===0}get isAtEnd(){const e=this.parent.is("text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;for(;!(e instanceof _o);)if(e.parent)e=e.parent;else return null;return e}getShiftedBy(e){const o=Ft._createAt(this),c=o.offset+e;return o.offset=c<0?0:c,o}getLastMatchingPosition(e,o={}){o.startPosition=this;const c=new Xr(o);return c.skip(e),c.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const o=this.getAncestors(),c=e.getAncestors();let _=0;for(;o[_]==c[_]&&o[_];)_++;return _===0?null:o[_-1]}is(e){return e=="position"||e=="view:position"}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return this.compareWith(e)=="before"}isAfter(e){return this.compareWith(e)=="after"}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const o=this.parent.is("node")?this.parent.getPath():[],c=e.parent.is("node")?e.parent.getPath():[];o.push(this.offset),c.push(e.offset);const _=Yn(o,c);switch(_){case"prefix":return"before";case"extension":return"after";default:return o[_]<c[_]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new Xr(e)}clone(){return new Ft(this.parent,this.offset)}static _createAt(e,o){if(e instanceof Ft)return new this(e.parent,e.offset);{const c=e;if(o=="end")o=c.is("text")?c.data.length:c.childCount;else{if(o=="before")return this._createBefore(c);if(o=="after")return this._createAfter(c);if(o!==0&&!o)throw new yt.b("view-createPositionAt-offset-required: View#createPositionAt() requires the offset when the first parameter is a view item.",c)}return new Ft(c,o)}}static _createAfter(e){if(e.is("textProxy"))return new Ft(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new yt.b("view-position-after-root: You can not make position after root.",e,{root:e});return new Ft(e.parent,e.index+1)}static _createBefore(e){if(e.is("textProxy"))return new Ft(e.textNode,e.offsetInText);if(!e.parent)throw new yt.b("view-position-before-root: You can not make position before root.",e,{root:e});return new Ft(e.parent,e.index)}}class Jt{constructor(e,o=null){this.start=e.clone(),this.end=o?o.clone():e.clone()}*[Symbol.iterator](){yield*new Xr({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(wo,{direction:"backward"}),o=this.end.getLastMatchingPosition(wo);return e.parent.is("text")&&e.isAtStart&&(e=Ft._createBefore(e.parent)),o.parent.is("text")&&o.isAtEnd&&(o=Ft._createAfter(o.parent)),new Jt(e,o)}getTrimmed(){let e=this.start.getLastMatchingPosition(wo);if(e.isAfter(this.end)||e.isEqual(this.end))return new Jt(e,e);let o=this.end.getLastMatchingPosition(wo,{direction:"backward"});const c=e.nodeAfter,_=o.nodeBefore;return c&&c.is("text")&&(e=new Ft(c,0)),_&&_.is("text")&&(o=new Ft(_,_.data.length)),new Jt(e,o)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,o=!1){e.isCollapsed&&(o=!1);const c=this.containsPosition(e.start)||o&&this.start.isEqual(e.start),_=this.containsPosition(e.end)||o&&this.end.isEqual(e.end);return c&&_}getDifference(e){const o=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&o.push(new Jt(this.start,e.start)),this.containsPosition(e.end)&&o.push(new Jt(e.end,this.end))):o.push(this.clone()),o}getIntersection(e){if(this.isIntersecting(e)){let o=this.start,c=this.end;return this.containsPosition(e.start)&&(o=e.start),this.containsPosition(e.end)&&(c=e.end),new Jt(o,c)}return null}getWalker(e={}){return e.boundaries=this,new Xr(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,o=this.end.nodeBefore;return this.start.parent.is("text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(o=this.end.parent.previousSibling),e&&e.is("element")&&e===o?e:null}clone(){return new Jt(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const o=new Xr(e);for(const c of o)yield c.item}*getPositions(e={}){e.boundaries=this;const o=new Xr(e);yield o.position;for(const c of o)yield c.nextPosition}is(e){return e=="range"||e=="view:range"}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,o,c,_){return new this(new Ft(e,o),new Ft(c,_))}static _createFromPositionAndShift(e,o){const c=e,_=e.getShiftedBy(o);return o>0?new this(c,_):new this(_,c)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const o=e.is("textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(Ft._createBefore(e),o)}}function wo(h){return!!(h.item.is("attributeElement")||h.item.is("uiElement"))}function Xl(h){let e=0;for(const o of h)e++;return e}class pr{constructor(e=null,o,c){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(e,o,c)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.end:e.start).clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.start:e.end).clone()}get isCollapsed(){return this.rangeCount===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const o of this._ranges)(!e||o.start.isBefore(e.start))&&(e=o);return e?e.clone():null}getLastRange(){let e=null;for(const o of this._ranges)(!e||o.end.isAfter(e.end))&&(e=o);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake||this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel||this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const o of this._ranges){let c=!1;for(const _ of e._ranges)if(o.isEqual(_)){c=!0;break}if(!c)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const o=Xl(this.getRanges()),c=Xl(e.getRanges());if(o!=c)return!1;if(o==0)return!0;for(let _ of this.getRanges()){_=_.getTrimmed();let j=!1;for(let _e of e.getRanges())if(_e=_e.getTrimmed(),_.start.isEqual(_e.start)&&_.end.isEqual(_e.end)){j=!0;break}if(!j)return!1}return!0}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}setTo(e,o,c){if(e===null)this._setRanges([]),this._setFakeOptions(o);else if(e instanceof pr||e instanceof Zl)this._setRanges(e.getRanges(),e.isBackward),this._setFakeOptions({fake:e.isFake,label:e.fakeSelectionLabel});else if(e instanceof Jt)this._setRanges([e],o&&o.backward),this._setFakeOptions(o);else if(e instanceof Ft)this._setRanges([new Jt(e)]),this._setFakeOptions(o);else if(e instanceof hs){const _=!!c&&!!c.backward;let j;if(o===void 0)throw new yt.b("view-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.",this);o=="in"?j=Jt._createIn(e):o=="on"?j=Jt._createOn(e):j=new Jt(Ft._createAt(e,o)),this._setRanges([j],_),this._setFakeOptions(c)}else if(hr(e))this._setRanges(e,o&&o.backward),this._setFakeOptions(o);else throw new yt.b("view-selection-setTo-not-selectable: Cannot set selection to given place.",this);this.fire("change")}setFocus(e,o){if(this.anchor===null)throw new yt.b("view-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.",this);const c=Ft._createAt(e,o);if(c.compareWith(this.focus)=="same")return;const _=this.anchor;this._ranges.pop(),c.compareWith(_)=="before"?this._addRange(new Jt(c,_),!0):this._addRange(new Jt(_,c)),this.fire("change")}is(e){return e=="selection"||e=="view:selection"}_setRanges(e,o=!1){e=Array.from(e),this._ranges=[];for(const c of e)this._addRange(c);this._lastRangeBackward=!!o}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,o=!1){if(!(e instanceof Jt))throw new yt.b("view-selection-add-range-not-range: Selection range set to an object that is not an instance of view.Range",this);this._pushRange(e),this._lastRangeBackward=!!o}_pushRange(e){for(const o of this._ranges)if(e.isIntersecting(o))throw new yt.b("view-selection-range-intersects: Trying to add a range that intersects with another range from selection.",this,{addedRange:e,intersectingRange:o});this._ranges.push(new Jt(e.start,e.end))}}Zt(pr,xn);class Zl{constructor(e=null,o,c){this._selection=new pr,this._selection.delegate("change").to(this),this._selection.setTo(e,o,c)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}is(e){return e=="selection"||e=="documentSelection"||e=="view:selection"||e=="view:documentSelection"}_setTo(e,o,c){this._selection.setTo(e,o,c)}_setFocus(e,o){this._selection.setFocus(e,o)}}Zt(Zl,xn);class vo{constructor(e){this.selection=new Zl,this.roots=new or({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isComposing",!1),this._postFixers=new Set}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.map(e=>e.destroy()),this.stopListening()}_callPostFixers(e){let o=!1;do for(const c of this._postFixers)if(o=c(e),o)break;while(o)}}Zt(vo,Mn);const wm=10;class ps extends fr{constructor(e,o,c,_){super(e,o,c,_),this.getFillerOffset=J1,this._priority=wm,this._id=null,this._clonesGroup=null}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(this.id===null)throw new yt.b("attribute-element-get-elements-with-same-id-no-id: Cannot get elements with the same id for an attribute element without id.",this);return new Set(this._clonesGroup)}is(e,o=null){const c=e&&e.replace(/^view:/,"");return o?c=="attributeElement"&&o==this.name||super.is(e,o):c=="attributeElement"||super.is(e)}isSimilar(e){return this.id!==null||e.id!==null?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e){const o=super._clone(e);return o._priority=this._priority,o._id=this._id,o}}ps.DEFAULT_PRIORITY=wm;function J1(){if(_c(this))return null;let h=this.parent;for(;h&&h.is("attributeElement");){if(_c(h)>1)return null;h=h.parent}return!h||_c(h)>1?null:this.childCount}function _c(h){return Array.from(h.getChildren()).filter(e=>!e.is("uiElement")).length}class vm extends fr{constructor(e,o,c,_){super(e,o,c,_),this.getFillerOffset=X1}is(e,o=null){const c=e.replace(/^view:/,"");return o?c=="emptyElement"&&o==this.name||super.is(e,o):c=="emptyElement"||super.is(e)}_insertChild(e,o){if(o&&(o instanceof hs||Array.from(o).length>0))throw new yt.b("view-emptyelement-cannot-add: Cannot add child nodes to EmptyElement instance.",[this,o])}}function X1(){return null}const Ms=navigator.userAgent.toLowerCase();var ar={isMac:Z1(Ms),isEdge:eA(Ms),isGecko:tA(Ms),isSafari:nA(Ms),isAndroid:iA(Ms),features:{isRegExpUnicodePropertySupported:rA()}};function Z1(h){return h.indexOf("macintosh")>-1}function eA(h){return!!h.match(/edge\/(\d+.?\d*)/)}function tA(h){return!!h.match(/gecko\/\d+/)}function nA(h){return h.indexOf(" applewebkit/")>-1&&h.indexOf("chrome")===-1}function iA(h){return h.indexOf("android")>-1}function rA(){let h=!1;try{h="".search(new RegExp("[\\p{L}]","u"))===0}catch{}return h}const sA={"":"ctrl","":"shift","":"alt"},oA={ctrl:"",shift:"",alt:""},mn=aA();function Ir(h){let e;if(typeof h=="string"){if(e=mn[h.toLowerCase()],!e)throw new yt.b("keyboard-unknown-key: Unknown key name.",null,{key:h})}else e=h.keyCode+(h.altKey?mn.alt:0)+(h.ctrlKey?mn.ctrl:0)+(h.shiftKey?mn.shift:0);return e}function bm(h){return typeof h=="string"&&(h=km(h)),h.map(e=>typeof e=="string"?Ir(e):e).reduce((e,o)=>o+e,0)}function ym(h){return ar.isMac?km(h).map(e=>oA[e.toLowerCase()]||e).reduce((e,o)=>e.slice(-1)in sA?e+o:e+"+"+o):h}function aA(){const h={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let e=65;e<=90;e++){const o=String.fromCharCode(e);h[o.toLowerCase()]=e}for(let e=48;e<=57;e++)h[e-48]=e;for(let e=112;e<=123;e++)h["f"+(e-111)]=e;return h}function km(h){return h.split(/\s*\+\s*/)}class xm extends fr{constructor(e,o,c,_){super(e,o,c,_),this.getFillerOffset=cA}is(e,o=null){const c=e.replace(/^view:/,"");return o?c=="uiElement"&&o==this.name||super.is(e,o):c=="uiElement"||super.is(e)}_insertChild(e,o){if(o&&(o instanceof hs||Array.from(o).length>0))throw new yt.b("view-uielement-cannot-add: Cannot add child nodes to UIElement instance.",this)}render(e){return this.toDomElement(e)}toDomElement(e){const o=e.createElement(this.name);for(const c of this.getAttributeKeys())o.setAttribute(c,this.getAttribute(c));return o}}function lA(h){h.document.on("keydown",(e,o)=>uA(e,o,h.domConverter))}function cA(){return null}function uA(h,e,o){if(e.keyCode==mn.arrowright){const c=e.domTarget.ownerDocument.defaultView.getSelection(),_=c.rangeCount==1&&c.getRangeAt(0).collapsed;if(_||e.shiftKey){const j=c.focusNode,_e=c.focusOffset,et=o.domPositionToView(j,_e);if(et===null)return;let nt=!1;const st=et.getLastMatchingPosition(at=>(at.item.is("uiElement")&&(nt=!0),!!(at.item.is("uiElement")||at.item.is("attributeElement"))));if(nt){const at=o.viewPositionToDom(st);_?c.collapse(at.parent,at.offset):c.extend(at.parent,at.offset)}}}}class ms{constructor(e,o){this.document=e,this._children=[],o&&this._insertChild(0,o)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}is(e){return e=="documentFragment"||e=="view:documentFragment"}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,o){this._fireChange("children",this);let c=0;const _=dA(this.document,o);for(const j of _)j.parent!==null&&j._remove(),j.parent=this,this._children.splice(e,0,j),e++,c++;return c}_removeChildren(e,o=1){this._fireChange("children",this);for(let c=e;c<e+o;c++)this._children[c].parent=null;return this._children.splice(e,o)}_fireChange(e,o){this.fire("change:"+e,o)}}Zt(ms,xn);function dA(h,e){return typeof e=="string"?[new wn(h,e)]:(hr(e)||(e=[e]),Array.from(e).map(o=>typeof o=="string"?new wn(h,o):o instanceof Ar?new wn(h,o.data):o))}class Em{constructor(e){this.document=e,this._cloneGroups=new Map}setSelection(e,o,c){this.document.selection._setTo(e,o,c)}setSelectionFocus(e,o){this.document.selection._setFocus(e,o)}createText(e){return new wn(this.document,e)}createAttributeElement(e,o,c={}){const _=new ps(this.document,e,o);return c.priority&&(_._priority=c.priority),c.id&&(_._id=c.id),_}createContainerElement(e,o){return new fo(this.document,e,o)}createEditableElement(e,o){const c=new _o(this.document,e,o);return c._document=this.document,c}createEmptyElement(e,o){return new vm(this.document,e,o)}createUIElement(e,o,c){const _=new xm(this.document,e,o);return c&&(_.render=c),_}setAttribute(e,o,c){c._setAttribute(e,o)}removeAttribute(e,o){o._removeAttribute(e)}addClass(e,o){o._addClass(e)}removeClass(e,o){o._removeClass(e)}setStyle(e,o,c){St(e)&&c===void 0&&(c=o),c._setStyle(e,o)}removeStyle(e,o){o._removeStyle(e)}setCustomProperty(e,o,c){c._setCustomProperty(e,o)}removeCustomProperty(e,o){return o._removeCustomProperty(e)}breakAttributes(e){return e instanceof Ft?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const o=e.parent;if(!o.is("containerElement"))throw new yt.b("view-writer-break-non-container-element: Trying to break an element which is not a container element.",this.document);if(!o.parent)throw new yt.b("view-writer-break-root: Trying to break root element.",this.document);if(e.isAtStart)return Ft._createBefore(o);if(!e.isAtEnd){const c=o._clone(!1);this.insert(Ft._createAfter(o),c);const _=new Jt(e,Ft._createAt(o,"end")),j=new Ft(c,0);this.move(_,j)}return Ft._createAfter(o)}mergeAttributes(e){const o=e.offset,c=e.parent;if(c.is("text"))return e;if(c.is("attributeElement")&&c.childCount===0){const _e=c.parent,et=c.index;return c._remove(),this._removeFromClonedElementsGroup(c),this.mergeAttributes(new Ft(_e,et))}const _=c.getChild(o-1),j=c.getChild(o);if(!_||!j)return e;if(_.is("text")&&j.is("text"))return Am(_,j);if(_.is("attributeElement")&&j.is("attributeElement")&&_.isSimilar(j)){const _e=_.childCount;return _._appendChild(j.getChildren()),j._remove(),this._removeFromClonedElementsGroup(j),this.mergeAttributes(new Ft(_,_e))}return e}mergeContainers(e){const o=e.nodeBefore,c=e.nodeAfter;if(!o||!c||!o.is("containerElement")||!c.is("containerElement"))throw new yt.b("view-writer-merge-containers-invalid-position: Element before and after given position cannot be merged.",this.document);const _=o.getChild(o.childCount-1),j=_ instanceof wn?Ft._createAt(_,"end"):Ft._createAt(o,"end");return this.move(Jt._createIn(c),Ft._createAt(o,"end")),this.remove(Jt._createOn(c)),j}insert(e,o){o=hr(o)?[...o]:[o],Sm(o,this.document);const c=eu(e);if(!c)throw new yt.b("view-writer-invalid-position-container",this.document);const _=this._breakAttributes(e,!0),j=c._insertChild(_.offset,o);for(const nt of o)this._addToClonedElementsGroup(nt);const _e=_.getShiftedBy(j),et=this.mergeAttributes(_);if(j===0)return new Jt(et,et);{et.isEqual(_)||_e.offset--;const nt=this.mergeAttributes(_e);return new Jt(et,nt)}}remove(e){const o=e instanceof Jt?e:Jt._createOn(e);if(Ls(o,this.document),o.isCollapsed)return new ms(this.document);const{start:c,end:_}=this._breakAttributesRange(o,!0),j=c.parent,_e=_.offset-c.offset,et=j._removeChildren(c.offset,_e);for(const st of et)this._removeFromClonedElementsGroup(st);const nt=this.mergeAttributes(c);return o.start=nt,o.end=nt.clone(),new ms(this.document,et)}clear(e,o){Ls(e,this.document);const c=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const _ of c){const j=_.item;let _e;if(j.is("element")&&o.isSimilar(j))_e=Jt._createOn(j);else if(!_.nextPosition.isAfter(e.start)&&j.is("textProxy")){const et=j.getAncestors().find(nt=>nt.is("element")&&o.isSimilar(nt));et&&(_e=Jt._createIn(et))}_e&&(_e.end.isAfter(e.end)&&(_e.end=e.end),_e.start.isBefore(e.start)&&(_e.start=e.start),this.remove(_e))}}move(e,o){let c;if(o.isAfter(e.end)){o=this._breakAttributes(o,!0);const _=o.parent,j=_.childCount;e=this._breakAttributesRange(e,!0),c=this.remove(e),o.offset+=_.childCount-j}else c=this.remove(e);return this.insert(o,c)}wrap(e,o){if(!(o instanceof ps))throw new yt.b("view-writer-wrap-invalid-attribute",this.document);if(Ls(e,this.document),e.isCollapsed){let c=e.start;c.parent.is("element")&&!hA(c.parent)&&(c=c.getLastMatchingPosition(j=>j.item.is("uiElement"))),c=this._wrapPosition(c,o);const _=this.document.selection;return _.isCollapsed&&_.getFirstPosition().isEqual(e.start)&&this.setSelection(c),new Jt(c)}else return this._wrapRange(e,o)}unwrap(e,o){if(!(o instanceof ps))throw new yt.b("view-writer-unwrap-invalid-attribute",this.document);if(Ls(e,this.document),e.isCollapsed)return e;const{start:c,end:_}=this._breakAttributesRange(e,!0),j=c.parent,_e=this._unwrapChildren(j,c.offset,_.offset,o),et=this.mergeAttributes(_e.start);et.isEqual(_e.start)||_e.end.offset--;const nt=this.mergeAttributes(_e.end);return new Jt(et,nt)}rename(e,o){const c=new fo(this.document,e,o.getAttributes());return this.insert(Ft._createAfter(o),c),this.move(Jt._createIn(o),Ft._createAt(c,0)),this.remove(Jt._createOn(o)),c}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,o){return Ft._createAt(e,o)}createPositionAfter(e){return Ft._createAfter(e)}createPositionBefore(e){return Ft._createBefore(e)}createRange(e,o){return new Jt(e,o)}createRangeOn(e){return Jt._createOn(e)}createRangeIn(e){return Jt._createIn(e)}createSelection(e,o,c){return new pr(e,o,c)}_wrapChildren(e,o,c,_){let j=o;const _e=[];for(;j<c;){const nt=e.getChild(j),st=nt.is("text"),at=nt.is("attributeElement"),ct=nt.is("emptyElement"),dt=nt.is("uiElement");if(at&&this._wrapAttributeElement(_,nt))_e.push(new Ft(e,j));else if(st||ct||dt||at&&fA(_,nt)){const gt=_._clone();nt._remove(),gt._appendChild(nt),e._insertChild(j,gt),this._addToClonedElementsGroup(gt),_e.push(new Ft(e,j))}else at&&this._wrapChildren(nt,0,nt.childCount,_);j++}let et=0;for(const nt of _e){if(nt.offset-=et,nt.offset==o)continue;this.mergeAttributes(nt).isEqual(nt)||(et++,c--)}return Jt._createFromParentsAndOffsets(e,o,e,c)}_unwrapChildren(e,o,c,_){let j=o;const _e=[];for(;j<c;){const nt=e.getChild(j);if(!nt.is("attributeElement")){j++;continue}if(nt.isSimilar(_)){const st=nt.getChildren(),at=nt.childCount;nt._remove(),e._insertChild(j,st),this._removeFromClonedElementsGroup(nt),_e.push(new Ft(e,j),new Ft(e,j+at)),j+=at,c+=at-1;continue}if(this._unwrapAttributeElement(_,nt)){_e.push(new Ft(e,j),new Ft(e,j+1)),j++;continue}this._unwrapChildren(nt,0,nt.childCount,_),j++}let et=0;for(const nt of _e){if(nt.offset-=et,nt.offset==o||nt.offset==c)continue;this.mergeAttributes(nt).isEqual(nt)||(et++,c--)}return Jt._createFromParentsAndOffsets(e,o,e,c)}_wrapRange(e,o){const{start:c,end:_}=this._breakAttributesRange(e,!0),j=c.parent,_e=this._wrapChildren(j,c.offset,_.offset,o),et=this.mergeAttributes(_e.start);et.isEqual(_e.start)||_e.end.offset--;const nt=this.mergeAttributes(_e.end);return new Jt(et,nt)}_wrapPosition(e,o){if(o.isSimilar(e.parent))return Cm(e.clone());e.parent.is("text")&&(e=Tm(e));const c=this.createAttributeElement();c._priority=Number.POSITIVE_INFINITY,c.isSimilar=()=>!1,e.parent._insertChild(e.offset,c);const _=new Jt(e,e.getShiftedBy(1));this.wrap(_,o);const j=new Ft(c.parent,c.index);c._remove();const _e=j.nodeBefore,et=j.nodeAfter;return _e instanceof wn&&et instanceof wn?Am(_e,et):Cm(j)}_wrapAttributeElement(e,o){if(!Im(e,o)||e.name!==o.name||e.priority!==o.priority)return!1;for(const c of e.getAttributeKeys())if(!(c==="class"||c==="style")&&o.hasAttribute(c)&&o.getAttribute(c)!==e.getAttribute(c))return!1;for(const c of e.getStyleNames())if(o.hasStyle(c)&&o.getStyle(c)!==e.getStyle(c))return!1;for(const c of e.getAttributeKeys())c==="class"||c==="style"||o.hasAttribute(c)||this.setAttribute(c,e.getAttribute(c),o);for(const c of e.getStyleNames())o.hasStyle(c)||this.setStyle(c,e.getStyle(c),o);for(const c of e.getClassNames())o.hasClass(c)||this.addClass(c,o);return!0}_unwrapAttributeElement(e,o){if(!Im(e,o)||e.name!==o.name||e.priority!==o.priority)return!1;for(const c of e.getAttributeKeys())if(!(c==="class"||c==="style")&&(!o.hasAttribute(c)||o.getAttribute(c)!==e.getAttribute(c)))return!1;if(!o.hasClass(...e.getClassNames()))return!1;for(const c of e.getStyleNames())if(!o.hasStyle(c)||o.getStyle(c)!==e.getStyle(c))return!1;for(const c of e.getAttributeKeys())c==="class"||c==="style"||this.removeAttribute(c,o);return this.removeClass(Array.from(e.getClassNames()),o),this.removeStyle(Array.from(e.getStyleNames()),o),!0}_breakAttributesRange(e,o=!1){const c=e.start,_=e.end;if(Ls(e,this.document),e.isCollapsed){const nt=this._breakAttributes(e.start,o);return new Jt(nt,nt)}const j=this._breakAttributes(_,o),_e=j.parent.childCount,et=this._breakAttributes(c,o);return j.offset+=j.parent.childCount-_e,new Jt(et,j)}_breakAttributes(e,o=!1){const c=e.offset,_=e.parent;if(e.parent.is("emptyElement"))throw new yt.b("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new yt.b("view-writer-cannot-break-ui-element",this.document);if(!o&&_.is("text")&&tu(_.parent)||tu(_))return e.clone();if(_.is("text"))return this._breakAttributes(Tm(e),o);const j=_.childCount;if(c==j){const _e=new Ft(_.parent,_.index+1);return this._breakAttributes(_e,o)}else if(c===0){const _e=new Ft(_.parent,_.index);return this._breakAttributes(_e,o)}else{const _e=_.index+1,et=_._clone();_.parent._insertChild(_e,et),this._addToClonedElementsGroup(et);const nt=_.childCount-c,st=_._removeChildren(c,nt);et._appendChild(st);const at=new Ft(_.parent,_e);return this._breakAttributes(at,o)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const _ of e.getChildren())this._addToClonedElementsGroup(_);const o=e.id;if(!o)return;let c=this._cloneGroups.get(o);c||(c=new Set,this._cloneGroups.set(o,c)),c.add(e),e._clonesGroup=c}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const _ of e.getChildren())this._removeFromClonedElementsGroup(_);const o=e.id;if(!o)return;const c=this._cloneGroups.get(o);c&&c.delete(e)}}function hA(h){return Array.from(h.getChildren()).some(e=>!e.is("uiElement"))}function eu(h){let e=h.parent;for(;!tu(e);){if(!e)return;e=e.parent}return e}function fA(h,e){return h.priority<e.priority?!0:h.priority>e.priority?!1:h.getIdentity()<e.getIdentity()}function Cm(h){const e=h.nodeBefore;if(e&&e.is("text"))return new Ft(e,e.data.length);const o=h.nodeAfter;return o&&o.is("text")?new Ft(o,0):h}function Tm(h){if(h.offset==h.parent.data.length)return new Ft(h.parent.parent,h.parent.index+1);if(h.offset===0)return new Ft(h.parent.parent,h.parent.index);const e=h.parent.data.slice(h.offset);return h.parent._data=h.parent.data.slice(0,h.offset),h.parent.parent._insertChild(h.parent.index+1,new wn(h.root.document,e)),new Ft(h.parent.parent,h.parent.index+1)}function Am(h,e){const o=h.data.length;return h._data+=e.data,e._remove(),new Ft(h,o)}function Sm(h,e){for(const o of h){if(!pA.some(c=>o instanceof c))throw new yt.b("view-writer-insert-invalid-node",e);o.is("text")||Sm(o.getChildren(),e)}}const pA=[wn,ps,fo,vm,xm];function tu(h){return h&&(h.is("containerElement")||h.is("documentFragment"))}function Ls(h,e){const o=eu(h.start),c=eu(h.end);if(!o||!c||o!==c)throw new yt.b("view-writer-invalid-range-container",e)}function Im(h,e){return h.id===null&&e.id===null}function Un(h){return Object.prototype.toString.call(h)=="[object Text]"}const mA=h=>h.createTextNode(""),Pm=h=>{const e=h.createElement("br");return e.dataset.ckeFiller=!0,e},br=7,bo=(()=>{let h="";for(let e=0;e<br;e++)h+="";return h})();function nr(h){return Un(h)&&h.data.substr(0,br)===bo}function yo(h){return h.data.length==br&&nr(h)}function nu(h){return nr(h)?h.data.slice(br):h.data}function gA(h){h.document.on("keydown",_A)}function _A(h,e){if(e.keyCode==mn.arrowleft){const o=e.domTarget.ownerDocument.defaultView.getSelection();if(o.rangeCount==1&&o.getRangeAt(0).collapsed){const c=o.getRangeAt(0).startContainer,_=o.getRangeAt(0).startOffset;nr(c)&&_<=br&&o.collapse(c,0)}}}function Rm(h,e,o,c=!1){o=o||function(j,_e){return j===_e},Array.isArray(h)||(h=Array.from(h)),Array.isArray(e)||(e=Array.from(e));const _=wA(h,e,o);return c?bA(_,e.length):vA(e,_)}function wA(h,e,o){const c=Nm(h,e,o);if(c===-1)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const _=Om(h,c),j=Om(e,c),_e=Nm(_,j,o),et=h.length-_e,nt=e.length-_e;return{firstIndex:c,lastIndexOld:et,lastIndexNew:nt}}function Nm(h,e,o){for(let c=0;c<Math.max(h.length,e.length);c++)if(h[c]===void 0||e[c]===void 0||!o(h[c],e[c]))return c;return-1}function Om(h,e){return h.slice(e).reverse()}function vA(h,e){const o=[],{firstIndex:c,lastIndexOld:_,lastIndexNew:j}=e;return j-c>0&&o.push({index:c,type:"insert",values:h.slice(c,j)}),_-c>0&&o.push({index:c+(j-c),type:"delete",howMany:_-c}),o}function bA(h,e){const{firstIndex:o,lastIndexOld:c,lastIndexNew:_}=h;if(o===-1)return Array(e).fill("equal");let j=[];return o>0&&(j=j.concat(Array(o).fill("equal"))),_-o>0&&(j=j.concat(Array(_-o).fill("insert"))),c-o>0&&(j=j.concat(Array(c-o).fill("delete"))),_<e&&(j=j.concat(Array(e-_).fill("equal"))),j}function Br(h,e,o){o=o||function(Ct,Nt){return Ct===Nt};const c=h.length,_=e.length;if(c>200||_>200||c+_>300)return Br.fastDiff(h,e,o,!0);let j,_e;if(_<c){const Ct=h;h=e,e=Ct,j="delete",_e="insert"}else j="insert",_e="delete";const et=h.length,nt=e.length,st=nt-et,at={},ct={};function dt(Ct){const Nt=(ct[Ct-1]!==void 0?ct[Ct-1]:-1)+1,Wt=ct[Ct+1]!==void 0?ct[Ct+1]:-1,tn=Nt>Wt?-1:1;at[Ct+tn]&&(at[Ct]=at[Ct+tn].slice(0)),at[Ct]||(at[Ct]=[]),at[Ct].push(Nt>Wt?j:_e);let nn=Math.max(Nt,Wt),un=nn-Ct;for(;un<et&&nn<nt&&o(h[un],e[nn]);)un++,nn++,at[Ct].push("equal");return nn}let gt=0,kt;do{for(kt=-gt;kt<st;kt++)ct[kt]=dt(kt);for(kt=st+gt;kt>st;kt--)ct[kt]=dt(kt);ct[st]=dt(st),gt++}while(ct[st]!==nt);return at[st].slice(1)}Br.fastDiff=Rm;function Mm(h,e,o){h.insertBefore(o,h.childNodes[e]||null)}function jm(h){const e=h.parentNode;e&&e.removeChild(h)}function gs(h){if(h){if(h.defaultView)return h instanceof h.defaultView.Document;if(h.ownerDocument&&h.ownerDocument.defaultView)return h instanceof h.ownerDocument.defaultView.Node}return!1}class Lm{constructor(e,o){this.domDocuments=new Set,this.domConverter=e,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this.selection=o,this.isFocused=!1,this._inlineFiller=null,this._fakeSelectionContainer=null}markToSync(e,o){if(e==="text")this.domConverter.mapViewToDom(o.parent)&&this.markedTexts.add(o);else{if(!this.domConverter.mapViewToDom(o))return;if(e==="attributes")this.markedAttributes.add(o);else if(e==="children")this.markedChildren.add(o);else throw new yt.b("view-renderer-unknown-type: Unknown type passed to Renderer.markToSync.",this)}}render(){let e;for(const o of this.markedChildren)this._updateChildrenMappings(o);this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent));for(const o of this.markedAttributes)this._updateAttrs(o);for(const o of this.markedChildren)this._updateChildren(o,{inlineFillerPosition:e});for(const o of this.markedTexts)!this.markedChildren.has(o.parent)&&this.domConverter.mapViewToDom(o.parent)&&this._updateText(o,{inlineFillerPosition:e});if(e){const o=this.domConverter.viewPositionToDom(e),c=o.parent.ownerDocument;nr(o.parent)?this._inlineFiller=o.parent:this._inlineFiller=Dm(c,o.parent,o.offset)}else this._inlineFiller=null;this._updateSelection(),this._updateFocus(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const o=this.domConverter.mapViewToDom(e);if(!o)return;const c=this.domConverter.mapViewToDom(e).childNodes,_=Array.from(this.domConverter.viewChildrenToDom(e,o.ownerDocument,{withChildren:!1})),j=this._diffNodeLists(c,_),_e=this._findReplaceActions(j,c,_);if(_e.indexOf("replace")!==-1){const et={equal:0,insert:0,delete:0};for(const nt of _e)if(nt==="replace"){const st=et.equal+et.insert,at=et.equal+et.delete,ct=e.getChild(st);ct&&!ct.is("uiElement")&&this._updateElementMappings(ct,c[at]),jm(_[st]),et.equal++}else et[nt]++}}_updateElementMappings(e,o){this.domConverter.unbindDomElement(o),this.domConverter.bindElements(o,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("text")?Ft._createBefore(this.selection.getFirstPosition().parent):e}_isSelectionInInlineFiller(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),o=this.domConverter.viewPositionToDom(e);return!!(o&&Un(o.parent)&&nr(o.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!nr(e))throw new yt.b("view-renderer-filler-was-lost: The inline filler node was lost.",this);yo(e)?e.parentNode.removeChild(e):e.data=e.data.substr(br),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),o=e.parent,c=e.offset;if(!this.domConverter.mapViewToDom(o.root)||!o.is("element")||!yA(o)||c===o.getFillerOffset())return!1;const _=e.nodeBefore,j=e.nodeAfter;return!(_ instanceof wn||j instanceof wn)}_updateText(e,o){const c=this.domConverter.findCorrespondingDomText(e),_=this.domConverter.viewToDom(e,c.ownerDocument),j=c.data;let _e=_.data;const et=o.inlineFillerPosition;if(et&&et.parent==e.parent&&et.offset==e.index&&(_e=bo+_e),j!=_e){const nt=Rm(j,_e);for(const st of nt)st.type==="insert"?c.insertData(st.index,st.values.join("")):c.deleteData(st.index,st.howMany)}}_updateAttrs(e){const o=this.domConverter.mapViewToDom(e);if(!o)return;const c=Array.from(o.attributes).map(j=>j.name),_=e.getAttributeKeys();for(const j of _)o.setAttribute(j,e.getAttribute(j));for(const j of c)e.hasAttribute(j)||o.removeAttribute(j)}_updateChildren(e,o){const c=this.domConverter.mapViewToDom(e);if(!c)return;const _=o.inlineFillerPosition,j=this.domConverter.mapViewToDom(e).childNodes,_e=Array.from(this.domConverter.viewChildrenToDom(e,c.ownerDocument,{bind:!0,inlineFillerPosition:_}));_&&_.parent===e&&Dm(c.ownerDocument,_e,_.offset);const et=this._diffNodeLists(j,_e);let nt=0;const st=new Set;for(const at of et)at==="delete"?(st.add(j[nt]),jm(j[nt])):at==="equal"&&nt++;nt=0;for(const at of et)at==="insert"?(Mm(c,nt,_e[nt]),nt++):at==="equal"&&(this._markDescendantTextToSync(this.domConverter.domToView(_e[nt])),nt++);for(const at of st)at.parentNode||this.domConverter.unbindDomElement(at)}_diffNodeLists(e,o){return e=EA(e,this._fakeSelectionContainer),Br(e,o,kA.bind(null,this.domConverter))}_findReplaceActions(e,o,c){if(e.indexOf("insert")===-1||e.indexOf("delete")===-1)return e;let _=[],j=[],_e=[];const et={equal:0,insert:0,delete:0};for(const nt of e)nt==="insert"?_e.push(c[et.equal+et.insert]):nt==="delete"?j.push(o[et.equal+et.delete]):(_=_.concat(Br(j,_e,Fm).map(st=>st==="equal"?"replace":st)),_.push("equal"),j=[],_e=[]),et[nt]++;return _.concat(Br(j,_e,Fm).map(nt=>nt==="equal"?"replace":nt))}_markDescendantTextToSync(e){if(e){if(e.is("text"))this.markedTexts.add(e);else if(e.is("element"))for(const o of e.getChildren())this._markDescendantTextToSync(o)}}_updateSelection(){if(this.selection.rangeCount===0){this._removeDomSelection(),this._removeFakeSelection();return}const e=this.domConverter.mapViewToDom(this.selection.editableElement);!this.isFocused||!e||(this.selection.isFake?this._updateFakeSelection(e):(this._removeFakeSelection(),this._updateDomSelection(e)))}_updateFakeSelection(e){const o=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=CA(o));const c=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(c,this.selection),!this._fakeSelectionNeedsUpdate(e))return;(!c.parentElement||c.parentElement!=e)&&e.appendChild(c),c.textContent=this.selection.fakeSelectionLabel||"";const _=o.getSelection(),j=o.createRange();_.removeAllRanges(),j.selectNodeContents(c),_.addRange(j)}_updateDomSelection(e){const o=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(o))return;const c=this.domConverter.viewPositionToDom(this.selection.anchor),_=this.domConverter.viewPositionToDom(this.selection.focus);e.focus(),o.collapse(c.parent,c.offset),o.extend(_.parent,_.offset),ar.isGecko&&xA(_,o)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const o=e&&this.domConverter.domSelectionToView(e);return!(o&&this.selection.isEqual(o)||!this.selection.isCollapsed&&this.selection.isSimilar(o))}_fakeSelectionNeedsUpdate(e){const o=this._fakeSelectionContainer,c=e.ownerDocument.getSelection();return!o||o.parentElement!==e||c.anchorNode!==o&&!o.contains(c.anchorNode)?!0:o.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const e of this.domDocuments)if(e.getSelection().rangeCount){const c=e.activeElement,_=this.domConverter.mapDomToView(c);c&&_&&e.getSelection().removeAllRanges()}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}}Zt(Lm,Mn);function yA(h){if(h.getAttribute("contenteditable")=="false")return!1;const e=h.findAncestor(o=>o.hasAttribute("contenteditable"));return!e||e.getAttribute("contenteditable")=="true"}function Dm(h,e,o){const c=e instanceof Array?e:e.childNodes,_=c[o];if(Un(_))return _.data=bo+_.data,_;{const j=h.createTextNode(bo);return Array.isArray(e)?c.splice(o,0,j):Mm(e,o,j),j}}function Fm(h,e){return gs(h)&&gs(e)&&!Un(h)&&!Un(e)&&h.tagName.toLowerCase()===e.tagName.toLowerCase()}function kA(h,e,o){return e===o?!0:Un(e)&&Un(o)?e.data===o.data:!!(h.isBlockFiller(e)&&h.isBlockFiller(o))}function xA(h,e){const o=h.parent;if(o.nodeType!=Node.ELEMENT_NODE||h.offset!=o.childNodes.length-1)return;const c=o.childNodes[h.offset];c&&c.tagName=="BR"&&e.addRange(e.getRangeAt(0))}function EA(h,e){const o=Array.from(h);return o.length==0||!e||o[o.length-1]==e&&o.pop(),o}function CA(h){const e=h.createElement("div");return Object.assign(e.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),e.textContent="",e}var jn={window,document};function iu(h){let e=0;for(;h.previousSibling;)h=h.previousSibling,e++;return e}function Ds(h){const e=[];for(;h&&h.nodeType!=Node.DOCUMENT_NODE;)e.unshift(h),h=h.parentNode;return e}function TA(h,e){const o=Ds(h),c=Ds(e);let _=0;for(;o[_]==c[_]&&o[_];)_++;return _===0?null:o[_-1]}const AA=Pm(document);class Fs{constructor(e,o={}){this.document=e,this.blockFillerMode=o.blockFillerMode||"br",this.preElements=["pre"],this.blockElements=["p","div","h1","h2","h3","h4","h5","h6","li","dd","dt","figcaption"],this._blockFiller=this.blockFillerMode=="br"?Pm:mA,this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap}bindFakeSelection(e,o){this._fakeSelectionMapping.set(e,new pr(o))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,o){this._domToViewMapping.set(e,o),this._viewToDomMapping.set(o,e)}unbindDomElement(e){const o=this._domToViewMapping.get(e);if(o){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(o);for(const c of Array.from(e.childNodes))this.unbindDomElement(c)}}bindDocumentFragments(e,o){this._domToViewMapping.set(e,o),this._viewToDomMapping.set(o,e)}viewToDom(e,o,c={}){if(e.is("text")){const _=this._processDataFromViewText(e);return o.createTextNode(_)}else{if(this.mapViewToDom(e))return this.mapViewToDom(e);let _;if(e.is("documentFragment"))_=o.createDocumentFragment(),c.bind&&this.bindDocumentFragments(_,e);else{if(e.is("uiElement"))return _=e.render(o),c.bind&&this.bindElements(_,e),_;e.hasAttribute("xmlns")?_=o.createElementNS(e.getAttribute("xmlns"),e.name):_=o.createElement(e.name),c.bind&&this.bindElements(_,e);for(const j of e.getAttributeKeys())_.setAttribute(j,e.getAttribute(j))}if(c.withChildren||c.withChildren===void 0)for(const j of this.viewChildrenToDom(e,o,c))_.appendChild(j);return _}}*viewChildrenToDom(e,o,c={}){const _=e.getFillerOffset&&e.getFillerOffset();let j=0;for(const _e of e.getChildren())_===j&&(yield this._blockFiller(o)),yield this.viewToDom(_e,o,c),j++;_===j&&(yield this._blockFiller(o))}viewRangeToDom(e){const o=this.viewPositionToDom(e.start),c=this.viewPositionToDom(e.end),_=document.createRange();return _.setStart(o.parent,o.offset),_.setEnd(c.parent,c.offset),_}viewPositionToDom(e){const o=e.parent;if(o.is("text")){const c=this.findCorrespondingDomText(o);if(!c)return null;let _=e.offset;return nr(c)&&(_+=br),{parent:c,offset:_}}else{let c,_,j;if(e.offset===0){if(c=this.mapViewToDom(o),!c)return null;j=c.childNodes[0]}else{const et=e.nodeBefore;if(_=et.is("text")?this.findCorrespondingDomText(et):this.mapViewToDom(e.nodeBefore),!_)return null;c=_.parentNode,j=_.nextSibling}if(Un(j)&&nr(j))return{parent:j,offset:br};const _e=_?iu(_)+1:0;return{parent:c,offset:_e}}}domToView(e,o={}){if(this.isBlockFiller(e,this.blockFillerMode))return null;const c=this.getParentUIElement(e,this._domToViewMapping);if(c)return c;if(Un(e)){if(yo(e))return null;{const _=this._processDataFromDomText(e);return _===""?null:new wn(this.document,_)}}else{if(this.isComment(e))return null;{if(this.mapDomToView(e))return this.mapDomToView(e);let _;if(this.isDocumentFragment(e))_=new ms(this.document),o.bind&&this.bindDocumentFragments(e,_);else{const j=o.keepOriginalCase?e.tagName:e.tagName.toLowerCase();_=new fr(this.document,j),o.bind&&this.bindElements(e,_);const _e=e.attributes;for(let et=_e.length-1;et>=0;et--)_._setAttribute(_e[et].name,_e[et].value)}if(o.withChildren||o.withChildren===void 0)for(const j of this.domChildrenToView(e,o))_._appendChild(j);return _}}}*domChildrenToView(e,o={}){for(let c=0;c<e.childNodes.length;c++){const _=e.childNodes[c],j=this.domToView(_,o);j!==null&&(yield j)}}domSelectionToView(e){if(e.rangeCount===1){let _=e.getRangeAt(0).startContainer;Un(_)&&(_=_.parentNode);const j=this.fakeSelectionToView(_);if(j)return j}const o=this.isDomSelectionBackward(e),c=[];for(let _=0;_<e.rangeCount;_++){const j=e.getRangeAt(_),_e=this.domRangeToView(j);_e&&c.push(_e)}return new pr(c,{backward:o})}domRangeToView(e){const o=this.domPositionToView(e.startContainer,e.startOffset),c=this.domPositionToView(e.endContainer,e.endOffset);return o&&c?new Jt(o,c):null}domPositionToView(e,o){if(this.isBlockFiller(e,this.blockFillerMode))return this.domPositionToView(e.parentNode,iu(e));const c=this.mapDomToView(e);if(c&&c.is("uiElement"))return Ft._createBefore(c);if(Un(e)){if(yo(e))return this.domPositionToView(e.parentNode,iu(e));const _=this.findCorrespondingViewText(e);let j=o;return _?(nr(e)&&(j-=br,j=j<0?0:j),new Ft(_,j)):null}else{if(o===0){const _=this.mapDomToView(e);if(_)return new Ft(_,0)}else{const _=e.childNodes[o-1],j=Un(_)?this.findCorrespondingViewText(_):this.mapDomToView(_);if(j&&j.parent)return new Ft(j.parent,j.index+1)}return null}}mapDomToView(e){return this.getParentUIElement(e)||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(yo(e))return null;const o=this.getParentUIElement(e);if(o)return o;const c=e.previousSibling;if(c){if(!this.isElement(c))return null;const _=this.mapDomToView(c);if(_)return _.nextSibling instanceof wn?_.nextSibling:null}else{const _=this.mapDomToView(e.parentNode);if(_){const j=_.getChild(0);return j instanceof wn?j:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const o=e.previousSibling;return o&&this.mapViewToDom(o)?this.mapViewToDom(o).nextSibling:!o&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const o=this.mapViewToDom(e);if(o&&o.ownerDocument.activeElement!==o){const{scrollX:c,scrollY:_}=jn.window,j=[];Bm(o,_e=>{const{scrollLeft:et,scrollTop:nt}=_e;j.push([et,nt])}),o.focus(),Bm(o,_e=>{const[et,nt]=j.shift();_e.scrollLeft=et,_e.scrollTop=nt}),jn.window.scrollTo(c,_)}}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(e){return e&&e.nodeType==Node.COMMENT_NODE}isBlockFiller(e){return this.blockFillerMode=="br"?e.isEqualNode(AA):e.tagName==="BR"&&zm(e,this.blockElements)&&e.parentNode.childNodes.length===1?!0:SA(e,this.blockElements)}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const o=document.createRange();o.setStart(e.anchorNode,e.anchorOffset),o.setEnd(e.focusNode,e.focusOffset);const c=o.collapsed;return o.detach(),c}getParentUIElement(e){const o=Ds(e);for(o.pop();o.length;){const c=o.pop(),_=this._domToViewMapping.get(c);if(_&&_.is("uiElement"))return _}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}_isDomSelectionPositionCorrect(e,o){if(Un(e)&&nr(e)&&o<br||this.isElement(e)&&nr(e.childNodes[o]))return!1;const c=this.mapDomToView(e);return!(c&&c.is("uiElement"))}_processDataFromViewText(e){let o=e.data;if(e.getAncestors().some(c=>this.preElements.includes(c.name)))return o;if(o.charAt(0)==" "){const c=this._getTouchingViewTextNode(e,!1);(c&&this._nodeEndsWithSpace(c)||!c)&&(o=""+o.substr(1))}if(o.charAt(o.length-1)==" "){const c=this._getTouchingViewTextNode(e,!0);(o.charAt(o.length-2)==" "||!c||c.data.charAt(0)==" ")&&(o=o.substr(0,o.length-1)+"")}return o.replace(/ {2}/g," ")}_nodeEndsWithSpace(e){if(e.getAncestors().some(c=>this.preElements.includes(c.name)))return!1;const o=this._processDataFromViewText(e);return o.charAt(o.length-1)==" "}_processDataFromDomText(e){let o=e.data;if(ru(e,this.preElements))return nu(e);o=o.replace(/[ \n\t\r]{1,}/g," ");const c=this._getTouchingInlineDomNode(e,!1),_=this._getTouchingInlineDomNode(e,!0),j=this._checkShouldLeftTrimDomText(c),_e=this._checkShouldRightTrimDomText(e,_);return j&&(o=o.replace(/^ /,"")),_e&&(o=o.replace(/ $/,"")),o=nu(new Text(o)),o=o.replace(/ \u00A0/g,"  "),(/( |\u00A0)\u00A0$/.test(o)||!_||_.data&&_.data.charAt(0)==" ")&&(o=o.replace(/\u00A0$/," ")),j&&(o=o.replace(/^\u00A0/," ")),o}_checkShouldLeftTrimDomText(e){return!e||Cr(e)?!0:/[^\S\u00A0]/.test(e.data.charAt(e.data.length-1))}_checkShouldRightTrimDomText(e,o){return o?!1:!nr(e)}_getTouchingViewTextNode(e,o){const c=new Xr({startPosition:o?Ft._createAfter(e):Ft._createBefore(e),direction:o?"forward":"backward"});for(const _ of c){if(_.item.is("containerElement"))return null;if(_.item.is("br"))return null;if(_.item.is("textProxy"))return _.item}return null}_getTouchingInlineDomNode(e,o){if(!e.parentNode)return null;const c=o?"nextNode":"previousNode",_=e.ownerDocument,j=Ds(e)[0],_e=_.createTreeWalker(j,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode(nt){return Un(nt)||nt.tagName=="BR"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});_e.currentNode=e;const et=_e[c]();if(et!==null){const nt=TA(e,et);if(nt&&!ru(e,this.blockElements,nt)&&!ru(et,this.blockElements,nt))return et}return null}}function ru(h,e,o){let c=Ds(h);return o&&(c=c.slice(c.indexOf(o)+1)),c.some(_=>_.tagName&&e.includes(_.tagName.toLowerCase()))}function Bm(h,e){for(;h&&h!=jn.document;)e(h),h=h.parentNode}function SA(h,e){return Un(h)&&h.data==""&&zm(h,e)&&h.parentNode.childNodes.length===1}function zm(h,e){const o=h.parentNode;return o&&o.tagName&&e.includes(o.tagName.toLowerCase())}function ko(h){const e=Object.prototype.toString.apply(h);return e=="[object Window]"||e=="[object global]"}var Bs=fs({},xn,{listenTo(h,...e){if(gs(h)||ko(h)){const o=this._getProxyEmitter(h)||new su(h);o.attach(...e),h=o}xn.listenTo.call(this,h,...e)},stopListening(h,e,o){if(gs(h)||ko(h)){const c=this._getProxyEmitter(h);if(!c)return;h=c}xn.stopListening.call(this,h,e,o),h instanceof su&&h.detach(e)},_getProxyEmitter(h){return rT(this,Vm(h))}});class su{constructor(e){Hp(this,Vm(e)),this._domNode=e}}fs(su.prototype,xn,{attach(h,e,o={}){if(this._domListeners&&this._domListeners[h])return;const c=this._createDomListener(h,!!o.useCapture);this._domNode.addEventListener(h,c,!!o.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[h]=c},detach(h){let e;this._domListeners[h]&&(!(e=this._events[h])||!e.callbacks.length)&&this._domListeners[h].removeListener()},_createDomListener(h,e){const o=c=>{this.fire(h,c)};return o.removeListener=()=>{this._domNode.removeEventListener(h,o,e),delete this._domListeners[h]},o}});function Vm(h){return h["data-ck-expando"]||(h["data-ck-expando"]=Tr())}class zr{constructor(e){this.view=e,this.document=e.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}}Zt(zr,Bs);var IA="__lodash_hash_undefined__";function PA(h){return this.__data__.set(h,IA),this}var RA=PA;function NA(h){return this.__data__.has(h)}var OA=NA;function xo(h){var e=-1,o=h==null?0:h.length;for(this.__data__=new ro;++e<o;)this.add(h[e])}xo.prototype.add=xo.prototype.push=RA,xo.prototype.has=OA;var MA=xo;function jA(h,e){for(var o=-1,c=h==null?0:h.length;++o<c;)if(e(h[o],o,h))return!0;return!1}var LA=jA;function DA(h,e){return h.has(e)}var FA=DA,BA=1,zA=2;function VA(h,e,o,c,_,j){var _e=o&BA,et=h.length,nt=e.length;if(et!=nt&&!(_e&&nt>et))return!1;var st=j.get(h);if(st&&j.get(e))return st==e;var at=-1,ct=!0,dt=o&zA?new MA:void 0;for(j.set(h,e),j.set(e,h);++at<et;){var gt=h[at],kt=e[at];if(c)var Ct=_e?c(kt,gt,at,e,h,j):c(gt,kt,at,h,e,j);if(Ct!==void 0){if(Ct)continue;ct=!1;break}if(dt){if(!LA(e,function(Nt,Wt){if(!FA(dt,Wt)&&(gt===Nt||_(gt,Nt,o,c,j)))return dt.push(Wt)})){ct=!1;break}}else if(!(gt===kt||_(gt,kt,o,c,j))){ct=!1;break}}return j.delete(h),j.delete(e),ct}var $m=VA;function $A(h){var e=-1,o=Array(h.size);return h.forEach(function(c,_){o[++e]=[_,c]}),o}var UA=$A;function WA(h){var e=-1,o=Array(h.size);return h.forEach(function(c){o[++e]=c}),o}var HA=WA,GA=1,qA=2,KA="[object Boolean]",YA="[object Date]",QA="[object Error]",JA="[object Map]",XA="[object Number]",ZA="[object RegExp]",eS="[object Set]",tS="[object String]",nS="[object Symbol]",iS="[object ArrayBuffer]",rS="[object DataView]",Um=b?b.prototype:void 0,ou=Um?Um.valueOf:void 0;function sS(h,e,o,c,_,j,_e){switch(o){case rS:if(h.byteLength!=e.byteLength||h.byteOffset!=e.byteOffset)return!1;h=h.buffer,e=e.buffer;case iS:return!(h.byteLength!=e.byteLength||!j(new ao(h),new ao(e)));case KA:case YA:case XA:return Qt(+h,+e);case QA:return h.name==e.name&&h.message==e.message;case ZA:case tS:return h==e+"";case JA:var et=UA;case eS:var nt=c&GA;if(et||(et=HA),h.size!=e.size&&!nt)return!1;var st=_e.get(h);if(st)return st==e;c|=qA,_e.set(h,e);var at=$m(et(h),et(e),c,_,j,_e);return _e.delete(h),at;case nS:if(ou)return ou.call(h)==ou.call(e)}return!1}var oS=sS,aS=1,lS=Object.prototype,cS=lS.hasOwnProperty;function uS(h,e,o,c,_,j){var _e=o&aS,et=Pl(h),nt=et.length,st=Pl(e),at=st.length;if(nt!=at&&!_e)return!1;for(var ct=nt;ct--;){var dt=et[ct];if(!(_e?dt in e:cS.call(e,dt)))return!1}var gt=j.get(h);if(gt&&j.get(e))return gt==e;var kt=!0;j.set(h,e),j.set(e,h);for(var Ct=_e;++ct<nt;){dt=et[ct];var Nt=h[dt],Wt=e[dt];if(c)var tn=_e?c(Wt,Nt,dt,e,h,j):c(Nt,Wt,dt,h,e,j);if(!(tn===void 0?Nt===Wt||_(Nt,Wt,o,c,j):tn)){kt=!1;break}Ct||(Ct=dt=="constructor")}if(kt&&!Ct){var nn=h.constructor,un=e.constructor;nn!=un&&"constructor"in h&&"constructor"in e&&!(typeof nn=="function"&&nn instanceof nn&&typeof un=="function"&&un instanceof un)&&(kt=!1)}return j.delete(h),j.delete(e),kt}var dS=uS,hS=1,Wm="[object Arguments]",Hm="[object Array]",Eo="[object Object]",fS=Object.prototype,Gm=fS.hasOwnProperty;function pS(h,e,o,c,_,j){var _e=Kn(h),et=Kn(e),nt=_e?Hm:Os(h),st=et?Hm:Os(e);nt=nt==Wm?Eo:nt,st=st==Wm?Eo:st;var at=nt==Eo,ct=st==Eo,dt=nt==st;if(dt&&Object(Rs.a)(h)){if(!Object(Rs.a)(e))return!1;_e=!0,at=!1}if(dt&&!at)return j||(j=new Ps),_e||Tl(h)?$m(h,e,o,c,_,j):oS(h,e,nt,o,c,_,j);if(!(o&hS)){var gt=at&&Gm.call(h,"__wrapped__"),kt=ct&&Gm.call(e,"__wrapped__");if(gt||kt){var Ct=gt?h.value():h,Nt=kt?e.value():e;return j||(j=new Ps),_(Ct,Nt,o,c,j)}}return dt?(j||(j=new Ps),dS(h,e,o,c,_,j)):!1}var mS=pS;function qm(h,e,o,c,_){return h===e?!0:h==null||e==null||!Lt(h)&&!Lt(e)?h!==h&&e!==e:mS(h,e,o,c,qm,_)}var Km=qm;function gS(h,e,o){o=typeof o=="function"?o:void 0;var c=o?o(h,e):void 0;return c===void 0?Km(h,e,void 0,o):!!c}var _S=gS;class Ym extends zr{constructor(e){super(e),this._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},this.domConverter=e.domConverter,this.renderer=e._renderer,this._domElements=[],this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.push(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(e.length===0)return;const o=this.domConverter,c=new Map,_=new Set;for(const st of e)if(st.type==="childList"){const at=o.mapDomToView(st.target);if(at&&at.is("uiElement"))continue;at&&!this._isBogusBrMutation(st)&&_.add(at)}for(const st of e){const at=o.mapDomToView(st.target);if(!(at&&at.is("uiElement"))&&st.type==="characterData"){const ct=o.findCorrespondingViewText(st.target);ct&&!_.has(ct.parent)?c.set(ct,{type:"text",oldText:ct.data,newText:nu(st.target),node:ct}):!ct&&nr(st.target)&&_.add(o.mapDomToView(st.target.parentNode))}}const j=[];for(const st of c.values())this.renderer.markToSync("text",st.node),j.push(st);for(const st of _){const at=o.mapViewToDom(st),ct=Array.from(st.getChildren()),dt=Array.from(o.domChildrenToView(at,{withChildren:!1}));_S(ct,dt,nt)||(this.renderer.markToSync("children",st),j.push({type:"children",oldChildren:ct,newChildren:dt,node:st}))}const _e=e[0].target.ownerDocument.getSelection();let et=null;if(_e&&_e.anchorNode){const st=o.domPositionToView(_e.anchorNode,_e.anchorOffset),at=o.domPositionToView(_e.focusNode,_e.focusOffset);st&&at&&(et=new pr(st),et.setFocus(at))}j.length&&(this.document.fire("mutations",j,et),this.view.forceRender());function nt(st,at){if(!Array.isArray(st))return st===at?!0:st.is("text")&&at.is("text")?st.data===at.data:!1}}_isBogusBrMutation(e){let o=null;return e.nextSibling===null&&e.removedNodes.length===0&&e.addedNodes.length==1&&(o=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),o&&o.is("element","br")}}class au{constructor(e,o,c){this.view=e,this.document=e.document,this.domEvent=o,this.domTarget=o.target,fs(this,c)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class Vr extends zr{constructor(e){super(e),this.useCapture=!1}observe(e){(typeof this.domEventType=="string"?[this.domEventType]:this.domEventType).forEach(c=>{this.listenTo(e,c,(_,j)=>{this.isEnabled&&this.onDomEvent(j)},{useCapture:this.useCapture})})}fire(e,o,c){this.isEnabled&&this.document.fire(e,new au(this.view,o,c))}}class wS extends Vr{constructor(e){super(e),this.domEventType=["keydown","keyup"]}onDomEvent(e){this.fire(e.type,e,{keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey||e.metaKey,shiftKey:e.shiftKey,get keystroke(){return Ir(this)}})}}var vS=function(){return d.a.Date.now()},lu=vS,Qm=NaN,bS=/^\s+|\s+$/g,yS=/^[-+]0x[0-9a-f]+$/i,kS=/^0b[01]+$/i,xS=/^0o[0-7]+$/i,ES=parseInt;function CS(h){if(typeof h=="number")return h;if(uo(h))return Qm;if(In(h)){var e=typeof h.valueOf=="function"?h.valueOf():h;h=In(e)?e+"":e}if(typeof h!="string")return h===0?h:+h;h=h.replace(bS,"");var o=kS.test(h);return o||xS.test(h)?ES(h.slice(2),o?2:8):yS.test(h)?Qm:+h}var Jm=CS,TS="Expected a function",AS=Math.max,SS=Math.min;function IS(h,e,o){var c,_,j,_e,et,nt,st=0,at=!1,ct=!1,dt=!0;if(typeof h!="function")throw new TypeError(TS);e=Jm(e)||0,In(o)&&(at=!!o.leading,ct="maxWait"in o,j=ct?AS(Jm(o.maxWait)||0,e):j,dt="trailing"in o?!!o.trailing:dt);function gt(Cn){var Vn=c,eo=_;return c=_=void 0,st=Cn,_e=h.apply(eo,Vn),_e}function kt(Cn){return st=Cn,et=setTimeout(Wt,e),at?gt(Cn):_e}function Ct(Cn){var Vn=Cn-nt,eo=Cn-st,$y=e-Vn;return ct?SS($y,j-eo):$y}function Nt(Cn){var Vn=Cn-nt,eo=Cn-st;return nt===void 0||Vn>=e||Vn<0||ct&&eo>=j}function Wt(){var Cn=lu();if(Nt(Cn))return tn(Cn);et=setTimeout(Wt,Ct(Cn))}function tn(Cn){return et=void 0,dt&&c?gt(Cn):(c=_=void 0,_e)}function nn(){et!==void 0&&clearTimeout(et),st=0,c=nt=_=et=void 0}function un(){return et===void 0?_e:tn(lu())}function rr(){var Cn=lu(),Vn=Nt(Cn);if(c=arguments,_=this,nt=Cn,Vn){if(et===void 0)return kt(nt);if(ct)return clearTimeout(et),et=setTimeout(Wt,e),gt(nt)}return et===void 0&&(et=setTimeout(Wt,e)),_e}return rr.cancel=nn,rr.flush=un,rr}var Xm=IS;class PS extends zr{constructor(e){super(e),this._fireSelectionChangeDoneDebounced=Xm(o=>this.document.fire("selectionChangeDone",o),200)}observe(){const e=this.document;e.on("keydown",(o,c)=>{e.selection.isFake&&RS(c.keyCode)&&this.isEnabled&&(c.preventDefault(),this._handleSelectionMove(c.keyCode))},{priority:"lowest"})}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const o=this.document.selection,c=new pr(o.getRanges(),{backward:o.isBackward,fake:!1});(e==mn.arrowleft||e==mn.arrowup)&&c.setTo(c.getFirstPosition()),(e==mn.arrowright||e==mn.arrowdown)&&c.setTo(c.getLastPosition());const _={oldSelection:o,newSelection:c,domSelection:null};this.document.fire("selectionChange",_),this._fireSelectionChangeDoneDebounced(_)}}function RS(h){return h==mn.arrowright||h==mn.arrowleft||h==mn.arrowup||h==mn.arrowdown}class NS extends zr{constructor(e){super(e),this.mutationObserver=e.getObserver(Ym),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=Xm(o=>this.document.fire("selectionChangeDone",o),200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._loopbackCounter=0}observe(e){const o=e.ownerDocument;this._documents.has(o)||(this.listenTo(o,"selectionchange",()=>{this._handleSelectionChange(o)}),this._documents.add(o))}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionChange(e){if(!this.isEnabled)return;this.mutationObserver.flush();const o=e.defaultView.getSelection(),c=this.domConverter.domSelectionToView(o);if(c.rangeCount!=0&&!(this.selection.isEqual(c)&&this.domConverter.isDomSelectionCorrect(o))&&!(++this._loopbackCounter>60))if(this.selection.isSimilar(c))this.view.forceRender();else{const _={oldSelection:this.selection,newSelection:c,domSelection:o};this.document.fire("selectionChange",_),this._fireSelectionChangeDoneDebounced(_)}}_clearInfiniteLoop(){this._loopbackCounter=0}}class OS extends Vr{constructor(e){super(e),this.domEventType=["focus","blur"],this.useCapture=!0;const o=this.document;o.on("focus",()=>{o.isFocused=!0,this._renderTimeoutId=setTimeout(()=>e.forceRender(),50)}),o.on("blur",(c,_)=>{const j=o.selection.editableElement;(j===null||j===_.target)&&(o.isFocused=!1,e.forceRender())})}onDomEvent(e){this.fire(e.type,e)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}class MS extends Vr{constructor(e){super(e),this.domEventType=["compositionstart","compositionupdate","compositionend"];const o=this.document;o.on("compositionstart",()=>{o.isComposing=!0}),o.on("compositionend",()=>{o.isComposing=!1})}onDomEvent(e){this.fire(e.type,e)}}class jS extends Vr{constructor(e){super(e),this.domEventType=["beforeinput"]}onDomEvent(e){this.fire(e.type,e)}}function Co(h){return Object.prototype.toString.apply(h)=="[object Range]"}function Zm(h){const e=h.ownerDocument.defaultView.getComputedStyle(h);return{top:parseInt(e.borderTopWidth,10),right:parseInt(e.borderRightWidth,10),bottom:parseInt(e.borderBottomWidth,10),left:parseInt(e.borderLeftWidth,10)}}const _g=["top","right","bottom","left","width","height"];class Rn{constructor(e){const o=Co(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),Cr(e)||o)o?To(this,Rn.getDomRangeRects(e)[0]):To(this,e.getBoundingClientRect());else if(ko(e)){const{innerWidth:c,innerHeight:_}=e;To(this,{top:0,right:c,bottom:_,left:0,width:c,height:_})}else To(this,e)}clone(){return new Rn(this)}moveTo(e,o){return this.top=o,this.right=e+this.width,this.bottom=o+this.height,this.left=e,this}moveBy(e,o){return this.top+=o,this.right+=e,this.left+=e,this.bottom+=o,this}getIntersection(e){const o={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left)};return o.width=o.right-o.left,o.height=o.bottom-o.top,o.width<0||o.height<0?null:new Rn(o)}getIntersectionArea(e){const o=this.getIntersection(e);return o?o.getArea():0}getArea(){return this.width*this.height}getVisible(){const e=this._source;let o=this.clone();if(!e_(e)){let c=e.parentNode||e.commonAncestorContainer;for(;c&&!e_(c);){const _=new Rn(c),j=o.getIntersection(_);if(j)j.getArea()<o.getArea()&&(o=j);else return null;c=c.parentNode}}return o}isEqual(e){for(const o of _g)if(this[o]!==e[o])return!1;return!0}contains(e){const o=this.getIntersection(e);return!!(o&&o.isEqual(e))}excludeScrollbarsAndBorders(){const e=this._source;let o,c,_;if(ko(e))o=e.innerWidth-e.document.documentElement.clientWidth,c=e.innerHeight-e.document.documentElement.clientHeight,_=e.getComputedStyle(e.document.documentElement).direction;else{const j=Zm(this._source);o=e.offsetWidth-e.clientWidth-j.left-j.right,c=e.offsetHeight-e.clientHeight-j.top-j.bottom,_=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=j.left,this.top+=j.top,this.right-=j.right,this.bottom-=j.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=o,_==="ltr"?this.right-=o:this.left+=o,this.height-=c,this.bottom-=c,this}static getDomRangeRects(e){const o=[],c=Array.from(e.getClientRects());if(c.length)for(const _ of c)o.push(new Rn(_));else{let _=e.startContainer;Un(_)&&(_=_.parentNode);const j=new Rn(_.getBoundingClientRect());j.right=j.left,j.width=0,o.push(j)}return o}}function To(h,e){for(const o of _g)h[o]=e[o]}function e_(h){return Cr(h)?h===h.ownerDocument.body:!1}const LS={};function t_({target:h,viewportOffset:e=0}){const o=cu(h);let c=o,_=null;for(;c;){let j;c==o?j=uu(h):j=uu(_),n_(j,()=>a_(h,c));const _e=a_(h,c);if(FS(c,_e,e),c.parent!=c){if(_=c.frameElement,c=c.parent,!_)return}else c=null}}function DS(h){const e=uu(h);n_(e,()=>new Rn(h))}Object.assign(LS,{scrollViewportToShowTarget:t_,scrollAncestorsToShowTarget:DS});function FS(h,e,o){const c=e.clone().moveBy(0,o),_=e.clone().moveBy(0,-o),j=new Rn(h).excludeScrollbarsAndBorders();if(![_,c].every(et=>j.contains(et))){let{scrollX:et,scrollY:nt}=h;r_(_,j)?nt-=j.top-e.top+o:i_(c,j)&&(nt+=e.bottom-j.bottom+o),s_(e,j)?et-=j.left-e.left+o:o_(e,j)&&(et+=e.right-j.right+o),h.scrollTo(et,nt)}}function n_(h,e){const o=cu(h);let c,_;for(;h!=o.document.body;)_=e(),c=new Rn(h).excludeScrollbarsAndBorders(),c.contains(_)||(r_(_,c)?h.scrollTop-=c.top-_.top:i_(_,c)&&(h.scrollTop+=_.bottom-c.bottom),s_(_,c)?h.scrollLeft-=c.left-_.left:o_(_,c)&&(h.scrollLeft+=_.right-c.right)),h=h.parentNode}function i_(h,e){return h.bottom>e.bottom}function r_(h,e){return h.top<e.top}function s_(h,e){return h.left<e.left}function o_(h,e){return h.right>e.right}function cu(h){return Co(h)?h.startContainer.ownerDocument.defaultView:h.ownerDocument.defaultView}function uu(h){if(Co(h)){let e=h.commonAncestorContainer;return Un(e)&&(e=e.parentNode),e}else return h.parentNode}function a_(h,e){const o=cu(h),c=new Rn(h);if(o===e)return c;{let _=o;for(;_!=e;){const j=_.frameElement,_e=new Rn(j).excludeScrollbarsAndBorders();c.moveBy(_e.left,_e.top),_=_.parent}}return c}class l_{constructor(e){this.document=new vo(e),this.domConverter=new Fs(this.document),this.domRoots=new Map,this.set("isRenderingInProgress",!1),this._renderer=new Lm(this.domConverter,this.document.selection),this._renderer.bind("isFocused").to(this.document),this._initialDomRootAttributes=new WeakMap,this._observers=new Map,this._ongoingChange=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._hasChangedSinceTheLastRendering=!1,this._writer=new Em(this.document),this.addObserver(Ym),this.addObserver(NS),this.addObserver(OS),this.addObserver(wS),this.addObserver(PS),this.addObserver(MS),ar.isAndroid&&this.addObserver(jS),gA(this),lA(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0})}attachDomRoot(e,o="main"){const c=this.document.getRoot(o);c._name=e.tagName.toLowerCase();const _={};for(const{name:_e,value:et}of Array.from(e.attributes))_[_e]=et,_e==="class"?this._writer.addClass(et.split(" "),c):this._writer.setAttribute(_e,et,c);this._initialDomRootAttributes.set(e,_);const j=()=>{this._writer.setAttribute("contenteditable",!c.isReadOnly,c),c.isReadOnly?this._writer.addClass("ck-read-only",c):this._writer.removeClass("ck-read-only",c)};j(),this.domRoots.set(o,e),this.domConverter.bindElements(e,c),this._renderer.markToSync("children",c),this._renderer.markToSync("attributes",c),this._renderer.domDocuments.add(e.ownerDocument),c.on("change:children",(_e,et)=>this._renderer.markToSync("children",et)),c.on("change:attributes",(_e,et)=>this._renderer.markToSync("attributes",et)),c.on("change:text",(_e,et)=>this._renderer.markToSync("text",et)),c.on("change:isReadOnly",()=>this.change(j)),c.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const _e of this._observers.values())_e.observe(e,o)}detachDomRoot(e){const o=this.domRoots.get(e);Array.from(o.attributes).forEach(({name:_})=>o.removeAttribute(_));const c=this._initialDomRootAttributes.get(o);for(const _ in c)o.setAttribute(_,c[_]);this.domRoots.delete(e),this.domConverter.unbindDomElement(o)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let o=this._observers.get(e);if(o)return o;o=new e(this),this._observers.set(e,o);for(const[c,_]of this.domRoots)o.observe(_,c);return o.enable(),o}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection(){const e=this.document.selection.getFirstRange();e&&t_({target:this.domConverter.viewRangeToDom(e),viewportOffset:20})}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new yt.b("cannot-change-view-tree: Attempting to make changes to the view when it is in an incorrect state: rendering or post-fixers are in progress. This may cause some unexpected behavior and inconsistency between the DOM and the view.",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const o=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),o}catch(o){yt.b.rethrowUnexpectedError(o,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.change(()=>{})}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,o){return Ft._createAt(e,o)}createPositionAfter(e){return Ft._createAfter(e)}createPositionBefore(e){return Ft._createBefore(e)}createRange(e,o){return new Jt(e,o)}createRangeOn(e){return Jt._createOn(e)}createRangeIn(e){return Jt._createIn(e)}createSelection(e,o,c){return new pr(e,o,c)}_disableRendering(e){this._renderingDisabled=e,e==!1&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}Zt(l_,Mn);class Zr{constructor(e){this.parent=null,this._attrs=Fr(e)}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))===null)throw new yt.b("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return e}get startOffset(){let e;if(!this.parent)return null;if((e=this.parent.getChildStartOffset(this))===null)throw new yt.b("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return e}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let o=this;for(;o.parent;)e.unshift(o.startOffset),o=o.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const o=[];let c=e.includeSelf?this:this.parent;for(;c;)o[e.parentFirst?"push":"unshift"](c),c=c.parent;return o}getCommonAncestor(e,o={}){const c=this.getAncestors(o),_=e.getAncestors(o);let j=0;for(;c[j]==_[j]&&c[j];)j++;return j===0?null:c[j-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const o=this.getPath(),c=e.getPath(),_=Yn(o,c);switch(_){case"prefix":return!0;case"extension":return!1;default:return o[_]<c[_]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce((o,c)=>(o[c[0]]=c[1],o),{})),e}is(e){return e=="node"||e=="model:node"}_clone(){return new Zr(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,o){this._attrs.set(e,o)}_setAttributesTo(e){this._attrs=Fr(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}}class gn extends Zr{constructor(e,o){super(o),this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}is(e){return e=="text"||e=="model:text"||super.is(e)}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new gn(this.data,this.getAttributes())}static fromJSON(e){return new gn(e.data,e.attributes)}}class yr{constructor(e,o,c){if(this.textNode=e,o<0||o>e.offsetSize)throw new yt.b("model-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(c<0||o+c>e.offsetSize)throw new yt.b("model-textproxy-wrong-length: Given length value is incorrect.",this);this.data=e.data.substring(o,o+c),this.offsetInText=o}get startOffset(){return this.textNode.startOffset!==null?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return this.startOffset!==null?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}is(e){return e=="textProxy"||e=="model:textProxy"}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const o=[];let c=e.includeSelf?this:this.parent;for(;c;)o[e.parentFirst?"push":"unshift"](c),c=c.parent;return o}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}class _s{constructor(e){this._nodes=[],e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((e,o)=>e+o.offsetSize,0)}getNode(e){return this._nodes[e]||null}getNodeIndex(e){const o=this._nodes.indexOf(e);return o==-1?null:o}getNodeStartOffset(e){const o=this.getNodeIndex(e);return o===null?null:this._nodes.slice(0,o).reduce((c,_)=>c+_.offsetSize,0)}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const o=this._nodes[e];if(!o)throw new yt.b("model-nodelist-index-out-of-bounds: Given index cannot be found in the node list.",this);return this.getNodeStartOffset(o)}offsetToIndex(e){let o=0;for(const c of this._nodes){if(e>=o&&e<o+c.offsetSize)return this.getNodeIndex(c);o+=c.offsetSize}if(o!=e)throw new yt.b("model-nodelist-offset-out-of-bounds: Given offset cannot be found in the node list.",this,{offset:e,nodeList:this});return this.length}_insertNodes(e,o){for(const c of o)if(!(c instanceof Zr))throw new yt.b("model-nodelist-insertNodes-not-node: Trying to insert an object which is not a Node instance.",this);this._nodes.splice(e,0,...o)}_removeNodes(e,o=1){return this._nodes.splice(e,o)}toJSON(){return this._nodes.map(e=>e.toJSON())}}class vn extends Zr{constructor(e,o,c){super(o),this.name=e,this._children=new _s,c&&this._insertChild(0,c)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}is(e,o=null){const c=e.replace(/^model:/,"");return o?c=="element"&&o==this.name:c=="element"||c==this.name||super.is(e)}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let o=this;for(const c of e)o=o.getChild(o.offsetToIndex(c));return o}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const o of this._children)e.children.push(o.toJSON())}return e}_clone(e=!1){const o=e?Array.from(this._children).map(c=>c._clone(!0)):null;return new vn(this.name,this.getAttributes(),o)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,o){const c=BS(o);for(const _ of c)_.parent!==null&&_._remove(),_.parent=this;this._children._insertNodes(e,c)}_removeChildren(e,o=1){const c=this._children._removeNodes(e,o);for(const _ of c)_.parent=null;return c}static fromJSON(e){let o=null;if(e.children){o=[];for(const c of e.children)c.name?o.push(vn.fromJSON(c)):o.push(gn.fromJSON(c))}return new vn(e.name,e.attributes,o)}}function BS(h){return typeof h=="string"?[new gn(h)]:(hr(h)||(h=[h]),Array.from(h).map(e=>typeof e=="string"?new gn(e):e instanceof yr?new gn(e.data,e.getAttributes()):e))}class Pr{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new yt.b("model-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);const o=e.direction||"forward";if(o!="forward"&&o!="backward")throw new yt.b("model-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",e,{direction:o});this.direction=o,this.boundaries=e.boundaries||null,e.startPosition?this.position=e.startPosition.clone():this.position=Mt._createAt(this.boundaries[this.direction=="backward"?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(e){let o,c,_,j;do _=this.position,j=this._visitedParent,{done:o,value:c}=this.next();while(!o&&e(c));o||(this.position=_,this._visitedParent=j)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){const e=this.position,o=this.position.clone(),c=this._visitedParent;if(c.parent===null&&o.offset===c.maxOffset)return{done:!0};if(c===this._boundaryEndParent&&o.offset==this.boundaries.end.offset)return{done:!0};const _=o.textNode?o.textNode:o.nodeAfter;if(_ instanceof vn)return this.shallow?o.offset++:(o.path.push(0),this._visitedParent=_),this.position=o,es("elementStart",_,e,o,1);if(_ instanceof gn){let j;if(this.singleCharacters)j=1;else{let nt=_.endOffset;this._boundaryEndParent==c&&this.boundaries.end.offset<nt&&(nt=this.boundaries.end.offset),j=nt-o.offset}const _e=o.offset-_.startOffset,et=new yr(_,_e,j);return o.offset+=j,this.position=o,es("text",et,e,o,j)}else return o.path.pop(),o.offset++,this.position=o,this._visitedParent=c.parent,this.ignoreElementEnd?this._next():es("elementEnd",c,e,o)}_previous(){const e=this.position,o=this.position.clone(),c=this._visitedParent;if(c.parent===null&&o.offset===0)return{done:!0};if(c==this._boundaryStartParent&&o.offset==this.boundaries.start.offset)return{done:!0};const _=o.textNode?o.textNode:o.nodeBefore;if(_ instanceof vn)return o.offset--,this.shallow?(this.position=o,es("elementStart",_,e,o,1)):(o.path.push(_.maxOffset),this.position=o,this._visitedParent=_,this.ignoreElementEnd?this._previous():es("elementEnd",_,e,o));if(_ instanceof gn){let j;if(this.singleCharacters)j=1;else{let nt=_.startOffset;this._boundaryStartParent==c&&this.boundaries.start.offset>nt&&(nt=this.boundaries.start.offset),j=o.offset-nt}const _e=o.offset-_.startOffset,et=new yr(_,_e-j,j);return o.offset-=j,this.position=o,es("text",et,e,o,j)}else return o.path.pop(),this.position=o,this._visitedParent=c.parent,es("elementStart",c,e,o,1)}}function es(h,e,o,c,_){return{done:!1,value:{type:h,item:e,previousPosition:o,nextPosition:c,length:_}}}class Mt{constructor(e,o,c="toNone"){if(!e.is("element")&&!e.is("documentFragment"))throw new yt.b("model-position-root-invalid: Position root invalid.",e);if(!(o instanceof Array)||o.length===0)throw new yt.b("model-position-path-incorrect-format: Position path must be an array with at least one item.",e,{path:o});o=e.getPath().concat(o),e=e.root,this.root=e,this.path=o,this.stickiness=c}get offset(){return nm(this.path)}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let o=0;o<this.path.length-1;o++)if(e=e.getChild(e.offsetToIndex(this.path[o])),!e)throw new yt.b("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});if(e.is("text"))throw new yt.b("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){const e=this.parent.getChild(this.index);return e instanceof gn&&e.startOffset<this.offset?e:null}get nodeAfter(){return this.textNode===null?this.parent.getChild(this.index):null}get nodeBefore(){return this.textNode===null?this.parent.getChild(this.index-1):null}get isAtStart(){return this.offset===0}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const o=Yn(this.path,e.path);switch(o){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[o]<e.path[o]?"before":"after"}}getLastMatchingPosition(e,o={}){o.startPosition=this;const c=new Pr(o);return c.skip(e),c.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonPath(e){if(this.root!=e.root)return[];const o=Yn(this.path,e.path),c=typeof o=="string"?Math.min(this.path.length,e.path.length):o;return this.path.slice(0,c)}getCommonAncestor(e){const o=this.getAncestors(),c=e.getAncestors();let _=0;for(;o[_]==c[_]&&o[_];)_++;return _===0?null:o[_-1]}getShiftedBy(e){const o=this.clone(),c=o.offset+e;return o.offset=c<0?0:c,o}isAfter(e){return this.compareWith(e)=="after"}isBefore(e){return this.compareWith(e)=="before"}isEqual(e){return this.compareWith(e)=="same"}isTouching(e){let o=null,c=null;switch(this.compareWith(e)){case"same":return!0;case"before":o=Mt._createAt(this),c=Mt._createAt(e);break;case"after":o=Mt._createAt(e),c=Mt._createAt(this);break;default:return!1}let j=o.parent;for(;o.path.length+c.path.length;){if(o.isEqual(c))return!0;if(o.path.length>c.path.length){if(o.offset!==j.maxOffset)return!1;o.path=o.path.slice(0,-1),j=j.parent,o.offset++}else{if(c.offset!==0)return!1;c.path=c.path.slice(0,-1)}}}is(e){return e=="position"||e=="model:position"}hasSameParentAs(e){if(this.root!==e.root)return!1;const o=this.getParentPath(),c=e.getParentPath();return Yn(o,c)=="same"}getTransformedByOperation(e){let o;switch(e.type){case"insert":o=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":o=this._getTransformedByMoveOperation(e);break;case"split":o=this._getTransformedBySplitOperation(e);break;case"merge":o=this._getTransformedByMergeOperation(e);break;default:o=Mt._createAt(this);break}return o}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const o=e.movedRange;return o.containsPosition(this)||o.start.isEqual(this)&&this.stickiness=="toNext"?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const o=e.movedRange,c=o.containsPosition(this)||o.start.isEqual(this);let _;return c?(_=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(_=_._getTransformedByDeletion(e.deletionPosition,1))):this.isEqual(e.deletionPosition)?_=Mt._createAt(e.deletionPosition):_=this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),_}_getTransformedByDeletion(e,o){const c=Mt._createAt(this);if(this.root!=e.root)return c;if(Yn(e.getParentPath(),this.getParentPath())=="same"){if(e.offset<this.offset){if(e.offset+o>this.offset)return null;c.offset-=o}}else if(Yn(e.getParentPath(),this.getParentPath())=="prefix"){const _=e.path.length-1;if(e.offset<=this.path[_]){if(e.offset+o>this.path[_])return null;c.path[_]-=o}}return c}_getTransformedByInsertion(e,o){const c=Mt._createAt(this);if(this.root!=e.root)return c;if(Yn(e.getParentPath(),this.getParentPath())=="same")(e.offset<this.offset||e.offset==this.offset&&this.stickiness!="toPrevious")&&(c.offset+=o);else if(Yn(e.getParentPath(),this.getParentPath())=="prefix"){const _=e.path.length-1;e.offset<=this.path[_]&&(c.path[_]+=o)}return c}_getTransformedByMove(e,o,c){if(o=o._getTransformedByDeletion(e,c),e.isEqual(o))return Mt._createAt(this);const _=this._getTransformedByDeletion(e,c);return _===null||e.isEqual(this)&&this.stickiness=="toNext"||e.getShiftedBy(c).isEqual(this)&&this.stickiness=="toPrevious"?this._getCombined(e,o):_._getTransformedByInsertion(o,c)}_getCombined(e,o){const c=e.path.length-1,_=Mt._createAt(o);return _.stickiness=this.stickiness,_.offset=_.offset+this.path[c]-e.offset,_.path=_.path.concat(this.path.slice(c+1)),_}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,o,c="toNone"){if(e instanceof Mt)return new Mt(e.root,e.path,e.stickiness);{const _=e;if(o=="end")o=_.maxOffset;else{if(o=="before")return this._createBefore(_,c);if(o=="after")return this._createAfter(_,c);if(o!==0&&!o)throw new yt.b("model-createPositionAt-offset-required: Model#createPositionAt() requires the offset when the first parameter is a model item.",[this,e])}if(!_.is("element")&&!_.is("documentFragment"))throw new yt.b("model-position-parent-incorrect: Position parent have to be a element or document fragment.",[this,e]);const j=_.getPath();return j.push(o),new this(_.root,j,c)}}static _createAfter(e,o){if(!e.parent)throw new yt.b("model-position-after-root: You cannot make a position after root.",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,o)}static _createBefore(e,o){if(!e.parent)throw new yt.b("model-position-before-root: You cannot make a position before root.",e,{root:e});return this._createAt(e.parent,e.startOffset,o)}static fromJSON(e,o){if(e.root==="$graveyard"){const c=new Mt(o.graveyard,e.path);return c.stickiness=e.stickiness,c}if(!o.getRoot(e.root))throw new yt.b("model-position-fromjson-no-root: Cannot create position for document. Root with specified name does not exist.",o,{rootName:e.root});return new Mt(o.getRoot(e.root),e.path,e.stickiness)}}class Tt{constructor(e,o=null){this.start=Mt._createAt(e),this.end=o?Mt._createAt(o):Mt._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new Pr({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const e=this.start.getParentPath(),o=this.end.getParentPath();return Yn(e,o)=="same"}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,o=!1){e.isCollapsed&&(o=!1);const c=this.containsPosition(e.start)||o&&this.start.isEqual(e.start),_=this.containsPosition(e.end)||o&&this.end.isEqual(e.end);return c&&_}containsItem(e){const o=Mt._createBefore(e);return this.containsPosition(o)||this.start.isEqual(o)}is(e){return e=="range"||e=="model:range"}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const o=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&o.push(new Tt(this.start,e.start)),this.containsPosition(e.end)&&o.push(new Tt(e.end,this.end))):o.push(new Tt(this.start,this.end)),o}getIntersection(e){if(this.isIntersecting(e)){let o=this.start,c=this.end;return this.containsPosition(e.start)&&(o=e.start),this.containsPosition(e.end)&&(c=e.end),new Tt(o,c)}return null}getMinimalFlatRanges(){const e=[],o=this.start.getCommonPath(this.end).length,c=Mt._createAt(this.start);let _=c.parent;for(;c.path.length>o+1;){const j=_.maxOffset-c.offset;j!==0&&e.push(new Tt(c,c.getShiftedBy(j))),c.path=c.path.slice(0,-1),c.offset++,_=_.parent}for(;c.path.length<=this.end.path.length;){const j=this.end.path[c.path.length-1],_e=j-c.offset;_e!==0&&e.push(new Tt(c,c.getShiftedBy(_e))),c.offset=j,c.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new Pr(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const o=new Pr(e);for(const c of o)yield c.item}*getPositions(e={}){e.boundaries=this;const o=new Pr(e);yield o.position;for(const c of o)yield c.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new Tt(this.start,this.end)]}getTransformedByOperations(e){const o=[new Tt(this.start,this.end)];for(const c of e)for(let _=0;_<o.length;_++){const j=o[_].getTransformedByOperation(c);o.splice(_,1,...j),_+=j.length-1}for(let c=0;c<o.length;c++){const _=o[c];for(let j=c+1;j<o.length;j++){const _e=o[j];(_.containsRange(_e)||_e.containsRange(_)||_.isEqual(_e))&&o.splice(j,1)}}return o}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,o=this.end.nodeBefore;return e&&e.is("element")&&e===o?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,o=!1){return this._getTransformedByInsertion(e.position,e.howMany,o)}_getTransformedByMoveOperation(e,o=!1){const c=e.sourcePosition,_=e.howMany,j=e.targetPosition;return this._getTransformedByMove(c,j,_,o)}_getTransformedBySplitOperation(e){const o=this.start._getTransformedBySplitOperation(e);let c=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(c=this.end.getShiftedBy(1)),o.root!=c.root&&(c=this.end.getShiftedBy(-1)),new Tt(o,c)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new Tt(this.start);let o=this.start._getTransformedByMergeOperation(e),c=this.end._getTransformedByMergeOperation(e);return o.root!=c.root&&(c=this.end.getShiftedBy(-1)),o.isAfter(c)?(e.sourcePosition.isBefore(e.targetPosition)?(o=Mt._createAt(c),o.offset=0):(e.deletionPosition.isEqual(o)||(c=e.deletionPosition),o=e.targetPosition),new Tt(o,c)):new Tt(o,c)}_getTransformedByInsertion(e,o,c=!1){if(c&&this.containsPosition(e))return[new Tt(this.start,e),new Tt(e.getShiftedBy(o),this.end._getTransformedByInsertion(e,o))];{const _=new Tt(this.start,this.end);return _.start=_.start._getTransformedByInsertion(e,o),_.end=_.end._getTransformedByInsertion(e,o),[_]}}_getTransformedByMove(e,o,c,_=!1){if(this.isCollapsed){const ct=this.start._getTransformedByMove(e,o,c);return[new Tt(ct)]}const j=Tt._createFromPositionAndShift(e,c),_e=o._getTransformedByDeletion(e,c);if(this.containsPosition(o)&&!_&&(j.containsPosition(this.start)||j.containsPosition(this.end))){const ct=this.start._getTransformedByMove(e,o,c),dt=this.end._getTransformedByMove(e,o,c);return[new Tt(ct,dt)]}let et;const nt=this.getDifference(j);let st=null;const at=this.getIntersection(j);if(nt.length==1?st=new Tt(nt[0].start._getTransformedByDeletion(e,c),nt[0].end._getTransformedByDeletion(e,c)):nt.length==2&&(st=new Tt(this.start,this.end._getTransformedByDeletion(e,c))),st?et=st._getTransformedByInsertion(_e,c,at!==null||_):et=[],at){const ct=new Tt(at.start._getCombined(j.start,_e),at.end._getCombined(j.start,_e));et.length==2?et.splice(1,0,ct):et.push(ct)}return et}_getTransformedByDeletion(e,o){let c=this.start._getTransformedByDeletion(e,o),_=this.end._getTransformedByDeletion(e,o);return c==null&&_==null?null:(c==null&&(c=e),_==null&&(_=e),new Tt(c,_))}static _createFromPositionAndShift(e,o){const c=e,_=e.getShiftedBy(o);return o>0?new this(c,_):new this(_,c)}static _createIn(e){return new this(Mt._createAt(e,0),Mt._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(Mt._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(e.length===0)throw new yt.b("range-create-from-ranges-empty-array: At least one range has to be passed.",null);if(e.length==1)return e[0].clone();const o=e[0];e.sort((j,_e)=>j.start.isAfter(_e.start)?1:-1);const c=e.indexOf(o),_=new this(o.start,o.end);if(c>0)for(let j=c-1;e[j].end.isEqual(_.start);j++)_.start=Mt._createAt(e[j].start);for(let j=c+1;j<e.length&&e[j].start.isEqual(_.end);j++)_.end=Mt._createAt(e[j].end);return _}static fromJSON(e,o){return new this(Mt.fromJSON(e.start,o),Mt.fromJSON(e.end,o))}}class du{constructor(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",(e,o)=>{if(o.viewPosition)return;const c=this._modelToViewMapping.get(o.modelPosition.parent);o.viewPosition=this._findPositionIn(c,o.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(e,o)=>{if(o.modelPosition)return;const c=this.findMappedViewAncestor(o.viewPosition),_=this._viewToModelMapping.get(c),j=this._toModelOffset(o.viewPosition.parent,o.viewPosition.offset,c);o.modelPosition=Mt._createAt(_,j)},{priority:"low"})}bindElements(e,o){this._modelToViewMapping.set(e,o),this._viewToModelMapping.set(o,e)}unbindViewElement(e){const o=this.toModelElement(e);if(this._viewToModelMapping.delete(e),this._elementToMarkerNames.has(e))for(const c of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(c);this._modelToViewMapping.get(o)==e&&this._modelToViewMapping.delete(o)}unbindModelElement(e){const o=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(o)==e&&this._viewToModelMapping.delete(o)}bindElementToMarker(e,o){const c=this._markerNameToElements.get(o)||new Set;c.add(e);const _=this._elementToMarkerNames.get(e)||new Set;_.add(o),this._markerNameToElements.set(o,c),this._elementToMarkerNames.set(e,_)}unbindElementFromMarkerName(e,o){const c=this._markerNameToElements.get(o);c&&(c.delete(e),c.size==0&&this._markerNameToElements.delete(o));const _=this._elementToMarkerNames.get(e);_&&(_.delete(o),_.size==0&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new Tt(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new Jt(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const o={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",o),o.modelPosition}toViewPosition(e,o={isPhantom:!1}){const c={modelPosition:e,mapper:this,isPhantom:o.isPhantom};return this.fire("modelToViewPosition",c),c.viewPosition}markerNameToElements(e){const o=this._markerNameToElements.get(e);if(!o)return null;const c=new Set;for(const _ of o)if(_.is("attributeElement"))for(const j of _.getElementsWithSameId())c.add(j);else c.add(_);return c}registerViewToModelLength(e,o){this._viewToModelLengthCallbacks.set(e,o)}findMappedViewAncestor(e){let o=e.parent;for(;!this._viewToModelMapping.has(o);)o=o.parent;return o}_toModelOffset(e,o,c){if(c!=e){const j=this._toModelOffset(e.parent,e.index,c),_e=this._toModelOffset(e,o,e);return j+_e}if(e.is("text"))return o;let _=0;for(let j=0;j<o;j++)_+=this.getModelLength(e.getChild(j));return _}getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name))return this._viewToModelLengthCallbacks.get(e.name)(e);if(this._viewToModelMapping.has(e))return 1;if(e.is("text"))return e.data.length;if(e.is("uiElement"))return 0;{let o=0;for(const c of e.getChildren())o+=this.getModelLength(c);return o}}_findPositionIn(e,o){let c,_=0,j=0,_e=0;if(e.is("text"))return new Ft(e,o);for(;j<o;)c=e.getChild(_e),_=this.getModelLength(c),j+=_,_e++;return j==o?this._moveViewPositionToTextNode(new Ft(e,_e)):this._findPositionIn(c,o-(j-_))}_moveViewPositionToTextNode(e){const o=e.nodeBefore,c=e.nodeAfter;return o instanceof wn?new Ft(o,o.data.length):c instanceof wn?new Ft(c,0):e}}Zt(du,xn);class Ao{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(e,o){o=So(o),e instanceof yr&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(o,!0)}consume(e,o){return o=So(o),e instanceof yr&&(e=this._getSymbolForTextProxy(e)),this.test(e,o)?(this._consumable.get(e).set(o,!1),!0):!1}test(e,o){o=So(o),e instanceof yr&&(e=this._getSymbolForTextProxy(e));const c=this._consumable.get(e);if(c===void 0)return null;const _=c.get(o);return _===void 0?null:_}revert(e,o){o=So(o),e instanceof yr&&(e=this._getSymbolForTextProxy(e));const c=this.test(e,o);return c===!1?(this._consumable.get(e).set(o,!0),!0):c===!0?!1:null}_getSymbolForTextProxy(e){let o=null;const c=this._textProxyRegistry.get(e.startOffset);if(c){const _=c.get(e.endOffset);_&&(o=_.get(e.parent))}return o||(o=this._addSymbolForTextProxy(e.startOffset,e.endOffset,e.parent)),o}_addSymbolForTextProxy(e,o,c){const _=Symbol("textProxySymbol");let j,_e;return j=this._textProxyRegistry.get(e),j||(j=new Map,this._textProxyRegistry.set(e,j)),_e=j.get(o),_e||(_e=new Map,j.set(o,_e)),_e.set(c,_),_}}function So(h){const e=h.split(":");return e.length>1?e[0]+":"+e[1]:e[0]}class hu{constructor(e){this.conversionApi=fs({dispatcher:this},e)}convertChanges(e,o,c){for(const _ of e.getMarkersToRemove())this.convertMarkerRemove(_.name,_.range,c);for(const _ of e.getChanges())_.type=="insert"?this.convertInsert(Tt._createFromPositionAndShift(_.position,_.length),c):_.type=="remove"?this.convertRemove(_.position,_.length,_.name,c):this.convertAttribute(_.range,_.attributeKey,_.attributeOldValue,_.attributeNewValue,c);for(const _ of this.conversionApi.mapper.flushUnboundMarkerNames()){const j=o.get(_).getRange();this.convertMarkerRemove(_,j,c),this.convertMarkerAdd(_,j,c)}for(const _ of e.getMarkersToAdd())this.convertMarkerAdd(_.name,_.range,c)}convertInsert(e,o){this.conversionApi.writer=o,this.conversionApi.consumable=this._createInsertConsumable(e);for(const c of e){const _=c.item,j=Tt._createFromPositionAndShift(c.previousPosition,c.length),_e={item:_,range:j};this._testAndFire("insert",_e);for(const et of _.getAttributeKeys())_e.attributeKey=et,_e.attributeOldValue=null,_e.attributeNewValue=_.getAttribute(et),this._testAndFire(`attribute:${et}`,_e)}this._clearConversionApi()}convertRemove(e,o,c,_){this.conversionApi.writer=_,this.fire("remove:"+c,{position:e,length:o},this.conversionApi),this._clearConversionApi()}convertAttribute(e,o,c,_,j){this.conversionApi.writer=j,this.conversionApi.consumable=this._createConsumableForRange(e,`attribute:${o}`);for(const _e of e){const et=_e.item,nt=Tt._createFromPositionAndShift(_e.previousPosition,_e.length),st={item:et,range:nt,attributeKey:o,attributeOldValue:c,attributeNewValue:_};this._testAndFire(`attribute:${o}`,st)}this._clearConversionApi()}convertSelection(e,o,c){const _=Array.from(o.getMarkersAtPosition(e.getFirstPosition()));if(this.conversionApi.writer=c,this.conversionApi.consumable=this._createSelectionConsumable(e,_),this.fire("selection",{selection:e},this.conversionApi),!!e.isCollapsed){for(const j of _){const _e=j.getRange();if(!zS(e.getFirstPosition(),j,this.conversionApi.mapper))continue;const et={item:e,markerName:j.name,markerRange:_e};this.conversionApi.consumable.test(e,"addMarker:"+j.name)&&this.fire("addMarker:"+j.name,et,this.conversionApi)}for(const j of e.getAttributeKeys()){const _e={item:e,range:e.getFirstRange(),attributeKey:j,attributeOldValue:null,attributeNewValue:e.getAttribute(j)};this.conversionApi.consumable.test(e,"attribute:"+_e.attributeKey)&&this.fire("attribute:"+_e.attributeKey+":$text",_e,this.conversionApi)}this._clearConversionApi()}}convertMarkerAdd(e,o,c){if(!o.root.document||o.root.rootName=="$graveyard")return;this.conversionApi.writer=c;const _="addMarker:"+e,j=new Ao;if(j.add(o,_),this.conversionApi.consumable=j,this.fire(_,{markerName:e,markerRange:o},this.conversionApi),!!j.test(o,_)){this.conversionApi.consumable=this._createConsumableForRange(o,_);for(const _e of o.getItems()){if(!this.conversionApi.consumable.test(_e,_))continue;const et={item:_e,range:Tt._createOn(_e),markerName:e,markerRange:o};this.fire(_,et,this.conversionApi)}this._clearConversionApi()}}convertMarkerRemove(e,o,c){!o.root.document||o.root.rootName=="$graveyard"||(this.conversionApi.writer=c,this.fire("removeMarker:"+e,{markerName:e,markerRange:o},this.conversionApi),this._clearConversionApi())}_createInsertConsumable(e){const o=new Ao;for(const c of e){const _=c.item;o.add(_,"insert");for(const j of _.getAttributeKeys())o.add(_,"attribute:"+j)}return o}_createConsumableForRange(e,o){const c=new Ao;for(const _ of e.getItems())c.add(_,o);return c}_createSelectionConsumable(e,o){const c=new Ao;c.add(e,"selection");for(const _ of o)c.add(e,"addMarker:"+_.name);for(const _ of e.getAttributeKeys())c.add(e,"attribute:"+_);return c}_testAndFire(e,o){if(!this.conversionApi.consumable.test(o.item,e))return;const c=o.item.name||"$text";this.fire(e+":"+c,o,this.conversionApi)}_clearConversionApi(){delete this.conversionApi.writer,delete this.conversionApi.consumable}}Zt(hu,xn);function zS(h,e,o){const c=e.getRange(),_=Array.from(h.getAncestors());return _.shift(),_.reverse(),!_.some(_e=>{if(c.containsItem(_e))return!!o.toViewElement(_e).getCustomProperty("addHighlight")})}class kr{constructor(e,o,c){this._lastRangeBackward=!1,this._ranges=[],this._attrs=new Map,e&&this.setTo(e,o,c)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){return this._ranges.length===1?this._ranges[0].isCollapsed:!1}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const o of this._ranges){let c=!1;for(const _ of e._ranges)if(o.isEqual(_)){c=!0;break}if(!c)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new Tt(e.start,e.end)}getFirstRange(){let e=null;for(const o of this._ranges)(!e||o.start.isBefore(e.start))&&(e=o);return e?new Tt(e.start,e.end):null}getLastRange(){let e=null;for(const o of this._ranges)(!e||o.end.isAfter(e.end))&&(e=o);return e?new Tt(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(e,o,c){if(e===null)this._setRanges([]);else if(e instanceof kr)this._setRanges(e.getRanges(),e.isBackward);else if(e&&typeof e.getRanges=="function")this._setRanges(e.getRanges(),e.isBackward);else if(e instanceof Tt)this._setRanges([e],!!o&&!!o.backward);else if(e instanceof Mt)this._setRanges([new Tt(e)]);else if(e instanceof Zr){const _=!!c&&!!c.backward;let j;if(o=="in")j=Tt._createIn(e);else if(o=="on")j=Tt._createOn(e);else if(o!==void 0)j=new Tt(Mt._createAt(e,o));else throw new yt.b("model-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.",[this,e]);this._setRanges([j],_)}else if(hr(e))this._setRanges(e,o&&!!o.backward);else throw new yt.b("model-selection-setTo-not-selectable: Cannot set the selection to the given place.",[this,e])}_setRanges(e,o=!1){e=Array.from(e);const c=e.some(_=>{if(!(_ instanceof Tt))throw new yt.b("model-selection-set-ranges-not-range: Selection range set to an object that is not an instance of model.Range.",[this,e]);return this._ranges.every(j=>!j.isEqual(_))});if(!(e.length===this._ranges.length&&!c)){this._removeAllRanges();for(const _ of e)this._pushRange(_);this._lastRangeBackward=!!o,this.fire("change:range",{directChange:!0})}}setFocus(e,o){if(this.anchor===null)throw new yt.b("model-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.",[this,e]);const c=Mt._createAt(e,o);if(c.compareWith(this.focus)=="same")return;const _=this.anchor;this._ranges.length&&this._popRange(),c.compareWith(_)=="before"?(this._pushRange(new Tt(c,_)),this._lastRangeBackward=!0):(this._pushRange(new Tt(_,c)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,o){this.getAttribute(e)!==o&&(this._attrs.set(e,o),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}is(e){return e=="selection"||e=="model:selection"}*getSelectedBlocks(){const e=new WeakSet;for(const o of this.getRanges()){const c=u_(o.start,e);c&&fu(c,o)&&(yield c);for(const j of o.getWalker()){const _e=j.item;j.type=="elementEnd"&&VS(_e,e,o)&&(yield _e)}const _=u_(o.end,e);_&&!o.end.isTouching(Mt._createAt(_,0))&&fu(_,o)&&(yield _)}}containsEntireContent(e=this.anchor.root){const o=Mt._createAt(e,0),c=Mt._createAt(e,"end");return o.isTouching(this.getFirstPosition())&&c.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new Tt(e.start,e.end))}_checkRange(e){for(let o=0;o<this._ranges.length;o++)if(e.isIntersecting(this._ranges[o]))throw new yt.b("model-selection-range-intersects: Trying to add a range that intersects with another range in the selection.",[this,e],{addedRange:e,intersectingRange:this._ranges[o]})}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}Zt(kr,xn);function c_(h,e){return e.has(h)?!1:(e.add(h),h.root.document.model.schema.isBlock(h)&&h.parent)}function VS(h,e,o){return c_(h,e)&&fu(h,o)}function u_(h,e){const c=h.parent.root.document.model.schema,_=h.parent.getAncestors({parentFirst:!0,includeSelf:!0});let j=!1;const _e=_.find(et=>j?!1:(j=c.isLimit(et),!j&&c_(et,e)));return _.forEach(et=>e.add(et)),_e}function fu(h,e){const o=$S(h);return o?!e.containsRange(Tt._createOn(o),!0):!0}function $S(h){const e=h.root.document.model.schema;let o=h.parent;for(;o;){if(e.isBlock(o))return o;o=o.parent}}class $r extends Tt{constructor(e,o){super(e,o),US.call(this)}detach(){this.stopListening()}is(e){return e=="liveRange"||e=="model:liveRange"||super.is(e)}toRange(){return new Tt(this.start,this.end)}static fromRange(e){return new $r(e.start,e.end)}}function US(){this.listenTo(this.root.document.model,"applyOperation",(h,e)=>{const o=e[0];o.isDocumentOperation&&WS.call(this,o)},{priority:"low"})}function WS(h){const e=this.getTransformedByOperation(h),o=Tt._createFromRanges(e),c=!o.isEqual(this),_=HS(this,h);let j=null;if(c){o.root.rootName=="$graveyard"&&(h.type=="remove"?j=h.sourcePosition:j=h.deletionPosition);const _e=this.toRange();this.start=o.start,this.end=o.end,this.fire("change:range",_e,{deletionPosition:j})}else _&&this.fire("change:content",this.toRange(),{deletionPosition:j})}function HS(h,e){switch(e.type){case"insert":return h.containsPosition(e.position);case"move":case"remove":case"reinsert":case"merge":return h.containsPosition(e.sourcePosition)||h.start.isEqual(e.sourcePosition)||h.containsPosition(e.targetPosition);case"split":return h.containsPosition(e.splitPosition)||h.containsPosition(e.insertionPosition)}return!1}Zt($r,xn);const zs="selection:";class mr{constructor(e){this._selection=new GS(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection._updateMarkers(),this._selection._updateAttributes(!1)}is(e){return e=="selection"||e=="model:selection"||e=="documentSelection"||e=="model:documentSelection"}_setFocus(e,o){this._selection.setFocus(e,o)}_setTo(e,o,c){this._selection.setTo(e,o,c)}_setAttribute(e,o){this._selection.setAttribute(e,o)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection._getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return zs+e}static _isStoreAttributeKey(e){return e.startsWith(zs)}}Zt(mr,xn);class GS extends kr{constructor(e){super(),this.markers=new or({idProperty:"name"}),this._model=e.model,this._document=e,this._attributePriority=new Map,this._fixGraveyardRangesData=[],this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this.listenTo(this._model,"applyOperation",(o,c)=>{const _=c[0];if(!(!_.isDocumentOperation||_.type=="marker"||_.type=="rename"||_.type=="noop")){for(;this._fixGraveyardRangesData.length;){const{liveRange:j,sourcePosition:_e}=this._fixGraveyardRangesData.shift();this._fixGraveyardSelection(j,_e)}this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1}))}},{priority:"lowest"}),this.on("change:range",()=>{for(const o of this.getRanges())if(!this._document._validateSelectionRange(o))throw new yt.b("document-selection-wrong-position: Range from document selection starts or ends at incorrect position.",this,{range:o})}),this.listenTo(this._model.markers,"update",()=>this._updateMarkers()),this.listenTo(this._document,"change",(o,c)=>{qS(this._model,c)})}get isCollapsed(){return this._ranges.length===0?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(e,o,c){super.setTo(e,o,c),this._updateAttributes(!0),this._updateMarkers()}setFocus(e,o){super.setFocus(e,o),this._updateAttributes(!0),this._updateMarkers()}setAttribute(e,o){if(this._setAttribute(e,o)){const c=[e];this.fire("change:attribute",{attributeKeys:c,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const o=[e];this.fire("change:attribute",{attributeKeys:o,directChange:!0})}}overrideGravity(){const e=Tr();return this._overriddenGravityRegister.add(e),this._overriddenGravityRegister.size===1&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new yt.b("document-selection-gravity-wrong-restore: Attempting to restore the selection gravity for an unknown UID.",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const o=this._prepareRange(e);o&&this._ranges.push(o)}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const o=$r.fromRange(e);return o.on("change:range",(c,_,j)=>{this._hasChangedRange=!0,o.root==this._document.graveyard&&this._fixGraveyardRangesData.push({liveRange:o,sourcePosition:j.deletionPosition})}),o}_updateMarkers(){const e=[];let o=!1;for(const _ of this._model.markers){const j=_.getRange();for(const _e of this.getRanges())j.containsRange(_e,!_e.isCollapsed)&&e.push(_)}const c=Array.from(this.markers);for(const _ of e)this.markers.has(_)||(this.markers.add(_),o=!0);for(const _ of Array.from(this.markers))e.includes(_)||(this.markers.remove(_),o=!0);o&&this.fire("change:marker",{oldMarkers:c,directChange:!1})}_updateAttributes(e){const o=Fr(this._getSurroundingAttributes()),c=Fr(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[j,_e]of this._attributePriority)_e=="low"&&(this._attrs.delete(j),this._attributePriority.delete(j));this._setAttributesTo(o);const _=[];for(const[j,_e]of this.getAttributes())(!c.has(j)||c.get(j)!==_e)&&_.push(j);for(const[j]of c)this.hasAttribute(j)||_.push(j);_.length>0&&this.fire("change:attribute",{attributeKeys:_,directChange:!1})}_setAttribute(e,o,c=!0){const _=c?"normal":"low";return _=="low"&&this._attributePriority.get(e)=="normal"||super.getAttribute(e)===o?!1:(this._attrs.set(e,o),this._attributePriority.set(e,_),!0)}_removeAttribute(e,o=!0){const c=o?"normal":"low";return c=="low"&&this._attributePriority.get(e)=="normal"||(this._attributePriority.set(e,c),!super.hasAttribute(e))?!1:(this._attrs.delete(e),!0)}_setAttributesTo(e){const o=new Set;for(const[c,_]of this.getAttributes())e.get(c)!==_&&this._removeAttribute(c,!1);for(const[c,_]of e)this._setAttribute(c,_,!1)&&o.add(c);return o}*_getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const o of e.getAttributeKeys())o.startsWith(zs)&&(yield[o.substr(zs.length),e.getAttribute(o)])}_getSurroundingAttributes(){const e=this.getFirstPosition(),o=this._model.schema;let c=null;if(this.isCollapsed){const _=e.textNode?e.textNode:e.nodeBefore,j=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(c=Io(_)),c||(c=Io(j)),!this.isGravityOverridden&&!c){let _e=_;for(;_e&&!c;)_e=_e.previousSibling,c=Io(_e)}if(!c){let _e=j;for(;_e&&!c;)_e=_e.nextSibling,c=Io(_e)}c||(c=this._getStoredAttributes())}else{const _=this.getFirstRange();for(const j of _){if(j.item.is("element")&&o.isObject(j.item))break;if(j.type=="text"){c=j.item.getAttributes();break}}}return c}_fixGraveyardSelection(e,o){const c=o.clone(),_=this._model.schema.getNearestSelectionRange(c),j=this._ranges.indexOf(e);if(this._ranges.splice(j,1),e.detach(),_){const _e=this._prepareRange(_);this._ranges.splice(j,0,_e)}}}function Io(h){return h instanceof yr||h instanceof gn?h.getAttributes():null}function qS(h,e){const o=h.document.differ;for(const c of o.getChanges()){if(c.type!="insert")continue;const _=c.position.parent;c.length===_.maxOffset&&h.enqueueChange(e,_e=>{const et=Array.from(_.getAttributeKeys()).filter(nt=>nt.startsWith(zs));for(const nt of et)_e.removeAttribute(nt,_)})}}class d_{constructor(e){this._dispatchers=e}add(e){for(const o of this._dispatchers)e(o);return this}}var KS=1,YS=4;function QS(h){return Dl(h,KS|YS)}var Ur=QS;class JS extends d_{elementToElement(e){return this.add(uI(e))}attributeToElement(e){return this.add(dI(e))}attributeToAttribute(e){return this.add(hI(e))}markerToElement(e){return this.add(fI(e))}markerToHighlight(e){return this.add(pI(e))}}function h_(){return(h,e,o)=>{if(!o.consumable.consume(e.item,"insert"))return;const c=o.writer,_=o.mapper.toViewPosition(e.range.start),j=c.createText(e.item.data);c.insert(_,j)}}function XS(){return(h,e,o)=>{const c=o.mapper.toViewPosition(e.position),_=e.position.getShiftedBy(e.length),j=o.mapper.toViewPosition(_,{isPhantom:!0}),_e=o.writer.createRange(c,j),et=o.writer.remove(_e.getTrimmed());for(const nt of o.writer.createRangeIn(et).getItems())o.mapper.unbindViewElement(nt)}}function f_(h,e){const o=h.createAttributeElement("span",e.attributes);return e.classes&&o._addClass(e.classes),e.priority&&(o._priority=e.priority),o._id=e.id,o}function ZS(){return(h,e,o)=>{const c=e.selection;if(c.isCollapsed||!o.consumable.consume(c,"selection"))return;const _=[];for(const j of c.getRanges()){const _e=o.mapper.toViewRange(j);_.push(_e)}o.writer.setSelection(_,{backward:c.isBackward})}}function eI(){return(h,e,o)=>{const c=e.selection;if(!c.isCollapsed||!o.consumable.consume(c,"selection"))return;const _=o.writer,j=c.getFirstPosition(),_e=o.mapper.toViewPosition(j),et=_.breakAttributes(_e);_.setSelection(et)}}function tI(){return(h,e,o)=>{const c=o.writer,_=c.document.selection;for(const j of _.getRanges())j.isCollapsed&&j.end.parent.isAttached()&&o.writer.mergeAttributes(j.start);c.setSelection(null)}}function nI(h){return(e,o,c)=>{const _=h(o.attributeOldValue,c.writer),j=h(o.attributeNewValue,c.writer);if(!_&&!j||!c.consumable.consume(o.item,e.name))return;const _e=c.writer,et=_e.document.selection;if(o.item instanceof kr||o.item instanceof mr)_e.wrap(et.getFirstRange(),j);else{let nt=c.mapper.toViewRange(o.range);o.attributeOldValue!==null&&_&&(nt=_e.unwrap(nt,_)),o.attributeNewValue!==null&&j&&_e.wrap(nt,j)}}}function iI(h){return(e,o,c)=>{const _=h(o.item,c.writer);if(!_||!c.consumable.consume(o.item,"insert"))return;const j=c.mapper.toViewPosition(o.range.start);c.mapper.bindElements(o.item,_),c.writer.insert(j,_)}}function rI(h){return(e,o,c)=>{o.isOpening=!0;const _=h(o,c.writer);o.isOpening=!1;const j=h(o,c.writer);if(!_||!j)return;const _e=o.markerRange;if(_e.isCollapsed&&!c.consumable.consume(_e,e.name))return;for(const st of _e)if(!c.consumable.consume(st.item,e.name))return;const et=c.mapper,nt=c.writer;nt.insert(et.toViewPosition(_e.start),_),c.mapper.bindElementToMarker(_,o.markerName),_e.isCollapsed||(nt.insert(et.toViewPosition(_e.end),j),c.mapper.bindElementToMarker(j,o.markerName)),e.stop()}}function sI(){return(h,e,o)=>{const c=o.mapper.markerNameToElements(e.markerName);if(c){for(const _ of c)o.mapper.unbindElementFromMarkerName(_,e.markerName),o.writer.clear(o.writer.createRangeOn(_),_);o.writer.clearClonedElementsGroup(e.markerName),h.stop()}}}function oI(h){return(e,o,c)=>{const _=h(o.attributeOldValue,o),j=h(o.attributeNewValue,o);if(!_&&!j||!c.consumable.consume(o.item,e.name))return;const _e=c.mapper.toViewElement(o.item),et=c.writer;if(!_e)throw new yt.b("conversion-attribute-to-attribute-on-text: Trying to convert text node's attribute with attribute-to-attribute converter.",[o,c]);if(o.attributeOldValue!==null&&_)if(_.key=="class"){const nt=Array.isArray(_.value)?_.value:[_.value];for(const st of nt)et.removeClass(st,_e)}else if(_.key=="style"){const nt=Object.keys(_.value);for(const st of nt)et.removeStyle(st,_e)}else et.removeAttribute(_.key,_e);if(o.attributeNewValue!==null&&j)if(j.key=="class"){const nt=Array.isArray(j.value)?j.value:[j.value];for(const st of nt)et.addClass(st,_e)}else if(j.key=="style"){const nt=Object.keys(j.value);for(const st of nt)et.setStyle(st,j.value[st],_e)}else et.setAttribute(j.key,j.value,_e)}}function aI(h){return(e,o,c)=>{if(!o.item||!(o.item instanceof kr||o.item instanceof mr)&&!o.item.is("textProxy"))return;const _=pu(h,o,c);if(!_||!c.consumable.consume(o.item,e.name))return;const j=c.writer,_e=f_(j,_),et=j.document.selection;if(o.item instanceof kr||o.item instanceof mr)j.wrap(et.getFirstRange(),_e,et);else{const nt=c.mapper.toViewRange(o.range),st=j.wrap(nt,_e);for(const at of st.getItems())if(at.is("attributeElement")&&at.isSimilar(_e)){c.mapper.bindElementToMarker(at,o.markerName);break}}}}function lI(h){return(e,o,c)=>{if(!o.item||!(o.item instanceof vn))return;const _=pu(h,o,c);if(!_||!c.consumable.test(o.item,e.name))return;const j=c.mapper.toViewElement(o.item);if(j&&j.getCustomProperty("addHighlight")){c.consumable.consume(o.item,e.name);for(const _e of Tt._createIn(o.item))c.consumable.consume(_e.item,e.name);j.getCustomProperty("addHighlight")(j,_,c.writer),c.mapper.bindElementToMarker(j,o.markerName)}}}function cI(h){return(e,o,c)=>{if(o.markerRange.isCollapsed)return;const _=pu(h,o,c);if(!_)return;const j=f_(c.writer,_),_e=c.mapper.markerNameToElements(o.markerName);if(_e){for(const et of _e)c.mapper.unbindElementFromMarkerName(et,o.markerName),et.is("attributeElement")?c.writer.unwrap(c.writer.createRangeOn(et),j):et.getCustomProperty("removeHighlight")(et,_.id,c.writer);c.writer.clearClonedElementsGroup(o.markerName),e.stop()}}}function uI(h){return h=Ur(h),h.view=Po(h.view,"container"),e=>{e.on("insert:"+h.model,iI(h.view),{priority:h.converterPriority||"normal"})}}function dI(h){h=Ur(h);let o="attribute:"+(h.model.key?h.model.key:h.model);if(h.model.name&&(o+=":"+h.model.name),h.model.values)for(const _ of h.model.values)h.view[_]=Po(h.view[_],"attribute");else h.view=Po(h.view,"attribute");const c=p_(h);return _=>{_.on(o,nI(c),{priority:h.converterPriority||"normal"})}}function hI(h){h=Ur(h);let o="attribute:"+(h.model.key?h.model.key:h.model);if(h.model.name&&(o+=":"+h.model.name),h.model.values)for(const _ of h.model.values)h.view[_]=m_(h.view[_]);else h.view=m_(h.view);const c=p_(h);return _=>{_.on(o,oI(c),{priority:h.converterPriority||"normal"})}}function fI(h){return h=Ur(h),h.view=Po(h.view,"ui"),e=>{e.on("addMarker:"+h.model,rI(h.view),{priority:h.converterPriority||"normal"}),e.on("removeMarker:"+h.model,sI(h.view),{priority:h.converterPriority||"normal"})}}function pI(h){return e=>{e.on("addMarker:"+h.model,aI(h.view),{priority:h.converterPriority||"normal"}),e.on("addMarker:"+h.model,lI(h.view),{priority:h.converterPriority||"normal"}),e.on("removeMarker:"+h.model,cI(h.view),{priority:h.converterPriority||"normal"})}}function Po(h,e){return typeof h=="function"?h:(o,c)=>mI(h,c,e)}function mI(h,e,o){typeof h=="string"&&(h={name:h});let c;const _=Object.assign({},h.attributes);if(o=="container")c=e.createContainerElement(h.name,_);else if(o=="attribute"){const j={priority:h.priority||ps.DEFAULT_PRIORITY};c=e.createAttributeElement(h.name,_,j)}else c=e.createUIElement(h.name,_);if(h.styles){const j=Object.keys(h.styles);for(const _e of j)e.setStyle(_e,h.styles[_e],c)}if(h.classes){const j=h.classes;if(typeof j=="string")e.addClass(j,c);else for(const _e of j)e.addClass(_e,c)}return c}function p_(h){return h.model.values?(e,o)=>{const c=h.view[e];return c?c(e,o):null}:h.view}function m_(h){return typeof h=="string"?e=>({key:h,value:e}):typeof h=="object"?h.value?()=>h:e=>({key:h.key,value:e}):h}function pu(h,e,o){const c=typeof h=="function"?h(e,o):h;return c?(c.priority||(c.priority=10),c.id||(c.id=e.markerName),c):null}class gI extends d_{elementToElement(e){return this.add(__(e))}elementToAttribute(e){return this.add(vI(e))}attributeToAttribute(e){return this.add(bI(e))}elementToMarker(e){return this.add(yI(e))}}function g_(){return(h,e,o)=>{if(!e.modelRange&&o.consumable.consume(e.viewItem,{name:!0})){const{modelRange:c,modelCursor:_}=o.convertChildren(e.viewItem,e.modelCursor);e.modelRange=c,e.modelCursor=_}}}function _I(){return(h,e,o)=>{if(o.schema.checkChild(e.modelCursor,"$text")&&o.consumable.consume(e.viewItem)){const c=o.writer.createText(e.viewItem.data);o.writer.insert(c,e.modelCursor),e.modelRange=Tt._createFromPositionAndShift(e.modelCursor,c.offsetSize),e.modelCursor=e.modelRange.end}}}function wI(h,e){return(o,c)=>{const _=c.newSelection,j=new kr,_e=[];for(const et of _.getRanges())_e.push(e.toModelRange(et));j.setTo(_e,{backward:_.isBackward}),j.isEqual(h.document.selection)||h.change(et=>{et.setSelection(j)})}}function __(h){h=Ur(h);const e=kI(h),o=mu(h.view),c=o?"element:"+o:"element";return _=>{_.on(c,e,{priority:h.converterPriority||"normal"})}}function vI(h){h=Ur(h),w_(h);const e=v_(h,!1),o=mu(h.view),c=o?"element:"+o:"element";return _=>{_.on(c,e,{priority:h.converterPriority||"low"})}}function bI(h){h=Ur(h);let e=null;(typeof h.view=="string"||h.view.key)&&(e=EI(h)),w_(h,e);const o=v_(h,!0);return c=>{c.on("element",o,{priority:h.converterPriority||"low"})}}function yI(h){return h=Ur(h),AI(h),__(h)}function mu(h){return typeof h=="string"?h:typeof h=="object"&&typeof h.name=="string"?h.name:null}function kI(h){const e=h.view?new Sr(h.view):null;return(o,c,_)=>{let j={};if(e){const st=e.match(c.viewItem);if(!st)return;j=st.match}j.name=!0;const _e=xI(h.model,c.viewItem,_.writer);if(!_e||!_.consumable.test(c.viewItem,j))return;const et=_.splitToAllowedParent(_e,c.modelCursor);if(!et)return;_.writer.insert(_e,et.position),_.convertChildren(c.viewItem,_.writer.createPositionAt(_e,0)),_.consumable.consume(c.viewItem,j);const nt=_.getSplitParts(_e);c.modelRange=new Tt(_.writer.createPositionBefore(_e),_.writer.createPositionAfter(nt[nt.length-1])),et.cursorParent?c.modelCursor=_.writer.createPositionAt(et.cursorParent,0):c.modelCursor=c.modelRange.end}}function xI(h,e,o){return h instanceof Function?h(e,o):o.createElement(h)}function EI(h){typeof h.view=="string"&&(h.view={key:h.view});const e=h.view.key;let o;if(e=="class"||e=="style")o={[e=="class"?"classes":"styles"]:h.view.value};else{const c=typeof h.view.value>"u"?/[\s\S]*/:h.view.value;o={attributes:{[e]:c}}}return h.view.name&&(o.name=h.view.name),h.view=o,e}function w_(h,e=null){const o=e===null?!0:j=>j.getAttribute(e),c=typeof h.model!="object"?h.model:h.model.key,_=typeof h.model!="object"||typeof h.model.value>"u"?o:h.model.value;h.model={key:c,value:_}}function v_(h,e){const o=new Sr(h.view);return(c,_,j)=>{const _e=o.match(_.viewItem);if(!_e)return;const et=h.model.key,nt=typeof h.model.value=="function"?h.model.value(_.viewItem):h.model.value;if(nt===null||(CI(h.view,_.viewItem)?_e.match.name=!0:delete _e.match.name,!j.consumable.test(_.viewItem,_e.match)))return;_.modelRange||(_=Object.assign(_,j.convertChildren(_.viewItem,_.modelCursor))),TI(_.modelRange,{key:et,value:nt},e,j)&&j.consumable.consume(_.viewItem,_e.match)}}function CI(h,e){const o=typeof h=="function"?h(e):h;return typeof o=="object"&&!mu(o)?!1:!o.classes&&!o.attributes&&!o.styles}function TI(h,e,o,c){let _=!1;for(const j of Array.from(h.getItems({shallow:o})))c.schema.checkAttribute(j,e.key)&&(c.writer.setAttribute(e.key,e.value,j),_=!0);return _}function AI(h){const e=h.model;h.model=(o,c)=>{const _=typeof e=="string"?e:e(o);return c.createElement("$marker",{"data-name":_})}}class b_{constructor(e,o){this.model=e,this.view=new l_(o),this.mapper=new du,this.downcastDispatcher=new hu({mapper:this.mapper});const c=this.model.document,_=c.selection,j=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(c,"change",()=>{this.view.change(_e=>{this.downcastDispatcher.convertChanges(c.differ,j,_e),this.downcastDispatcher.convertSelection(_,j,_e)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",wI(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",h_(),{priority:"lowest"}),this.downcastDispatcher.on("remove",XS(),{priority:"low"}),this.downcastDispatcher.on("selection",tI(),{priority:"low"}),this.downcastDispatcher.on("selection",ZS(),{priority:"low"}),this.downcastDispatcher.on("selection",eI(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(_e=>{if(_e.rootName=="$graveyard")return null;const et=new Q1(this.view.document,_e.name);return et.rootName=_e.rootName,this.mapper.bindElements(_e,et),et})}destroy(){this.view.destroy(),this.stopListening()}}Zt(b_,Mn);class SI{constructor(){this._commands=new Map}add(e,o){this._commands.set(e,o)}get(e){return this._commands.get(e)}execute(e,...o){const c=this.get(e);if(!c)throw new yt.b("commandcollection-command-not-found: Command does not exist.",this,{commandName:e});c.execute(...o)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}}class Vs{constructor(){this._consumables=new Map}add(e,o){let c;if(e.is("text")||e.is("documentFragment")){this._consumables.set(e,!0);return}this._consumables.has(e)?c=this._consumables.get(e):(c=new II(e),this._consumables.set(e,c)),c.add(o)}test(e,o){const c=this._consumables.get(e);return c===void 0?null:e.is("text")||e.is("documentFragment")?c:c.test(o)}consume(e,o){return this.test(e,o)?(e.is("text")||e.is("documentFragment")?this._consumables.set(e,!1):this._consumables.get(e).consume(o),!0):!1}revert(e,o){const c=this._consumables.get(e);c!==void 0&&(e.is("text")||e.is("documentFragment")?this._consumables.set(e,!0):c.revert(o))}static consumablesFromElement(e){const o={element:e,name:!0,attributes:[],classes:[],styles:[]},c=e.getAttributeKeys();for(const _e of c)_e=="style"||_e=="class"||o.attributes.push(_e);const _=e.getClassNames();for(const _e of _)o.classes.push(_e);const j=e.getStyleNames();for(const _e of j)o.styles.push(_e);return o}static createFrom(e,o){if(o||(o=new Vs(e)),e.is("text"))return o.add(e),o;e.is("element")&&o.add(e,Vs.consumablesFromElement(e)),e.is("documentFragment")&&o.add(e);for(const c of e.getChildren())o=Vs.createFrom(c,o);return o}}class II{constructor(e){this.element=e,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(e){e.name&&(this._canConsumeName=!0);for(const o in this._consumables)o in e&&this._add(o,e[o])}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const o in this._consumables)if(o in e){const c=this._test(o,e[o]);if(c!==!0)return c}return!0}consume(e){e.name&&(this._canConsumeName=!1);for(const o in this._consumables)o in e&&this._consume(o,e[o])}revert(e){e.name&&(this._canConsumeName=!0);for(const o in this._consumables)o in e&&this._revert(o,e[o])}_add(e,o){const c=Kn(o)?o:[o],_=this._consumables[e];for(const j of c){if(e==="attributes"&&(j==="class"||j==="style"))throw new yt.b("viewconsumable-invalid-attribute: Classes and styles should be handled separately.",this);if(_.set(j,!0),e==="styles")for(const _e of this.element.document.stylesProcessor.getRelatedStyles(j))_.set(_e,!0)}}_test(e,o){const c=Kn(o)?o:[o],_=this._consumables[e];for(const j of c)if(e==="attributes"&&(j==="class"||j==="style")){const _e=j=="class"?"classes":"styles",et=this._test(_e,[...this._consumables[_e].keys()]);if(et!==!0)return et}else{const _e=_.get(j);if(_e===void 0)return null;if(!_e)return!1}return!0}_consume(e,o){const c=Kn(o)?o:[o],_=this._consumables[e];for(const j of c)if(e==="attributes"&&(j==="class"||j==="style")){const _e=j=="class"?"classes":"styles";this._consume(_e,[...this._consumables[_e].keys()])}else if(_.set(j,!1),e=="styles")for(const _e of this.element.document.stylesProcessor.getRelatedStyles(j))_.set(_e,!1)}_revert(e,o){const c=Kn(o)?o:[o],_=this._consumables[e];for(const j of c)if(e==="attributes"&&(j==="class"||j==="style")){const _e=j=="class"?"classes":"styles";this._revert(_e,[...this._consumables[_e].keys()])}else _.get(j)===!1&&_.set(j,!0)}}class y_{constructor(){this._sourceDefinitions={},this._attributeProperties={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(e,o)=>{o[0]=new ts(o[0])},{priority:"highest"}),this.on("checkChild",(e,o)=>{o[0]=new ts(o[0]),o[1]=this.getDefinition(o[1])},{priority:"highest"})}register(e,o){if(this._sourceDefinitions[e])throw new yt.b("schema-cannot-register-item-twice: A single item cannot be registered twice in the schema.",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},o)],this._clearCache()}extend(e,o){if(!this._sourceDefinitions[e])throw new yt.b("schema-cannot-extend-missing-item: Cannot extend an item which was not registered yet.",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},o)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let o;return typeof e=="string"?o=e:e.is&&(e.is("text")||e.is("textProxy"))?o="$text":o=e.name,this.getDefinitions()[o]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const o=this.getDefinition(e);return!!(o&&o.isBlock)}isLimit(e){const o=this.getDefinition(e);return o?!!(o.isLimit||o.isObject):!1}isObject(e){const o=this.getDefinition(e);return!!(o&&o.isObject)}isInline(e){const o=this.getDefinition(e);return!!(o&&o.isInline)}checkChild(e,o){return o?this._checkContextMatch(o,e):!1}checkAttribute(e,o){const c=this.getDefinition(e.last);return c?c.allowAttributes.includes(o):!1}checkMerge(e,o=null){if(e instanceof Mt){const c=e.nodeBefore,_=e.nodeAfter;if(!(c instanceof vn))throw new yt.b("schema-check-merge-no-element-before: The node before the merge position must be an element.",this);if(!(_ instanceof vn))throw new yt.b("schema-check-merge-no-element-after: The node after the merge position must be an element.",this);return this.checkMerge(c,_)}for(const c of o.getChildren())if(!this.checkChild(e,c))return!1;return!0}addChildCheck(e){this.on("checkChild",(o,[c,_])=>{if(!_)return;const j=e(c,_);typeof j=="boolean"&&(o.stop(),o.return=j)},{priority:"high"})}addAttributeCheck(e){this.on("checkAttribute",(o,[c,_])=>{const j=e(c,_);typeof j=="boolean"&&(o.stop(),o.return=j)},{priority:"high"})}setAttributeProperties(e,o){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),o)}getAttributeProperties(e){return this._attributeProperties[e]||{}}getLimitElement(e){let o;for(e instanceof Mt?o=e.parent:o=(e instanceof Tt?[e]:Array.from(e.getRanges())).reduce((_,j)=>{const _e=j.getCommonAncestor();return _?_.getCommonAncestor(_e,{includeSelf:!0}):_e},null);!this.isLimit(o)&&o.parent;)o=o.parent;return o}checkAttributeInSelection(e,o){if(e.isCollapsed){const _=[...e.getFirstPosition().getAncestors(),new gn("",e.getAttributes())];return this.checkAttribute(_,o)}else{const c=e.getRanges();for(const _ of c)for(const j of _)if(this.checkAttribute(j.item,o))return!0}return!1}*getValidRanges(e,o){e=UI(e);for(const c of e)yield*this._getValidRangesForRange(c,o)}getNearestSelectionRange(e,o="both"){if(this.checkChild(e,"$text"))return new Tt(e);let c,_;const j=e.getAncestors().reverse().find(_e=>this.isLimit(_e))||e.root;(o=="both"||o=="backward")&&(c=new Pr({boundaries:Tt._createIn(j),startPosition:e,direction:"backward"})),(o=="both"||o=="forward")&&(_=new Pr({boundaries:Tt._createIn(j),startPosition:e}));for(const _e of $I(c,_)){const et=_e.walker==c?"elementEnd":"elementStart",nt=_e.value;if(nt.type==et&&this.isObject(nt.item))return Tt._createOn(nt.item);if(this.checkChild(nt.nextPosition,"$text"))return new Tt(nt.nextPosition)}return null}findAllowedParent(e,o){let c=e.parent;for(;c;){if(this.checkChild(c,o))return c;if(this.isLimit(c))return null;c=c.parent}return null}removeDisallowedAttributes(e,o){for(const c of e)if(c.is("text"))k_(this,c,o);else{const j=Tt._createIn(c).getPositions();for(const _e of j){const et=_e.nodeBefore||_e.parent;k_(this,et,o)}}}createContext(e){return new ts(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},o=this._sourceDefinitions,c=Object.keys(o);for(const _ of c)e[_]=PI(o[_],_);for(const _ of c)RI(e,_);for(const _ of c)NI(e,_);for(const _ of c)OI(e,_),MI(e,_);for(const _ of c)jI(e,_),LI(e,_);this._compiledDefinitions=e}_checkContextMatch(e,o,c=o.length-1){const _=o.getItem(c);if(e.allowIn.includes(_.name)){if(c==0)return!0;{const j=this.getDefinition(_);return this._checkContextMatch(j,o,c-1)}}else return!1}*_getValidRangesForRange(e,o){let c=e.start,_=e.start;for(const j of e.getItems({shallow:!0}))j.is("element")&&(yield*this._getValidRangesForRange(Tt._createIn(j),o)),this.checkAttribute(j,o)||(c.isEqual(_)||(yield new Tt(c,_)),c=Mt._createAfter(j)),_=Mt._createAfter(j);c.isEqual(_)||(yield new Tt(c,_))}}Zt(y_,Mn);class ts{constructor(e){if(e instanceof ts)return e;typeof e=="string"?e=[e]:Array.isArray(e)||(e=e.getAncestors({includeSelf:!0})),e[0]&&typeof e[0]!="string"&&e[0].is("documentFragment")&&e.shift(),this._items=e.map(VI)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(e){const o=new ts([e]);return o._items=[...this._items,...o._items],o}getItem(e){return this._items[e]}*getNames(){yield*this._items.map(e=>e.name)}endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e)}startsWith(e){return Array.from(this.getNames()).join(" ").startsWith(e)}}function PI(h,e){const o={name:e,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],inheritTypesFrom:[]};return DI(h,o),ws(h,o,"allowIn"),ws(h,o,"allowContentOf"),ws(h,o,"allowWhere"),ws(h,o,"allowAttributes"),ws(h,o,"allowAttributesOf"),ws(h,o,"inheritTypesFrom"),FI(h,o),o}function RI(h,e){for(const o of h[e].allowContentOf)h[o]&&BI(h,o).forEach(_=>{_.allowIn.push(e)});delete h[e].allowContentOf}function NI(h,e){for(const o of h[e].allowWhere){const c=h[o];if(c){const _=c.allowIn;h[e].allowIn.push(..._)}}delete h[e].allowWhere}function OI(h,e){for(const o of h[e].allowAttributesOf){const c=h[o];if(c){const _=c.allowAttributes;h[e].allowAttributes.push(..._)}}delete h[e].allowAttributesOf}function MI(h,e){const o=h[e];for(const c of o.inheritTypesFrom){const _=h[c];if(_){const j=Object.keys(_).filter(_e=>_e.startsWith("is"));for(const _e of j)_e in o||(o[_e]=_[_e])}}delete o.inheritTypesFrom}function jI(h,e){const o=h[e],c=o.allowIn.filter(_=>h[_]);o.allowIn=Array.from(new Set(c))}function LI(h,e){const o=h[e];o.allowAttributes=Array.from(new Set(o.allowAttributes))}function DI(h,e){for(const o of h){const c=Object.keys(o).filter(_=>_.startsWith("is"));for(const _ of c)e[_]=o[_]}}function ws(h,e,o){for(const c of h)typeof c[o]=="string"?e[o].push(c[o]):Array.isArray(c[o])&&e[o].push(...c[o])}function FI(h,e){for(const o of h){const c=o.inheritAllFrom;c&&(e.allowContentOf.push(c),e.allowWhere.push(c),e.allowAttributesOf.push(c),e.inheritTypesFrom.push(c))}}function BI(h,e){const o=h[e];return zI(h).filter(c=>c.allowIn.includes(o.name))}function zI(h){return Object.keys(h).map(e=>h[e])}function VI(h){return typeof h=="string"?{name:h,*getAttributeKeys(){},getAttribute(){}}:{name:h.is("element")?h.name:"$text",*getAttributeKeys(){yield*h.getAttributeKeys()},getAttribute(e){return h.getAttribute(e)}}}function*$I(h,e){let o=!1;for(;!o;){if(o=!0,h){const c=h.next();c.done||(o=!1,yield{walker:h,value:c.value})}if(e){const c=e.next();c.done||(o=!1,yield{walker:e,value:c.value})}}}function*UI(h){for(const e of h)yield*e.getMinimalFlatRanges()}function k_(h,e,o){for(const c of e.getAttributeKeys())h.checkAttribute(e,c)||o.removeAttribute(c,e)}class x_{constructor(e={}){this._splitParts=new Map,this._modelCursor=null,this.conversionApi=Object.assign({},e),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this),this.conversionApi.splitToAllowedParent=this._splitToAllowedParent.bind(this),this.conversionApi.getSplitParts=this._getSplitParts.bind(this)}convert(e,o,c=["$root"]){this.fire("viewCleanup",e),this._modelCursor=HI(c,o),this.conversionApi.writer=o,this.conversionApi.consumable=Vs.createFrom(e),this.conversionApi.store={};const{modelRange:_}=this._convertItem(e,this._modelCursor),j=o.createDocumentFragment();if(_){this._removeEmptyElements();for(const _e of Array.from(this._modelCursor.parent.getChildren()))o.append(_e,j);j.markers=WI(j,o)}return this._modelCursor=null,this._splitParts.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,j}_convertItem(e,o){const c=Object.assign({viewItem:e,modelCursor:o,modelRange:null});if(e.is("element")?this.fire("element:"+e.name,c,this.conversionApi):e.is("text")?this.fire("text",c,this.conversionApi):this.fire("documentFragment",c,this.conversionApi),c.modelRange&&!(c.modelRange instanceof Tt))throw new yt.b("view-conversion-dispatcher-incorrect-result: Incorrect conversion result was dropped.",this);return{modelRange:c.modelRange,modelCursor:c.modelCursor}}_convertChildren(e,o){const c=new Tt(o);let _=o;for(const j of Array.from(e.getChildren())){const _e=this._convertItem(j,_);_e.modelRange instanceof Tt&&(c.end=_e.modelRange.end,_=_e.modelCursor)}return{modelRange:c,modelCursor:_}}_splitToAllowedParent(e,o){const c=this.conversionApi.schema.findAllowedParent(o,e);if(!c)return null;if(c===o.parent)return{position:o};if(this._modelCursor.parent.getAncestors().includes(c))return null;const _=this.conversionApi.writer.split(o,c),j=[];for(const _e of _.range.getWalker())if(_e.type=="elementEnd")j.push(_e.item);else{const et=j.pop(),nt=_e.item;this._registerSplitPair(et,nt)}return{position:_.position,cursorParent:_.range.end.parent}}_registerSplitPair(e,o){this._splitParts.has(e)||this._splitParts.set(e,[e]);const c=this._splitParts.get(e);this._splitParts.set(o,c),c.push(o)}_getSplitParts(e){let o;return this._splitParts.has(e)?o=this._splitParts.get(e):o=[e],o}_removeEmptyElements(){let e=!1;for(const o of this._splitParts.keys())o.isEmpty&&(this.conversionApi.writer.remove(o),this._splitParts.delete(o),e=!0);e&&this._removeEmptyElements()}}Zt(x_,xn);function WI(h,e){const o=new Set,c=new Map,_=Tt._createIn(h).getItems();for(const j of _)j.name=="$marker"&&o.add(j);for(const j of o){const _e=j.getAttribute("data-name"),et=e.createPositionBefore(j);c.has(_e)?c.get(_e).end=et.clone():c.set(_e,new Tt(et.clone())),e.remove(j)}return c}function HI(h,e){let o;for(const c of new ts(h)){const _={};for(const _e of c.getAttributeKeys())_[_e]=c.getAttribute(_e);const j=e.createElement(c.name,_);o&&e.append(j,o),o=Mt._createAt(j,0)}return o}class E_{constructor(e,o){this.model=e,this.stylesProcessor=o,this.processor,this.mapper=new du,this.downcastDispatcher=new hu({mapper:this.mapper}),this.downcastDispatcher.on("insert:$text",h_(),{priority:"lowest"}),this.upcastDispatcher=new x_({schema:e.schema}),this.viewDocument=new vo(o),this._viewWriter=new Em(this.viewDocument),this.upcastDispatcher.on("text",_I(),{priority:"lowest"}),this.upcastDispatcher.on("element",g_(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",g_(),{priority:"lowest"}),this.decorate("init"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"})}get(e){const{rootName:o="main",trim:c="empty"}=e||{};if(!this._checkIfRootsExists([o]))throw new yt.b("datacontroller-get-non-existent-root: Attempting to get data from a non-existing root.",this);const _=this.model.document.getRoot(o);return c==="empty"&&!this.model.hasContent(_,{ignoreWhitespaces:!0})?"":this.stringify(_)}stringify(e){const o=this.toView(e);return this.processor.toData(o)}toView(e){const o=this.viewDocument,c=this._viewWriter;this.mapper.clearBindings();const _=Tt._createIn(e),j=new ms(o);if(this.mapper.bindElements(e,j),this.downcastDispatcher.convertInsert(_,c),!e.is("documentFragment")){const _e=GI(e);for(const[et,nt]of _e)this.downcastDispatcher.convertMarkerAdd(et,nt,c)}return j}init(e){if(this.model.document.version)throw new yt.b("datacontroller-init-document-not-empty: Trying to set initial data to not empty document.",this);let o={};if(typeof e=="string"?o.main=e:o=e,!this._checkIfRootsExists(Object.keys(o)))throw new yt.b("datacontroller-init-non-existent-root: Attempting to init data on a non-existing root.",this);return this.model.enqueueChange("transparent",c=>{for(const _ of Object.keys(o)){const j=this.model.document.getRoot(_);c.insert(this.parse(o[_],j),j,0)}}),Promise.resolve()}set(e){let o={};if(typeof e=="string"?o.main=e:o=e,!this._checkIfRootsExists(Object.keys(o)))throw new yt.b("datacontroller-set-non-existent-root: Attempting to set data on a non-existing root.",this);this.model.enqueueChange("transparent",c=>{c.setSelection(null),c.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const _ of Object.keys(o)){const j=this.model.document.getRoot(_);c.remove(c.createRangeIn(j)),c.insert(this.parse(o[_],j),j,0)}})}parse(e,o="$root"){const c=this.processor.toView(e);return this.toModel(c,o)}toModel(e,o="$root"){return this.model.change(c=>this.upcastDispatcher.convert(e,c,o))}addStyleProcessorRules(e){e(this.stylesProcessor)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const o of e)if(!this.model.document.getRootNames().includes(o))return!1;return!0}}Zt(E_,Mn);function GI(h){const e=[],o=h.root.document;if(!o)return[];const c=Tt._createIn(h);for(const _ of o.model.markers){const j=c.getIntersection(_.getRange());j&&e.push([_.name,j])}return e}class qI{constructor(e,o){this._helpers=new Map,this._downcast=Array.isArray(e)?e:[e],this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=Array.isArray(o)?o:[o],this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,o){const c=this._downcast.includes(o);if(!this._upcast.includes(o)&&!c)throw new yt.b("conversion-add-alias-dispatcher-not-registered: Trying to register and alias for a dispatcher that nas not been registered.",this);this._createConversionHelpers({name:e,dispatchers:[o],isDowncast:c})}for(e){if(!this._helpers.has(e))throw new yt.b("conversion-for-unknown-group: Trying to add a converter to an unknown dispatchers group.",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:o,view:c}of gu(e))this.for("upcast").elementToElement({model:o,view:c,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:o,view:c}of gu(e))this.for("upcast").elementToAttribute({view:c,model:o,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:o,view:c}of gu(e))this.for("upcast").attributeToAttribute({view:c,model:o})}_createConversionHelpers({name:e,dispatchers:o,isDowncast:c}){if(this._helpers.has(e))throw new yt.b("conversion-group-exists: Trying to register a group name that has already been registered.",this);const _=c?new JS(o):new gI(o);this._helpers.set(e,_)}}function*gu(h){if(h.model.values)for(const e of h.model.values){const o={key:h.model.key,value:e},c=h.view[e],_=h.upcastAlso?h.upcastAlso[e]:void 0;yield*C_(o,c,_)}else yield*C_(h.model,h.view,h.upcastAlso)}function*C_(h,e,o){if(yield{model:h,view:e},o){o=Array.isArray(o)?o:[o];for(const c of o)yield{model:h,view:c}}}class Ro{constructor(e="default"){this.operations=[],this.type=e}get baseVersion(){for(const e of this.operations)if(e.baseVersion!==null)return e.baseVersion;return null}addOperation(e){return e.batch=this,this.operations.push(e),e}}class lr{constructor(e){this.baseVersion=e,this.isDocumentOperation=this.baseVersion!==null,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e){return new this(e.baseVersion)}}class Rr{constructor(e){this.markers=new Map,this._children=new _s,e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}is(e){return e=="documentFragment"||e=="model:documentFragment"}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let o=this;for(const c of e)o=o.getChild(o.offsetToIndex(c));return o}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const o of this._children)e.push(o.toJSON());return e}static fromJSON(e){const o=[];for(const c of e)c.name?o.push(vn.fromJSON(c)):o.push(gn.fromJSON(c));return new Rr(o)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,o){const c=KI(o);for(const _ of c)_.parent!==null&&_._remove(),_.parent=this;this._children._insertNodes(e,c)}_removeChildren(e,o=1){const c=this._children._removeNodes(e,o);for(const _ of c)_.parent=null;return c}}function KI(h){return typeof h=="string"?[new gn(h)]:(hr(h)||(h=[h]),Array.from(h).map(e=>typeof e=="string"?new gn(e):e instanceof yr?new gn(e.data,e.getAttributes()):e))}function _u(h,e){e=A_(e);const o=e.reduce((j,_e)=>j+_e.offsetSize,0),c=h.parent;Ws(h);const _=h.index;return c._insertChild(_,e),Us(c,_+e.length),Us(c,_),new Tt(h,h.getShiftedBy(o))}function T_(h){if(!h.isFlat)throw new yt.b("operation-utils-remove-range-not-flat: Trying to remove a range which starts and ends in different element.",this);const e=h.start.parent;Ws(h.start),Ws(h.end);const o=e._removeChildren(h.start.index,h.end.index-h.start.index);return Us(e,h.start.index),o}function $s(h,e){if(!h.isFlat)throw new yt.b("operation-utils-move-range-not-flat: Trying to move a range which starts and ends in different element.",this);const o=T_(h);return e=e._getTransformedByDeletion(h.start,h.end.offset-h.start.offset),_u(e,o)}function YI(h,e,o){Ws(h.start),Ws(h.end);for(const c of h.getItems({shallow:!0})){const _=c.is("textProxy")?c.textNode:c;o!==null?_._setAttribute(e,o):_._removeAttribute(e),Us(_.parent,_.index)}Us(h.end.parent,h.end.index)}function A_(h){const e=[];h instanceof Array||(h=[h]);for(let o=0;o<h.length;o++)if(typeof h[o]=="string")e.push(new gn(h[o]));else if(h[o]instanceof yr)e.push(new gn(h[o].data,h[o].getAttributes()));else if(h[o]instanceof Rr||h[o]instanceof _s)for(const c of h[o])e.push(c);else h[o]instanceof Zr&&e.push(h[o]);for(let o=1;o<e.length;o++){const c=e[o],_=e[o-1];c instanceof gn&&_ instanceof gn&&S_(c,_)&&(e.splice(o-1,2,new gn(_.data+c.data,_.getAttributes())),o--)}return e}function Us(h,e){const o=h.getChild(e-1),c=h.getChild(e);if(o&&c&&o.is("text")&&c.is("text")&&S_(o,c)){const _=new gn(o.data+c.data,o.getAttributes());h._removeChildren(e-1,2),h._insertChild(e-1,_)}}function Ws(h){const e=h.textNode,o=h.parent;if(e){const c=h.offset-e.startOffset,_=e.index;o._removeChildren(_,1);const j=new gn(e.data.substr(0,c),e.getAttributes()),_e=new gn(e.data.substr(c),e.getAttributes());o._insertChild(_,[j,_e])}}function S_(h,e){const o=h.getAttributes(),c=e.getAttributes();for(const _ of o){if(_[1]!==e.getAttribute(_[0]))return!1;c.next()}return c.next().done}function QI(h,e){return Km(h,e)}var I_=QI;class Nn extends lr{constructor(e,o,c,_,j){super(j),this.range=e.clone(),this.key=o,this.oldValue=c===void 0?null:c,this.newValue=_===void 0?null:_}get type(){return this.oldValue===null?"addAttribute":this.newValue===null?"removeAttribute":"changeAttribute"}clone(){return new Nn(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Nn(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new yt.b("attribute-operation-range-not-flat: The range to change is not flat.",this);for(const e of this.range.getItems({shallow:!0})){if(this.oldValue!==null&&!I_(e.getAttribute(this.key),this.oldValue))throw new yt.b("attribute-operation-wrong-old-value: Changed node has different attribute value than operation's old attribute value.",this,{item:e,key:this.key,value:this.oldValue});if(this.oldValue===null&&this.newValue!==null&&e.hasAttribute(this.key))throw new yt.b("attribute-operation-attribute-exists: The attribute with given key already exists.",this,{node:e,key:this.key})}}_execute(){I_(this.oldValue,this.newValue)||YI(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,o){return new Nn(Tt.fromJSON(e.range,o),e.key,e.oldValue,e.newValue,e.baseVersion)}}class JI extends lr{constructor(e,o){super(null),this.sourcePosition=e.clone(),this.howMany=o}get type(){return"detach"}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new yt.b("detach-operation-on-document-node: Cannot detach document node.",this)}_execute(){T_(Tt._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}class pn extends lr{constructor(e,o,c,_){super(_),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=o,this.targetPosition=c.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName=="$graveyard"?"remove":this.sourcePosition.root.rootName=="$graveyard"?"reinsert":"move"}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new this.constructor(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,o=this.targetPosition.parent,c=this.sourcePosition.offset,_=this.targetPosition.offset;if(c+this.howMany>e.maxOffset)throw new yt.b("move-operation-nodes-do-not-exist: The nodes which should be moved do not exist.",this);if(e===o&&c<_&&_<c+this.howMany)throw new yt.b("move-operation-range-into-itself: Trying to move a range of nodes to the inside of that range.",this);if(this.sourcePosition.root==this.targetPosition.root&&Yn(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())=="prefix"){const j=this.sourcePosition.path.length-1;if(this.targetPosition.path[j]>=c&&this.targetPosition.path[j]<c+this.howMany)throw new yt.b("move-operation-node-into-itself: Trying to move a range of nodes into one of nodes from that range.",this)}}_execute(){$s(Tt._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,o){const c=Mt.fromJSON(e.sourcePosition,o),_=Mt.fromJSON(e.targetPosition,o);return new this(c,e.howMany,_,e.baseVersion)}}class Fn extends lr{constructor(e,o,c){super(c),this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new _s(A_(o)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}clone(){const e=new _s([...this.nodes].map(c=>c._clone(!0))),o=new Fn(this.position,e,this.baseVersion);return o.shouldReceiveAttributes=this.shouldReceiveAttributes,o}getReversed(){const e=this.position.root.document.graveyard,o=new Mt(e,[0]);return new pn(this.position,this.nodes.maxOffset,o,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new yt.b("insert-operation-position-invalid: Insertion position is invalid.",this)}_execute(){const e=this.nodes;this.nodes=new _s([...e].map(o=>o._clone(!0))),_u(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,o){const c=[];for(const j of e.nodes)j.name?c.push(vn.fromJSON(j)):c.push(gn.fromJSON(j));const _=new Fn(Mt.fromJSON(e.position,o),c,e.baseVersion);return _.shouldReceiveAttributes=e.shouldReceiveAttributes,_}}class Zn extends lr{constructor(e,o,c,_,j,_e){super(_e),this.name=e,this.oldRange=o?o.clone():null,this.newRange=c?c.clone():null,this.affectsData=j,this._markers=_}get type(){return"marker"}clone(){return new Zn(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new Zn(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){const e=this.newRange?"_set":"_remove";this._markers[e](this.name,this.newRange,!0,this.affectsData)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,o){return new Zn(e.name,e.oldRange?Tt.fromJSON(e.oldRange,o):null,e.newRange?Tt.fromJSON(e.newRange,o):null,o.model.markers,e.affectsData,e.baseVersion)}}class _i extends lr{constructor(e,o,c,_){super(_),this.position=e,this.position.stickiness="toNext",this.oldName=o,this.newName=c}get type(){return"rename"}clone(){return new _i(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new _i(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(e instanceof vn){if(e.name!==this.oldName)throw new yt.b("rename-operation-wrong-name: Element to change has different name than operation's old name.",this)}else throw new yt.b("rename-operation-wrong-position: Given position is invalid or node after it is not an instance of Element.",this)}_execute(){const e=this.position.nodeAfter;e.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,o){return new _i(Mt.fromJSON(e.position,o),e.oldName,e.newName,e.baseVersion)}}class Nr extends lr{constructor(e,o,c,_,j){super(j),this.root=e,this.key=o,this.oldValue=c,this.newValue=_}get type(){return this.oldValue===null?"addRootAttribute":this.newValue===null?"removeRootAttribute":"changeRootAttribute"}clone(){return new Nr(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Nr(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new yt.b("rootattribute-operation-not-a-root: The element to change is not a root element.",this,{root:this.root,key:this.key});if(this.oldValue!==null&&this.root.getAttribute(this.key)!==this.oldValue)throw new yt.b("rootattribute-operation-wrong-old-value: Changed node has different attribute value than operation's old attribute value.",this,{root:this.root,key:this.key});if(this.oldValue===null&&this.newValue!==null&&this.root.hasAttribute(this.key))throw new yt.b("rootattribute-operation-attribute-exists: The attribute with given key already exists.",this,{root:this.root,key:this.key})}_execute(){this.newValue!==null?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,o){if(!o.getRoot(e.root))throw new yt.b("rootattribute-operation-fromjson-no-root: Cannot create RootAttributeOperation. Root with specified name does not exist.",this,{rootName:e.root});return new Nr(o.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}class Ln extends lr{constructor(e,o,c,_,j){super(j),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=o,this.targetPosition=c.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=_.clone()}get type(){return"merge"}get deletionPosition(){return new Mt(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new Tt(this.sourcePosition,e)}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),o=this.sourcePosition.path.slice(0,-1),c=new Mt(this.sourcePosition.root,o)._getTransformedByMergeOperation(this),_=new _n(e,this.howMany,this.graveyardPosition,this.baseVersion+1);return _.insertionPosition=c,_}_validate(){const e=this.sourcePosition.parent,o=this.targetPosition.parent;if(e.parent)if(o.parent){if(this.howMany!=e.maxOffset)throw new yt.b("merge-operation-how-many-invalid: Merge operation specifies wrong number of nodes to move.",this)}else throw new yt.b("merge-operation-target-position-invalid: Merge target position is invalid.",this);else throw new yt.b("merge-operation-source-position-invalid: Merge source position is invalid.",this)}_execute(){const e=this.sourcePosition.parent,o=Tt._createIn(e);$s(o,this.targetPosition),$s(Tt._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,o){const c=Mt.fromJSON(e.sourcePosition,o),_=Mt.fromJSON(e.targetPosition,o),j=Mt.fromJSON(e.graveyardPosition,o);return new this(c,e.howMany,_,j,e.baseVersion)}}class _n extends lr{constructor(e,o,c,_){super(_),this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=o,this.insertionPosition=_n.getInsertionPosition(e),this.insertionPosition.stickiness="toNone",this.graveyardPosition=c?c.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new Mt(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new Tt(this.splitPosition,e)}clone(){const e=new this.constructor(this.splitPosition,this.howMany,this.graveyardPosition,this.baseVersion);return e.insertionPosition=this.insertionPosition,e}getReversed(){const e=this.splitPosition.root.document.graveyard,o=new Mt(e,[0]);return new Ln(this.moveTargetPosition,this.howMany,this.splitPosition,o,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,o=this.splitPosition.offset;if(!e||e.maxOffset<o)throw new yt.b("split-operation-position-invalid: Split position is invalid.",this);if(e.parent){if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new yt.b("split-operation-how-many-invalid: Split operation specifies wrong number of nodes to move.",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new yt.b("split-operation-graveyard-position-invalid: Graveyard position invalid.",this)}else throw new yt.b("split-operation-split-in-root: Cannot split root element.",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)$s(Tt._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const c=e._clone();_u(this.insertionPosition,c)}const o=new Tt(Mt._createAt(e,this.splitPosition.offset),Mt._createAt(e,e.maxOffset));$s(o,this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const o=e.path.slice(0,-1);return o[o.length-1]++,new Mt(e.root,o)}static fromJSON(e,o){const c=Mt.fromJSON(e.splitPosition,o),_=Mt.fromJSON(e.insertionPosition,o),j=e.graveyardPosition?Mt.fromJSON(e.graveyardPosition,o):null,_e=new this(c,e.howMany,j,e.baseVersion);return _e.insertionPosition=_,_e}}class wu extends vn{constructor(e,o,c="main"){super(o),this._document=e,this.rootName=c}get document(){return this._document}is(e,o){const c=e.replace("model:","");return o?c=="rootElement"&&o==this.name||super.is(e,o):c=="rootElement"||super.is(e)}toJSON(){return this.rootName}}class XI{constructor(e,o){this.model=e,this.batch=o}createText(e,o){return new gn(e,o)}createElement(e,o){return new vn(e,o)}createDocumentFragment(){return new Rr}insert(e,o,c=0){if(this._assertWriterUsedCorrectly(),e instanceof gn&&e.data=="")return;const _=Mt._createAt(o,c);if(e.parent)if(N_(e.root,_.root)){this.move(Tt._createOn(e),_);return}else{if(e.root.document)throw new yt.b("model-writer-insert-forbidden-move: Cannot move a node from a document to a different tree. It is forbidden to move a node that was already in a document outside of it.",this);this.remove(e)}const j=_.root.document?_.root.document.version:null,_e=new Fn(_,e,j);if(e instanceof gn&&(_e.shouldReceiveAttributes=!0),this.batch.addOperation(_e),this.model.applyOperation(_e),e instanceof Rr)for(const[et,nt]of e.markers){const st=Mt._createAt(nt.root,0),ct={range:new Tt(nt.start._getCombined(st,_),nt.end._getCombined(st,_)),usingOperation:!0,affectsData:!0};this.model.markers.has(et)?this.updateMarker(et,ct):this.addMarker(et,ct)}}insertText(e,o,c,_){o instanceof Rr||o instanceof vn||o instanceof Mt?this.insert(this.createText(e),o,c):this.insert(this.createText(e,o),c,_)}insertElement(e,o,c,_){o instanceof Rr||o instanceof vn||o instanceof Mt?this.insert(this.createElement(e),o,c):this.insert(this.createElement(e,o),c,_)}append(e,o){this.insert(e,o,"end")}appendText(e,o,c){o instanceof Rr||o instanceof vn?this.insert(this.createText(e),o,"end"):this.insert(this.createText(e,o),c,"end")}appendElement(e,o,c){o instanceof Rr||o instanceof vn?this.insert(this.createElement(e),o,"end"):this.insert(this.createElement(e,o),c,"end")}setAttribute(e,o,c){if(this._assertWriterUsedCorrectly(),c instanceof Tt){const _=c.getMinimalFlatRanges();for(const j of _)P_(this,e,o,j)}else R_(this,e,o,c)}setAttributes(e,o){for(const[c,_]of Fr(e))this.setAttribute(c,_,o)}removeAttribute(e,o){if(this._assertWriterUsedCorrectly(),o instanceof Tt){const c=o.getMinimalFlatRanges();for(const _ of c)P_(this,e,null,_)}else R_(this,e,null,o)}clearAttributes(e){this._assertWriterUsedCorrectly();const o=c=>{for(const _ of c.getAttributeKeys())this.removeAttribute(_,c)};if(!(e instanceof Tt))o(e);else for(const c of e.getItems())o(c)}move(e,o,c){if(this._assertWriterUsedCorrectly(),!(e instanceof Tt))throw new yt.b("writer-move-invalid-range: Invalid range to move.",this);if(!e.isFlat)throw new yt.b("writer-move-range-not-flat: Range to move is not flat.",this);const _=Mt._createAt(o,c);if(_.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!N_(e.root,_.root))throw new yt.b("writer-move-different-document: Range is going to be moved between different documents.",this);const j=e.root.document?e.root.document.version:null,_e=new pn(e.start,e.end.offset-e.start.offset,_,j);this.batch.addOperation(_e),this.model.applyOperation(_e)}remove(e){this._assertWriterUsedCorrectly();const c=(e instanceof Tt?e:Tt._createOn(e)).getMinimalFlatRanges().reverse();for(const _ of c)this._addOperationForAffectedMarkers("move",_),ZI(_.start,_.end.offset-_.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const o=e.nodeBefore,c=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(o instanceof vn))throw new yt.b("writer-merge-no-element-before: Node before merge position must be an element.",this);if(!(c instanceof vn))throw new yt.b("writer-merge-no-element-after: Node after merge position must be an element.",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,o,c){return this.model.createPositionFromPath(e,o,c)}createPositionAt(e,o){return this.model.createPositionAt(e,o)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,o){return this.model.createRange(e,o)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(e,o,c){return this.model.createSelection(e,o,c)}_mergeDetached(e){const o=e.nodeBefore,c=e.nodeAfter;this.move(Tt._createIn(c),Mt._createAt(o,"end")),this.remove(c)}_merge(e){const o=Mt._createAt(e.nodeBefore,"end"),c=Mt._createAt(e.nodeAfter,0),_=e.root.document.graveyard,j=new Mt(_,[0]),_e=e.root.document.version,et=new Ln(c,e.nodeAfter.maxOffset,o,j,_e);this.batch.addOperation(et),this.model.applyOperation(et)}rename(e,o){if(this._assertWriterUsedCorrectly(),!(e instanceof vn))throw new yt.b("writer-rename-not-element-instance: Trying to rename an object which is not an instance of Element.",this);const c=e.root.document?e.root.document.version:null,_=new _i(Mt._createBefore(e),e.name,o,c);this.batch.addOperation(_),this.model.applyOperation(_)}split(e,o){this._assertWriterUsedCorrectly();let c=e.parent;if(!c.parent)throw new yt.b("writer-split-element-no-parent: Element with no parent can not be split.",this);if(o||(o=c.parent),!e.parent.getAncestors({includeSelf:!0}).includes(o))throw new yt.b("writer-split-invalid-limit-element: Limit element is not a position ancestor.",this);let _,j;do{const _e=c.root.document?c.root.document.version:null,et=c.maxOffset-e.offset,nt=new _n(e,et,null,_e);this.batch.addOperation(nt),this.model.applyOperation(nt),!_&&!j&&(_=c,j=e.parent.nextSibling),e=this.createPositionAfter(e.parent),c=e.parent}while(c!==o);return{position:e,range:new Tt(Mt._createAt(_,"end"),Mt._createAt(j,0))}}wrap(e,o){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new yt.b("writer-wrap-range-not-flat: Range to wrap is not flat.",this);const c=o instanceof vn?o:new vn(o);if(c.childCount>0)throw new yt.b("writer-wrap-element-not-empty: Element to wrap with is not empty.",this);if(c.parent!==null)throw new yt.b("writer-wrap-element-attached: Element to wrap with is already attached to tree model.",this);this.insert(c,e.start);const _=new Tt(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(_,Mt._createAt(c,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),e.parent===null)throw new yt.b("writer-unwrap-element-no-parent: Trying to unwrap an element which has no parent.",this);this.move(Tt._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,o){if(this._assertWriterUsedCorrectly(),!o||typeof o.usingOperation!="boolean")throw new yt.b("writer-addMarker-no-usingOperation: The options.usingOperation parameter is required when adding a new marker.",this);const c=o.usingOperation,_=o.range,j=o.affectsData===void 0?!1:o.affectsData;if(this.model.markers.has(e))throw new yt.b("writer-addMarker-marker-exists: Marker with provided name already exists.",this);if(!_)throw new yt.b("writer-addMarker-no-range: Range parameter is required when adding a new marker.",this);return c?(Hs(this,e,null,_,j),this.model.markers.get(e)):this.model.markers._set(e,_,c,j)}updateMarker(e,o){this._assertWriterUsedCorrectly();const c=typeof e=="string"?e:e.name,_=this.model.markers.get(c);if(!_)throw new yt.b("writer-updateMarker-marker-not-exists: Marker with provided name does not exists.",this);if(!o){this.model.markers._refresh(_);return}const j=typeof o.usingOperation=="boolean",_e=typeof o.affectsData=="boolean",et=_e?o.affectsData:_.affectsData;if(!j&&!o.range&&!_e)throw new yt.b("writer-updateMarker-wrong-options: One of the options is required - provide range, usingOperations or affectsData.",this);const nt=_.getRange(),st=o.range?o.range:nt;if(j&&o.usingOperation!==_.managedUsingOperations){o.usingOperation?Hs(this,c,null,st,et):(Hs(this,c,nt,null,et),this.model.markers._set(c,st,void 0,et));return}_.managedUsingOperations?Hs(this,c,nt,st,et):this.model.markers._set(c,st,void 0,et)}removeMarker(e){this._assertWriterUsedCorrectly();const o=typeof e=="string"?e:e.name;if(!this.model.markers.has(o))throw new yt.b("writer-removeMarker-no-marker: Trying to remove marker which does not exist.",this);const c=this.model.markers.get(o);if(!c.managedUsingOperations){this.model.markers._remove(o);return}const _=c.getRange();Hs(this,o,_,null,c.affectsData)}setSelection(e,o,c){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(e,o,c)}setSelectionFocus(e,o){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,o)}setSelectionAttribute(e,o){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._setSelectionAttribute(e,o);else for(const[c,_]of Fr(e))this._setSelectionAttribute(c,_)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._removeSelectionAttribute(e);else for(const o of e)this._removeSelectionAttribute(o)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,o){const c=this.model.document.selection;if(c.isCollapsed&&c.anchor.parent.isEmpty){const _=mr._getStoreAttributeKey(e);this.setAttribute(_,o,c.anchor.parent)}c._setAttribute(e,o)}_removeSelectionAttribute(e){const o=this.model.document.selection;if(o.isCollapsed&&o.anchor.parent.isEmpty){const c=mr._getStoreAttributeKey(e);this.removeAttribute(c,o.anchor.parent)}o._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new yt.b("writer-incorrect-use: Trying to use a writer outside the change() block.",this)}_addOperationForAffectedMarkers(e,o){for(const c of this.model.markers){if(!c.managedUsingOperations)continue;const _=c.getRange();let j=!1;if(e=="move")j=o.containsPosition(_.start)||o.start.isEqual(_.start)||o.containsPosition(_.end)||o.end.isEqual(_.end);else{const _e=o.nodeBefore,et=o.nodeAfter,nt=_.start.parent==_e&&_.start.isAtEnd,st=_.end.parent==et&&_.end.offset==0,at=_.end.nodeAfter==et,ct=_.start.nodeAfter==et;j=nt||st||at||ct}j&&this.updateMarker(c.name,{range:_})}}}function P_(h,e,o,c){const _=h.model,j=_.document;let _e=c.start,et,nt,st;for(const ct of c.getWalker({shallow:!0}))st=ct.item.getAttribute(e),et&&nt!=st&&(nt!=o&&at(),_e=et),et=ct.nextPosition,nt=st;et instanceof Mt&&et!=_e&&nt!=o&&at();function at(){const ct=new Tt(_e,et),dt=ct.root.document?j.version:null,gt=new Nn(ct,e,nt,o,dt);h.batch.addOperation(gt),_.applyOperation(gt)}}function R_(h,e,o,c){const _=h.model,j=_.document,_e=c.getAttribute(e);let et,nt;if(_e!=o){if(c.root===c){const at=c.document?j.version:null;nt=new Nr(c,e,_e,o,at)}else{et=new Tt(Mt._createBefore(c),h.createPositionAfter(c));const at=et.root.document?j.version:null;nt=new Nn(et,e,_e,o,at)}h.batch.addOperation(nt),_.applyOperation(nt)}}function Hs(h,e,o,c,_){const j=h.model,_e=j.document,et=new Zn(e,o,c,j.markers,_,_e.version);h.batch.addOperation(et),j.applyOperation(et)}function ZI(h,e,o,c){let _;if(h.root.document){const j=c.document,_e=new Mt(j.graveyard,[0]);_=new pn(h,e,_e,j.version)}else _=new JI(h,e);o.addOperation(_),c.applyOperation(_)}function N_(h,e){return h===e||h instanceof wu&&e instanceof wu}class eP{constructor(e){this._markerCollection=e,this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null}get isEmpty(){return this._changesInElement.size==0&&this._changedMarkers.size==0}refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize);const o=Tt._createOn(e);for(const c of this._markerCollection.getMarkersIntersectingRange(o)){const _=c.getRange();this.bufferMarkerChange(c.name,_,_,c.affectsData)}this._cachedChanges=null}bufferOperation(e){switch(e.type){case"insert":{if(this._isInInsertedElement(e.position.parent))return;this._markInsert(e.position.parent,e.position.offset,e.nodes.maxOffset);break}case"addAttribute":case"removeAttribute":case"changeAttribute":{for(const o of e.range.getItems({shallow:!0}))this._isInInsertedElement(o.parent)||this._markAttribute(o);break}case"remove":case"move":case"reinsert":{if(e.sourcePosition.isEqual(e.targetPosition)||e.sourcePosition.getShiftedBy(e.howMany).isEqual(e.targetPosition))return;const o=this._isInInsertedElement(e.sourcePosition.parent),c=this._isInInsertedElement(e.targetPosition.parent);o||this._markRemove(e.sourcePosition.parent,e.sourcePosition.offset,e.howMany),c||this._markInsert(e.targetPosition.parent,e.getMovedRangeStart().offset,e.howMany);break}case"rename":{if(this._isInInsertedElement(e.position.parent))return;this._markRemove(e.position.parent,e.position.offset,1),this._markInsert(e.position.parent,e.position.offset,1);const o=Tt._createFromPositionAndShift(e.position,1);for(const c of this._markerCollection.getMarkersIntersectingRange(o)){const _=c.getRange();this.bufferMarkerChange(c.name,_,_,c.affectsData)}break}case"split":{const o=e.splitPosition.parent;this._isInInsertedElement(o)||this._markRemove(o,e.splitPosition.offset,e.howMany),this._isInInsertedElement(e.insertionPosition.parent)||this._markInsert(e.insertionPosition.parent,e.insertionPosition.offset,1),e.graveyardPosition&&this._markRemove(e.graveyardPosition.parent,e.graveyardPosition.offset,1);break}case"merge":{const o=e.sourcePosition.parent;this._isInInsertedElement(o.parent)||this._markRemove(o.parent,o.startOffset,1);const c=e.graveyardPosition.parent;this._markInsert(c,e.graveyardPosition.offset,1);const _=e.targetPosition.parent;this._isInInsertedElement(_)||this._markInsert(_,e.targetPosition.offset,o.maxOffset);break}}this._cachedChanges=null}bufferMarkerChange(e,o,c,_){const j=this._changedMarkers.get(e);j?(j.newRange=c,j.affectsData=_,j.oldRange==null&&j.newRange==null&&this._changedMarkers.delete(e)):this._changedMarkers.set(e,{oldRange:o,newRange:c,affectsData:_})}getMarkersToRemove(){const e=[];for(const[o,c]of this._changedMarkers)c.oldRange!=null&&e.push({name:o,range:c.oldRange});return e}getMarkersToAdd(){const e=[];for(const[o,c]of this._changedMarkers)c.newRange!=null&&e.push({name:o,range:c.newRange});return e}getChangedMarkers(){return Array.from(this._changedMarkers).map(e=>({name:e[0],data:{oldRange:e[1].oldRange,newRange:e[1].newRange}}))}hasDataChanges(){for(const[,e]of this._changedMarkers)if(e.affectsData)return!0;return this._changesInElement.size>0}getChanges(e={includeChangesInGraveyard:!1}){if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();const o=[];for(const c of this._changesInElement.keys()){const _=this._changesInElement.get(c).sort((at,ct)=>at.offset===ct.offset?at.type!=ct.type?at.type=="remove"?-1:1:0:at.offset<ct.offset?-1:1),j=this._elementSnapshots.get(c),_e=O_(c.getChildren()),et=tP(j.length,_);let nt=0,st=0;for(const at of et)if(at==="i")o.push(this._getInsertDiff(c,nt,_e[nt].name)),nt++;else if(at==="r")o.push(this._getRemoveDiff(c,nt,j[st].name)),st++;else if(at==="a"){const ct=_e[nt].attributes,dt=j[st].attributes;let gt;if(_e[nt].name=="$text")gt=new Tt(Mt._createAt(c,nt),Mt._createAt(c,nt+1));else{const kt=c.offsetToIndex(nt);gt=new Tt(Mt._createAt(c,nt),Mt._createAt(c.getChild(kt),0))}o.push(...this._getAttributesDiff(gt,dt,ct)),nt++,st++}else nt++,st++}o.sort((c,_)=>c.position.root!=_.position.root?c.position.root.rootName<_.position.root.rootName?-1:1:c.position.isEqual(_.position)?c.changeCount-_.changeCount:c.position.isBefore(_.position)?-1:1);for(let c=1;c<o.length;c++){const _=o[c-1],j=o[c],_e=_.type=="remove"&&j.type=="remove"&&_.name=="$text"&&j.name=="$text"&&_.position.isEqual(j.position),et=_.type=="insert"&&j.type=="insert"&&_.name=="$text"&&j.name=="$text"&&_.position.parent==j.position.parent&&_.position.offset+_.length==j.position.offset,nt=_.type=="attribute"&&j.type=="attribute"&&_.position.parent==j.position.parent&&_.range.isFlat&&j.range.isFlat&&_.position.offset+_.length==j.position.offset&&_.attributeKey==j.attributeKey&&_.attributeOldValue==j.attributeOldValue&&_.attributeNewValue==j.attributeNewValue;(_e||et||nt)&&(o[c-1].length++,nt&&(o[c-1].range.end=o[c-1].range.end.getShiftedBy(1)),o.splice(c,1),c--)}for(const c of o)delete c.changeCount,c.type=="attribute"&&(delete c.position,delete c.length);return this._changeCount=0,this._cachedChangesWithGraveyard=o.slice(),this._cachedChanges=o.slice().filter(nP),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard:this._cachedChanges}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._cachedChanges=null}_markInsert(e,o,c){const _={type:"insert",offset:o,howMany:c,count:this._changeCount++};this._markChange(e,_)}_markRemove(e,o,c){const _={type:"remove",offset:o,howMany:c,count:this._changeCount++};this._markChange(e,_),this._removeAllNestedChanges(e,o,c)}_markAttribute(e){const o={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,o)}_markChange(e,o){this._makeSnapshot(e);const c=this._getChangesForElement(e);this._handleChange(o,c),c.push(o);for(let _=0;_<c.length;_++)c[_].howMany<1&&(c.splice(_,1),_--)}_getChangesForElement(e){let o;return this._changesInElement.has(e)?o=this._changesInElement.get(e):(o=[],this._changesInElement.set(e,o)),o}_makeSnapshot(e){this._elementSnapshots.has(e)||this._elementSnapshots.set(e,O_(e.getChildren()))}_handleChange(e,o){e.nodesToHandle=e.howMany;for(const c of o){const _=e.offset+e.howMany,j=c.offset+c.howMany;if(e.type=="insert"&&(c.type=="insert"&&(e.offset<=c.offset?c.offset+=e.howMany:e.offset<j&&(c.howMany+=e.nodesToHandle,e.nodesToHandle=0)),c.type=="remove"&&e.offset<c.offset&&(c.offset+=e.howMany),c.type=="attribute")){if(e.offset<=c.offset)c.offset+=e.howMany;else if(e.offset<j){const _e=c.howMany;c.howMany=e.offset-c.offset,o.unshift({type:"attribute",offset:_,howMany:_e-c.howMany,count:this._changeCount++})}}if(e.type=="remove"){if(c.type=="insert"){if(_<=c.offset)c.offset-=e.howMany;else if(_<=j)if(e.offset<c.offset){const _e=_-c.offset;c.offset=e.offset,c.howMany-=_e,e.nodesToHandle-=_e}else c.howMany-=e.nodesToHandle,e.nodesToHandle=0;else if(e.offset<=c.offset)e.nodesToHandle-=c.howMany,c.howMany=0;else if(e.offset<j){const _e=j-e.offset;c.howMany-=_e,e.nodesToHandle-=_e}}if(c.type=="remove"&&(_<=c.offset?c.offset-=e.howMany:e.offset<c.offset&&(e.nodesToHandle+=c.howMany,c.howMany=0)),c.type=="attribute"){if(_<=c.offset)c.offset-=e.howMany;else if(e.offset<c.offset){const _e=_-c.offset;c.offset=e.offset,c.howMany-=_e}else if(e.offset<j)if(_<=j){const _e=c.howMany;c.howMany=e.offset-c.offset;const et=_e-c.howMany-e.nodesToHandle;o.unshift({type:"attribute",offset:e.offset,howMany:et,count:this._changeCount++})}else c.howMany-=j-e.offset}}if(e.type=="attribute"){if(c.type=="insert")if(e.offset<c.offset&&_>c.offset){if(_>j){const _e={type:"attribute",offset:j,howMany:_-j,count:this._changeCount++};this._handleChange(_e,o),o.push(_e)}e.nodesToHandle=c.offset-e.offset,e.howMany=e.nodesToHandle}else e.offset>=c.offset&&e.offset<j&&(_>j?(e.nodesToHandle=_-j,e.offset=j):e.nodesToHandle=0);if(c.type=="remove"&&e.offset<c.offset&&_>c.offset){const _e={type:"attribute",offset:c.offset,howMany:_-c.offset,count:this._changeCount++};this._handleChange(_e,o),o.push(_e),e.nodesToHandle=c.offset-e.offset,e.howMany=e.nodesToHandle}c.type=="attribute"&&(e.offset>=c.offset&&_<=j?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=c.offset&&_>=j&&(c.howMany=0))}}e.howMany=e.nodesToHandle,delete e.nodesToHandle}_getInsertDiff(e,o,c){return{type:"insert",position:Mt._createAt(e,o),name:c,length:1,changeCount:this._changeCount++}}_getRemoveDiff(e,o,c){return{type:"remove",position:Mt._createAt(e,o),name:c,length:1,changeCount:this._changeCount++}}_getAttributesDiff(e,o,c){const _=[];c=new Map(c);for(const[j,_e]of o){const et=c.has(j)?c.get(j):null;et!==_e&&_.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:j,attributeOldValue:_e,attributeNewValue:et,changeCount:this._changeCount++}),c.delete(j)}for(const[j,_e]of c)_.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:j,attributeOldValue:null,attributeNewValue:_e,changeCount:this._changeCount++});return _}_isInInsertedElement(e){const o=e.parent;if(!o)return!1;const c=this._changesInElement.get(o),_=e.startOffset;if(c){for(const j of c)if(j.type=="insert"&&_>=j.offset&&_<j.offset+j.howMany)return!0}return this._isInInsertedElement(o)}_removeAllNestedChanges(e,o,c){const _=new Tt(Mt._createAt(e,o),Mt._createAt(e,o+c));for(const j of _.getItems({shallow:!0}))j.is("element")&&(this._elementSnapshots.delete(j),this._changesInElement.delete(j),this._removeAllNestedChanges(j,0,j.maxOffset))}}function O_(h){const e=[];for(const o of h)if(o.is("text"))for(let c=0;c<o.data.length;c++)e.push({name:"$text",attributes:new Map(o.getAttributes())});else e.push({name:o.name,attributes:new Map(o.getAttributes())});return e}function tP(h,e){const o=[];let c=0,_=0;for(const j of e){if(j.offset>c){for(let _e=0;_e<j.offset-c;_e++)o.push("e");_+=j.offset-c}if(j.type=="insert"){for(let _e=0;_e<j.howMany;_e++)o.push("i");c=j.offset+j.howMany}else if(j.type=="remove"){for(let _e=0;_e<j.howMany;_e++)o.push("r");c=j.offset,_+=j.howMany}else o.push(..."a".repeat(j.howMany).split("")),c=j.offset+j.howMany,_+=j.howMany}if(_<h)for(let j=0;j<h-_-c;j++)o.push("e");return o}function nP(h){const e=h.position&&h.position.root.rootName=="$graveyard",o=h.range&&h.range.root.rootName=="$graveyard";return!e&&!o}class iP{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set}addOperation(e){this._operations.includes(e)||this._operations.push(e)}getOperations(e=0,o=Number.POSITIVE_INFINITY){return e<0?[]:this._operations.slice(e,o)}getOperation(e){return this._operations[e]}setOperationAsUndone(e,o){this._undoPairs.set(o,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}}function rP(h){return!!h&&h.length==1&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(h)}function sP(h){return!!h&&h.length==1&&/[\ud800-\udbff]/.test(h)}function oP(h){return!!h&&h.length==1&&/[\udc00-\udfff]/.test(h)}function M_(h,e){return sP(h.charAt(e-1))&&oP(h.charAt(e))}function j_(h,e){return rP(h.charAt(e))}const vu="$graveyard";class L_{constructor(e){this.model=e,this.version=0,this.history=new iP(this),this.selection=new mr(this),this.roots=new or({idProperty:"rootName"}),this.differ=new eP(e.markers),this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",vu),this.listenTo(e,"applyOperation",(o,c)=>{const _=c[0];if(_.isDocumentOperation&&_.baseVersion!==this.version)throw new yt.b("model-document-applyOperation-wrong-version: Only operations with matching versions can be applied.",this,{operation:_})},{priority:"highest"}),this.listenTo(e,"applyOperation",(o,c)=>{const _=c[0];_.isDocumentOperation&&this.differ.bufferOperation(_)},{priority:"high"}),this.listenTo(e,"applyOperation",(o,c)=>{const _=c[0];_.isDocumentOperation&&(this.version++,this.history.addOperation(_))},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(e.markers,"update",(o,c,_,j)=>{this.differ.bufferMarkerChange(c.name,_,j,c.affectsData),_===null&&c.on("change",(_e,et)=>{this.differ.bufferMarkerChange(c.name,et,c.getRange(),c.affectsData)})})}get graveyard(){return this.getRoot(vu)}createRoot(e="$root",o="main"){if(this.roots.get(o))throw new yt.b("model-document-createRoot-name-exists: Root with specified name already exists.",this,{name:o});const c=new wu(this,e,o);return this.roots.add(c),c}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(){return Array.from(this.roots,e=>e.rootName).filter(e=>e!=vu)}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=Qp(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){for(const e of this.roots)if(e!==this.graveyard)return e;return this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),o=this.model,c=o.schema,_=o.createPositionFromPath(e,[0]);return c.getNearestSelectionRange(_)||o.createRange(_)}_validateSelectionRange(e){return D_(e.start)&&D_(e.end)}_callPostFixers(e){let o=!1;do for(const c of this._postFixers)if(this.selection.refresh(),o=c(e),o)break;while(o)}}Zt(L_,xn);function D_(h){const e=h.textNode;if(e){const o=e.data,c=h.offset-e.startOffset;return!M_(o,c)&&!j_(o,c)}return!0}class F_{constructor(){this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(e){return this._markers.has(e)}get(e){return this._markers.get(e)||null}_set(e,o,c=!1,_=!1){const j=e instanceof Gs?e.name:e,_e=this._markers.get(j);if(_e){const st=_e.getRange();let at=!1;return st.isEqual(o)||(_e._attachLiveRange($r.fromRange(o)),at=!0),c!=_e.managedUsingOperations&&(_e._managedUsingOperations=c,at=!0),typeof _=="boolean"&&_!=_e.affectsData&&(_e._affectsData=_,at=!0),at&&this.fire("update:"+j,_e,st,o),_e}const et=$r.fromRange(o),nt=new Gs(j,et,c,_);return this._markers.set(j,nt),this.fire("update:"+j,nt,null,o),nt}_remove(e){const o=e instanceof Gs?e.name:e,c=this._markers.get(o);return c?(this._markers.delete(o),this.fire("update:"+o,c,c.getRange(),null),this._destroyMarker(c),!0):!1}_refresh(e){const o=e instanceof Gs?e.name:e,c=this._markers.get(o);if(!c)throw new yt.b("markercollection-refresh-marker-not-exists: Marker with provided name does not exists.",this);const _=c.getRange();this.fire("update:"+o,c,_,_,c.managedUsingOperations,c.affectsData)}*getMarkersAtPosition(e){for(const o of this)o.getRange().containsPosition(e)&&(yield o)}*getMarkersIntersectingRange(e){for(const o of this)o.getRange().getIntersection(e)!==null&&(yield o)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const o of this._markers.values())o.name.startsWith(e+":")&&(yield o)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}Zt(F_,xn);class Gs{constructor(e,o,c,_){this.name=e,this._liveRange=this._attachLiveRange(o),this._managedUsingOperations=c,this._affectsData=_}get managedUsingOperations(){if(!this._liveRange)throw new yt.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new yt.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._affectsData}getStart(){if(!this._liveRange)throw new yt.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new yt.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new yt.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._liveRange.toRange()}is(e){return e=="marker"||e=="model:marker"}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}Zt(Gs,xn);class Wn extends lr{get type(){return"noop"}clone(){return new Wn(this.baseVersion)}getReversed(){return new Wn(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}const gr={};gr[Nn.className]=Nn,gr[Fn.className]=Fn,gr[Zn.className]=Zn,gr[pn.className]=pn,gr[Wn.className]=Wn,gr[lr.className]=lr,gr[_i.className]=_i,gr[Nr.className]=Nr,gr[_n.className]=_n,gr[Ln.className]=Ln;class aP{static fromJSON(e,o){return gr[e.__className].fromJSON(e,o)}}class Gn extends Mt{constructor(e,o,c="toNone"){if(super(e,o,c),!this.root.is("rootElement"))throw new yt.b("model-liveposition-root-not-rootelement: LivePosition's root has to be an instance of RootElement.",e);lP.call(this)}detach(){this.stopListening()}is(e){return e=="livePosition"||e=="model:livePosition"||super.is(e)}toPosition(){return new Mt(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,o){return new this(e.root,e.path.slice(),o||e.stickiness)}}function lP(){this.listenTo(this.root.document.model,"applyOperation",(h,e)=>{const o=e[0];o.isDocumentOperation&&cP.call(this,o)},{priority:"low"})}function cP(h){const e=this.getTransformedByOperation(h);if(!this.isEqual(e)){const o=this.toPosition();this.path=e.path,this.root=e.root,this.fire("change",o)}}Zt(Gn,xn);function uP(h,e,o,c){return h.change(_=>{let j;o?o instanceof kr||o instanceof mr?j=o:j=_.createSelection(o,c):j=h.document.selection,j.isCollapsed||h.deleteContent(j,{doNotAutoparagraph:!0});const _e=new dP(h,_,j.anchor);let et;e.is("documentFragment")?et=e.getChildren():et=[e],_e.handleNodes(et,{isFirst:!0,isLast:!0});const nt=_e.getSelectionRange();nt&&(j instanceof mr?_.setSelection(nt):j.setTo(nt));const st=_e.getAffectedRange()||h.createRange(j.anchor);return _e.destroy(),st})}class dP{constructor(e,o,c){this.model=e,this.writer=o,this.position=c,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._filterAttributesOf=[],this._affectedStart=null,this._affectedEnd=null}handleNodes(e,o){e=Array.from(e);for(let c=0;c<e.length;c++){const _=e[c];this._handleNode(_,{isFirst:c===0&&o.isFirst,isLast:c===e.length-1&&o.isLast})}this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}getSelectionRange(){return this.nodeToSelect?Tt._createOn(this.nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new Tt(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e,o){if(this.schema.isObject(e)){this._handleObject(e,o);return}if(!this._checkAndSplitToAllowedPosition(e,o)){this._handleDisallowedNode(e,o);return}this._insert(e),this._mergeSiblingsOf(e,o)}_handleObject(e,o){this._checkAndSplitToAllowedPosition(e)?this._insert(e):this._tryAutoparagraphing(e,o)}_handleDisallowedNode(e,o){e.is("element")?this.handleNodes(e.getChildren(),o):this._tryAutoparagraphing(e,o)}_insert(e){if(!this.schema.checkChild(this.position,e))throw new yt.b("insertcontent-wrong-position: Given node cannot be inserted on the given position.",this,{node:e,position:this.position});const o=Gn.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this.writer.insert(e,this.position),this.position=o.toPosition(),o.detach(),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this.nodeToSelect=e:this.nodeToSelect=null,this._filterAttributesOf.push(e)}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=Gn.fromPosition(e,"toPrevious")),(!this._affectedEnd||this._affectedEnd.isBefore(e))&&(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=Gn.fromPosition(e,"toNext"))}_mergeSiblingsOf(e,o){if(!(e instanceof vn))return;const c=this._canMergeLeft(e,o),_=this._canMergeRight(e,o),j=Gn._createBefore(e);j.stickiness="toNext";const _e=Gn._createAfter(e);if(_e.stickiness="toNext",c){const et=Gn.fromPosition(this.position);et.stickiness="toNext",this._affectedStart.isEqual(j)&&(this._affectedStart.detach(),this._affectedStart=Gn._createAt(j.nodeBefore,"end","toPrevious")),this.writer.merge(j),j.isEqual(this._affectedEnd)&&o.isLast&&(this._affectedEnd.detach(),this._affectedEnd=Gn._createAt(j.nodeBefore,"end","toNext")),this.position=et.toPosition(),et.detach()}if(_){if(!this.position.isEqual(_e))throw new yt.b("insertcontent-invalid-insertion-position",this);this.position=Mt._createAt(_e.nodeBefore,"end");const et=Gn.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(_e)&&(this._affectedEnd.detach(),this._affectedEnd=Gn._createAt(_e.nodeBefore,"end","toNext")),this.writer.merge(_e),_e.getShiftedBy(-1).isEqual(this._affectedStart)&&o.isFirst&&(this._affectedStart.detach(),this._affectedStart=Gn._createAt(_e.nodeBefore,0,"toPrevious")),this.position=et.toPosition(),et.detach()}(c||_)&&this._filterAttributesOf.push(this.position.parent),j.detach(),_e.detach()}_canMergeLeft(e,o){const c=e.previousSibling;return o.isFirst&&c instanceof vn&&this.canMergeWith.has(c)&&this.model.schema.checkMerge(c,e)}_canMergeRight(e,o){const c=e.nextSibling;return o.isLast&&c instanceof vn&&this.canMergeWith.has(c)&&this.model.schema.checkMerge(e,c)}_tryAutoparagraphing(e,o){const c=this.writer.createElement("paragraph");this._getAllowedIn(c,this.position.parent)&&this.schema.checkChild(c,e)&&(c._appendChild(e),this._handleNode(c,o))}_checkAndSplitToAllowedPosition(e){const o=this._getAllowedIn(e,this.position.parent);if(!o)return!1;for(;o!=this.position.parent;){if(this.schema.isLimit(this.position.parent))return!1;if(this.position.isAtStart){const c=this.position.parent;this.position=this.writer.createPositionBefore(c),c.isEmpty&&c.parent===o&&this.writer.remove(c)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const c=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=c,this.canMergeWith.add(this.position.nodeAfter)}}return!0}_getAllowedIn(e,o){return this.schema.checkChild(o,e)?o:o.parent?this._getAllowedIn(e,o.parent):null}}function hP(h,e,o={}){if(e.isCollapsed)return;const c=e.getFirstRange();if(c.root.rootName=="$graveyard")return;const _=h.schema;h.change(j=>{if(!o.doNotResetEntireContent&&gP(_,e)){mP(j,e);return}const _e=c.start,et=Gn.fromPosition(c.end,"toNext");c.start.isTouching(c.end)||j.remove(c),o.leaveUnmerged||(B_(j,_e,et),_.removeDisallowedAttributes(_e.parent.getChildren(),j)),V_(j,e,_e),!o.doNotAutoparagraph&&fP(_,_e)&&z_(j,_e,e),et.detach()})}function B_(h,e,o){const c=e.parent,_=o.parent;if(c!=_&&!(h.model.schema.isLimit(c)||h.model.schema.isLimit(_))&&pP(e,o,h.model.schema)){for(e=h.createPositionAfter(c),o=h.createPositionBefore(_),o.isEqual(e)||h.insert(_,e),h.merge(e);o.parent.isEmpty;){const j=o.parent;o=h.createPositionBefore(j),h.remove(j)}B_(h,e,o)}}function fP(h,e){const o=h.checkChild(e,"$text"),c=h.checkChild(e,"paragraph");return!o&&c}function pP(h,e,o){const c=new Tt(h,e);for(const _ of c.getWalker())if(o.isLimit(_.item))return!1;return!0}function z_(h,e,o){const c=h.createElement("paragraph");h.insert(c,e),V_(h,o,h.createPositionAt(c,0))}function mP(h,e){const o=h.model.schema.getLimitElement(e);h.remove(h.createRangeIn(o)),z_(h,h.createPositionAt(o,0),e)}function gP(h,e){const o=h.getLimitElement(e);if(!e.containsEntireContent(o))return!1;const c=e.getFirstRange();return c.start.parent==c.end.parent?!1:h.checkChild(o,"paragraph")}function V_(h,e,o){e instanceof mr?h.setSelection(o):e.setTo(o)}const $_=' ,.?!:;"-()';function _P(h,e,o={}){const c=h.schema,_=o.direction!="backward",j=o.unit?o.unit:"character",_e=e.focus,et=new Pr({boundaries:yP(_e,_),singleCharacters:!0,direction:_?"forward":"backward"}),nt={walker:et,schema:c,isForward:_,unit:j};let st;for(;st=et.next();){if(st.done)return;const at=wP(nt,st.value);if(at){e instanceof mr?h.change(ct=>{ct.setSelectionFocus(at)}):e.setFocus(at);return}}}function wP(h,e){if(e.type=="text")return h.unit==="word"?bP(h.walker,h.isForward):vP(h.walker,h.unit);if(e.type==(h.isForward?"elementStart":"elementEnd")){if(h.schema.isObject(e.item))return Mt._createAt(e.item,h.isForward?"after":"before");if(h.schema.checkChild(e.nextPosition,"$text"))return e.nextPosition}else{if(h.schema.isLimit(e.item)){h.walker.skip(()=>!0);return}if(h.schema.checkChild(e.nextPosition,"$text"))return e.nextPosition}}function vP(h,e){const o=h.position.textNode;if(o){const c=o.data;let _=h.position.offset-o.startOffset;for(;M_(c,_)||e=="character"&&j_(c,_);)h.next(),_=h.position.offset-o.startOffset}return h.position}function bP(h,e){let o=h.position.textNode;if(o){let c=h.position.offset-o.startOffset;for(;!kP(o.data,c,e)&&!xP(o,c,e);){h.next();const _=e?h.position.nodeAfter:h.position.nodeBefore;if(_&&_.is("text")){const j=_.data.charAt(e?0:_.data.length-1);$_.includes(j)||(h.next(),o=h.position.textNode)}c=h.position.offset-o.startOffset}}return h.position}function yP(h,e){const o=h.root,c=Mt._createAt(o,e?"end":0);return e?new Tt(h,c):new Tt(c,h)}function kP(h,e,o){const c=e+(o?0:-1);return $_.includes(h.charAt(c))}function xP(h,e,o){return e===(o?h.endOffset:0)}function EP(h,e){return h.change(o=>{const c=o.createDocumentFragment(),_=e.getFirstRange();if(!_||_.isCollapsed)return c;const j=_.start.root,_e=_.start.getCommonPath(_.end),et=j.getNodeByPath(_e);let nt;_.start.parent==_.end.parent?nt=_:nt=o.createRange(o.createPositionAt(et,_.start.path[_e.length]),o.createPositionAt(et,_.end.path[_e.length]+1));const st=nt.end.offset-nt.start.offset;for(const at of nt.getItems({shallow:!0}))at.is("textProxy")?o.appendText(at.data,at.getAttributes(),c):o.append(at._clone(!0),c);if(nt!=_){const at=_._getTransformedByMove(nt.start,o.createPositionAt(c,0),st)[0],ct=o.createRange(o.createPositionAt(c,0),at.start),dt=o.createRange(at.end,o.createPositionAt(c,"end"));U_(dt,o),U_(ct,o)}return c})}function U_(h,e){const o=[];Array.from(h.getItems({direction:"backward"})).map(c=>e.createRangeOn(c)).filter(c=>(c.start.isAfter(h.start)||c.start.isEqual(h.start))&&(c.end.isBefore(h.end)||c.end.isEqual(h.end))).forEach(c=>{o.push(c.start.parent),e.remove(c)}),o.forEach(c=>{let _=c;for(;_.parent&&_.isEmpty;){const j=e.createRangeOn(_);_=_.parent,e.remove(j)}})}function CP(h){h.document.registerPostFixer(e=>TP(e,h))}function TP(h,e){const o=e.document.selection,c=e.schema,_=[];let j=!1;for(const _e of o.getRanges()){const et=AP(_e,c);et?(_.push(et),j=!0):_.push(_e)}j&&h.setSelection(RP(_),{backward:o.isBackward})}function AP(h,e){return h.isCollapsed?SP(h,e):IP(h,e)}function SP(h,e){const o=h.start,c=e.getNearestSelectionRange(o);if(!c)return null;if(!c.isCollapsed)return c;const _=c.start;return o.isEqual(_)?null:new Tt(_)}function IP(h,e){const o=h.start,c=h.end,_=e.checkChild(o,"$text"),j=e.checkChild(c,"$text"),_e=e.getLimitElement(o),et=e.getLimitElement(c);if(_e===et){if(_&&j)return null;if(PP(o,c,e)){const ct=o.nodeAfter&&e.isObject(o.nodeAfter)?null:e.getNearestSelectionRange(o,"forward"),gt=c.nodeBefore&&e.isObject(c.nodeBefore)?null:e.getNearestSelectionRange(c,"backward"),kt=ct?ct.start:o,Ct=gt?gt.start:c;return new Tt(kt,Ct)}}const nt=_e&&!_e.is("rootElement"),st=et&&!et.is("rootElement");if(nt||st){const at=o.nodeAfter&&c.nodeBefore&&o.nodeAfter.parent===c.nodeBefore.parent,ct=nt&&(!at||!H_(o.nodeAfter,e)),dt=st&&(!at||!H_(c.nodeBefore,e));let gt=o,kt=c;return ct&&(gt=Mt._createBefore(W_(_e,e))),dt&&(kt=Mt._createAfter(W_(et,e))),new Tt(gt,kt)}return null}function W_(h,e){let o=h,c=o;for(;e.isLimit(c)&&c.parent;)o=c,c=c.parent;return o}function PP(h,e,o){const c=h.nodeAfter&&!o.isLimit(h.nodeAfter)||o.checkChild(h,"$text"),_=e.nodeBefore&&!o.isLimit(e.nodeBefore)||o.checkChild(e,"$text");return c||_}function RP(h){const e=[];e.push(h.shift());for(const o of h){const c=e.pop();if(o.isIntersecting(c)){const _=c.start.isAfter(o.start)?o.start:c.start,j=c.end.isAfter(o.end)?c.end:o.end,_e=new Tt(_,j);e.push(_e)}else e.push(c),e.push(o)}return e}function H_(h,e){return h&&e.isObject(h)}class G_{constructor(){this.markers=new F_,this.document=new L_(this),this.schema=new y_,this._pendingChanges=[],this._currentWriter=null,["insertContent","deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(e=>this.decorate(e)),this.on("applyOperation",(e,o)=>{o[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$block",{allowIn:"$root",isBlock:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",isLimit:!0}),this.schema.extend("$text",{allowIn:"$clipboardHolder"}),this.schema.register("$marker"),this.schema.addChildCheck((e,o)=>{if(o.name==="$marker")return!0}),CP(this)}change(e){try{return this._pendingChanges.length===0?(this._pendingChanges.push({batch:new Ro,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(o){yt.b.rethrowUnexpectedError(o,this)}}enqueueChange(e,o){try{typeof e=="string"?e=new Ro(e):typeof e=="function"&&(o=e,e=new Ro),this._pendingChanges.push({batch:e,callback:o}),this._pendingChanges.length==1&&this._runPendingChanges()}catch(c){yt.b.rethrowUnexpectedError(c,this)}}applyOperation(e){e._execute()}insertContent(e,o,c){return uP(this,e,o,c)}deleteContent(e,o){hP(this,e,o)}modifySelection(e,o){_P(this,e,o)}getSelectedContent(e){return EP(this,e)}hasContent(e,o){const c=e instanceof vn?Tt._createIn(e):e;if(c.isCollapsed)return!1;for(const j of this.markers.getMarkersIntersectingRange(c))if(j.affectsData)return!0;const{ignoreWhitespaces:_=!1}=o||{};for(const j of c.getItems())if(j.is("textProxy"))if(_){if(j.data.search(/\S/)!==-1)return!0}else return!0;else if(this.schema.isObject(j))return!0;return!1}createPositionFromPath(e,o,c){return new Mt(e,o,c)}createPositionAt(e,o){return Mt._createAt(e,o)}createPositionAfter(e){return Mt._createAfter(e)}createPositionBefore(e){return Mt._createBefore(e)}createRange(e,o){return new Tt(e,o)}createRangeIn(e){return Tt._createIn(e)}createRangeOn(e){return Tt._createOn(e)}createSelection(e,o,c){return new kr(e,o,c)}createBatch(e){return new Ro(e)}createOperationFromJSON(e){return aP.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];for(this.fire("_beforeChanges");this._pendingChanges.length;){const o=this._pendingChanges[0].batch;this._currentWriter=new XI(this,o);const c=this._pendingChanges[0].callback(this._currentWriter);e.push(c),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}return this.fire("_afterChanges"),e}}Zt(G_,Mn);class Wr{constructor(){this._listener=Object.create(Bs)}listenTo(e){this._listener.listenTo(e,"keydown",(o,c)=>{this._listener.fire("_keydown:"+Ir(c),c)})}set(e,o,c={}){const _=bm(e),j=c.priority;this._listener.listenTo(this._listener,"_keydown:"+_,(_e,et)=>{o(et,()=>{et.preventDefault(),et.stopPropagation(),_e.stop()}),_e.return=!0},{priority:j})}press(e){return!!this._listener.fire("_keydown:"+Ir(e),e)}destroy(){this._listener.stopListening()}}class NP extends Wr{constructor(e){super(),this.editor=e}set(e,o,c={}){if(typeof o=="string"){const _=o;o=(j,_e)=>{this.editor.execute(_),_e()}}super.set(e,o,c)}}class q_{constructor(e={}){this._context=e.context||new hT({language:e.language}),this._context._addEditor(this,!e.context);const o=Array.from(this.constructor.builtinPlugins||[]);this.config=new $p(e,this.constructor.defaultConfig),this.config.define("plugins",o),this.config.define(this._context._getEditorConfig()),this.plugins=new Ul(this,o,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this.commands=new SI,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.set("isReadOnly",!1),this.model=new G_;const c=new um;this.data=new E_(this.model,c),this.editing=new b_(this.model,c),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new qI([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new NP(this),this.keystrokes.listenTo(this.editing.view.document)}initPlugins(){const e=this.config,o=e.get("plugins"),c=e.get("removePlugins")||[],_=e.get("extraPlugins")||[];return this.plugins.init(o.concat(_),c)}destroy(){let e=Promise.resolve();return this.state=="initializing"&&(e=new Promise(o=>this.once("ready",o))),e.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(...e){try{this.commands.execute(...e)}catch(o){yt.b.rethrowUnexpectedError(o,this)}}}Zt(q_,Mn);var OP={setData(h){this.data.set(h)},getData(h){return this.data.get(h)}};function MP(h,e){h instanceof HTMLTextAreaElement&&(h.value=e),h.innerHTML=e}var jP={updateSourceElement(){if(!this.sourceElement)throw new yt.b("editor-missing-sourceelement: Cannot update the source element of a detached editor.",this);MP(this.sourceElement,this.data.get())}};function LP(h){if(!qn(h.updateSourceElement))throw new yt.b("attachtoform-missing-elementapi-interface: Editor passed to attachToForm() must implement ElementApi.",h);const e=h.sourceElement;if(e&&e.tagName.toLowerCase()==="textarea"&&e.form){let o;const c=e.form,_=()=>h.updateSourceElement();qn(c.submit)&&(o=c.submit,c.submit=()=>{_(),o.apply(c)}),c.addEventListener("submit",_),h.on("destroy",()=>{c.removeEventListener("submit",_),o&&(c.submit=o)})}}class K_{getHtml(e){const c=document.implementation.createHTMLDocument("").createElement("div");return c.appendChild(e),c.innerHTML}}class No{constructor(e){this._domParser=new DOMParser,this._domConverter=new Fs(e,{blockFillerMode:"nbsp"}),this._htmlWriter=new K_}toData(e){const o=this._domConverter.viewToDom(e,document);return this._htmlWriter.getHtml(o)}toView(e){const o=this._toDom(e);return this._domConverter.domToView(o)}_toDom(e){const o=this._domParser.parseFromString(e,"text/html"),c=o.createDocumentFragment(),_=o.body.childNodes;for(;_.length>0;)c.appendChild(_[0]);return c}}class DP{constructor(e){this.editor=e,this._components=new Map}*names(){for(const e of this._components.values())yield e.originalName}add(e,o){if(this.has(e))throw new yt.b("componentfactory-item-exists: The item already exists in the component factory.",this,{name:e});this._components.set(bu(e),{callback:o,originalName:e})}create(e){if(!this.has(e))throw new yt.b("componentfactory-item-missing: The required component is not registered in the factory.",this,{name:e});return this._components.get(bu(e)).callback(this.editor.locale)}has(e){return this._components.has(bu(e))}}function bu(h){return String(h).toLowerCase()}class _r{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(e){if(this._elements.has(e))throw new yt.b("focusTracker-add-element-already-exist",this);this.listenTo(e,"focus",()=>this._focus(e),{useCapture:!0}),this.listenTo(e,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(e)}remove(e){e===this.focusedElement&&this._blur(e),this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e))}destroy(){this.stopListening()}_focus(e){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=e,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}Zt(_r,Bs),Zt(_r,Mn);class Y_{constructor(e){this.editor=e,this.componentFactory=new DP(e),this.focusTracker=new _r,this._editableElementsMap=new Map,this.listenTo(e.editing.view.document,"layoutChanged",()=>this.update())}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null;this._editableElementsMap=new Map}setEditableElement(e,o){this._editableElementsMap.set(e,o),o.ckeditorInstance||(o.ckeditorInstance=this.editor)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}}Zt(Y_,xn);function FP({origin:h,originKeystrokeHandler:e,originFocusTracker:o,toolbar:c,beforeFocus:_,afterBlur:j}){o.add(c.element),e.set("Alt+F10",(_e,et)=>{o.isFocused&&!c.focusTracker.isFocused&&(_&&_(),c.focus(),et())}),c.keystrokes.set("Esc",(_e,et)=>{c.focusTracker.isFocused&&(h.focus(),j&&j(),et())})}function BP(h){return Array.isArray(h)?{items:h}:h?Object.assign({items:[]},h):{items:[]}}a(14);const Oo=new WeakMap;function Q_(h){const{view:e,element:o,text:c,isDirectHost:_=!0}=h,j=e.document;Oo.has(j)||(Oo.set(j,new Map),j.registerPostFixer(_e=>J_(j,_e))),Oo.get(j).set(o,{text:c,isDirectHost:_}),e.change(_e=>J_(j,_e))}function zP(h,e){return e.hasClass("ck-placeholder")?!1:(h.addClass("ck-placeholder",e),!0)}function VP(h,e){return e.hasClass("ck-placeholder")?(h.removeClass("ck-placeholder",e),!0):!1}function $P(h){if(!h.isAttached())return!1;const e=!Array.from(h.getChildren()).some(j=>!j.is("uiElement")),o=h.document;if(!o.isFocused&&e)return!0;const _=o.selection.anchor;return!!(e&&_&&_.parent!==h)}function J_(h,e){const o=Oo.get(h);let c=!1;for(const[_,j]of o)UP(e,_,j)&&(c=!0);return c}function UP(h,e,o){const{text:c,isDirectHost:_}=o,j=_?e:WP(e);let _e=!1;return j?(o.hostElement=j,j.getAttribute("data-placeholder")!==c&&(h.setAttribute("data-placeholder",c,j),_e=!0),$P(j)?zP(h,j)&&(_e=!0):VP(h,j)&&(_e=!0),_e):!1}function WP(h){if(h.childCount===1){const e=h.getChild(0);if(e.is("element")&&!e.is("uiElement"))return e}return null}class HP{constructor(){this._replacedElements=[]}replace(e,o){this._replacedElements.push({element:e,newElement:o}),e.style.display="none",o&&e.parentNode.insertBefore(o,e.nextSibling)}restore(){this._replacedElements.forEach(({element:e,newElement:o})=>{e.style.display="",o&&o.remove()}),this._replacedElements=[]}}class GP extends Y_{constructor(e,o){super(e),this.view=o,this._toolbarConfig=BP(e.config.get("toolbar")),this._elementReplacer=new HP}get element(){return this.view.element}init(e){const o=this.editor,c=this.view,_=o.editing.view,j=c.editable,_e=_.document.getRoot();j.name=_e.rootName,c.render();const et=j.element;this.setEditableElement(j.name,et),this.focusTracker.add(et),c.editable.bind("isFocused").to(this.focusTracker),_.attachDomRoot(et),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),this.fire("ready")}destroy(){const e=this.view,o=this.editor.editing.view;this._elementReplacer.restore(),o.detachDomRoot(e.editable.name),e.destroy(),super.destroy()}_initToolbar(){const e=this.editor,o=this.view,c=e.editing.view;o.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),o.stickyPanel.limiterElement=o.element,this._toolbarConfig.viewportTopOffset&&(o.stickyPanel.viewportTopOffset=this._toolbarConfig.viewportTopOffset),o.toolbar.fillFromConfig(this._toolbarConfig.items,this.componentFactory),FP({origin:c,originFocusTracker:this.focusTracker,originKeystrokeHandler:e.keystrokes,toolbar:o.toolbar})}_initPlaceholder(){const e=this.editor,o=e.editing.view,c=o.document.getRoot(),_=e.sourceElement,j=e.config.get("placeholder")||_&&_.tagName.toLowerCase()==="textarea"&&_.getAttribute("placeholder");j&&Q_({view:o,element:c,text:j,isDirectHost:!1})}}class ns extends or{constructor(e){super({idProperty:"viewUid"}),this.on("add",(o,c,_)=>{c.isRendered||c.render(),c.element&&this._parentElement&&this._parentElement.insertBefore(c.element,this._parentElement.children[_])}),this.on("remove",(o,c)=>{c.element&&this._parentElement&&c.element.remove()}),this.locale=e,this._parentElement=null}destroy(){this.map(e=>e.destroy())}setParent(e){this._parentElement=e}delegate(...e){if(!e.length||!qP(e))throw new yt.b("ui-viewcollection-delegate-wrong-events: All event names must be strings.",this);return{to:o=>{for(const c of this)for(const _ of e)c.delegate(_).to(o);this.on("add",(c,_)=>{for(const j of e)_.delegate(j).to(o)}),this.on("remove",(c,_)=>{for(const j of e)_.stopDelegating(j,o)})}}}}function qP(h){return h.every(e=>typeof e=="string")}const KP="http://www.w3.org/1999/xhtml";class xr{constructor(e){Object.assign(this,tw(ew(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData=ow(),this._renderNode({node:e,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new yt.b("ui-template-revert-not-applied: Attempting to revert a template which has not been applied yet.",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){function*e(o){if(o.children)for(const c of o.children)jo(c)?yield c:yu(c)&&(yield*e(c))}yield*e(this)}static bind(e,o){return{to(c,_){return new YP({eventNameOrFunction:c,attribute:c,observable:e,emitter:o,callback:_})},if(c,_,j){return new X_({observable:e,emitter:o,attribute:c,valueIfTrue:_,callback:j})}}}static extend(e,o){if(e._isRendered)throw new yt.b("template-extend-render: Attempting to extend a template which has already been rendered.",[this,e]);sw(e,tw(ew(o)))}_renderNode(e){let o;if(e.node?o=this.tag&&this.text:o=this.tag?this.text:!this.text,o)throw new yt.b('ui-template-wrong-syntax: Node definition must have either "tag" or "text" when rendering a new Node.',this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let o=e.node;return o||(o=e.node=document.createElementNS(this.ns||KP,this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),o}_renderText(e){let o=e.node;return o?e.revertData.text=o.textContent:o=e.node=document.createTextNode(""),Mo(this.text)?this._bindToObservable({schema:this.text,updater:JP(o),data:e}):o.textContent=this.text.join(""),o}_renderAttributes(e){let o,c,_,j;if(!this.attributes)return;const _e=e.node,et=e.revertData;for(o in this.attributes)if(_=_e.getAttribute(o),c=this.attributes[o],et&&(et.attributes[o]=_),j=In(c[0])&&c[0].ns?c[0].ns:null,Mo(c)){const nt=j?c[0].value:c;et&&aw(o)&&nt.unshift(_),this._bindToObservable({schema:nt,updater:XP(_e,o,j),data:e})}else o=="style"&&typeof c[0]!="string"?this._renderStyleAttribute(c[0],e):(et&&_&&aw(o)&&c.unshift(_),c=c.map(nt=>nt&&(nt.value||nt)).reduce((nt,st)=>nt.concat(st),[]).reduce(iw,""),vs(c)||_e.setAttributeNS(j,o,c))}_renderStyleAttribute(e,o){const c=o.node;for(const _ in e){const j=e[_];Mo(j)?this._bindToObservable({schema:[j],updater:ZP(c,_),data:o}):c.style[_]=j}}_renderElementChildren(e){const o=e.node,c=e.intoFragment?document.createDocumentFragment():o,_=e.isApplying;let j=0;for(const _e of this.children)if(ku(_e)){if(!_){_e.setParent(o);for(const et of _e)c.appendChild(et.element)}}else if(jo(_e))_||(_e.isRendered||_e.render(),c.appendChild(_e.element));else if(gs(_e))c.appendChild(_e);else if(_){const et=e.revertData,nt=ow();et.children.push(nt),_e._renderNode({node:c.childNodes[j++],isApplying:!0,revertData:nt})}else c.appendChild(_e.render());e.intoFragment&&o.appendChild(c)}_setUpListeners(e){if(this.eventListeners)for(const o in this.eventListeners){const c=this.eventListeners[o].map(_=>{const[j,_e]=o.split("@");return _.activateDomEventListener(j,_e,e)});e.revertData&&e.revertData.bindings.push(c)}}_bindToObservable({schema:e,updater:o,data:c}){const _=c.revertData;Z_(e,o,c);const j=e.filter(_e=>!vs(_e)).filter(_e=>_e.observable).map(_e=>_e.activateAttributeListener(e,o,c));_&&_.bindings.push(j)}_revertTemplateFromNode(e,o){for(const c of o.bindings)for(const _ of c)_();if(o.text){e.textContent=o.text;return}for(const c in o.attributes){const _=o.attributes[c];_===null?e.removeAttribute(c):e.setAttribute(c,_)}for(let c=0;c<o.children.length;++c)this._revertTemplateFromNode(e.childNodes[c],o.children[c])}}Zt(xr,xn);class qs{constructor(e){Object.assign(this,e)}getValue(e){const o=this.observable[this.attribute];return this.callback?this.callback(o,e):o}activateAttributeListener(e,o,c){const _=()=>Z_(e,o,c);return this.emitter.listenTo(this.observable,"change:"+this.attribute,_),()=>{this.emitter.stopListening(this.observable,"change:"+this.attribute,_)}}}class YP extends qs{activateDomEventListener(e,o,c){const _=(j,_e)=>{(!o||_e.target.matches(o))&&(typeof this.eventNameOrFunction=="function"?this.eventNameOrFunction(_e):this.observable.fire(this.eventNameOrFunction,_e))};return this.emitter.listenTo(c.node,e,_),()=>{this.emitter.stopListening(c.node,e,_)}}}class X_ extends qs{getValue(e){const o=super.getValue(e);return vs(o)?!1:this.valueIfTrue||!0}}function Mo(h){return h?(h.value&&(h=h.value),Array.isArray(h)?h.some(Mo):h instanceof qs):!1}function QP(h,e){return h.map(o=>o instanceof qs?o.getValue(e):o)}function Z_(h,e,{node:o}){let c=QP(h,o);h.length==1&&h[0]instanceof X_?c=c[0]:c=c.reduce(iw,""),vs(c)?e.remove():e.set(c)}function JP(h){return{set(e){h.textContent=e},remove(){h.textContent=""}}}function XP(h,e,o){return{set(c){h.setAttributeNS(o,e,c)},remove(){h.removeAttributeNS(o,e)}}}function ZP(h,e){return{set(o){h.style[e]=o},remove(){h.style[e]=null}}}function ew(h){return Vp(h,o=>{if(o&&(o instanceof qs||yu(o)||jo(o)||ku(o)))return o})}function tw(h){if(typeof h=="string"?h=nR(h):h.text&&iR(h),h.on&&(h.eventListeners=tR(h.on),delete h.on),!h.text){h.attributes&&eR(h.attributes);const e=[];if(h.children)if(ku(h.children))e.push(h.children);else for(const o of h.children)yu(o)||jo(o)||gs(o)?e.push(o):e.push(new xr(o));h.children=e}return h}function eR(h){for(const e in h)h[e].value&&(h[e].value=[].concat(h[e].value)),nw(h,e)}function tR(h){for(const e in h)nw(h,e);return h}function nR(h){return{text:[h]}}function iR(h){Array.isArray(h.text)||(h.text=[h.text])}function nw(h,e){Array.isArray(h[e])||(h[e]=[h[e]])}function iw(h,e){return vs(e)?h:vs(h)?e:`${h} ${e}`}function rw(h,e){for(const o in e)h[o]?h[o].push(...e[o]):h[o]=e[o]}function sw(h,e){if(e.attributes&&(h.attributes||(h.attributes={}),rw(h.attributes,e.attributes)),e.eventListeners&&(h.eventListeners||(h.eventListeners={}),rw(h.eventListeners,e.eventListeners)),e.text&&h.text.push(...e.text),e.children&&e.children.length){if(h.children.length!=e.children.length)throw new yt.b("ui-template-extend-children-mismatch: The number of children in extended definition does not match.",h);let o=0;for(const c of e.children)sw(h.children[o++],c)}}function vs(h){return!h&&h!==0}function jo(h){return h instanceof sn}function yu(h){return h instanceof xr}function ku(h){return h instanceof ns}function ow(){return{children:[],bindings:[],attributes:{}}}function aw(h){return h=="class"||h=="style"}a(16);class sn{constructor(e){this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new or,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(o,c)=>{c.locale=e}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=xr.bind(this,this)}createCollection(){const e=new ns;return this._viewCollections.add(e),e}registerChild(e){hr(e)||(e=[e]);for(const o of e)this._unboundChildren.add(o)}deregisterChild(e){hr(e)||(e=[e]);for(const o of e)this._unboundChildren.remove(o)}setTemplate(e){this.template=new xr(e)}extendTemplate(e){xr.extend(this.template,e)}render(){if(this.isRendered)throw new yt.b("ui-view-render-already-rendered: This View has already been rendered.",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(e=>e.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}}Zt(sn,Bs),Zt(sn,Mn);var rR="[object String]";function sR(h){return typeof h=="string"||!Kn(h)&&Lt(h)&&bt(h)==rR}var lw=sR;function oR(h,e,o={},c=[]){const _=o&&o.xmlns,j=_?h.createElementNS(_,e):h.createElement(e);for(const _e in o)j.setAttribute(_e,o[_e]);(lw(c)||!hr(c))&&(c=[c]);for(let _e of c)lw(_e)&&(_e=h.createTextNode(_e)),j.appendChild(_e);return j}class aR extends ns{attachToDom(){this._bodyCollectionContainer=new xr({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let e=document.querySelector(".ck-body-wrapper");e||(e=oR(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(e)),e.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const e=document.querySelector(".ck-body-wrapper");e&&e.childElementCount==0&&e.remove()}}a(18);class lR extends sn{constructor(e){super(e),this.body=new aR(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}a(20);class cw extends sn{constructor(e){super(e),this.set("text"),this.set("for"),this.id=`ck-editor__label_${Tr()}`;const o=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:o.to("for")},children:[{text:o.to("text")}]})}}class cR extends lR{constructor(e){super(e),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,o=new cw;return o.text=e("ba"),o.extendTemplate({attributes:{class:"ck-voice-label"}}),o}}class uR extends sn{constructor(e,o,c){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.name=null,this.set("isFocused",!1),this._editableElement=c,this._hasExternalElement=!!this._editableElement,this._editingView=o}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}_updateIsFocusedClasses(){const e=this._editingView;e.isRenderingInProgress?c(this):o(this);function o(_){e.change(j=>{const _e=e.document.getRoot(_.name);j.addClass(_.isFocused?"ck-focused":"ck-blurred",_e),j.removeClass(_.isFocused?"ck-blurred":"ck-focused",_e)})}function c(_){e.once("change:isRenderingInProgress",(j,_e,et)=>{et?c(_):o(_)})}}}class dR extends uR{constructor(e,o,c){super(e,o,c),this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const e=this._editingView,o=this.t;e.change(c=>{const _=e.document.getRoot(this.name);c.setAttribute("aria-label",o("cd",[this.name]),_)})}}function xu(h){return e=>e+h}a(22);const Ks=xu("px");class hR extends sn{constructor(e){super(e);const o=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheLimiter",!1),this.set("_hasViewportTopOffset",!1),this.content=this.createCollection(),this._contentPanelPlaceholder=new xr({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:o.to("isSticky",c=>c?"block":"none"),height:o.to("isSticky",c=>c?Ks(this._panelRect.height):null)}}}).render(),this._contentPanel=new xr({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",o.if("isSticky","ck-sticky-panel__content_sticky"),o.if("_isStickyToTheLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:o.to("isSticky",c=>c?Ks(this._contentPanelPlaceholder.getBoundingClientRect().width):null),top:o.to("_hasViewportTopOffset",c=>c?Ks(this.viewportTopOffset):null),bottom:o.to("_isStickyToTheLimiter",c=>c?Ks(this.limiterBottomOffset):null),marginLeft:o.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this._contentPanel]})}render(){super.render(),this._checkIfShouldBeSticky(),this.listenTo(jn.window,"scroll",()=>{this._checkIfShouldBeSticky()}),this.listenTo(this,"change:isActive",()=>{this._checkIfShouldBeSticky()})}_checkIfShouldBeSticky(){const e=this._panelRect=this._contentPanel.getBoundingClientRect();let o;this.limiterElement?(o=this._limiterRect=this.limiterElement.getBoundingClientRect(),this.isSticky=this.isActive&&o.top<this.viewportTopOffset&&this._panelRect.height+this.limiterBottomOffset<o.height):this.isSticky=!1,this.isSticky?(this._isStickyToTheLimiter=o.bottom<e.height+this.limiterBottomOffset+this.viewportTopOffset,this._hasViewportTopOffset=!this._isStickyToTheLimiter&&!!this.viewportTopOffset,this._marginLeft=this._isStickyToTheLimiter?null:Ks(-jn.window.scrollX)):(this._isStickyToTheLimiter=!1,this._hasViewportTopOffset=!1,this._marginLeft=null)}}class bs{constructor(e){if(Object.assign(this,e),e.actions&&e.keystrokeHandler)for(const o in e.actions){let c=e.actions[o];typeof c=="string"&&(c=[c]);for(const _ of c)e.keystrokeHandler.set(_,(j,_e)=>{this[o](),_e()})}}get first(){return this.focusables.find(Eu)||null}get last(){return this.focusables.filter(Eu).slice(-1)[0]||null}get next(){return this._getFocusableItem(1)}get previous(){return this._getFocusableItem(-1)}get current(){let e=null;return this.focusTracker.focusedElement===null?null:(this.focusables.find((o,c)=>{const _=o.element===this.focusTracker.focusedElement;return _&&(e=c),_}),e)}focusFirst(){this._focus(this.first)}focusLast(){this._focus(this.last)}focusNext(){this._focus(this.next)}focusPrevious(){this._focus(this.previous)}_focus(e){e&&e.focus()}_getFocusableItem(e){const o=this.current,c=this.focusables.length;if(!c)return null;if(o===null)return this[e===1?"first":"last"];let _=(o+c+e)%c;do{const j=this.focusables.get(_);if(Eu(j))return j;_=(_+c+e)%c}while(_!==o);return null}}function Eu(h){return!!(h.focus&&jn.window.getComputedStyle(h.element).display!="none")}class uw extends sn{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}const dw=100;class En{constructor(e,o){En._observerInstance||En._createObserver(),this._element=e,this._callback=o,En._addElementCallback(e,o),En._observerInstance.observe(e)}destroy(){En._deleteElementCallback(this._element,this._callback)}static _addElementCallback(e,o){En._elementCallbacks||(En._elementCallbacks=new Map);let c=En._elementCallbacks.get(e);c||(c=new Set,En._elementCallbacks.set(e,c)),c.add(o)}static _deleteElementCallback(e,o){const c=En._getElementCallbacks(e);c&&(c.delete(o),c.size||(En._elementCallbacks.delete(e),En._observerInstance.unobserve(e))),En._elementCallbacks&&!En._elementCallbacks.size&&(En._observerInstance=null,En._elementCallbacks=null)}static _getElementCallbacks(e){return En._elementCallbacks?En._elementCallbacks.get(e):null}static _createObserver(){let e;typeof jn.window.ResizeObserver=="function"?e=jn.window.ResizeObserver:e=hw,En._observerInstance=new e(o=>{for(const c of o){const _=En._getElementCallbacks(c.target);if(_)for(const j of _)j(c)}})}}En._observerInstance=null,En._elementCallbacks=null;class hw{constructor(e){this._callback=e,this._elements=new Set,this._previousRects=new Map,this._periodicCheckTimeout=null}observe(e){this._elements.add(e),this._checkElementRectsAndExecuteCallback(),this._elements.size===1&&this._startPeriodicCheck()}unobserve(e){this._elements.delete(e),this._previousRects.delete(e),this._elements.size||this._stopPeriodicCheck()}_startPeriodicCheck(){const e=()=>{this._checkElementRectsAndExecuteCallback(),this._periodicCheckTimeout=setTimeout(e,dw)};this.listenTo(jn.window,"resize",()=>{this._checkElementRectsAndExecuteCallback()}),this._periodicCheckTimeout=setTimeout(e,dw)}_stopPeriodicCheck(){clearTimeout(this._periodicCheckTimeout),this.stopListening(),this._previousRects.clear()}_checkElementRectsAndExecuteCallback(){const e=[];for(const o of this._elements)this._hasRectChanged(o)&&e.push({target:o,contentRect:this._previousRects.get(o)});e.length&&this._callback(e)}_hasRectChanged(e){if(!e.ownerDocument.body.contains(e))return!1;const o=new Rn(e),c=this._previousRects.get(e),_=!c||!c.isEqual(o);return this._previousRects.set(e,o),_}}Zt(hw,Bs);function fR(h){return h.bindTemplate.to(e=>{e.target===h.element&&e.preventDefault()})}class pR extends sn{constructor(e){super(e);const o=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",o.to("position",c=>`ck-dropdown__panel_${c}`),o.if("isVisible","ck-dropdown__panel-visible")]},children:this.children,on:{selectstart:o.to(c=>c.preventDefault())}})}focus(){this.children.length&&this.children.first.focus()}focusLast(){if(this.children.length){const e=this.children.last;typeof e.focusLast=="function"?e.focusLast():e.focus()}}}a(24);function mR(h){for(;h&&h.tagName.toLowerCase()!="html";){if(jn.window.getComputedStyle(h).position!="static")return h;h=h.parentElement}return null}function fw({element:h,target:e,positions:o,limiter:c,fitInViewport:_}){qn(e)&&(e=e()),qn(c)&&(c=c());const j=mR(h.parentElement),_e=new Rn(h),et=new Rn(e);let nt,st;if(!c&&!_)[st,nt]=Cu(o[0],et,_e);else{const dt=c&&new Rn(c).getVisible(),gt=_&&new Rn(jn.window);[st,nt]=gR(o,et,_e,dt,gt)||Cu(o[0],et,_e)}let{left:at,top:ct}=pw(nt);if(j){const dt=pw(new Rn(j)),gt=Zm(j);at-=dt.left,ct-=dt.top,at+=j.scrollLeft,ct+=j.scrollTop,at-=gt.left,ct-=gt.top}return{left:at,top:ct,name:st}}function Cu(h,e,o){const{left:c,top:_,name:j}=h(e,o);return[j,o.clone().moveTo(c,_)]}function gR(h,e,o,c,_){let j=0,_e=0,et,nt;const st=o.getArea();return h.some(at=>{const[ct,dt]=Cu(at,e,o);let gt,kt;if(c)if(_){const Nt=c.getIntersection(_);Nt?gt=Nt.getIntersectionArea(dt):gt=0}else gt=c.getIntersectionArea(dt);_&&(kt=_.getIntersectionArea(dt)),_&&!c?kt>_e&&Ct():!_&&c?gt>j&&Ct():(kt>_e&&gt>=j||kt>=_e&&gt>j)&&Ct();function Ct(){_e=kt,j=gt,et=dt,nt=ct}return gt===st}),et?[nt,et]:null}function pw({left:h,top:e}){const{scrollX:o,scrollY:c}=jn.window;return{left:h+o,top:e+c}}class ys extends sn{constructor(e,o,c){super(e);const _=this.bindTemplate;this.buttonView=o,this.panelView=c,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class"),this.set("id"),this.set("panelPosition","auto"),this.focusTracker=new _r,this.keystrokes=new Wr,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",_.to("class"),_.if("isEnabled","ck-disabled",j=>!j)],id:_.to("id"),"aria-describedby":_.to("ariaDescribedById")},children:[o,c]}),o.extendTemplate({attributes:{class:["ck-dropdown__button"]}})}render(){super.render(),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.panelView.bind("isVisible").to(this,"isOpen"),this.on("change:isOpen",()=>{this.isOpen&&(this.panelPosition==="auto"?this.panelView.position=ys._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions}).name:this.panelView.position=this.panelPosition)}),this.keystrokes.listenTo(this.element),this.focusTracker.add(this.element);const e=(o,c)=>{this.isOpen&&(this.buttonView.focus(),this.isOpen=!1,c())};this.keystrokes.set("arrowdown",(o,c)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,c())}),this.keystrokes.set("arrowright",(o,c)=>{this.isOpen&&c()}),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{southEast:e,southWest:o,northEast:c,northWest:_}=ys.defaultPanelPositions;return this.locale.uiLanguageDirection==="ltr"?[e,o,c,_]:[o,e,_,c]}}ys.defaultPanelPositions={southEast:h=>({top:h.bottom,left:h.left,name:"se"}),southWest:(h,e)=>({top:h.bottom,left:h.left-e.width+h.width,name:"sw"}),northEast:(h,e)=>({top:h.top-e.height,left:h.left,name:"ne"}),northWest:(h,e)=>({top:h.bottom-e.height,left:h.left-e.width+h.width,name:"nw"})},ys._getOptimalPosition=fw,a(26);class Lo extends sn{constructor(){super();const e=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon"],viewBox:e.to("viewBox")}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const o=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),c=o.getAttribute("viewBox");for(c&&(this.viewBox=c),this.element.innerHTML="";o.childNodes.length>0;)this.element.appendChild(o.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(e=>{e.style.fill=this.fillColor})}}a(28);class mw extends sn{constructor(e){super(e),this.set("text",""),this.set("position","s");const o=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip",o.to("position",c=>"ck-tooltip_"+c),o.if("text","ck-hidden",c=>!c.trim())]},children:[{tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:o.to("text")}]}]})}}a(30);class Sn extends sn{constructor(e){super(e);const o=this.bindTemplate,c=Tr();this.set("class"),this.set("labelStyle"),this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.tooltipView=this._createTooltipView(),this.labelView=this._createLabelView(c),this.iconView=new Lo,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this)),this.setTemplate({tag:"button",attributes:{class:["ck","ck-button",o.to("class"),o.if("isEnabled","ck-disabled",_=>!_),o.if("isVisible","ck-hidden",_=>!_),o.to("isOn",_=>_?"ck-on":"ck-off"),o.if("withText","ck-button_with-text"),o.if("withKeystroke","ck-button_with-keystroke")],type:o.to("type",_=>_||"button"),tabindex:o.to("tabindex"),"aria-labelledby":`ck-editor__aria-label_${c}`,"aria-disabled":o.if("isEnabled",!0,_=>!_),"aria-pressed":o.to("isOn",_=>this.isToggleable?String(_):!1)},children:this.children,on:{mousedown:o.to(_=>{_.preventDefault()}),click:o.to(_=>{this.isEnabled?this.fire("execute"):_.preventDefault()})}})}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.tooltipView),this.children.add(this.labelView),this.withKeystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}_createTooltipView(){const e=new mw;return e.bind("text").to(this,"_tooltipString"),e.bind("position").to(this,"tooltipPosition"),e}_createLabelView(e){const o=new sn,c=this.bindTemplate;return o.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:c.to("labelStyle"),id:`ck-editor__aria-label_${e}`},children:[{text:this.bindTemplate.to("label")}]}),o}_createKeystrokeView(){const e=new sn;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",o=>ym(o))}]}),e}_getTooltipString(e,o,c){return e?typeof e=="string"?e:(c&&(c=ym(c)),e instanceof Function?e(o,c):`${o}${c?` (${c})`:""}`):""}}var _R='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';class gw extends Sn{constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Lo;return e.content=_R,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}a(32);class wR extends sn{constructor(){super(),this.items=this.createCollection(),this.focusTracker=new _r,this.keystrokes=new Wr,this._focusCycler=new bs({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"]},children:this.items})}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,o)=>{this.focusTracker.add(o.element)}),this.items.on("remove",(e,o)=>{this.focusTracker.remove(o.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}class vR extends sn{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item"]},children:this.children})}focus(){this.children.first.focus()}}class bR extends sn{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}a(34);class Tu extends Sn{constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new sn;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}function Au({emitter:h,activator:e,callback:o,contextElements:c}){h.listenTo(document,"mousedown",(_,{target:j})=>{if(e()){for(const _e of c)if(_e.contains(j))return;o()}})}a(36),a(38);function Ys(h,e=gw){const o=new e(h),c=new pR(h),_=new ys(h,o,c);return o.bind("isEnabled").to(_),o instanceof gw?o.bind("isOn").to(_,"isOpen"):o.arrowView.bind("isOn").to(_,"isOpen"),kR(_),_}function yR(h,e){const o=h.locale,c=o.t,_=h.toolbarView=new Su(o);_.set("ariaLabel",c("bl")),h.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),e.map(j=>_.items.add(j)),h.panelView.children.add(_),_.items.delegate("execute").to(h)}function _w(h,e){const o=h.locale,c=h.listView=new wR(o);c.items.bindTo(e).using(({type:_,model:j})=>{if(_==="separator")return new bR(o);if(_==="button"||_==="switchbutton"){const _e=new vR(o);let et;return _==="button"?et=new Sn(o):et=new Tu(o),et.bind(...Object.keys(j)).to(j),et.delegate("execute").to(_e),_e.children.add(et),_e}}),h.panelView.children.add(c),c.items.delegate("execute").to(h)}function kR(h){xR(h),ER(h),CR(h)}function xR(h){h.on("render",()=>{Au({emitter:h,activator:()=>h.isOpen,callback:()=>{h.isOpen=!1},contextElements:[h.element]})})}function ER(h){h.on("execute",e=>{e.source instanceof Tu||(h.isOpen=!1)})}function CR(h){h.keystrokes.set("arrowdown",(e,o)=>{h.isOpen&&(h.panelView.focus(),o())}),h.keystrokes.set("arrowup",(e,o)=>{h.isOpen&&(h.panelView.focusLast(),o())})}var TR='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>';a(40);class Su extends sn{constructor(e,o){super(e);const c=this.bindTemplate,_=this.t;this.options=o||{},this.set("ariaLabel",_("bj")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new _r,this.keystrokes=new Wr,this.set("class"),this.set("isCompact",!1),this.itemsView=new AR(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection(),this._focusCycler=new bs({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:["arrowleft","arrowup"],focusNext:["arrowright","arrowdown"]}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar",c.to("class"),c.if("isCompact","ck-toolbar_compact")],role:"toolbar","aria-label":c.to("ariaLabel"),style:{maxWidth:c.to("maxWidth")}},children:this.children,on:{mousedown:fR(this)}}),this._behavior=this.options.shouldGroupWhenFull?new IR(this):new SR(this)}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,o)=>{this.focusTracker.add(o.element)}),this.items.on("remove",(e,o)=>{this.focusTracker.remove(o.element)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,o){e.map(c=>{c=="|"?this.items.add(new uw):o.has(c)?this.items.add(o.create(c)):console.warn(Object(yt.a)("toolbarview-item-unavailable: The requested toolbar item is unavailable."),{name:c})})}}class AR extends sn{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class SR{constructor(e){const o=e.bindTemplate;e.set("isVertical",!1),e.itemsView.children.bindTo(e.items).using(c=>c),e.focusables.bindTo(e.items).using(c=>c),e.extendTemplate({attributes:{class:[o.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class IR{constructor(e){this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),this.resizeObserver=null,this.cachedPadding=null,e.itemsView.children.bindTo(this.ungroupedItems).using(o=>o),this.ungroupedItems.on("add",this._updateFocusCycleableItems.bind(this)),this.ungroupedItems.on("remove",this._updateFocusCycleableItems.bind(this)),e.children.on("add",this._updateFocusCycleableItems.bind(this)),e.children.on("remove",this._updateFocusCycleableItems.bind(this)),e.items.on("add",(o,c,_)=>{_>this.ungroupedItems.length?this.groupedItems.add(c,_-this.ungroupedItems.length):this.ungroupedItems.add(c,_),this._updateGrouping()}),e.items.on("remove",(o,c,_)=>{_>this.ungroupedItems.length?this.groupedItems.remove(c):this.ungroupedItems.remove(c),this._updateGrouping()}),e.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;let e;for(;this._areItemsOverflowing;)this._groupLastItem(),e=!0;if(!e&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,o=this.viewLocale.uiLanguageDirection,c=new Rn(e.lastChild),_=new Rn(e);if(!this.cachedPadding){const j=jn.window.getComputedStyle(e),_e=o==="ltr"?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(j[_e])}return o==="ltr"?c.right>_.right-this.cachedPadding:c.left<_.left+this.cachedPadding}_enableGroupingOnResize(){let e;this.resizeObserver=new En(this.viewElement,o=>{(!e||e!==o.contentRect.width)&&(this._updateGrouping(),e=o.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(e){e.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new uw),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,o=e.t,c=Ys(e);return c.class="ck-toolbar__grouped-dropdown",c.panelPosition=e.uiLanguageDirection==="ltr"?"sw":"se",yR(c,[]),c.buttonView.set({label:o("bk"),tooltip:!0,icon:TR}),c.toolbarView.items.bindTo(this.groupedItems).using(_=>_),c}_updateFocusCycleableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(e=>{this.viewFocusables.add(e)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}a(42);class PR extends cR{constructor(e,o,c={}){super(e),this.stickyPanel=new hR(e),this.toolbar=new Su(e,{shouldGroupWhenFull:c.shouldToolbarGroupWhenFull}),this.editable=new dR(e,o)}render(){super.render(),this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}function RR(h){return h instanceof HTMLTextAreaElement?h.value:h.innerHTML}class Iu extends q_{constructor(e,o){super(o),Cr(e)&&(this.sourceElement=e),this.data.processor=new No(this.data.viewDocument),this.model.document.createRoot();const c=!this.config.get("toolbar.shouldNotGroupWhenFull"),_=new PR(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:c});this.ui=new GP(this,_),LP(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,o={}){return new Promise(c=>{const _=new this(e,o);c(_.initPlugins().then(()=>_.ui.init(Cr(e)?e:null)).then(()=>{if(!Cr(e)&&o.initialData)throw new yt.b("editor-create-initial-data: The config.initialData option cannot be used together with initial data passed in Editor.create().",null);const j=o.initialData||NR(e);return _.data.init(j)}).then(()=>_.fire("ready")).then(()=>_))})}}Zt(Iu,OP),Zt(Iu,jP);function NR(h){return Cr(h)?RR(h):h}class Qs{static get pluginName(){return"BlockAutoformatEditing"}constructor(e,o,c){let _,j=null;typeof c=="function"?_=c:(j=e.commands.get(c),_=()=>{e.execute(c)}),e.model.document.on("change",(_e,et)=>{if(j&&!j.isEnabled||et.type=="transparent")return;const nt=Array.from(e.model.document.differ.getChanges()),st=nt[0];if(nt.length!=1||st.type!=="insert"||st.name!="$text"||st.length!=1)return;const at=st.position.parent;if(!at.is("paragraph")||at.childCount!==1)return;const ct=o.exec(at.getChild(0).data);ct&&e.model.enqueueChange(dt=>{const gt=dt.createPositionAt(at,0),kt=dt.createPositionAt(at,ct[0].length),Ct=new $r(gt,kt);_({match:ct})!==!1&&dt.remove(Ct),Ct.detach()})})}}function OR(h,e){let o=h.start;return{text:Array.from(h.getItems()).reduce((_,j)=>j.is("text")||j.is("textProxy")?_+j.data:(o=e.createPositionAfter(j),""),""),range:e.createRange(o,h.end)}}class Js{static get pluginName(){return"InlineAutoformatEditing"}constructor(e,o,c){let _,j,_e,et;o instanceof RegExp?_=o:_e=o,typeof c=="string"?j=c:et=c,_e=_e||(nt=>{let st;const at=[],ct=[];for(;(st=_.exec(nt))!==null&&!(st&&st.length<4);){let{index:dt,1:gt,2:kt,3:Ct}=st;const Nt=gt+kt+Ct;dt+=st[0].length-Nt.length;const Wt=[dt,dt+gt.length],tn=[dt+gt.length+kt.length,dt+gt.length+kt.length+Ct.length];at.push(Wt),at.push(tn),ct.push([dt+gt.length,dt+gt.length+kt.length])}return{remove:at,format:ct}}),et=et||((nt,st)=>{const at=e.model.schema.getValidRanges(st,j);for(const ct of at)nt.setAttribute(j,!0,ct);nt.removeSelectionAttribute(j)}),e.model.document.on("change",(nt,st)=>{if(st.type=="transparent")return;const at=e.model,ct=at.document.selection;if(!ct.isCollapsed)return;const dt=Array.from(at.document.differ.getChanges()),gt=dt[0];if(dt.length!=1||gt.type!=="insert"||gt.name!="$text"||gt.length!=1)return;const kt=ct.focus,Ct=kt.parent,{text:Nt,range:Wt}=OR(at.createRange(at.createPositionAt(Ct,0),kt),at),tn=_e(Nt),nn=ww(Wt.start,tn.format,at),un=ww(Wt.start,tn.remove,at);nn.length&&un.length&&at.enqueueChange(rr=>{if(et(rr,nn)!==!1)for(const Vn of un.reverse())rr.remove(Vn)})})}}function ww(h,e,o){return e.filter(c=>c[0]!==void 0&&c[1]!==void 0).map(c=>o.createRange(h.getShiftedBy(c[0]),h.getShiftedBy(c[1])))}class Ut{constructor(e){this.editor=e,this.set("isEnabled",!0),this._disableStack=new Set}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",vw,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",vw),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}}Zt(Ut,Mn);function vw(h){h.return=!1,h.stop()}class MR extends Ut{static get pluginName(){return"Autoformat"}afterInit(){this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats()}_addListAutoformats(){const e=this.editor.commands;e.get("bulletedList")&&new Qs(this.editor,/^[*-]\s$/,"bulletedList"),e.get("numberedList")&&new Qs(this.editor,/^1[.|)]\s$/,"numberedList")}_addBasicStylesAutoformats(){const e=this.editor.commands;if(e.get("bold")){const o=Pu(this.editor,"bold");new Js(this.editor,/(\*\*)([^*]+)(\*\*)$/g,o),new Js(this.editor,/(__)([^_]+)(__)$/g,o)}if(e.get("italic")){const o=Pu(this.editor,"italic");new Js(this.editor,/(?:^|[^*])(\*)([^*_]+)(\*)$/g,o),new Js(this.editor,/(?:^|[^_])(_)([^_]+)(_)$/g,o)}if(e.get("code")){const o=Pu(this.editor,"code");new Js(this.editor,/(`)([^`]+)(`)$/g,o)}}_addHeadingAutoformats(){const e=this.editor.commands.get("heading");e&&e.modelElements.filter(o=>o.match(/^heading[1-6]$/)).forEach(o=>{const c=o[7],_=new RegExp(`^(#{${c}})\\s$`);new Qs(this.editor,_,()=>{if(!e.isEnabled)return!1;this.editor.execute("heading",{value:o})})})}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&new Qs(this.editor,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){this.editor.commands.get("codeBlock")&&new Qs(this.editor,/^```$/,"codeBlock")}}function Pu(h,e){return(o,c)=>{if(!h.commands.get(e).isEnabled)return!1;const j=h.model.schema.getValidRanges(c,e);for(const _e of j)o.setAttribute(e,!0,_e);o.removeSelectionAttribute(e)}}class hn{constructor(e){this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.on("execute",o=>{this.isEnabled||o.stop()},{priority:"high"}),this.listenTo(e,"change:isReadOnly",(o,c,_)=>{_?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")})}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",bw,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",bw),this.refresh())}execute(){}destroy(){this.stopListening()}}Zt(hn,Mn);function bw(h){h.return=!1,h.stop()}function Or(h){const e=h.next();return e.done?null:e.value}class jR extends hn{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const o=this.editor.model,c=o.schema,_=o.document.selection,j=Array.from(_.getSelectedBlocks()),_e=e.forceValue===void 0?!this.value:e.forceValue;o.change(et=>{if(!_e)this._removeQuote(et,j.filter(Do));else{const nt=j.filter(st=>Do(st)||kw(c,st));this._applyQuote(et,nt)}})}_getValue(){const e=this.editor.model.document.selection,o=Or(e.getSelectedBlocks());return!!(o&&Do(o))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,o=this.editor.model.schema,c=Or(e.getSelectedBlocks());return c?kw(o,c):!1}_removeQuote(e,o){yw(e,o).reverse().forEach(c=>{if(c.start.isAtStart&&c.end.isAtEnd){e.unwrap(c.start.parent);return}if(c.start.isAtStart){const j=e.createPositionBefore(c.start.parent);e.move(c,j);return}c.end.isAtEnd||e.split(c.end);const _=e.createPositionAfter(c.end.parent);e.move(c,_)})}_applyQuote(e,o){const c=[];yw(e,o).reverse().forEach(_=>{let j=Do(_.start);j||(j=e.createElement("blockQuote"),e.wrap(_,j)),c.push(j)}),c.reverse().reduce((_,j)=>_.nextSibling==j?(e.merge(e.createPositionAfter(_)),_):j)}}function Do(h){return h.parent.name=="blockQuote"?h.parent:null}function yw(h,e){let o,c=0;const _=[];for(;c<e.length;){const j=e[c],_e=e[c+1];o||(o=h.createPositionBefore(j)),(!_e||j.nextSibling!=_e)&&(_.push(h.createRange(o,h.createPositionAfter(j))),o=null),c++}return _}function kw(h,e){const o=h.checkChild(e.parent,"blockQuote"),c=h.checkChild(["$root","blockQuote"],e);return o&&c}class LR extends Ut{static get pluginName(){return"BlockQuoteEditing"}init(){const e=this.editor,o=e.model.schema;e.commands.add("blockQuote",new jR(e)),o.register("blockQuote",{allowWhere:"$block",allowContentOf:"$root"}),o.addChildCheck((c,_)=>{if(c.endsWith("blockQuote")&&_.name=="blockQuote")return!1}),e.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),e.model.document.registerPostFixer(c=>{const _=e.model.document.differ.getChanges();for(const j of _)if(j.type=="insert"){const _e=j.position.nodeAfter;if(!_e)continue;if(_e.is("blockQuote")&&_e.isEmpty)return c.remove(_e),!0;if(_e.is("blockQuote")&&!o.checkChild(j.position,_e))return c.unwrap(_e),!0;if(_e.is("element")){const et=c.createRangeIn(_e);for(const nt of et.getItems())if(nt.is("blockQuote")&&!o.checkChild(c.createPositionBefore(nt),nt))return c.unwrap(nt),!0}}else if(j.type=="remove"){const _e=j.position.parent;if(_e.is("blockQuote")&&_e.isEmpty)return c.remove(_e),!0}return!1})}afterInit(){const o=this.editor.commands.get("blockQuote");this.listenTo(this.editor.editing.view.document,"enter",(c,_)=>{const j=this.editor.model.document,_e=j.selection.getLastPosition().parent;j.selection.isCollapsed&&_e.isEmpty&&o.value&&(this.editor.execute("blockQuote"),this.editor.editing.view.scrollToTheSelection(),_.preventDefault(),c.stop())})}}var DR='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>';a(44);class FR extends Ut{init(){const e=this.editor,o=e.t;e.ui.componentFactory.add("blockQuote",c=>{const _=e.commands.get("blockQuote"),j=new Sn(c);return j.set({label:o("d"),icon:DR,tooltip:!0,isToggleable:!0}),j.bind("isOn","isEnabled").to(_,"value","isEnabled"),this.listenTo(j,"execute",()=>{e.execute("blockQuote"),e.editing.view.focus()}),j})}}class BR extends Ut{static get requires(){return[LR,FR]}static get pluginName(){return"BlockQuote"}}class xw extends hn{constructor(e,o){super(e),this.attributeKey=o}refresh(){const e=this.editor.model,o=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(o.selection,this.attributeKey)}execute(e={}){const o=this.editor.model,_=o.document.selection,j=e.forceValue===void 0?!this.value:e.forceValue;o.change(_e=>{if(_.isCollapsed)j?_e.setSelectionAttribute(this.attributeKey,!0):_e.removeSelectionAttribute(this.attributeKey);else{const et=o.schema.getValidRanges(_.getRanges(),this.attributeKey);for(const nt of et)j?_e.setAttribute(this.attributeKey,j,nt):_e.removeAttribute(this.attributeKey,nt)}})}_getValueFromFirstAllowedNode(){const e=this.editor.model,o=e.schema,c=e.document.selection;if(c.isCollapsed)return c.hasAttribute(this.attributeKey);for(const _ of c.getRanges())for(const j of _.getItems())if(o.checkAttribute(j,this.attributeKey))return j.hasAttribute(this.attributeKey);return!1}}const ks="bold";class zR extends Ut{static get pluginName(){return"BoldEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:ks}),e.model.schema.setAttributeProperties(ks,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:ks,view:"strong",upcastAlso:["b",o=>{const c=o.getStyle("font-weight");if(!c)return null;if(c=="bold"||Number(c)>=600)return{name:!0,styles:["font-weight"]}}]}),e.commands.add(ks,new xw(e,ks)),e.keystrokes.set("CTRL+B",ks)}}var VR='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>';const Ru="bold";class $R extends Ut{init(){const e=this.editor,o=e.t;e.ui.componentFactory.add(Ru,c=>{const _=e.commands.get(Ru),j=new Sn(c);return j.set({label:o("ai"),icon:VR,keystroke:"CTRL+B",tooltip:!0,isToggleable:!0}),j.bind("isOn","isEnabled").to(_,"value","isEnabled"),this.listenTo(j,"execute",()=>{e.execute(Ru),e.editing.view.focus()}),j})}}class UR extends Ut{static get requires(){return[zR,$R]}static get pluginName(){return"Bold"}}var WR='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.627 16.5zm5.873-.196zm0-7.001V8h-13v8.5h4.341c.191.54.457 1.044.785 1.5H2a1.5 1.5 0 0 1-1.5-1.5v-13A1.5 1.5 0 0 1 2 2h4.5a1.5 1.5 0 0 1 1.06.44L9.122 4H16a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 19 8v2.531a6.027 6.027 0 0 0-1.5-1.228zM16 6.5v-1H8.5l-2-2H2v13h1V8a1.5 1.5 0 0 1 1.5-1.5H16z"/><path d="M14.5 19.5a5 5 0 1 1 0-10 5 5 0 0 1 0 10zM15 14v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2z"/></svg>';class HR extends Ut{static get pluginName(){return"CKFinderUI"}init(){const e=this.editor,o=e.ui.componentFactory,c=e.t;o.add("ckfinder",_=>{const j=e.commands.get("ckfinder"),_e=new Sn(_);return _e.set({label:c("e"),icon:WR,tooltip:!0}),_e.bind("isEnabled").to(j),_e.on("execute",()=>{e.execute("ckfinder"),e.editing.view.focus()}),_e})}}class GR extends zr{observe(e){this.listenTo(e,"load",(o,c)=>{c.target.tagName=="IMG"&&this._fireEvents(c)},{useCapture:!0})}_fireEvents(e){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",e))}}class Ew{constructor(){this._stack=[]}add(e,o){const c=this._stack,_=c[0];this._insertDescriptor(e);const j=c[0];_!==j&&!Nu(_,j)&&this.fire("change:top",{oldDescriptor:_,newDescriptor:j,writer:o})}remove(e,o){const c=this._stack,_=c[0];this._removeDescriptor(e);const j=c[0];_!==j&&!Nu(_,j)&&this.fire("change:top",{oldDescriptor:_,newDescriptor:j,writer:o})}_insertDescriptor(e){const o=this._stack,c=o.findIndex(j=>j.id===e.id);if(Nu(e,o[c]))return;c>-1&&o.splice(c,1);let _=0;for(;o[_]&&qR(o[_],e);)_++;o.splice(_,0,e)}_removeDescriptor(e){const o=this._stack,c=o.findIndex(_=>_.id===e);c>-1&&o.splice(c,1)}}Zt(Ew,xn);function Nu(h,e){return h&&e&&h.priority==e.priority&&Fo(h.classes)==Fo(e.classes)}function qR(h,e){return h.priority>e.priority?!0:h.priority<e.priority?!1:Fo(h.classes)>Fo(e.classes)}function Fo(h){return Array.isArray(h)?h.sort().join(","):h}var KR='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>';const YR="ck-widget",Cw="ck-widget_selected";function Hr(h){return h.is("element")?!!h.getCustomProperty("widget"):!1}function Bo(h,e,o={}){return ar.isEdge||e.setAttribute("contenteditable","false",h),e.addClass(YR,h),e.setCustomProperty("widget",!0,h),h.getFillerOffset=ZR,o.label&&JR(h,o.label,e),o.hasSelectionHandle&&eN(h,e),QR(h,e,(_,j,_e)=>_e.addClass(c(j.classes),_),(_,j,_e)=>_e.removeClass(c(j.classes),_)),h;function c(_){return Array.isArray(_)?_:[_]}}function QR(h,e,o,c){const _=new Ew;_.on("change:top",(j,_e)=>{_e.oldDescriptor&&c(h,_e.oldDescriptor,_e.writer),_e.newDescriptor&&o(h,_e.newDescriptor,_e.writer)}),e.setCustomProperty("addHighlight",(j,_e,et)=>_.add(_e,et),h),e.setCustomProperty("removeHighlight",(j,_e,et)=>_.remove(_e,et),h)}function JR(h,e,o){o.setCustomProperty("widgetLabel",e,h)}function XR(h){const e=h.getCustomProperty("widgetLabel");return e?typeof e=="function"?e():e:""}function Ou(h,e){return e.addClass(["ck-editor__editable","ck-editor__nested-editable"],h),ar.isEdge||(e.setAttribute("contenteditable",h.isReadOnly?"false":"true",h),h.on("change:isReadOnly",(o,c,_)=>{e.setAttribute("contenteditable",_?"false":"true",h)})),h.on("change:isFocused",(o,c,_)=>{_?e.addClass("ck-editor__nested-editable_focused",h):e.removeClass("ck-editor__nested-editable_focused",h)}),h}function zo(h,e){const o=h.getSelectedElement();if(o&&e.schema.isBlock(o))return e.createPositionAfter(o);const c=h.getSelectedBlocks().next().value;if(c){if(c.isEmpty)return e.createPositionAt(c,0);const _=e.createPositionAfter(c);return h.focus.isTouching(_)?_:e.createPositionBefore(c)}return h.focus}function ZR(){return null}function eN(h,e){const o=e.createUIElement("div",{class:"ck ck-widget__selection-handle"},function(c){const _=this.toDomElement(c),j=new Lo;return j.set("content",KR),j.render(),_.appendChild(j.element),_});e.insert(e.createPositionAt(h,0),o),e.addClass(["ck-widget_with-selection-handle"],h)}function tN(h,e,o){return e.setCustomProperty("image",!0,h),Bo(h,e,{label:c});function c(){const j=is(h).getAttribute("alt");return j?`${j} ${o}`:o}}function nN(h){return!!h.getCustomProperty("image")&&Hr(h)}function Mu(h){const e=h.getSelectedElement();return e&&nN(e)?e:null}function Vo(h){return!!h&&h.is("image")}function Tw(h,e,o={}){const c=h.createElement("image",o),_=zo(e.document.selection,e);e.insertContent(c,_),c.parent&&h.setSelection(c,"on")}function Aw(h){const e=h.schema,o=h.document.selection;return iN(o,e,h)&&!rN(o,e)&&sN(o)}function is(h){return Array.from(h.getChildren()).find(e=>e.is("img"))}function iN(h,e,o){const c=oN(h,o);return e.checkChild(c,"image")}function rN(h,e){const o=h.getSelectedElement();return o&&e.isObject(o)}function sN(h){return[...h.focus.getAncestors()].every(e=>!e.is("image"))}function oN(h,e){const c=zo(h,e).parent;return c.isEmpty&&!c.is("$root")?c.parent:c}function aN(){return e=>{e.on("element:figure",h)};function h(e,o,c){if(!c.consumable.test(o.viewItem,{name:!0,classes:"image"}))return;const _=is(o.viewItem);if(!_||!_.hasAttribute("src")||!c.consumable.test(_,{name:!0}))return;const j=c.convertItem(_,o.modelCursor),_e=Or(j.modelRange.getItems());_e&&(c.convertChildren(o.viewItem,c.writer.createPositionAt(_e,0)),o.modelRange=j.modelRange,o.modelCursor=j.modelCursor)}}function lN(){return e=>{e.on("attribute:srcset:image",h)};function h(e,o,c){if(!c.consumable.consume(o.item,e.name))return;const _=c.writer,j=c.mapper.toViewElement(o.item),_e=is(j);if(o.attributeNewValue===null){const et=o.attributeOldValue;et.data&&(_.removeAttribute("srcset",_e),_.removeAttribute("sizes",_e),et.width&&_.removeAttribute("width",_e))}else{const et=o.attributeNewValue;et.data&&(_.setAttribute("srcset",et.data,_e),_.setAttribute("sizes","100vw",_e),et.width&&_.setAttribute("width",et.width,_e))}}}function Sw(h){return o=>{o.on(`attribute:${h}:image`,e)};function e(o,c,_){if(!_.consumable.consume(c.item,o.name))return;const j=_.writer,_e=_.mapper.toViewElement(c.item),et=is(_e);c.attributeNewValue!==null?j.setAttribute(c.attributeKey,c.attributeNewValue,et):j.removeAttribute(c.attributeKey,et)}}class cN extends hn{refresh(){this.isEnabled=Aw(this.editor.model)}execute(e){const o=this.editor.model;o.change(c=>{const _=Array.isArray(e.source)?e.source:[e.source];for(const j of _)Tw(c,o,{src:j})})}}class Iw extends Ut{static get pluginName(){return"ImageEditing"}init(){const e=this.editor,o=e.model.schema,c=e.t,_=e.conversion;e.editing.view.addObserver(GR),o.register("image",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["alt","src","srcset"]}),_.for("dataDowncast").elementToElement({model:"image",view:(j,_e)=>Pw(_e)}),_.for("editingDowncast").elementToElement({model:"image",view:(j,_e)=>tN(Pw(_e),_e,c("ak"))}),_.for("downcast").add(Sw("src")).add(Sw("alt")).add(lN()),_.for("upcast").elementToElement({view:{name:"img",attributes:{src:!0}},model:(j,_e)=>_e.createElement("image",{src:j.getAttribute("src")})}).attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:{key:"srcset",value:j=>{const _e={data:j.getAttribute("srcset")};return j.hasAttribute("width")&&(_e.width=j.getAttribute("width")),_e}}}).add(aN()),e.commands.add("imageInsert",new cN(e))}}function Pw(h){const e=h.createEmptyElement("img"),o=h.createContainerElement("figure",{class:"image"});return h.insert(h.createPositionAt(o,0),e),o}function ju(h,e,o){return o.createRange(Rw(h,e,!0,o),Rw(h,e,!1,o))}function Rw(h,e,o,c){let _=h.textNode||(o?h.nodeBefore:h.nodeAfter),j=null;for(;_&&_.getAttribute("linkHref")==e;)j=_,_=o?_.previousSibling:_.nextSibling;return j?c.createPositionAt(j,o?"before":"after"):h}class uN extends hn{constructor(e){super(e),this.manualDecorators=new or}restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,o=e.document;this.value=o.selection.getAttribute("linkHref");for(const c of this.manualDecorators)c.value=this._getDecoratorStateFromModel(c.id);this.isEnabled=e.schema.checkAttributeInSelection(o.selection,"linkHref")}execute(e,o={}){const c=this.editor.model,_=c.document.selection,j=[],_e=[];for(const et in o)o[et]?j.push(et):_e.push(et);c.change(et=>{if(_.isCollapsed){const nt=_.getFirstPosition();if(_.hasAttribute("linkHref")){const st=ju(nt,_.getAttribute("linkHref"),c);et.setAttribute("linkHref",e,st),j.forEach(at=>{et.setAttribute(at,!0,st)}),_e.forEach(at=>{et.removeAttribute(at,st)}),et.setSelection(st)}else if(e!==""){const st=Fr(_.getAttributes());st.set("linkHref",e),j.forEach(ct=>{st.set(ct,!0)});const at=et.createText(e,st);c.insertContent(at,nt),et.setSelection(et.createRangeOn(at))}}else{const nt=c.schema.getValidRanges(_.getRanges(),"linkHref");for(const st of nt)et.setAttribute("linkHref",e,st),j.forEach(at=>{et.setAttribute(at,!0,st)}),_e.forEach(at=>{et.removeAttribute(at,st)})}})}_getDecoratorStateFromModel(e){return this.editor.model.document.selection.getAttribute(e)||!1}}class dN extends hn{refresh(){this.isEnabled=this.editor.model.document.selection.hasAttribute("linkHref")}execute(){const e=this.editor,o=this.editor.model,c=o.document.selection,_=e.commands.get("link");o.change(j=>{const _e=c.isCollapsed?[ju(c.getFirstPosition(),c.getAttribute("linkHref"),o)]:c.getRanges();for(const et of _e)if(j.removeAttribute("linkHref",et),_)for(const nt of _.manualDecorators)j.removeAttribute(nt.id,et)})}}function hN(h,e,o){var c=h.length;return o=o===void 0?c:o,!e&&o>=c?h:rm(h,e,o)}var fN=hN,pN="\\ud800-\\udfff",mN="\\u0300-\\u036f",gN="\\ufe20-\\ufe2f",_N="\\u20d0-\\u20ff",wN=mN+gN+_N,vN="\\ufe0e\\ufe0f",bN="\\u200d",yN=RegExp("["+bN+pN+wN+vN+"]");function kN(h){return yN.test(h)}var Nw=kN;function xN(h){return h.split("")}var EN=xN,Ow="\\ud800-\\udfff",CN="\\u0300-\\u036f",TN="\\ufe20-\\ufe2f",AN="\\u20d0-\\u20ff",SN=CN+TN+AN,IN="\\ufe0e\\ufe0f",PN="["+Ow+"]",Lu="["+SN+"]",Du="\\ud83c[\\udffb-\\udfff]",RN="(?:"+Lu+"|"+Du+")",Mw="[^"+Ow+"]",jw="(?:\\ud83c[\\udde6-\\uddff]){2}",Lw="[\\ud800-\\udbff][\\udc00-\\udfff]",NN="\\u200d",Dw=RN+"?",Fw="["+IN+"]?",ON="(?:"+NN+"(?:"+[Mw,jw,Lw].join("|")+")"+Fw+Dw+")*",MN=Fw+Dw+ON,jN="(?:"+[Mw+Lu+"?",Lu,jw,Lw,PN].join("|")+")",LN=RegExp(Du+"(?="+Du+")|"+jN+MN,"g");function DN(h){return h.match(LN)||[]}var FN=DN;function BN(h){return Nw(h)?FN(h):EN(h)}var zN=BN;function VN(h){return function(e){e=tm(e);var o=Nw(e)?zN(e):void 0,c=o?o[0]:e.charAt(0),_=o?fN(o,1).join(""):e.slice(1);return c[h]()+_}}var $N=VN,UN=$N("toUpperCase"),WN=UN;const HN=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,GN=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i;function qN(h){return h.is("attributeElement")&&!!h.getCustomProperty("link")}function Bw(h,e){const o=e.createAttributeElement("a",{href:h},{priority:5});return e.setCustomProperty("link",!0,o),o}function zw(h){return h=String(h),KN(h)?h:"#"}function KN(h){return h.replace(HN,"").match(GN)}function YN(h,e){const o={"Open in a new tab":h("bp"),Downloadable:h("bq")};return e.forEach(c=>(c.label&&o[c.label]&&(c.label=o[c.label]),c)),e}function QN(h){const e=[];if(h)for(const[o,c]of Object.entries(h)){const _=Object.assign({},c,{id:`link${WN(o)}`});e.push(_)}return e}class JN{constructor(){this._definitions=new Set}get length(){return this._definitions.size}add(e){Array.isArray(e)?e.forEach(o=>this._definitions.add(o)):this._definitions.add(e)}getDispatcher(){return e=>{e.on("attribute:linkHref",(o,c,_)=>{if(!_.consumable.test(c.item,"attribute:linkHref"))return;const j=_.writer,_e=j.document.selection;for(const et of this._definitions){const nt=j.createAttributeElement("a",et.attributes,{priority:5});j.setCustomProperty("link",!0,nt),et.callback(c.attributeNewValue)?c.item.is("selection")?j.wrap(_e.getFirstRange(),nt):j.wrap(_.mapper.toViewRange(c.range),nt):j.unwrap(_.mapper.toViewRange(c.range),nt)}},{priority:"high"})}}}class Vw{constructor({id:e,label:o,attributes:c}){this.id=e,this.set("value"),this.label=o,this.attributes=c}}Zt(Vw,Mn);function XN({view:h,model:e,emitter:o,attribute:c,locale:_}){const j=new ZN(e,o,c),_e=e.document.selection;o.listenTo(h.document,"keydown",(et,nt)=>{if(!_e.isCollapsed||nt.shiftKey||nt.altKey||nt.ctrlKey)return;const st=nt.keyCode==mn.arrowright,at=nt.keyCode==mn.arrowleft;if(!st&&!at)return;const ct=_e.getFirstPosition(),dt=_.contentLanguageDirection;let gt;dt==="ltr"&&st||dt==="rtl"&&at?gt=j.handleForwardMovement(ct,nt):gt=j.handleBackwardMovement(ct,nt),gt&&et.stop()},{priority:Fl.get("high")+1})}class ZN{constructor(e,o,c){this.model=e,this.attribute=c,this._modelSelection=e.document.selection,this._overrideUid=null,this._isNextGravityRestorationSkipped=!1,o.listenTo(this._modelSelection,"change:range",(_,j)=>{if(this._isNextGravityRestorationSkipped){this._isNextGravityRestorationSkipped=!1;return}this._isGravityOverridden&&(!j.directChange&&$w(this._modelSelection.getFirstPosition(),c)||this._restoreGravity())})}handleForwardMovement(e,o){const c=this.attribute;if(!this._isGravityOverridden&&!(e.isAtStart&&this._hasSelectionAttribute)){if(Bu(e,c)&&this._hasSelectionAttribute)return this._preventCaretMovement(o),this._removeSelectionAttribute(),!0;if(Uw(e,c))return this._preventCaretMovement(o),this._overrideGravity(),!0;if(Fu(e,c)&&this._hasSelectionAttribute)return this._preventCaretMovement(o),this._overrideGravity(),!0}}handleBackwardMovement(e,o){const c=this.attribute;if(this._isGravityOverridden)return Bu(e,c)&&this._hasSelectionAttribute?(this._preventCaretMovement(o),this._restoreGravity(),this._removeSelectionAttribute(),!0):(this._preventCaretMovement(o),this._restoreGravity(),e.isAtStart&&this._removeSelectionAttribute(),!0);if(Bu(e,c)&&!this._hasSelectionAttribute)return this._preventCaretMovement(o),this._setSelectionAttributeFromTheNodeBefore(e),!0;if(e.isAtEnd&&Fu(e,c))if(this._hasSelectionAttribute){Ww(e,c)&&(this._skipNextAutomaticGravityRestoration(),this._overrideGravity());return}else return this._preventCaretMovement(o),this._setSelectionAttributeFromTheNodeBefore(e),!0;if(e.isAtStart)return this._hasSelectionAttribute?(this._removeSelectionAttribute(),this._preventCaretMovement(o),!0):void 0;Ww(e,c)&&(this._skipNextAutomaticGravityRestoration(),this._overrideGravity())}get _isGravityOverridden(){return!!this._overrideUid}get _hasSelectionAttribute(){return this._modelSelection.hasAttribute(this.attribute)}_overrideGravity(){this._overrideUid=this.model.change(e=>e.overrideSelectionGravity())}_restoreGravity(){this.model.change(e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}_preventCaretMovement(e){e.preventDefault()}_removeSelectionAttribute(){this.model.change(e=>{e.removeSelectionAttribute(this.attribute)})}_setSelectionAttributeFromTheNodeBefore(e){const o=this.attribute;this.model.change(c=>{c.setSelectionAttribute(this.attribute,e.nodeBefore.getAttribute(o))})}_skipNextAutomaticGravityRestoration(){this._isNextGravityRestorationSkipped=!0}}function $w(h,e){return Uw(h,e)||Fu(h,e)}function Uw(h,e){const{nodeBefore:o,nodeAfter:c}=h,_=o?o.hasAttribute(e):!1;return(c?c.hasAttribute(e):!1)&&(!_||o.getAttribute(e)!==c.getAttribute(e))}function Fu(h,e){const{nodeBefore:o,nodeAfter:c}=h,_=o?o.hasAttribute(e):!1,j=c?c.hasAttribute(e):!1;return _&&(!j||o.getAttribute(e)!==c.getAttribute(e))}function Bu(h,e){const{nodeBefore:o,nodeAfter:c}=h,_=o?o.hasAttribute(e):!1;if(!(!(c&&c.hasAttribute(e))||!_))return c.getAttribute(e)!==o.getAttribute(e)}function Ww(h,e){return $w(h.getShiftedBy(-1),e)}a(46);const zu="ck-link_selected",Hw="automatic",eO="manual",tO=/^(https?:)?\/\//;class Gw extends Ut{static get pluginName(){return"LinkEditing"}constructor(e){super(e),e.config.define("link",{addTargetToExternalLinks:!1})}init(){const e=this.editor,o=e.locale;e.model.schema.extend("$text",{allowAttributes:"linkHref"}),e.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:Bw}),e.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(_,j)=>Bw(zw(_),j)}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:_=>_.getAttribute("href")}}),e.commands.add("link",new uN(e)),e.commands.add("unlink",new dN(e));const c=YN(e.t,QN(e.config.get("link.decorators")));this._enableAutomaticDecorators(c.filter(_=>_.mode===Hw)),this._enableManualDecorators(c.filter(_=>_.mode===eO)),XN({view:e.editing.view,model:e.model,emitter:this,attribute:"linkHref",locale:o}),this._setupLinkHighlight()}_enableAutomaticDecorators(e){const o=this.editor,c=new JN;o.config.get("link.addTargetToExternalLinks")&&c.add({id:"linkIsExternal",mode:Hw,callback:_=>tO.test(_),attributes:{target:"_blank",rel:"noopener noreferrer"}}),c.add(e),c.length&&o.conversion.for("downcast").add(c.getDispatcher())}_enableManualDecorators(e){if(!e.length)return;const o=this.editor,_=o.commands.get("link").manualDecorators;e.forEach(j=>{o.model.schema.extend("$text",{allowAttributes:j.id}),_.add(new Vw(j)),o.conversion.for("downcast").attributeToElement({model:j.id,view:(_e,et)=>{if(_e){const nt=_.get(j.id).attributes,st=et.createAttributeElement("a",nt,{priority:5});return et.setCustomProperty("link",!0,st),st}}}),o.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:_.get(j.id).attributes},model:{key:j.id}})})}_setupLinkHighlight(){const e=this.editor,o=e.editing.view,c=new Set;o.document.registerPostFixer(_=>{const j=e.model.document.selection;let _e=!1;if(j.hasAttribute("linkHref")){const et=ju(j.getFirstPosition(),j.getAttribute("linkHref"),e.model),nt=e.editing.mapper.toViewRange(et);for(const st of nt.getItems())st.is("a")&&!st.hasClass(zu)&&(_.addClass(zu,st),c.add(st),_e=!0)}return _e}),e.conversion.for("editingDowncast").add(_=>{_.on("insert",j,{priority:"highest"}),_.on("remove",j,{priority:"highest"}),_.on("attribute",j,{priority:"highest"}),_.on("selection",j,{priority:"highest"});function j(){o.change(_e=>{for(const et of c.values())_e.removeClass(zu,et),c.delete(et)})}})}}class Vu{constructor(e){this.context=e}destroy(){this.stopListening()}static get isContextPlugin(){return!0}}Zt(Vu,Mn);class $u extends Vu{static get pluginName(){return"Notification"}init(){this.on("show:warning",(e,o)=>{window.alert(o.message)},{priority:"lowest"})}showSuccess(e,o={}){this._showNotification({message:e,type:"success",namespace:o.namespace,title:o.title})}showInfo(e,o={}){this._showNotification({message:e,type:"info",namespace:o.namespace,title:o.title})}showWarning(e,o={}){this._showNotification({message:e,type:"warning",namespace:o.namespace,title:o.title})}_showNotification(e){const o=`show:${e.type}`+(e.namespace?`:${e.namespace}`:"");this.fire(o,{message:e.message,type:e.type,title:e.title||""})}}class nO extends hn{constructor(e){super(e),this.stopListening(this.editor.model.document,"change"),this.listenTo(this.editor.model.document,"change",()=>this.refresh(),{priority:"low"})}refresh(){const e=this.editor.commands.get("imageInsert"),o=this.editor.commands.get("link");this.isEnabled=e.isEnabled||o.isEnabled}execute(){const e=this.editor,o=this.editor.config.get("ckfinder.openerMethod")||"modal";if(o!="popup"&&o!="modal")throw new yt.b('ckfinder-unknown-openerMethod: The openerMethod config option must by "popup" or "modal".',e);const c=this.editor.config.get("ckfinder.options")||{};c.chooseFiles=!0;const _=c.onInit;c.language||(c.language=e.locale.uiLanguage),c.onInit=j=>{_&&_(j),j.on("files:choose",_e=>{const et=_e.data.files.toArray(),nt=et.filter(ct=>!ct.isImage()),st=et.filter(ct=>ct.isImage());for(const ct of nt)e.execute("link",ct.getUrl());const at=[];for(const ct of st){const dt=ct.getUrl();at.push(dt||j.request("file:getProxyUrl",{file:ct}))}at.length&&qw(e,at)}),j.on("file:choose:resizedImage",_e=>{const et=_e.data.resizedUrl;if(!et){const nt=e.plugins.get("Notification"),st=e.locale.t;nt.showWarning(st("av"),{title:st("aw"),namespace:"ckfinder"});return}qw(e,[et])})},window.CKFinder[o](c)}}function qw(h,e){if(!h.commands.get("imageInsert").isEnabled){const c=h.plugins.get("Notification"),_=h.locale.t;c.showWarning(_("ax"),{title:_("ay"),namespace:"ckfinder"});return}h.execute("imageInsert",{source:e})}class iO extends Ut{static get pluginName(){return"CKFinderEditing"}static get requires(){return[$u,Iw,Gw]}init(){const e=this.editor;e.commands.add("ckfinder",new nO(e))}}class Kw extends Vu{static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new or({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(e){if(typeof e!="string")throw new yt.b("pendingactions-add-invalid-message: The message must be a string.",this);const o=Object.create(Mn);return o.set("message",e),this._actions.add(o),this.hasAny=!0,o}remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}class Yw{constructor(){const e=new window.FileReader;this._reader=e,this._data=void 0,this.set("loaded",0),e.onprogress=o=>{this.loaded=o.loaded}}get error(){return this._reader.error}get data(){return this._data}read(e){const o=this._reader;return this.total=e.size,new Promise((c,_)=>{o.onload=()=>{const j=o.result;this._data=j,c(j)},o.onerror=()=>{_("error")},o.onabort=()=>{_("aborted")},this._reader.readAsDataURL(e)})}abort(){this._reader.abort()}}Zt(Yw,Mn);class Gr extends Ut{static get pluginName(){return"FileRepository"}static get requires(){return[Kw]}init(){this.loaders=new or,this.loaders.on("add",()=>this._updatePendingAction()),this.loaders.on("remove",()=>this._updatePendingAction()),this._loadersMap=new Map,this._pendingAction=null,this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(e,o)=>o?e/o*100:0)}getLoader(e){return this._loadersMap.get(e)||null}createLoader(e){if(!this.createUploadAdapter)return console.warn(Object(yt.a)("filerepository-no-upload-adapter: Upload adapter is not defined.")),null;const o=new Uu(Promise.resolve(e),this.createUploadAdapter);return this.loaders.add(o),this._loadersMap.set(e,o),e instanceof Promise&&o.file.then(c=>{this._loadersMap.set(c,o)}).catch(()=>{}),o.on("change:uploaded",()=>{let c=0;for(const _ of this.loaders)c+=_.uploaded;this.uploaded=c}),o.on("change:uploadTotal",()=>{let c=0;for(const _ of this.loaders)_.uploadTotal&&(c+=_.uploadTotal);this.uploadTotal=c}),o}destroyLoader(e){const o=e instanceof Uu?e:this.getLoader(e);o._destroy(),this.loaders.remove(o),this._loadersMap.forEach((c,_)=>{c===o&&this._loadersMap.delete(_)})}_updatePendingAction(){const e=this.editor.plugins.get(Kw);if(this.loaders.length){if(!this._pendingAction){const o=this.editor.t,c=_=>`${o("at")} ${parseInt(_)}%.`;this._pendingAction=e.add(c(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",c)}}else e.remove(this._pendingAction),this._pendingAction=null}}Zt(Gr,Mn);class Uu{constructor(e,o){this.id=Tr(),this._filePromiseWrapper=this._createFilePromiseWrapper(e),this._adapter=o(this),this._reader=new Yw,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(c,_)=>_?c/_*100:0),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then(e=>this._filePromiseWrapper?e:null):Promise.resolve(null)}get data(){return this._reader.data}read(){if(this.status!="idle")throw new yt.b("filerepository-read-wrong-status: You cannot call read if the status is different than idle.",this);return this.status="reading",this.file.then(e=>this._reader.read(e)).then(e=>(this.status="idle",e)).catch(e=>{throw e==="aborted"?(this.status="aborted","aborted"):(this.status="error",this._reader.error?this._reader.error:e)})}upload(){if(this.status!="idle")throw new yt.b("filerepository-upload-wrong-status: You cannot call upload if the status is different than idle.",this);return this.status="uploading",this.file.then(()=>this._adapter.upload()).then(e=>(this.uploadResponse=e,this.status="idle",e)).catch(e=>{throw this.status==="aborted"?"aborted":(this.status="error",e)})}abort(){const e=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?e=="reading"?this._reader.abort():e=="uploading"&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch(()=>{}),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(e){const o={};return o.promise=new Promise((c,_)=>{o.rejecter=_,o.isFulfilled=!1,e.then(j=>{o.isFulfilled=!0,c(j)}).catch(j=>{o.isFulfilled=!0,_(j)})}),o}}Zt(Uu,Mn);const Qw="ckCsrfToken",Jw=40,Xw="abcdefghijklmnopqrstuvwxyz0123456789";function rO(){let h=sO(Qw);return(!h||h.length!=Jw)&&(h=aO(Jw),oO(Qw,h)),h}function sO(h){h=h.toLowerCase();const e=document.cookie.split(";");for(const o of e){const c=o.split("=");if(decodeURIComponent(c[0].trim().toLowerCase())===h)return decodeURIComponent(c[1])}return null}function oO(h,e){document.cookie=encodeURIComponent(h)+"="+encodeURIComponent(e)+";path=/"}function aO(h){let e="";const o=new Uint8Array(h);window.crypto.getRandomValues(o);for(let c=0;c<o.length;c++){const _=Xw.charAt(o[c]%Xw.length);e+=Math.random()>.5?_.toUpperCase():_}return e}class Zw extends Ut{static get requires(){return[Gr]}static get pluginName(){return"CKFinderUploadAdapter"}init(){const e=this.editor.config.get("ckfinder.uploadUrl");e&&(this.editor.plugins.get(Gr).createUploadAdapter=o=>new lO(o,e,this.editor.t))}}class lO{constructor(e,o,c){this.loader=e,this.url=o,this.t=c}upload(){return this.loader.file.then(e=>new Promise((o,c)=>{this._initRequest(),this._initListeners(o,c,e),this._sendRequest(e)}))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const e=this.xhr=new XMLHttpRequest;e.open("POST",this.url,!0),e.responseType="json"}_initListeners(e,o,c){const _=this.xhr,j=this.loader,_e=this.t,et=_e("a")+` ${c.name}.`;_.addEventListener("error",()=>o(et)),_.addEventListener("abort",()=>o()),_.addEventListener("load",()=>{const nt=_.response;if(!nt||!nt.uploaded)return o(nt&&nt.error&&nt.error.message?nt.error.message:et);e({default:nt.url})}),_.upload&&_.upload.addEventListener("progress",nt=>{nt.lengthComputable&&(j.uploadTotal=nt.total,j.uploaded=nt.loaded)})}_sendRequest(e){const o=new FormData;o.append("upload",e),o.append("ckCsrfToken",rO()),this.xhr.send(o)}}class cO extends Ut{static get pluginName(){return"CKFinder"}static get requires(){return[iO,HR,Zw]}}class uO extends hn{refresh(){const e=this.editor.model,o=e.document,c=Or(o.selection.getSelectedBlocks());this.value=!!c&&c.is("paragraph"),this.isEnabled=!!c&&ev(c,e.schema)}execute(e={}){const o=this.editor.model,c=o.document;o.change(_=>{const j=(e.selection||c.selection).getSelectedBlocks();for(const _e of j)!_e.is("paragraph")&&ev(_e,o.schema)&&_.rename(_e,"paragraph")})}}function ev(h,e){return e.checkChild(h.parent,"paragraph")&&!e.isObject(h)}class xs extends Ut{static get pluginName(){return"Paragraph"}init(){const e=this.editor,o=e.model,c=e.data;e.commands.add("paragraph",new uO(e)),o.schema.register("paragraph",{inheritAllFrom:"$block"}),e.conversion.elementToElement({model:"paragraph",view:"p"}),e.conversion.for("upcast").elementToElement({model:(_,j)=>!xs.paragraphLikeElements.has(_.name)||_.isEmpty?null:j.createElement("paragraph"),converterPriority:"low"}),c.upcastDispatcher.on("element",(_,j,_e)=>{_e.consumable.test(j.viewItem,{name:j.viewItem.name})&&nv(j.viewItem,j.modelCursor,_e.schema)&&Object.assign(j,tv(j.viewItem,j.modelCursor,_e))},{priority:"low"}),c.upcastDispatcher.on("text",(_,j,_e)=>{j.modelRange||nv(j.viewItem,j.modelCursor,_e.schema)&&Object.assign(j,tv(j.viewItem,j.modelCursor,_e))},{priority:"lowest"}),o.document.registerPostFixer(_=>this._autoparagraphEmptyRoots(_)),e.data.on("ready",()=>{o.enqueueChange("transparent",_=>this._autoparagraphEmptyRoots(_))},{priority:"lowest"})}_autoparagraphEmptyRoots(e){const o=this.editor.model;for(const c of o.document.getRootNames()){const _=o.document.getRoot(c);if(_.isEmpty&&_.rootName!="$graveyard"&&o.schema.checkChild(_,"paragraph"))return e.insertElement("paragraph",_),!0}}}xs.paragraphLikeElements=new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td"]);function tv(h,e,o){const c=o.writer.createElement("paragraph");return o.writer.insert(c,e),o.convertItem(h,o.writer.createPositionAt(c,0))}function nv(h,e,o){const c=o.createContext(e);return!(!o.checkChild(c,"paragraph")||!o.checkChild(c.push("paragraph"),h))}class dO extends hn{constructor(e,o){super(e),this.modelElements=o}refresh(){const e=Or(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some(o=>iv(e,o,this.editor.model.schema))}execute(e){const o=this.editor.model,c=o.document,_=e.value;o.change(j=>{const _e=Array.from(c.selection.getSelectedBlocks()).filter(et=>iv(et,_,o.schema));for(const et of _e)et.is(_)||j.rename(et,_)})}}function iv(h,e,o){return o.checkChild(h.parent,e)&&!o.isObject(h)}const Wu="paragraph";class hO extends Ut{static get pluginName(){return"HeadingEditing"}constructor(e){super(e),e.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[xs]}init(){const e=this.editor,o=e.config.get("heading.options"),c=[];for(const _ of o)_.model!==Wu&&(e.model.schema.register(_.model,{inheritAllFrom:"$block"}),e.conversion.elementToElement(_),c.push(_.model));this._addDefaultH1Conversion(e),e.commands.add("heading",new dO(e,c))}afterInit(){const e=this.editor,o=e.commands.get("enter"),c=e.config.get("heading.options");o&&this.listenTo(o,"afterExecute",(_,j)=>{const _e=e.model.document.selection.getFirstPosition().parent;c.some(nt=>_e.is(nt.model))&&!_e.is(Wu)&&_e.childCount===0&&j.writer.rename(_e,Wu)})}_addDefaultH1Conversion(e){e.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:Fl.get("low")+1})}}class Hu{constructor(e,o){o&&fs(this,o),e&&this.set(e)}}Zt(Hu,Mn);function fO(h){const e=h.t,o={Paragraph:e("bw"),"Heading 1":e("bx"),"Heading 2":e("by"),"Heading 3":e("bz"),"Heading 4":e("ca"),"Heading 5":e("cb"),"Heading 6":e("cc")};return h.config.get("heading.options").map(c=>{const _=o[c.title];return _&&_!=c.title&&(c.title=_),c})}a(11);class pO extends Ut{init(){const e=this.editor,o=e.t,c=fO(e),_=o("f"),j=o("g");e.ui.componentFactory.add("heading",_e=>{const et={},nt=new or,st=e.commands.get("heading"),at=e.commands.get("paragraph"),ct=[st];for(const gt of c){const kt={type:"button",model:new Hu({label:gt.title,class:gt.class,withText:!0})};gt.model==="paragraph"?(kt.model.bind("isOn").to(at,"value"),kt.model.set("commandName","paragraph"),ct.push(at)):(kt.model.bind("isOn").to(st,"value",Ct=>Ct===gt.model),kt.model.set({commandName:"heading",commandValue:gt.model})),nt.add(kt),et[gt.model]=gt.title}const dt=Ys(_e);return _w(dt,nt),dt.buttonView.set({isOn:!1,withText:!0,tooltip:j}),dt.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),dt.bind("isEnabled").toMany(ct,"isEnabled",(...gt)=>gt.some(kt=>kt)),dt.buttonView.bind("label").to(st,"value",at,"value",(gt,kt)=>{const Ct=gt||kt&&"paragraph";return et[Ct]?et[Ct]:_}),this.listenTo(dt,"execute",gt=>{e.execute(gt.source.commandName,gt.source.commandValue?{value:gt.source.commandValue}:void 0),e.editing.view.focus()}),dt})}}class mO extends Ut{static get requires(){return[hO,pO]}static get pluginName(){return"Heading"}}class gO extends Vr{constructor(e){super(e),this.domEventType="mousedown"}onDomEvent(e){this.fire(e.type,e)}}a(49);const _O=bm("Ctrl+A");class $o extends Ut{static get pluginName(){return"Widget"}init(){const e=this.editor.editing.view,o=e.document;this._previouslySelected=new Set,this.editor.editing.downcastDispatcher.on("selection",(c,_,j)=>{this._clearPreviouslySelectedWidgets(j.writer);const _e=j.writer,et=_e.document.selection,nt=et.getSelectedElement();let st=null;for(const at of et.getRanges())for(const ct of at){const dt=ct.item;Hr(dt)&&!yO(dt,st)&&(_e.addClass(Cw,dt),this._previouslySelected.add(dt),st=dt,dt==nt&&_e.setSelection(et.getRanges(),{fake:!0,label:XR(nt)}))}},{priority:"low"}),e.addObserver(gO),this.listenTo(o,"mousedown",(...c)=>this._onMousedown(...c)),this.listenTo(o,"keydown",(...c)=>this._onKeydown(...c),{priority:"high"}),this.listenTo(o,"delete",(c,_)=>{this._handleDelete(_.direction=="forward")&&(_.preventDefault(),c.stop())},{priority:"high"})}_onMousedown(e,o){const c=this.editor,_=c.editing.view,j=_.document;let _e=o.target;if(bO(_e)){if(ar.isSafari&&o.domEvent.detail>=3){const st=c.editing.mapper.toModelElement(_e);this.editor.model.change(at=>{o.preventDefault(),at.setSelection(st,"in")})}return}if(!Hr(_e)&&(_e=_e.findAncestor(Hr),!_e))return;o.preventDefault(),j.isFocused||_.focus();const et=c.editing.mapper.toModelElement(_e);this._setSelectionOverElement(et)}_onKeydown(e,o){const c=o.keyCode,_=this.editor.locale.contentLanguageDirection==="ltr",j=c==mn.arrowdown||c==mn[_?"arrowright":"arrowleft"];let _e=!1;wO(c)?_e=this._handleArrowKeys(j):vO(o)?_e=this._selectAllNestedEditableContent()||this._selectAllContent():c===mn.enter&&(_e=this._handleEnterKey(o.shiftKey)),_e&&(o.preventDefault(),e.stop())}_handleDelete(e){if(this.editor.isReadOnly)return;const c=this.editor.model.document.selection;if(!c.isCollapsed)return;const _=this._getObjectElementNextToSelection(e);if(_)return this.editor.model.change(j=>{let _e=c.anchor.parent;for(;_e.isEmpty;){const et=_e;_e=et.parent,j.remove(et)}this._setSelectionOverElement(_)}),!0}_handleArrowKeys(e){const o=this.editor.model,c=o.schema,j=o.document.selection,_e=j.getSelectedElement();if(_e&&c.isObject(_e)){const nt=e?j.getLastPosition():j.getFirstPosition(),st=c.getNearestSelectionRange(nt,e?"forward":"backward");return st&&o.change(at=>{at.setSelection(st)}),!0}if(!j.isCollapsed)return;const et=this._getObjectElementNextToSelection(e);if(et&&c.isObject(et))return this._setSelectionOverElement(et),!0}_handleEnterKey(e){const o=this.editor.model,_=o.document.selection.getSelectedElement();if(kO(_,o.schema))return o.change(j=>{let _e=j.createPositionAt(_,e?"before":"after");const et=j.createElement("paragraph");if(o.schema.isBlock(_.parent)){const nt=o.schema.findAllowedParent(_e,et);_e=j.split(_e,nt).position}j.insert(et,_e),j.setSelection(et,"in")}),!0}_selectAllNestedEditableContent(){const e=this.editor.model,o=e.document.selection,c=e.schema.getLimitElement(o);return o.getFirstRange().root==c?!1:(e.change(_=>{_.setSelection(_.createRangeIn(c))}),!0)}_selectAllContent(){const e=this.editor.model,o=this.editor.editing,_e=o.view.document.selection.getSelectedElement();if(_e&&Hr(_e)){const et=o.mapper.toModelElement(_e.parent);return e.change(nt=>{nt.setSelection(nt.createRangeIn(et))}),!0}return!1}_setSelectionOverElement(e){this.editor.model.change(o=>{o.setSelection(o.createRangeOn(e))})}_getObjectElementNextToSelection(e){const o=this.editor.model,c=o.schema,_=o.document.selection,j=o.createSelection(_);o.modifySelection(j,{direction:e?"forward":"backward"});const _e=e?j.focus.nodeBefore:j.focus.nodeAfter;return _e&&c.isObject(_e)?_e:null}_clearPreviouslySelectedWidgets(e){for(const o of this._previouslySelected)e.removeClass(Cw,o);this._previouslySelected.clear()}}function wO(h){return h==mn.arrowright||h==mn.arrowleft||h==mn.arrowup||h==mn.arrowdown}function vO(h){return Ir(h)==_O}function bO(h){for(;h;){if(h.is("editableElement")&&!h.is("rootElement"))return!0;if(Hr(h))return!1;h=h.parent}return!1}function yO(h,e){return e?Array.from(h.getAncestors()).includes(e):!1}function kO(h,e){return h&&e.isObject(h)&&!e.isInline(h)}class xO extends hn{refresh(){const e=this.editor.model.document.selection.getSelectedElement();this.isEnabled=Vo(e),Vo(e)&&e.hasAttribute("alt")?this.value=e.getAttribute("alt"):this.value=!1}execute(e){const o=this.editor.model,c=o.document.selection.getSelectedElement();o.change(_=>{_.setAttribute("alt",e.newValue,c)})}}class EO extends Ut{static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new xO(this.editor))}}a(51);class Gu extends sn{constructor(e,o){super(e);const c=`ck-input-${Tr()}`,_=`ck-status-${Tr()}`;this.set("label"),this.set("value"),this.set("isReadOnly",!1),this.set("errorText",null),this.set("infoText",null),this.labelView=this._createLabelView(c),this.inputView=this._createInputView(o,c,_),this.statusView=this._createStatusView(_),this.bind("_statusText").to(this,"errorText",this,"infoText",(_e,et)=>_e||et);const j=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-input",j.if("isReadOnly","ck-disabled")]},children:[this.labelView,this.inputView,this.statusView]})}_createLabelView(e){const o=new cw(this.locale);return o.for=e,o.bind("text").to(this,"label"),o}_createInputView(e,o,c){const _=new e(this.locale,c);return _.id=o,_.ariaDescribedById=c,_.bind("value").to(this),_.bind("isReadOnly").to(this),_.bind("hasError").to(this,"errorText",j=>!!j),_.on("input",()=>{this.errorText=null}),_}_createStatusView(e){const o=new sn(this.locale),c=this.bindTemplate;return o.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-input__status",c.if("errorText","ck-labeled-input__status_error"),c.if("_statusText","ck-hidden",_=>!_)],id:e,role:c.if("errorText","alert")},children:[{text:c.to("_statusText")}]}),o}select(){this.inputView.select()}focus(){this.inputView.focus()}}a(53);class qu extends sn{constructor(e){super(e),this.set("value"),this.set("id"),this.set("placeholder"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById");const o=this.bindTemplate;this.setTemplate({tag:"input",attributes:{type:"text",class:["ck","ck-input","ck-input-text",o.if("hasError","ck-error")],id:o.to("id"),placeholder:o.to("placeholder"),readonly:o.to("isReadOnly"),"aria-invalid":o.if("hasError",!0),"aria-describedby":o.to("ariaDescribedById")},on:{input:o.to("input")}})}render(){super.render();const e=o=>{this.element.value=!o&&o!==0?"":o};e(this.value),this.on("change:value",(o,c,_)=>{e(_)})}select(){this.element.select()}focus(){this.element.focus()}}function Ku({view:h}){h.listenTo(h.element,"submit",(e,o)=>{o.preventDefault(),h.fire("submit")},{useCapture:!0})}var Yu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',Qu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.591 10.177l4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>';a(55);class CO extends sn{constructor(e){super(e);const o=this.locale.t;this.focusTracker=new _r,this.keystrokes=new Wr,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(o("bd"),Yu,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(o("be"),Qu,"ck-button-cancel","cancel"),this._focusables=new ns,this._focusCycler=new bs({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]})}render(){super.render(),this.keystrokes.listenTo(this.element),Ku({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)})}_createButton(e,o,c,_){const j=new Sn(this.locale);return j.set({label:e,icon:o,tooltip:!0}),j.extendTemplate({attributes:{class:c}}),_&&j.delegate("execute").to(this,_),j}_createLabeledInputView(){const e=this.locale.t,o=new Gu(this.locale,qu);return o.label=e("bf"),o.inputView.placeholder=e("bf"),o}}a(57);const rv=xu("px"),sv=jn.document.body;class an extends sn{constructor(e){super(e);const o=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class"),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",o.to("position",c=>`ck-balloon-panel_${c}`),o.if("isVisible","ck-balloon-panel_visible"),o.if("withArrow","ck-balloon-panel_with-arrow"),o.to("class")],style:{top:o.to("top",rv),left:o.to("left",rv)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){this.show();const o=an.defaultPositions,c=Object.assign({},{element:this.element,positions:[o.southArrowNorth,o.southArrowNorthMiddleWest,o.southArrowNorthMiddleEast,o.southArrowNorthWest,o.southArrowNorthEast,o.northArrowSouth,o.northArrowSouthMiddleWest,o.northArrowSouthMiddleEast,o.northArrowSouthWest,o.northArrowSouthEast],limiter:sv,fitInViewport:!0},e),_=an._getOptimalPosition(c),j=parseInt(_.left),_e=parseInt(_.top),et=_.name;Object.assign(this,{top:_e,left:j,position:et})}pin(e){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this._startPinning(e),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){this.attachTo(e);const o=Ju(e.target),c=e.limiter?Ju(e.limiter):sv;this.listenTo(jn.document,"scroll",(_,j)=>{const _e=j.target,et=o&&_e.contains(o),nt=c&&_e.contains(c);(et||nt||!o||!c)&&this.attachTo(e)},{useCapture:!0}),this.listenTo(jn.window,"resize",()=>{this.attachTo(e)})}_stopPinning(){this.stopListening(jn.document,"scroll"),this.stopListening(jn.window,"resize")}}function Ju(h){return Cr(h)?h:Co(h)?h.commonAncestorContainer:typeof h=="function"?Ju(h()):null}an.arrowHorizontalOffset=25,an.arrowVerticalOffset=10,an._getOptimalPosition=fw,an.defaultPositions={northWestArrowSouthWest:(h,e)=>({top:Qn(h,e),left:h.left-an.arrowHorizontalOffset,name:"arrow_sw"}),northWestArrowSouthMiddleWest:(h,e)=>({top:Qn(h,e),left:h.left-e.width*.25-an.arrowHorizontalOffset,name:"arrow_smw"}),northWestArrowSouth:(h,e)=>({top:Qn(h,e),left:h.left-e.width/2,name:"arrow_s"}),northWestArrowSouthMiddleEast:(h,e)=>({top:Qn(h,e),left:h.left-e.width*.75+an.arrowHorizontalOffset,name:"arrow_sme"}),northWestArrowSouthEast:(h,e)=>({top:Qn(h,e),left:h.left-e.width+an.arrowHorizontalOffset,name:"arrow_se"}),northArrowSouthWest:(h,e)=>({top:Qn(h,e),left:h.left+h.width/2-an.arrowHorizontalOffset,name:"arrow_sw"}),northArrowSouthMiddleWest:(h,e)=>({top:Qn(h,e),left:h.left+h.width/2-e.width*.25-an.arrowHorizontalOffset,name:"arrow_smw"}),northArrowSouth:(h,e)=>({top:Qn(h,e),left:h.left+h.width/2-e.width/2,name:"arrow_s"}),northArrowSouthMiddleEast:(h,e)=>({top:Qn(h,e),left:h.left+h.width/2-e.width*.75+an.arrowHorizontalOffset,name:"arrow_sme"}),northArrowSouthEast:(h,e)=>({top:Qn(h,e),left:h.left+h.width/2-e.width+an.arrowHorizontalOffset,name:"arrow_se"}),northEastArrowSouthWest:(h,e)=>({top:Qn(h,e),left:h.right-an.arrowHorizontalOffset,name:"arrow_sw"}),northEastArrowSouthMiddleWest:(h,e)=>({top:Qn(h,e),left:h.right-e.width*.25-an.arrowHorizontalOffset,name:"arrow_smw"}),northEastArrowSouth:(h,e)=>({top:Qn(h,e),left:h.right-e.width/2,name:"arrow_s"}),northEastArrowSouthMiddleEast:(h,e)=>({top:Qn(h,e),left:h.right-e.width*.75+an.arrowHorizontalOffset,name:"arrow_sme"}),northEastArrowSouthEast:(h,e)=>({top:Qn(h,e),left:h.right-e.width+an.arrowHorizontalOffset,name:"arrow_se"}),southWestArrowNorthWest:(h,e)=>({top:Jn(h),left:h.left-an.arrowHorizontalOffset,name:"arrow_nw"}),southWestArrowNorthMiddleWest:(h,e)=>({top:Jn(h),left:h.left-e.width*.25-an.arrowHorizontalOffset,name:"arrow_nmw"}),southWestArrowNorth:(h,e)=>({top:Jn(h),left:h.left-e.width/2,name:"arrow_n"}),southWestArrowNorthMiddleEast:(h,e)=>({top:Jn(h),left:h.left-e.width*.75+an.arrowHorizontalOffset,name:"arrow_nme"}),southWestArrowNorthEast:(h,e)=>({top:Jn(h),left:h.left-e.width+an.arrowHorizontalOffset,name:"arrow_ne"}),southArrowNorthWest:(h,e)=>({top:Jn(h),left:h.left+h.width/2-an.arrowHorizontalOffset,name:"arrow_nw"}),southArrowNorthMiddleWest:(h,e)=>({top:Jn(h),left:h.left+h.width/2-e.width*.25-an.arrowHorizontalOffset,name:"arrow_nmw"}),southArrowNorth:(h,e)=>({top:Jn(h),left:h.left+h.width/2-e.width/2,name:"arrow_n"}),southArrowNorthMiddleEast:(h,e)=>({top:Jn(h),left:h.left+h.width/2-e.width*.75+an.arrowHorizontalOffset,name:"arrow_nme"}),southArrowNorthEast:(h,e)=>({top:Jn(h),left:h.left+h.width/2-e.width+an.arrowHorizontalOffset,name:"arrow_ne"}),southEastArrowNorthWest:(h,e)=>({top:Jn(h),left:h.right-an.arrowHorizontalOffset,name:"arrow_nw"}),southEastArrowNorthMiddleWest:(h,e)=>({top:Jn(h),left:h.right-e.width*.25-an.arrowHorizontalOffset,name:"arrow_nmw"}),southEastArrowNorth:(h,e)=>({top:Jn(h),left:h.right-e.width/2,name:"arrow_n"}),southEastArrowNorthMiddleEast:(h,e)=>({top:Jn(h),left:h.right-e.width*.75+an.arrowHorizontalOffset,name:"arrow_nme"}),southEastArrowNorthEast:(h,e)=>({top:Jn(h),left:h.right-e.width+an.arrowHorizontalOffset,name:"arrow_ne"})};function Qn(h,e){return h.top-e.height-an.arrowVerticalOffset}function Jn(h){return h.bottom+an.arrowVerticalOffset}var TO='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',AO='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>';a(59),a(61);const Uo=xu("px");class Wo extends Ut{static get pluginName(){return"ContextualBalloon"}constructor(e){super(e),this.positionLimiter=()=>{const o=this.editor.editing.view,_=o.document.selection.editableElement;return _?o.domConverter.mapViewToDom(_.root):null},this.set("visibleView",null),this.view=new an(e.locale),e.ui.view.body.add(this.view),e.ui.focusTracker.add(this.view.element),this._viewToStack=new Map,this._idToStack=new Map,this.set("_numberOfStacks",0),this.set("_singleViewMode",!1),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this.hasView(e.view))throw new yt.b("contextualballoon-add-view-exist: Cannot add configuration of the same view twice.",[this,e]);const o=e.stackId||"main";if(!this._idToStack.has(o)){this._idToStack.set(o,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(o)),this._numberOfStacks=this._idToStack.size,(!this._visibleStack||e.singleViewMode)&&this.showStack(o);return}const c=this._idToStack.get(o);e.singleViewMode&&this.showStack(o),c.set(e.view,e),this._viewToStack.set(e.view,c),c===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new yt.b("contextualballoon-remove-view-not-exist: Cannot remove the configuration of a non-existent view.",[this,e]);const o=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(o.size===1?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(o.values())[o.size-2])),o.size===1?(this._idToStack.delete(this._getStackId(o)),this._numberOfStacks=this._idToStack.size):o.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(e){this.visibleStack=e;const o=this._idToStack.get(e);if(!o)throw new yt.b("contextualballoon-showstack-stack-not-exist: Cannot show a stack that does not exist.",this);this._visibleStack!==o&&this._showView(Array.from(o.values()).pop())}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){return Array.from(this._idToStack.entries()).find(c=>c[1]===e)[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let o=e.indexOf(this._visibleStack)+1;e[o]||(o=0),this.showStack(this._getStackId(e[o]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let o=e.indexOf(this._visibleStack)-1;e[o]||(o=e.length-1),this.showStack(this._getStackId(e[o]))}_createRotatorView(){const e=new SO(this.editor.locale),o=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(c,_)=>!_&&c>1),e.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(c,_)=>{if(_<2)return"";const j=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return o("bg",[j,_])}),e.buttonNextView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),e.buttonPrevView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),e}_createFakePanelsView(){const e=new IO(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(o,c)=>!c&&o>=2?Math.min(o-1,2):0),e.listenTo(this.view,"change:top",()=>e.updatePosition()),e.listenTo(this.view,"change:left",()=>e.updatePosition()),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:o="",withArrow:c=!0,singleViewMode:_=!1}){this.view.class=o,this.view.withArrow=c,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),_&&(this._singleViewMode=!0)}_getBalloonPosition(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&!e.limiter&&(e=Object.assign({},e,{limiter:this.positionLimiter})),e}}class SO extends sn{constructor(e){super(e);const o=e.t,c=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new _r,this.buttonPrevView=this._createButtonView(o("bh"),TO),this.buttonNextView=this._createButtonView(o("bi"),AO),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",c.to("isNavigationVisible",_=>_?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:c.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,o){const c=new Sn(this.locale);return c.set({label:e,icon:o,tooltip:!0}),c}}class IO extends sn{constructor(e,o){super(e);const c=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=o,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",c.to("numberOfPanels",_=>_?"":"ck-hidden")],style:{top:c.to("top",Uo),left:c.to("left",Uo),width:c.to("width",Uo),height:c.to("height",Uo)}},children:this.content}),this.on("change:numberOfPanels",(_,j,_e,et)=>{_e>et?this._addPanels(_e-et):this._removePanels(et-_e),this.updatePosition()})}_addPanels(e){for(;e--;){const o=new sn;o.setTemplate({tag:"div"}),this.content.add(o),this.registerChild(o)}}_removePanels(e){for(;e--;){const o=this.content.last;this.content.remove(o),this.deregisterChild(o),o.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:o}=this._balloonPanelView,{width:c,height:_}=new Rn(this._balloonPanelView.element);Object.assign(this,{top:e,left:o,width:c,height:_})}}}var PO='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22L2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21l-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>';function RO(h){const e=h.plugins.get("ContextualBalloon");if(Mu(h.editing.view.document.selection)){const o=ov(h);e.updatePosition(o)}}function ov(h){const e=h.editing.view,o=an.defaultPositions;return{target:e.domConverter.viewToDom(e.document.selection.getSelectedElement()),positions:[o.northArrowSouth,o.northArrowSouthWest,o.northArrowSouthEast,o.southArrowNorth,o.southArrowNorthWest,o.southArrowNorthEast]}}class NO extends Ut{static get requires(){return[Wo]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton(),this._createForm()}destroy(){super.destroy(),this._form.destroy()}_createButton(){const e=this.editor,o=e.t;e.ui.componentFactory.add("imageTextAlternative",c=>{const _=e.commands.get("imageTextAlternative"),j=new Sn(c);return j.set({label:o("az"),icon:PO,tooltip:!0}),j.bind("isEnabled").to(_,"isEnabled"),this.listenTo(j,"execute",()=>{this._showForm()}),j})}_createForm(){const e=this.editor,c=e.editing.view.document;this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new CO(e.locale),this._form.render(),this.listenTo(this._form,"submit",()=>{e.execute("imageTextAlternative",{newValue:this._form.labeledInput.inputView.element.value}),this._hideForm(!0)}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),this._form.keystrokes.set("Esc",(_,j)=>{this._hideForm(!0),j()}),this.listenTo(e.ui,"update",()=>{Mu(c.selection)?this._isVisible&&RO(e):this._hideForm(!0)}),Au({emitter:this._form,activator:()=>this._isVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;const e=this.editor,o=e.commands.get("imageTextAlternative"),c=this._form.labeledInput;this._isInBalloon||this._balloon.add({view:this._form,position:ov(e)}),c.value=c.inputView.element.value=o.value||"",this._form.labeledInput.select()}_hideForm(e){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return this._balloon.visibleView===this._form}get _isInBalloon(){return this._balloon.hasView(this._form)}}class OO extends Ut{static get requires(){return[EO,NO]}static get pluginName(){return"ImageTextAlternative"}}a(63);class MO extends Ut{static get requires(){return[Iw,$o,OO]}static get pluginName(){return"Image"}}function jO(h,e){return o=>{const c=o.createEditableElement("figcaption");return o.setCustomProperty("imageCaption",!0,c),Q_({view:h,element:c,text:e}),Ou(c,o)}}function Xu(h){for(const e of h.getChildren())if(e&&e.is("caption"))return e;return null}function LO(h){const e=h.parent;return h.name=="figcaption"&&e&&e.name=="figure"&&e.hasClass("image")?{name:!0}:null}class DO extends Ut{static get pluginName(){return"ImageCaptionEditing"}init(){const e=this.editor,o=e.editing.view,c=e.model.schema,_=e.data,j=e.editing,_e=e.t;c.register("caption",{allowIn:"image",allowContentOf:"$block",isLimit:!0}),e.model.document.registerPostFixer(st=>this._insertMissingModelCaptionElement(st)),e.conversion.for("upcast").elementToElement({view:LO,model:"caption"});const et=st=>st.createContainerElement("figcaption");_.downcastDispatcher.on("insert:caption",av(et,!1));const nt=jO(o,_e("al"));j.downcastDispatcher.on("insert:caption",av(nt)),j.downcastDispatcher.on("insert",this._fixCaptionVisibility(st=>st.item),{priority:"high"}),j.downcastDispatcher.on("remove",this._fixCaptionVisibility(st=>st.position.parent),{priority:"high"}),o.document.registerPostFixer(st=>this._updateCaptionVisibility(st))}_updateCaptionVisibility(e){const o=this.editor.editing.mapper,c=this._lastSelectedCaption;let _;const j=this.editor.model.document.selection,_e=j.getSelectedElement();if(_e&&_e.is("image")){const st=Xu(_e);_=o.toViewElement(st)}const et=j.getFirstPosition(),nt=lv(et.parent);if(nt&&(_=o.toViewElement(nt)),_)return c?(c===_||(cv(c,e),this._lastSelectedCaption=_),Zu(_,e)):(this._lastSelectedCaption=_,Zu(_,e));if(c){const st=cv(c,e);return this._lastSelectedCaption=null,st}else return!1}_fixCaptionVisibility(e){return(o,c,_)=>{const j=e(c),_e=lv(j),et=this.editor.editing.mapper,nt=_.writer;if(_e){const st=et.toViewElement(_e);st&&(_e.childCount?nt.removeClass("ck-hidden",st):nt.addClass("ck-hidden",st))}}}_insertMissingModelCaptionElement(e){const o=this.editor.model,c=o.document.differ.getChanges(),_=[];for(const j of c)if(j.type=="insert"&&j.name!="$text"){const _e=j.position.nodeAfter;if(_e.is("image")&&!Xu(_e)&&_.push(_e),!_e.is("image")&&_e.childCount)for(const et of o.createRangeIn(_e).getItems())et.is("image")&&!Xu(et)&&_.push(et)}for(const j of _)e.appendElement("caption",j);return!!_.length}}function av(h,e=!0){return(o,c,_)=>{const j=c.item;if(!(!j.childCount&&!e)&&Vo(j.parent)){if(!_.consumable.consume(c.item,"insert"))return;const _e=_.mapper.toViewElement(c.range.start.parent),et=h(_.writer),nt=_.writer;j.childCount||nt.addClass("ck-hidden",et),FO(et,c.item,_e,_)}}}function FO(h,e,o,c){const _=c.writer.createPositionAt(o,"end");c.writer.insert(_,h),c.mapper.bindElements(e,h)}function lv(h){const o=h.getAncestors({includeSelf:!0}).find(c=>c.name=="caption");return o&&o.parent&&o.parent.name=="image"?o:null}function cv(h,e){return!h.childCount&&!h.hasClass("ck-hidden")?(e.addClass("ck-hidden",h),!0):!1}function Zu(h,e){return h.hasClass("ck-hidden")?(e.removeClass("ck-hidden",h),!0):!1}a(65);class BO extends Ut{static get requires(){return[DO]}static get pluginName(){return"ImageCaption"}}class zO extends hn{constructor(e,o){super(e),this.defaultStyle=!1,this.styles=o.reduce((c,_)=>(c[_.name]=_,_.isDefault&&(this.defaultStyle=_.name),c),{})}refresh(){const e=this.editor.model.document.selection.getSelectedElement();if(this.isEnabled=Vo(e),!e)this.value=!1;else if(e.hasAttribute("imageStyle")){const o=e.getAttribute("imageStyle");this.value=this.styles[o]?o:!1}else this.value=this.defaultStyle}execute(e){const o=e.value,c=this.editor.model,_=c.document.selection.getSelectedElement();c.change(j=>{this.styles[o].isDefault?j.removeAttribute("imageStyle",_):j.setAttribute("imageStyle",o,_)})}}function VO(h){return(e,o,c)=>{if(!c.consumable.consume(o.item,e.name))return;const _=uv(o.attributeNewValue,h),j=uv(o.attributeOldValue,h),_e=c.mapper.toViewElement(o.item),et=c.writer;j&&et.removeClass(j.className,_e),_&&et.addClass(_.className,_e)}}function $O(h){const e=h.filter(o=>!o.isDefault);return(o,c,_)=>{if(!c.modelRange)return;const j=c.viewItem,_e=Or(c.modelRange.getItems());if(_.schema.checkAttribute(_e,"imageStyle"))for(const et of e)_.consumable.consume(j,{classes:et.className})&&_.writer.setAttribute("imageStyle",et.name,_e)}}function uv(h,e){for(const o of e)if(o.name===h)return o}var dv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm2.5 3V12h11V7.5h-11zM4.061 6H15.94c.586 0 1.061.407 1.061.91v5.68c0 .503-.475.91-1.061.91H4.06c-.585 0-1.06-.407-1.06-.91V6.91C3 6.406 3.475 6 4.061 6zM2 16.5V15h16v1.5z"/></svg>',hv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M18 4.5V3H2v1.5h16zm0 3V6h-5.674v1.5H18zm0 3V9h-5.674v1.5H18zm0 3V12h-5.674v1.5H18zm-8.5-6V12h-6V7.5h6zm.818-1.5H2.682C2.305 6 2 6.407 2 6.91v5.68c0 .503.305.91.682.91h7.636c.377 0 .682-.407.682-.91V6.91c0-.503-.305-.91-.682-.91zM18 16.5V15H2v1.5h16z"/></svg>',fv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm4.5 3V12h7V7.5h-7zM5.758 6h8.484c.419 0 .758.407.758.91v5.681c0 .502-.34.909-.758.909H5.758c-.419 0-.758-.407-.758-.91V6.91c0-.503.34-.91.758-.91zM2 16.5V15h16v1.5z"/></svg>',_d='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm0 3V6h5.674v1.5zm0 3V9h5.674v1.5zm0 3V12h5.674v1.5zm8.5-6V12h6V7.5h-6zM9.682 6h7.636c.377 0 .682.407.682.91v5.68c0 .503-.305.91-.682.91H9.682c-.377 0-.682-.407-.682-.91V6.91c0-.503.305-.91.682-.91zM2 16.5V15h16v1.5z"/></svg>';const Ho={full:{name:"full",title:"Full size image",icon:dv,isDefault:!0},side:{name:"side",title:"Side image",icon:_d,className:"image-style-side"},alignLeft:{name:"alignLeft",title:"Left aligned image",icon:hv,className:"image-style-align-left"},alignCenter:{name:"alignCenter",title:"Centered image",icon:fv,className:"image-style-align-center"},alignRight:{name:"alignRight",title:"Right aligned image",icon:_d,className:"image-style-align-right"}},pv={full:dv,left:hv,right:_d,center:fv};function mv(h=[]){return h.map(UO)}function UO(h){if(typeof h=="string"){const e=h;Ho[e]?h=Object.assign({},Ho[e]):(console.warn(Object(yt.a)("image-style-not-found: There is no such image style of given name."),{name:e}),h={name:e})}else if(Ho[h.name]){const e=Ho[h.name],o=Object.assign({},h);for(const c in e)h.hasOwnProperty(c)||(o[c]=e[c]);h=o}return typeof h.icon=="string"&&pv[h.icon]&&(h.icon=pv[h.icon]),h}class WO extends Ut{static get pluginName(){return"ImageStyleEditing"}init(){const e=this.editor,o=e.model.schema,c=e.data,_=e.editing;e.config.define("image.styles",["full","side"]);const j=mv(e.config.get("image.styles"));o.extend("image",{allowAttributes:"imageStyle"});const _e=VO(j);_.downcastDispatcher.on("attribute:imageStyle:image",_e),c.downcastDispatcher.on("attribute:imageStyle:image",_e),c.upcastDispatcher.on("element:figure",$O(j),{priority:"low"}),e.commands.add("imageStyle",new zO(e,j))}}a(67);class HO extends Ut{static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const e=this.editor.t;return{"Full size image":e("am"),"Side image":e("an"),"Left aligned image":e("ao"),"Centered image":e("ap"),"Right aligned image":e("aq")}}init(){const o=this.editor.config.get("image.styles"),c=GO(mv(o),this.localizedDefaultStylesTitles);for(const _ of c)this._createButton(_)}_createButton(e){const o=this.editor,c=`imageStyle:${e.name}`;o.ui.componentFactory.add(c,_=>{const j=o.commands.get("imageStyle"),_e=new Sn(_);return _e.set({label:e.title,icon:e.icon,tooltip:!0,isToggleable:!0}),_e.bind("isEnabled").to(j,"isEnabled"),_e.bind("isOn").to(j,"value",et=>et===e.name),this.listenTo(_e,"execute",()=>{o.execute("imageStyle",{value:e.name}),o.editing.view.focus()}),_e})}}function GO(h,e){for(const o of h)e[o.title]&&(o.title=e[o.title]);return h}class qO extends Ut{static get requires(){return[WO,HO]}static get pluginName(){return"ImageStyle"}}class Go extends Ut{static get requires(){return[Wo]}static get pluginName(){return"WidgetToolbarRepository"}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const o=e.plugins.get("BalloonToolbar");this.listenTo(o,"show",c=>{KO(e.editing.view.document.selection)&&c.stop()},{priority:"high"})}this._toolbarDefinitions=new Map,this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:o,items:c,getRelatedElement:_,balloonClassName:j="ck-toolbar-container"}){const _e=this.editor,et=_e.t,nt=new Su(_e.locale);if(nt.ariaLabel=o||et("au"),this._toolbarDefinitions.has(e))throw new yt.b("widget-toolbar-duplicated: Toolbar with the given id was already added.",this,{toolbarId:e});nt.fillFromConfig(c,_e.ui.componentFactory),this._toolbarDefinitions.set(e,{view:nt,getRelatedElement:_,balloonClassName:j})}_updateToolbarsVisibility(){let e=0,o=null,c=null;for(const _ of this._toolbarDefinitions.values()){const j=_.getRelatedElement(this.editor.editing.view.document.selection);if(!this.isEnabled||!j)this._isToolbarInBalloon(_)&&this._hideToolbar(_);else if(!this.editor.ui.focusTracker.isFocused)this._isToolbarVisible(_)&&this._hideToolbar(_);else{const _e=j.getAncestors().length;_e>e&&(e=_e,o=j,c=_)}}c&&this._showToolbar(c,o)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,o){this._isToolbarVisible(e)?gv(this.editor,o):this._isToolbarInBalloon(e)||(this._balloon.add({view:e.view,position:_v(this.editor,o),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",()=>{for(const c of this._toolbarDefinitions.values())if(this._isToolbarVisible(c)){const _=c.getRelatedElement(this.editor.editing.view.document.selection);gv(this.editor,_)}}))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function gv(h,e){const o=h.plugins.get("ContextualBalloon"),c=_v(h,e);o.updatePosition(c)}function _v(h,e){const o=h.editing.view,c=an.defaultPositions;return{target:o.domConverter.mapViewToDom(e),positions:[c.northArrowSouth,c.northArrowSouthWest,c.northArrowSouthEast,c.southArrowNorth,c.southArrowNorthWest,c.southArrowNorthEast]}}function KO(h){const e=h.getSelectedElement();return!!(e&&Hr(e))}class YO extends Ut{static get requires(){return[Go]}static get pluginName(){return"ImageToolbar"}afterInit(){const e=this.editor,o=e.t;e.plugins.get(Go).register("image",{ariaLabel:o("b"),items:e.config.get("image.toolbar")||[],getRelatedElement:Mu})}}class QO extends sn{constructor(e){super(e),this.buttonView=new Sn(e),this._fileInputView=new JO(e),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.setTemplate({tag:"span",attributes:{class:"ck-file-dialog-button"},children:[this.buttonView,this._fileInputView]}),this.buttonView.on("execute",()=>{this._fileInputView.open()})}focus(){this.buttonView.focus()}}class JO extends sn{constructor(e){super(e),this.set("acceptedType"),this.set("allowMultipleFiles",!1);const o=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:o.to("acceptedType"),multiple:o.to("allowMultipleFiles")},on:{change:o.to(()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}}var XO='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91 10.54c.26-.23.64-.21.88.03l3.36 3.14 2.23-2.06a.64.64 0 0 1 .87 0l2.52 2.97V4.5H3.2v10.12l3.71-4.08zm10.27-7.51c.6 0 1.09.47 1.09 1.05v11.84c0 .59-.49 1.06-1.09 1.06H2.79c-.6 0-1.09-.47-1.09-1.06V4.08c0-.58.49-1.05 1.1-1.05h14.38zm-5.22 5.56a1.96 1.96 0 1 1 3.4-1.96 1.96 1.96 0 0 1-3.4 1.96z"/></svg>';function wv(h){const e=h.map(o=>o.replace("+","\\+"));return new RegExp(`^image\\/(${e.join("|")})$`)}function ZO(h){return new Promise((e,o)=>{const c=h.getAttribute("src");fetch(c).then(_=>_.blob()).then(_=>{const j=tM(_,c),et=`image.${j.replace("image/","")}`,nt=nM(_,et,j);nt?e(nt):o()}).catch(o)})}function eM(h){return!h.is("element","img")||!h.getAttribute("src")?!1:h.getAttribute("src").match(/^data:image\/\w+;base64,/g)||h.getAttribute("src").match(/^blob:/g)}function tM(h,e){return h.type?h.type:e.match(/data:(image\/\w+);base64/)?e.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}function nM(h,e,o){try{return new File([h],e,{type:o})}catch{return null}}class iM extends Ut{init(){const e=this.editor,o=e.t;e.ui.componentFactory.add("imageUpload",c=>{const _=new QO(c),j=e.commands.get("imageUpload"),_e=e.config.get("image.upload.types"),et=wv(_e);return _.set({acceptedType:_e.map(nt=>`image/${nt}`).join(","),allowMultipleFiles:!0}),_.buttonView.set({label:o("ar"),icon:XO,tooltip:!0}),_.buttonView.bind("isEnabled").to(j),_.on("done",(nt,st)=>{const at=Array.from(st).filter(ct=>et.test(ct.type));at.length&&e.execute("imageUpload",{file:at})}),_})}}var rM='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 250"><rect rx="4"/></svg>';a(69),a(71),a(73);class sM extends Ut{constructor(e){super(e),this.placeholder="data:image/svg+xml;utf8,"+encodeURIComponent(rM)}init(){this.editor.editing.downcastDispatcher.on("attribute:uploadStatus:image",(...o)=>this.uploadStatusChange(...o))}uploadStatusChange(e,o,c){const _=this.editor,j=o.item,_e=j.getAttribute("uploadId");if(!c.consumable.consume(o.item,e.name))return;const et=_.plugins.get(Gr),nt=_e?o.attributeNewValue:null,st=this.placeholder,at=_.editing.mapper.toViewElement(j),ct=c.writer;if(nt=="reading"){vv(at,ct),bv(st,at,ct);return}if(nt=="uploading"){const dt=et.loaders.get(_e);vv(at,ct),dt?(yv(at,ct),aM(at,ct,dt,_.editing.view),hM(at,ct,dt)):bv(st,at,ct);return}nt=="complete"&&et.loaders.get(_e)&&!ar.isEdge&&cM(at,ct,_.editing.view),lM(at,ct),yv(at,ct),oM(at,ct)}}function vv(h,e){h.hasClass("ck-appear")||e.addClass("ck-appear",h)}function oM(h,e){e.removeClass("ck-appear",h)}function bv(h,e,o){e.hasClass("ck-image-upload-placeholder")||o.addClass("ck-image-upload-placeholder",e);const c=is(e);c.getAttribute("src")!==h&&o.setAttribute("src",h,c),kv(e,"placeholder")||o.insert(o.createPositionAfter(c),dM(o))}function yv(h,e){h.hasClass("ck-image-upload-placeholder")&&e.removeClass("ck-image-upload-placeholder",h),xv(h,e,"placeholder")}function aM(h,e,o,c){const _=uM(e);e.insert(e.createPositionAt(h,"end"),_),o.on("change:uploadedPercent",(j,_e,et)=>{c.change(nt=>{nt.setStyle("width",et+"%",_)})})}function lM(h,e){xv(h,e,"progressBar")}function cM(h,e,o){const c=e.createUIElement("div",{class:"ck-image-upload-complete-icon"});e.insert(e.createPositionAt(h,"end"),c),setTimeout(()=>{o.change(_=>_.remove(_.createRangeOn(c)))},3e3)}function uM(h){const e=h.createUIElement("div",{class:"ck-progress-bar"});return h.setCustomProperty("progressBar",!0,e),e}function dM(h){const e=h.createUIElement("div",{class:"ck-upload-placeholder-loader"});return h.setCustomProperty("placeholder",!0,e),e}function kv(h,e){for(const o of h.getChildren())if(o.getCustomProperty(e))return o}function xv(h,e,o){const c=kv(h,o);c&&e.remove(e.createRangeOn(c))}function hM(h,e,o){if(o.data){const c=is(h);e.setAttribute("src",o.data,c)}}class fM{constructor(e){this.files=pM(e),this._native=e}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,o){this._native.setData(e,o)}}function pM(h){const e=h.files?Array.from(h.files):[],o=h.items?Array.from(h.items):[];return e.length?e:o.filter(c=>c.kind==="file").map(c=>c.getAsFile())}class mM extends Vr{constructor(e){super(e);const o=this.document;this.domEventType=["paste","copy","cut","drop","dragover"],this.listenTo(o,"paste",c,{priority:"low"}),this.listenTo(o,"drop",c,{priority:"low"});function c(_,j){j.preventDefault();const _e=j.dropRange?[j.dropRange]:Array.from(o.selection.getRanges()),et=new co(o,"clipboardInput");o.fire(et,{dataTransfer:j.dataTransfer,targetRanges:_e}),et.stop.called&&j.stopPropagation()}}onDomEvent(e){const o={dataTransfer:new fM(e.clipboardData?e.clipboardData:e.dataTransfer)};e.type=="drop"&&(o.dropRange=gM(this.view,e)),this.fire(e.type,e,o)}}function gM(h,e){const o=e.target.ownerDocument,c=e.clientX,_=e.clientY;let j;return o.caretRangeFromPoint&&o.caretRangeFromPoint(c,_)?j=o.caretRangeFromPoint(c,_):e.rangeParent&&(j=o.createRange(),j.setStart(e.rangeParent,e.rangeOffset),j.collapse(!0)),j?h.domConverter.domRangeToView(j):h.document.selection.getFirstRange()}function _M(h){return h=h.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"</p><p>").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),h.indexOf("</p><p>")>-1&&(h=`<p>${h}</p>`),h}function wM(h){return h.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(e,o)=>o.length==1?" ":o)}const Ev=["figcaption","li"];function Cv(h){let e="";if(h.is("text")||h.is("textProxy"))e=h.data;else if(h.is("img")&&h.hasAttribute("alt"))e=h.getAttribute("alt");else{let o=null;for(const c of h.getChildren()){const _=Cv(c);o&&(o.is("containerElement")||c.is("containerElement"))&&(Ev.includes(o.name)||Ev.includes(c.name)?e+=`
`:e+=`

`),e+=_,o=c}}return e}class Es extends Ut{static get pluginName(){return"Clipboard"}init(){const e=this.editor,o=e.model.document,c=e.editing.view,_=c.document;this._htmlDataProcessor=new No(_),c.addObserver(mM),this.listenTo(_,"clipboardInput",_e=>{e.isReadOnly&&_e.stop()},{priority:"highest"}),this.listenTo(_,"clipboardInput",(_e,et)=>{const nt=et.dataTransfer;let st="";nt.getData("text/html")?st=wM(nt.getData("text/html")):nt.getData("text/plain")&&(st=_M(nt.getData("text/plain"))),st=this._htmlDataProcessor.toView(st),this.fire("inputTransformation",{content:st,dataTransfer:nt}),c.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(_e,et)=>{if(!et.content.isEmpty){const nt=this.editor.data,st=this.editor.model,at=nt.toModel(et.content,"$clipboardHolder");if(at.childCount==0)return;st.insertContent(at)}},{priority:"low"});function j(_e,et){const nt=et.dataTransfer;et.preventDefault();const st=e.data.toView(e.model.getSelectedContent(o.selection));_.fire("clipboardOutput",{dataTransfer:nt,content:st,method:_e.name})}this.listenTo(_,"copy",j,{priority:"low"}),this.listenTo(_,"cut",(_e,et)=>{e.isReadOnly?et.preventDefault():j(_e,et)},{priority:"low"}),this.listenTo(_,"clipboardOutput",(_e,et)=>{et.content.isEmpty||(et.dataTransfer.setData("text/html",this._htmlDataProcessor.toData(et.content)),et.dataTransfer.setData("text/plain",Cv(et.content))),et.method=="cut"&&e.model.deleteContent(o.selection)},{priority:"low"})}}class Xs{constructor(e){this.document=e}createDocumentFragment(e){return new ms(this.document,e)}createElement(e,o,c){return new fr(this.document,e,o,c)}createText(e){return new wn(this.document,e)}clone(e,o=!1){return e._clone(o)}appendChild(e,o){return o._appendChild(e)}insertChild(e,o,c){return c._insertChild(e,o)}removeChildren(e,o,c){return c._removeChildren(e,o)}remove(e){const o=e.parent;return o?this.removeChildren(o.getChildIndex(e),1,o):[]}replace(e,o){const c=e.parent;if(c){const _=c.getChildIndex(e);return this.removeChildren(_,1,c),this.insertChild(_,o,c),!0}return!1}unwrapElement(e){const o=e.parent;if(o){const c=o.getChildIndex(e);this.remove(e),this.insertChild(c,e.getChildren(),o)}}rename(e,o){const c=new fr(this.document,e,o.getAttributes(),o.getChildren());return this.replace(o,c)?c:null}setAttribute(e,o,c){c._setAttribute(e,o)}removeAttribute(e,o){o._removeAttribute(e)}addClass(e,o){o._addClass(e)}removeClass(e,o){o._removeClass(e)}setStyle(e,o,c){St(e)&&c===void 0&&(c=o),c._setStyle(e,o)}removeStyle(e,o){o._removeStyle(e)}setCustomProperty(e,o,c){c._setCustomProperty(e,o)}removeCustomProperty(e,o){return o._removeCustomProperty(e)}createPositionAt(e,o){return Ft._createAt(e,o)}createPositionAfter(e){return Ft._createAfter(e)}createPositionBefore(e){return Ft._createBefore(e)}createRange(e,o){return new Jt(e,o)}createRangeOn(e){return Jt._createOn(e)}createRangeIn(e){return Jt._createIn(e)}createSelection(e,o,c){return new pr(e,o,c)}}class vM extends hn{refresh(){this.isEnabled=Aw(this.editor.model)}execute(e){const o=this.editor,c=o.model,_=o.plugins.get(Gr);c.change(j=>{const _e=Array.isArray(e.file)?e.file:[e.file];for(const et of _e)bM(j,c,_,et)})}}function bM(h,e,o,c){const _=o.createLoader(c);_&&Tw(h,e,{uploadId:_.id})}class yM extends Ut{static get requires(){return[Gr,$u,Es]}static get pluginName(){return"ImageUploadEditing"}constructor(e){super(e),e.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}})}init(){const e=this.editor,o=e.model.document,c=e.model.schema,_=e.conversion,j=e.plugins.get(Gr),_e=wv(e.config.get("image.upload.types"));c.extend("image",{allowAttributes:["uploadId","uploadStatus"]}),e.commands.add("imageUpload",new vM(e)),_.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(e.editing.view.document,"clipboardInput",(et,nt)=>{if(kM(nt.dataTransfer))return;const st=Array.from(nt.dataTransfer.files).filter(ct=>ct?_e.test(ct.type):!1),at=nt.targetRanges.map(ct=>e.editing.mapper.toModelRange(ct));e.model.change(ct=>{ct.setSelection(at),st.length&&(et.stop(),e.model.enqueueChange("default",()=>{e.execute("imageUpload",{file:st})}))})}),this.listenTo(e.plugins.get(Es),"inputTransformation",(et,nt)=>{const st=Array.from(e.editing.view.createRangeIn(nt.content)).filter(ct=>eM(ct.item)&&!ct.item.getAttribute("uploadProcessed")).map(ct=>({promise:ZO(ct.item),imageElement:ct.item}));if(!st.length)return;const at=new Xs(e.editing.view.document);for(const ct of st){at.setAttribute("uploadProcessed",!0,ct.imageElement);const dt=j.createLoader(ct.promise);dt&&(at.setAttribute("src","",ct.imageElement),at.setAttribute("uploadId",dt.id,ct.imageElement))}}),e.editing.view.document.on("dragover",(et,nt)=>{nt.preventDefault()}),o.on("change",()=>{const et=o.differ.getChanges({includeChangesInGraveyard:!0});for(const nt of et)if(nt.type=="insert"&&nt.name!="$text"){const st=nt.position.nodeAfter,at=nt.position.root.rootName=="$graveyard";for(const ct of xM(e,st)){const dt=ct.getAttribute("uploadId");if(!dt)continue;const gt=j.loaders.get(dt);gt&&(at?gt.abort():gt.status=="idle"&&this._readAndUpload(gt,ct))}}})}_readAndUpload(e,o){const c=this.editor,_=c.model,j=c.locale.t,_e=c.plugins.get(Gr),et=c.plugins.get($u);return _.enqueueChange("transparent",st=>{st.setAttribute("uploadStatus","reading",o)}),e.read().then(()=>{const st=e.upload();if(ar.isSafari){const at=c.editing.mapper.toViewElement(o),ct=is(at);c.editing.view.once("render",()=>{if(!ct.parent)return;const dt=c.editing.view.domConverter.mapViewToDom(ct.parent);if(!dt)return;const gt=dt.style.display;dt.style.display="none",dt._ckHack=dt.offsetHeight,dt.style.display=gt})}return _.enqueueChange("transparent",at=>{at.setAttribute("uploadStatus","uploading",o)}),st}).then(st=>{_.enqueueChange("transparent",at=>{at.setAttributes({uploadStatus:"complete",src:st.default},o),this._parseAndSetSrcsetAttributeOnImage(st,o,at)}),nt()}).catch(st=>{if(e.status!=="error"&&e.status!=="aborted")throw st;e.status=="error"&&st&&et.showWarning(st,{title:j("as"),namespace:"upload"}),nt(),_.enqueueChange("transparent",at=>{at.remove(o)})});function nt(){_.enqueueChange("transparent",st=>{st.removeAttribute("uploadId",o),st.removeAttribute("uploadStatus",o)}),_e.destroyLoader(e)}}_parseAndSetSrcsetAttributeOnImage(e,o,c){let _=0;const j=Object.keys(e).filter(_e=>{const et=parseInt(_e,10);if(!isNaN(et))return _=Math.max(_,et),!0}).map(_e=>`${e[_e]} ${_e}w`).join(", ");j!=""&&c.setAttribute("srcset",{data:j,width:_},o)}}function kM(h){return Array.from(h.types).includes("text/html")&&h.getData("text/html")!==""}function xM(h,e){return Array.from(h.model.createRangeOn(e)).filter(o=>o.item.is("image")).map(o=>o.item)}class EM extends Ut{static get pluginName(){return"ImageUpload"}static get requires(){return[yM,iM,sM]}}class Tv extends hn{constructor(e){super(e),this._childCommands=[]}refresh(){}execute(...e){this._getFirstEnabledCommand().execute(e)}registerChildCommand(e){this._childCommands.push(e),e.on("change:isEnabled",()=>this._checkEnabled()),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){return this._childCommands.find(e=>e.isEnabled)}}class CM extends Ut{static get pluginName(){return"IndentEditing"}init(){const e=this.editor;e.commands.add("indent",new Tv(e)),e.commands.add("outdent",new Tv(e))}}var Av='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95L5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',Sv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>';class TM extends Ut{static get pluginName(){return"IndentUI"}init(){const e=this.editor,o=e.locale,c=e.t,_=o.uiLanguageDirection=="ltr"?Av:Sv,j=o.uiLanguageDirection=="ltr"?Sv:Av;this._defineButton("indent",c("h"),_),this._defineButton("outdent",c("i"),j)}_defineButton(e,o,c){const _=this.editor;_.ui.componentFactory.add(e,j=>{const _e=_.commands.get(e),et=new Sn(j);return et.set({label:o,icon:c,tooltip:!0}),et.bind("isOn","isEnabled").to(_e,"value","isEnabled"),this.listenTo(et,"execute",()=>{_.execute(e),_.editing.view.focus()}),et})}}class AM extends Ut{static get pluginName(){return"Indent"}static get requires(){return[CM,TM]}}const Cs="italic";class SM extends Ut{static get pluginName(){return"ItalicEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Cs}),e.model.schema.setAttributeProperties(Cs,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Cs,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(Cs,new xw(e,Cs)),e.keystrokes.set("CTRL+I",Cs)}}var IM='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.586 14.633l.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>';const _h="italic";class PM extends Ut{init(){const e=this.editor,o=e.t;e.ui.componentFactory.add(_h,c=>{const _=e.commands.get(_h),j=new Sn(c);return j.set({label:o("aj"),icon:IM,keystroke:"CTRL+I",tooltip:!0,isToggleable:!0}),j.bind("isOn","isEnabled").to(_,"value","isEnabled"),this.listenTo(j,"execute",()=>{e.execute(_h),e.editing.view.focus()}),j})}}class RM extends Ut{static get requires(){return[SM,PM]}static get pluginName(){return"Italic"}}class Iv extends Vr{constructor(e){super(e),this.domEventType="click"}onDomEvent(e){this.fire(e.type,e)}}a(75);class NM extends sn{constructor(e,o=[]){super(e);const c=e.t;this.focusTracker=new _r,this.keystrokes=new Wr,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(c("bd"),Yu,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(c("be"),Qu,"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(o),this.children=this._createFormChildren(o),this._focusables=new ns,this._focusCycler=new bs({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const _=["ck","ck-link-form"];o.length&&_.push("ck-link-form_layout-vertical"),this.setTemplate({tag:"form",attributes:{class:_,tabindex:"-1"},children:this.children})}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce((e,o)=>(e[o.name]=o.isOn,e),{})}render(){super.render(),Ku({view:this}),[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView].forEach(o=>{this._focusables.add(o),this.focusTracker.add(o.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createUrlInput(){const e=this.locale.t,o=new Gu(this.locale,qu);return o.label=e("bv"),o.inputView.placeholder="https://example.com",o}_createButton(e,o,c,_){const j=new Sn(this.locale);return j.set({label:e,icon:o,tooltip:!0}),j.extendTemplate({attributes:{class:c}}),_&&j.delegate("execute").to(this,_),j}_createManualDecoratorSwitches(e){const o=this.createCollection();for(const c of e){const _=new Tu(this.locale);_.set({name:c.id,label:c.label,withText:!0}),_.bind("isOn").to(c,"value"),_.on("execute",()=>{c.set("value",!_.isOn)}),o.add(_)}return o}_createFormChildren(e){const o=this.createCollection();if(o.add(this.urlInputView),e.length){const c=new sn;c.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map(_=>({tag:"li",children:[_],attributes:{class:["ck","ck-list__item"]}})),attributes:{class:["ck","ck-reset","ck-list"]}}),o.add(c)}return o.add(this.saveButtonView),o.add(this.cancelButtonView),o}}var OM='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.077 15l.991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562l-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>',MM='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7.3 17.37l-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506L13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5L9.375 17H19v1.5H8z"/></svg>';a(77);class jM extends sn{constructor(e){super(e);const o=e.t;this.focusTracker=new _r,this.keystrokes=new Wr,this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton(o("br"),OM,"unlink"),this.editButtonView=this._createButton(o("bs"),MM,"edit"),this.set("href"),this._focusables=new ns,this._focusCycler=new bs({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render(),[this.previewButtonView,this.editButtonView,this.unlinkButtonView].forEach(o=>{this._focusables.add(o),this.focusTracker.add(o.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createButton(e,o,c){const _=new Sn(this.locale);return _.set({label:e,icon:o,tooltip:!0}),_.delegate("execute").to(this,c),_}_createPreviewButton(){const e=new Sn(this.locale),o=this.bindTemplate,c=this.t;return e.set({withText:!0,tooltip:c("bt")}),e.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:o.to("href",_=>_&&zw(_)),target:"_blank",rel:"noopener noreferrer"}}),e.bind("label").to(this,"href",_=>_||c("bu")),e.bind("isEnabled").to(this,"href",_=>!!_),e.template.tag="a",e.template.eventListeners={},e}}var LM='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.077 15l.991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>';const _f="Ctrl+K";class DM extends Ut{static get requires(){return[Wo]}static get pluginName(){return"LinkUI"}init(){const e=this.editor;e.editing.view.addObserver(Iv),this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._balloon=e.plugins.get(Wo),this._createToolbarLinkButton(),this._enableUserBalloonInteractions()}destroy(){super.destroy(),this.formView.destroy()}_createActionsView(){const e=this.editor,o=new jM(e.locale),c=e.commands.get("link"),_=e.commands.get("unlink");return o.bind("href").to(c,"value"),o.editButtonView.bind("isEnabled").to(c),o.unlinkButtonView.bind("isEnabled").to(_),this.listenTo(o,"edit",()=>{this._addFormView()}),this.listenTo(o,"unlink",()=>{e.execute("unlink"),this._hideUI()}),o.keystrokes.set("Esc",(j,_e)=>{this._hideUI(),_e()}),o.keystrokes.set(_f,(j,_e)=>{this._addFormView(),_e()}),o}_createFormView(){const e=this.editor,o=e.commands.get("link"),c=new NM(e.locale,o.manualDecorators);return c.urlInputView.bind("value").to(o,"value"),c.urlInputView.bind("isReadOnly").to(o,"isEnabled",_=>!_),c.saveButtonView.bind("isEnabled").to(o),this.listenTo(c,"submit",()=>{e.execute("link",c.urlInputView.inputView.element.value,c.getDecoratorSwitchesState()),this._closeFormView()}),this.listenTo(c,"cancel",()=>{this._closeFormView()}),c.keystrokes.set("Esc",(_,j)=>{this._closeFormView(),j()}),c}_createToolbarLinkButton(){const e=this.editor,o=e.commands.get("link"),c=e.t;e.keystrokes.set(_f,(_,j)=>{j(),this._showUI(!0)}),e.ui.componentFactory.add("link",_=>{const j=new Sn(_);return j.isEnabled=!0,j.label=c("j"),j.icon=LM,j.keystroke=_f,j.tooltip=!0,j.isToggleable=!0,j.bind("isEnabled").to(o,"isEnabled"),j.bind("isOn").to(o,"value",_e=>!!_e),this.listenTo(j,"execute",()=>this._showUI(!0)),j})}_enableUserBalloonInteractions(){const e=this.editor.editing.view.document;this.listenTo(e,"click",()=>{this._getSelectedLinkElement()&&this._showUI()}),this.editor.keystrokes.set("Tab",(o,c)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),c())},{priority:"high"}),this.editor.keystrokes.set("Esc",(o,c)=>{this._isUIVisible&&(this._hideUI(),c())}),Au({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this._areActionsInPanel||this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this._isFormInPanel)return;const o=this.editor.commands.get("link");this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this._balloon.visibleView===this.formView&&this.formView.urlInputView.select(),this.formView.urlInputView.inputView.element.value=o.value||""}_closeFormView(){const e=this.editor.commands.get("link");e.restoreManualDecoratorStates(),e.value!==void 0?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this._balloon.remove(this.formView),this.editor.editing.view.focus())}_showUI(e=!1){this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),e&&this._balloon.showStack("main")):(this._addActionsView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(){if(!this._isUIInPanel)return;const e=this.editor;this.stopListening(e.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView)}_startUpdatingUI(){const e=this.editor,o=e.editing.view.document;let c=this._getSelectedLinkElement(),_=_e();const j=()=>{const et=this._getSelectedLinkElement(),nt=_e();c&&!et||!c&&nt!==_?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),c=et,_=nt};function _e(){return o.selection.focus.getAncestors().reverse().find(et=>et.is("element"))}this.listenTo(e.ui,"update",j),this.listenTo(this._balloon,"change:visibleView",j)}get _isFormInPanel(){return this._balloon.hasView(this.formView)}get _areActionsInPanel(){return this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){return this._balloon.visibleView==this.formView||this._areActionsVisible}_getBalloonPositionData(){const e=this.editor.editing.view,o=e.document,c=this._getSelectedLinkElement();return{target:c?e.domConverter.mapViewToDom(c):e.domConverter.viewRangeToDom(o.selection.getFirstRange())}}_getSelectedLinkElement(){const e=this.editor.editing.view,o=e.document.selection;if(o.isCollapsed)return ep(o.getFirstPosition());{const c=o.getFirstRange().getTrimmed(),_=ep(c.start),j=ep(c.end);return!_||_!=j?null:e.createRangeIn(_).getTrimmed().isEqual(c)?_:null}}}function ep(h){return h.getAncestors().find(e=>qN(e))}class FM extends Ut{static get requires(){return[Gw,DM]}static get pluginName(){return"Link"}}class Pv extends hn{constructor(e,o){super(e),this.type=o}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,o=e.document,c=Array.from(o.selection.getSelectedBlocks()).filter(j=>Nv(j,e.schema)),_=this.value===!0;e.change(j=>{if(_){let _e=c[c.length-1].nextSibling,et=Number.POSITIVE_INFINITY,nt=[];for(;_e&&_e.name=="listItem"&&_e.getAttribute("listIndent")!==0;){const st=_e.getAttribute("listIndent");st<et&&(et=st);const at=st-et;nt.push({element:_e,listIndent:at}),_e=_e.nextSibling}nt=nt.reverse();for(const st of nt)j.setAttribute("listIndent",st.listIndent,st.element)}if(!_){let _e=Number.POSITIVE_INFINITY;for(const et of c)et.is("listItem")&&et.getAttribute("listIndent")<_e&&(_e=et.getAttribute("listIndent"));_e=_e===0?1:_e,Rv(c,!0,_e),Rv(c,!1,_e)}for(const _e of c.reverse())_&&_e.name=="listItem"?j.rename(_e,"paragraph"):!_&&_e.name!="listItem"?(j.setAttributes({listType:this.type,listIndent:0},_e),j.rename(_e,"listItem")):!_&&_e.name=="listItem"&&_e.getAttribute("listType")!=this.type&&j.setAttribute("listType",this.type,_e)})}_getValue(){const e=Or(this.editor.model.document.selection.getSelectedBlocks());return!!e&&e.is("listItem")&&e.getAttribute("listType")==this.type}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,o=this.editor.model.schema,c=Or(e.getSelectedBlocks());return c?Nv(c,o):!1}}function Rv(h,e,o){const c=e?h[0]:h[h.length-1];if(c.is("listItem")){let _=c[e?"previousSibling":"nextSibling"],j=c.getAttribute("listIndent");for(;_&&_.is("listItem")&&_.getAttribute("listIndent")>=o;)j>_.getAttribute("listIndent")&&(j=_.getAttribute("listIndent")),_.getAttribute("listIndent")==j&&h[e?"unshift":"push"](_),_=_[e?"previousSibling":"nextSibling"]}}function Nv(h,e){return e.checkChild(h.parent,"listItem")&&!e.isObject(h)}class Ov extends hn{constructor(e,o){super(e),this._indentBy=o=="forward"?1:-1}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,o=e.document;let c=Array.from(o.selection.getSelectedBlocks());e.change(_=>{const j=c[c.length-1];let _e=j.nextSibling;for(;_e&&_e.name=="listItem"&&_e.getAttribute("listIndent")>j.getAttribute("listIndent");)c.push(_e),_e=_e.nextSibling;this._indentBy<0&&(c=c.reverse());for(const et of c){const nt=et.getAttribute("listIndent")+this._indentBy;nt<0?_.rename(et,"paragraph"):_.setAttribute("listIndent",nt,et)}})}_checkEnabled(){const e=Or(this.editor.model.document.selection.getSelectedBlocks());if(!e||!e.is("listItem"))return!1;if(this._indentBy>0){const o=e.getAttribute("listIndent"),c=e.getAttribute("listType");let _=e.previousSibling;for(;_&&_.is("listItem")&&_.getAttribute("listIndent")>=o;){if(_.getAttribute("listIndent")==o)return _.getAttribute("listType")==c;_=_.previousSibling}return!1}return!0}}function BM(h){const e=h.createContainerElement("li");return e.getFillerOffset=VM,e}function zM(h,e){const o=e.mapper,c=e.writer,_=h.getAttribute("listType")=="numbered"?"ol":"ul",j=BM(c),_e=c.createContainerElement(_,null);return c.insert(c.createPositionAt(_e,0),j),o.bindElements(h,j),j}function Mv(h,e,o,c){const _=e.parent,j=o.mapper,_e=o.writer;let et=j.toViewPosition(c.createPositionBefore(h));const nt=Lv(h.previousSibling,{sameIndent:!0,smallerIndent:!0,listIndent:h.getAttribute("listIndent")}),st=h.previousSibling;if(nt&&nt.getAttribute("listIndent")==h.getAttribute("listIndent")){const at=j.toViewElement(nt);et=_e.breakContainer(_e.createPositionAfter(at))}else st&&st.name=="listItem"?et=j.toViewPosition(c.createPositionAt(st,"end")):et=j.toViewPosition(c.createPositionBefore(h));if(et=jv(et),_e.insert(et,_),st&&st.name=="listItem"){const at=j.toViewElement(st),dt=_e.createRange(_e.createPositionAt(at,0),et).getWalker({ignoreElementEnd:!0});for(const gt of dt)if(gt.item.is("li")){const kt=_e.breakContainer(_e.createPositionBefore(gt.item)),Ct=gt.item.parent,Nt=_e.createPositionAt(e,"end");cr(_e,Nt.nodeBefore,Nt.nodeAfter),_e.move(_e.createRangeOn(Ct),Nt),dt.position=kt}}else{const at=_.nextSibling;if(at&&(at.is("ul")||at.is("ol"))){let ct=null;for(const dt of at.getChildren()){const gt=j.toModelElement(dt);if(gt&&gt.getAttribute("listIndent")>h.getAttribute("listIndent"))ct=dt;else break}ct&&(_e.breakContainer(_e.createPositionAfter(ct)),_e.move(_e.createRangeOn(ct.parent),_e.createPositionAt(e,"end")))}}cr(_e,_,_.nextSibling),cr(_e,_.previousSibling,_)}function cr(h,e,o){return!e||!o||e.name!="ul"&&e.name!="ol"||e.name!=o.name||e.getAttribute("class")!==o.getAttribute("class")?null:h.mergeContainers(h.createPositionAfter(e))}function jv(h){return h.getLastMatchingPosition(e=>e.item.is("uiElement"))}function Lv(h,e){const o=!!e.sameIndent,c=!!e.smallerIndent,_=e.listIndent;let j=h;for(;j&&j.name=="listItem";){const _e=j.getAttribute("listIndent");if(o&&_==_e||c&&_>_e)return j;j=j.previousSibling}return null}function Dv(h,e,o,c){h.ui.componentFactory.add(e,_=>{const j=h.commands.get(e),_e=new Sn(_);return _e.set({label:o,icon:c,tooltip:!0,isToggleable:!0}),_e.bind("isOn","isEnabled").to(j,"value","isEnabled"),_e.on("execute",()=>{h.execute(e),h.editing.view.focus()}),_e})}function VM(){const h=!this.isEmpty&&(this.getChild(0).name=="ul"||this.getChild(0).name=="ol");return this.isEmpty||h?0:hm.call(this)}function Fv(h){return(e,o,c)=>{const _=c.consumable;if(!_.test(o.item,"insert")||!_.test(o.item,"attribute:listType")||!_.test(o.item,"attribute:listIndent"))return;_.consume(o.item,"insert"),_.consume(o.item,"attribute:listType"),_.consume(o.item,"attribute:listIndent");const j=o.item,_e=zM(j,c);Mv(j,_e,c,h)}}function $M(h){return(e,o,c)=>{const j=c.mapper.toViewPosition(o.position).getLastMatchingPosition(dt=>!dt.item.is("li")).nodeAfter,_e=c.writer;_e.breakContainer(_e.createPositionBefore(j)),_e.breakContainer(_e.createPositionAfter(j));const et=j.parent,nt=et.previousSibling,st=_e.createRangeOn(et),at=_e.remove(st);nt&&nt.nextSibling&&cr(_e,nt,nt.nextSibling);const ct=c.mapper.toModelElement(j);$v(ct.getAttribute("listIndent")+1,o.position,st.start,j,c,h);for(const dt of _e.createRangeIn(at).getItems())c.mapper.unbindViewElement(dt);e.stop()}}function UM(h,e,o){if(!o.consumable.consume(e.item,"attribute:listType"))return;const c=o.mapper.toViewElement(e.item),_=o.writer;_.breakContainer(_.createPositionBefore(c)),_.breakContainer(_.createPositionAfter(c));const j=c.parent,_e=e.attributeNewValue=="numbered"?"ol":"ul";_.rename(_e,j)}function WM(h,e,o){const _=o.mapper.toViewElement(e.item).parent,j=o.writer;cr(j,_,_.nextSibling),cr(j,_.previousSibling,_);for(const _e of e.item.getChildren())o.consumable.consume(_e,"insert")}function HM(h){return(e,o,c)=>{if(!c.consumable.consume(o.item,"attribute:listIndent"))return;const _=c.mapper.toViewElement(o.item),j=c.writer;j.breakContainer(j.createPositionBefore(_)),j.breakContainer(j.createPositionAfter(_));const _e=_.parent,et=_e.previousSibling,nt=j.createRangeOn(_e);j.remove(nt),et&&et.nextSibling&&cr(j,et,et.nextSibling),$v(o.attributeOldValue+1,o.range.start,nt.start,_,c,h),Mv(o.item,_,c,h);for(const st of o.item.getChildren())c.consumable.consume(st,"insert")}}function Bv(h,e,o){if(e.item.name!="listItem"){let c=o.mapper.toViewPosition(e.range.start);const _=o.writer,j=[];for(;(c.parent.name=="ul"||c.parent.name=="ol")&&(c=_.breakContainer(c),c.parent.name=="li");){const _e=c,et=_.createPositionAt(c.parent,"end");if(!_e.isEqual(et)){const nt=_.remove(_.createRange(_e,et));j.push(nt)}c=_.createPositionAfter(c.parent)}if(j.length>0){for(let _e=0;_e<j.length;_e++){const et=c.nodeBefore;if(c=_.insert(c,j[_e]).end,_e>0){const st=cr(_,et,et.nextSibling);st&&st.parent==et&&c.offset--}}cr(_,c.nodeBefore,c.nodeAfter)}}}function GM(h,e,o){const c=o.mapper.toViewPosition(e.position),_=c.nodeBefore,j=c.nodeAfter;cr(o.writer,_,j)}function qM(h,e,o){if(o.consumable.consume(e.viewItem,{name:!0})){const c=o.writer,_=c.createElement("listItem"),j=_j(e.viewItem);c.setAttribute("listIndent",j,_);const _e=e.viewItem.parent&&e.viewItem.parent.name=="ol"?"numbered":"bulleted";c.setAttribute("listType",_e,_);const et=o.splitToAllowedParent(_,e.modelCursor);if(!et)return;c.insert(_,et.position);const nt=XM(_,e.viewItem.getChildren(),o);e.modelRange=c.createRange(e.modelCursor,nt),et.cursorParent?e.modelCursor=c.createPositionAt(et.cursorParent,0):e.modelCursor=e.modelRange.end}}function zv(h,e,o){if(o.consumable.test(e.viewItem,{name:!0})){const c=Array.from(e.viewItem.getChildren());for(const _ of c)!(_.is("li")||rs(_))&&_._remove()}}function KM(h,e,o){if(o.consumable.test(e.viewItem,{name:!0})){if(e.viewItem.childCount===0)return;const c=[...e.viewItem.getChildren()];let _=!1,j=!0;for(const _e of c)_&&!rs(_e)&&_e._remove(),_e.is("text")?(j&&(_e._data=_e.data.replace(/^\s+/,"")),(!_e.nextSibling||rs(_e.nextSibling))&&(_e._data=_e.data.replace(/\s+$/,""))):rs(_e)&&(_=!0),j=!1}}function Vv(h){return(e,o)=>{if(o.isPhantom)return;const c=o.modelPosition.nodeBefore;if(c&&c.is("listItem")){const _=o.mapper.toViewElement(c),j=_.getAncestors().find(rs),_e=h.createPositionAt(_,0).getWalker();for(const et of _e)if(et.type=="elementStart"&&et.item.is("li")){o.viewPosition=et.previousPosition;break}else if(et.type=="elementEnd"&&et.item==j){o.viewPosition=et.nextPosition;break}}}}function YM(h){return(e,o)=>{const c=o.viewPosition,_=c.parent,j=o.mapper;if(_.name=="ul"||_.name=="ol"){if(c.isAtEnd){const _e=j.toModelElement(c.nodeBefore),et=j.getModelLength(c.nodeBefore);o.modelPosition=h.createPositionBefore(_e).getShiftedBy(et)}else{const _e=j.toModelElement(c.nodeAfter);o.modelPosition=h.createPositionBefore(_e)}e.stop()}else if(_.name=="li"&&c.nodeBefore&&(c.nodeBefore.name=="ul"||c.nodeBefore.name=="ol")){const _e=j.toModelElement(_);let et=1,nt=c.nodeBefore;for(;nt&&rs(nt);)et+=j.getModelLength(nt),nt=nt.previousSibling;o.modelPosition=h.createPositionBefore(_e).getShiftedBy(et),e.stop()}}}function QM(h,e){const o=h.document.differ.getChanges(),c=new Map;let _=!1;for(const nt of o)if(nt.type=="insert"&&nt.name=="listItem")j(nt.position);else if(nt.type=="insert"&&nt.name!="listItem"){if(nt.name!="$text"){const at=nt.position.nodeAfter;at.hasAttribute("listIndent")&&(e.removeAttribute("listIndent",at),_=!0),at.hasAttribute("listType")&&(e.removeAttribute("listType",at),_=!0);for(const ct of Array.from(h.createRangeIn(at)).filter(dt=>dt.item.is("listItem")))j(ct.previousPosition)}const st=nt.position.getShiftedBy(nt.length);j(st)}else nt.type=="remove"&&nt.name=="listItem"?j(nt.position):(nt.type=="attribute"&&nt.attributeKey=="listIndent"||nt.type=="attribute"&&nt.attributeKey=="listType")&&j(nt.range.start);for(const nt of c.values())_e(nt),et(nt);return _;function j(nt){const st=nt.nodeBefore;if(!st||!st.is("listItem")){const at=nt.nodeAfter;at&&at.is("listItem")&&c.set(at,at)}else{let at=st;if(c.has(at))return;for(;at.previousSibling&&at.previousSibling.is("listItem");)if(at=at.previousSibling,c.has(at))return;c.set(nt.nodeBefore,at)}}function _e(nt){let st=0,at=null;for(;nt&&nt.is("listItem");){const ct=nt.getAttribute("listIndent");if(ct>st){let dt;at===null?(at=ct-st,dt=st):(at>ct&&(at=ct),dt=ct-at),e.setAttribute("listIndent",dt,nt),_=!0}else at=null,st=nt.getAttribute("listIndent")+1;nt=nt.nextSibling}}function et(nt){let st=[],at=null;for(;nt&&nt.is("listItem");){const ct=nt.getAttribute("listIndent");if(at&&at.getAttribute("listIndent")>ct&&(st=st.slice(0,ct+1)),ct!=0)if(st[ct]){const dt=st[ct];nt.getAttribute("listType")!=dt&&(e.setAttribute("listType",dt,nt),_=!0)}else st[ct]=nt.getAttribute("listType");at=nt,nt=nt.nextSibling}}}function JM(h,[e,o]){let c=e.is("documentFragment")?e.getChild(0):e,_;if(o?_=this.createSelection(o):_=this.document.selection,c&&c.is("listItem")){const j=_.getFirstPosition();let _e=null;if(j.parent.is("listItem")?_e=j.parent:j.nodeBefore&&j.nodeBefore.is("listItem")&&(_e=j.nodeBefore),_e){const et=_e.getAttribute("listIndent");if(et>0)for(;c&&c.is("listItem");)c._setAttribute("listIndent",c.getAttribute("listIndent")+et),c=c.nextSibling}}}function XM(h,e,o){const{writer:c,schema:_}=o;let j=c.createPositionAfter(h);for(const _e of e)if(_e.name=="ul"||_e.name=="ol")j=o.convertItem(_e,j).modelCursor;else{const et=o.convertItem(_e,c.createPositionAt(h,"end")),nt=et.modelRange.start.nodeAfter;nt&&nt.is("element")&&!_.checkChild(h,nt.name)&&(et.modelCursor.parent.is("listItem")?h=et.modelCursor.parent:h=ZM(et.modelCursor),j=c.createPositionAfter(h))}return j}function ZM(h){const e=new Pr({startPosition:h});let o;do o=e.next();while(!o.value.item.is("listItem"));return o.value.item}function $v(h,e,o,c,_,j){const _e=Lv(e.nodeBefore,{sameIndent:!0,smallerIndent:!0,listIndent:h,foo:"b"}),et=_.mapper,nt=_.writer,st=_e?_e.getAttribute("listIndent"):null;let at;if(!_e)at=o;else if(st==h){const ct=et.toViewElement(_e).parent;at=nt.createPositionAfter(ct)}else{const ct=j.createPositionAt(_e,"end");at=et.toViewPosition(ct)}at=jv(at);for(const ct of[...c.getChildren()])rs(ct)&&(at=nt.move(nt.createRangeOn(ct),at).end,cr(nt,ct,ct.nextSibling),cr(nt,ct.previousSibling,ct))}function rs(h){return h.is("ol")||h.is("ul")}function _j(h){let e=0,o=h.parent;for(;o;){if(o.is("li"))e++;else{const c=o.previousSibling;c&&c.is("li")&&e++}o=o.parent}return e}class $j extends Ut{static get pluginName(){return"ListEditing"}static get requires(){return[xs]}init(){const e=this.editor;e.model.schema.register("listItem",{inheritAllFrom:"$block",allowAttributes:["listType","listIndent"]});const o=e.data,c=e.editing;e.model.document.registerPostFixer(_e=>QM(e.model,_e)),c.mapper.registerViewToModelLength("li",tp),o.mapper.registerViewToModelLength("li",tp),c.mapper.on("modelToViewPosition",Vv(c.view)),c.mapper.on("viewToModelPosition",YM(e.model)),o.mapper.on("modelToViewPosition",Vv(c.view)),e.conversion.for("editingDowncast").add(_e=>{_e.on("insert",Bv,{priority:"high"}),_e.on("insert:listItem",Fv(e.model)),_e.on("attribute:listType:listItem",UM,{priority:"high"}),_e.on("attribute:listType:listItem",WM,{priority:"low"}),_e.on("attribute:listIndent:listItem",HM(e.model)),_e.on("remove:listItem",$M(e.model)),_e.on("remove",GM,{priority:"low"})}),e.conversion.for("dataDowncast").add(_e=>{_e.on("insert",Bv,{priority:"high"}),_e.on("insert:listItem",Fv(e.model))}),e.conversion.for("upcast").add(_e=>{_e.on("element:ul",zv,{priority:"high"}),_e.on("element:ol",zv,{priority:"high"}),_e.on("element:li",KM,{priority:"high"}),_e.on("element:li",qM)}),e.model.on("insertContent",JM,{priority:"high"}),e.commands.add("numberedList",new Pv(e,"numbered")),e.commands.add("bulletedList",new Pv(e,"bulleted")),e.commands.add("indentList",new Ov(e,"forward")),e.commands.add("outdentList",new Ov(e,"backward"));const _=c.view.document;this.listenTo(_,"enter",(_e,et)=>{const nt=this.editor.model.document,st=nt.selection.getLastPosition().parent;nt.selection.isCollapsed&&st.name=="listItem"&&st.isEmpty&&(this.editor.execute("outdentList"),et.preventDefault(),_e.stop())}),this.listenTo(_,"delete",(_e,et)=>{if(et.direction!=="backward")return;const nt=this.editor.model.document.selection;if(!nt.isCollapsed)return;const st=nt.getFirstPosition();if(!st.isAtStart)return;const at=st.parent;at.name!=="listItem"||at.previousSibling&&at.previousSibling.name==="listItem"||(this.editor.execute("outdentList"),et.preventDefault(),_e.stop())},{priority:"high"});const j=_e=>(et,nt)=>{this.editor.commands.get(_e).isEnabled&&(this.editor.execute(_e),nt())};e.keystrokes.set("Tab",j("indentList")),e.keystrokes.set("Shift+Tab",j("outdentList"))}afterInit(){const e=this.editor.commands,o=e.get("indent"),c=e.get("outdent");o&&o.registerChildCommand(e.get("indentList")),c&&c.registerChildCommand(e.get("outdentList"))}}function tp(h){let e=1;for(const o of h.getChildren())if(o.name=="ul"||o.name=="ol")for(const c of o.getChildren())e+=tp(c);return e}var eL='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',tL='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>';class nL extends Ut{init(){const e=this.editor.t;Dv(this.editor,"numberedList",e("k"),eL),Dv(this.editor,"bulletedList",e("l"),tL)}}class iL extends Ut{static get requires(){return[$j,nL]}static get pluginName(){return"List"}}function Uv(h,e){return c=>{c.on("attribute:url:media",o)};function o(c,_,j){if(!j.consumable.consume(_.item,c.name))return;const _e=_.attributeNewValue,et=j.writer,nt=j.mapper.toViewElement(_.item);et.remove(et.createRangeIn(nt));const st=h.getMediaViewElement(et,_e,e);et.insert(et.createPositionAt(nt,0),st)}}function rL(h,e,o){return e.setCustomProperty("media",!0,h),Bo(h,e,{label:o})}function Wv(h,e,o,c){const _=h.createContainerElement("figure",{class:"media"});return _.getFillerOffset=sL,h.insert(h.createPositionAt(_,0),e.getMediaViewElement(h,o,c)),_}function Hv(h){const e=h.getSelectedElement();return e&&e.is("media")?e:null}function Gv(h,e,o){h.change(c=>{const _=c.createElement("media",{url:e});h.insertContent(_,o),c.setSelection(_,"on")})}function sL(){return null}class oL extends hn{refresh(){const e=this.editor.model,o=e.document.selection,c=e.schema,_=o.getFirstPosition(),j=Hv(o);let _e=_.parent;_e!=_e.root&&(_e=_e.parent),this.value=j?j.getAttribute("url"):null,this.isEnabled=c.checkChild(_e,"media")}execute(e){const o=this.editor.model,c=o.document.selection,_=Hv(c);if(_)o.change(j=>{j.setAttribute("url",e,_)});else{const j=zo(c,o);Gv(o,e,j)}}}var aL='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>';const lL="0 0 64 42";class cL{constructor(e,o){const c=o.providers,_=o.extraProviders||[],j=new Set(o.removeProviders),_e=c.concat(_).filter(et=>{const nt=et.name;return nt?!j.has(nt):(console.warn(Object(yt.a)("media-embed-no-provider-name: The configured media provider has no name and cannot be used."),{provider:et}),!1)});this.locale=e,this.providerDefinitions=_e}hasMedia(e){return!!this._getMedia(e)}getMediaViewElement(e,o,c){return this._getMedia(o).getViewElement(e,c)}_getMedia(e){if(!e)return new qv(this.locale);e=e.trim();for(const o of this.providerDefinitions){const c=o.html;let _=o.url;Array.isArray(_)||(_=[_]);for(const j of _){const _e=this._getUrlMatches(e,j);if(_e)return new qv(this.locale,e,_e,c)}}return null}_getUrlMatches(e,o){let c=e.match(o);if(c)return c;let _=e.replace(/^https?:\/\//,"");return c=_.match(o),c||(_=_.replace(/^www\./,""),c=_.match(o),c)?c:null}}class qv{constructor(e,o,c,_){this.url=this._getValidUrl(o),this._t=e.t,this._match=c,this._previewRenderer=_}getViewElement(e,o){const c={};if(o.renderForEditingView||o.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(c["data-oembed-url"]=this.url),o.renderForEditingView&&(c.class="ck-media__wrapper");const _=this._getPreviewHtml(o);return e.createUIElement("div",c,function(j){const _e=this.toDomElement(j);return _e.innerHTML=_,_e})}else return this.url&&(c.url=this.url),e.createEmptyElement("oembed",c)}_getPreviewHtml(e){return this._previewRenderer?this._previewRenderer(this._match):this.url&&e.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const e=new mw,o=new Lo;return e.text=this._t("Open media in new tab"),o.content=aL,o.viewBox=lL,new xr({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[o]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]},e]}]}).render().outerHTML}_getValidUrl(e){return e?e.match(/^https?/)?e:"https://"+e:null}}a(79);class qo extends Ut{static get pluginName(){return"MediaEmbedEditing"}constructor(e){super(e),e.config.define("mediaEmbed",{providers:[{name:"dailymotion",url:/^dailymotion\.com\/video\/(\w+)/,html:o=>`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${o[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:o=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${o[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)/,/^youtube\.com\/embed\/([\w-]+)/,/^youtu\.be\/([\w-]+)/],html:o=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${o[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>`},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:o=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${o[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`},{name:"instagram",url:/^instagram\.com\/p\/(\w+)/},{name:"twitter",url:/^twitter\.com/},{name:"googleMaps",url:/^google\.com\/maps/},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new cL(e.locale,e.config.get("mediaEmbed"))}init(){const e=this.editor,o=e.model.schema,c=e.t,_=e.conversion,j=e.config.get("mediaEmbed.previewsInData"),_e=this.registry;e.commands.add("mediaEmbed",new oL(e)),o.register("media",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["url"]}),_.for("dataDowncast").elementToElement({model:"media",view:(et,nt)=>{const st=et.getAttribute("url");return Wv(nt,_e,st,{renderMediaPreview:st&&j})}}),_.for("dataDowncast").add(Uv(_e,{renderMediaPreview:j})),_.for("editingDowncast").elementToElement({model:"media",view:(et,nt)=>{const st=et.getAttribute("url"),at=Wv(nt,_e,st,{renderForEditingView:!0});return rL(at,nt,c("m"))}}),_.for("editingDowncast").add(Uv(_e,{renderForEditingView:!0})),_.for("upcast").elementToElement({view:{name:"oembed",attributes:{url:!0}},model:(et,nt)=>{const st=et.getAttribute("url");if(_e.hasMedia(st))return nt.createElement("media",{url:st})}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(et,nt)=>{const st=et.getAttribute("data-oembed-url");if(_e.hasMedia(st))return nt.createElement("media",{url:st})}})}}const np=new Map;function cn(h,e,o){let c=np.get(h);c||(c=new Map,np.set(h,c)),c.set(e,o)}function uL(h,e){const o=np.get(h);return o&&o.has(e)?o.get(e):dL}function dL(h){return[h]}function Kv(h,e,o={}){const c=uL(h.constructor,e.constructor);try{return h=h.clone(),c(h,e,o)}catch(_){throw _}}function hL(h,e,o){h=h.slice(),e=e.slice();const c=new fL(o.document,o.useRelations,o.forceWeakRemove);c.setOriginalOperations(h),c.setOriginalOperations(e);const _=c.originalOperations;if(h.length==0||e.length==0)return{operationsA:h,operationsB:e,originalOperations:_};const j=new WeakMap;for(const nt of h)j.set(nt,0);const _e={nextBaseVersionA:h[h.length-1].baseVersion+1,nextBaseVersionB:e[e.length-1].baseVersion+1,originalOperationsACount:h.length,originalOperationsBCount:e.length};let et=0;for(;et<h.length;){const nt=h[et],st=j.get(nt);if(st==e.length){et++;continue}const at=e[st],ct=Kv(nt,at,c.getContext(nt,at,!0)),dt=Kv(at,nt,c.getContext(at,nt,!1));c.updateRelation(nt,at),c.setOriginalOperations(ct,nt),c.setOriginalOperations(dt,at);for(const gt of ct)j.set(gt,st+dt.length);h.splice(et,1,...ct),e.splice(st,1,...dt)}return Yv(h,_e.nextBaseVersionB),Yv(e,_e.nextBaseVersionA),{operationsA:h,operationsB:e,originalOperations:_}}class fL{constructor(e,o,c=!1){this.originalOperations=new Map,this._history=e.history,this._useRelations=o,this._forceWeakRemove=!!c,this._relations=new Map}setOriginalOperations(e,o=null){const c=o?this.originalOperations.get(o):null;for(const _ of e)this.originalOperations.set(_,c||_)}updateRelation(e,o){switch(e.constructor){case pn:{switch(o.constructor){case Ln:{e.targetPosition.isEqual(o.sourcePosition)||o.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,o,"insertAtSource"):e.targetPosition.isEqual(o.deletionPosition)?this._setRelation(e,o,"insertBetween"):e.targetPosition.isAfter(o.sourcePosition)&&this._setRelation(e,o,"moveTargetAfter");break}case pn:{e.targetPosition.isEqual(o.sourcePosition)||e.targetPosition.isBefore(o.sourcePosition)?this._setRelation(e,o,"insertBefore"):this._setRelation(e,o,"insertAfter");break}}break}case _n:{switch(o.constructor){case Ln:{e.splitPosition.isBefore(o.sourcePosition)&&this._setRelation(e,o,"splitBefore");break}case pn:{(e.splitPosition.isEqual(o.sourcePosition)||e.splitPosition.isBefore(o.sourcePosition))&&this._setRelation(e,o,"splitBefore");break}}break}case Ln:{switch(o.constructor){case Ln:{e.targetPosition.isEqual(o.sourcePosition)||this._setRelation(e,o,"mergeTargetNotMoved"),e.sourcePosition.isEqual(o.targetPosition)&&this._setRelation(e,o,"mergeSourceNotMoved"),e.sourcePosition.isEqual(o.sourcePosition)&&this._setRelation(e,o,"mergeSameElement");break}case _n:e.sourcePosition.isEqual(o.splitPosition)&&this._setRelation(e,o,"splitAtSource")}break}case Zn:{const c=e.newRange;if(!c)return;switch(o.constructor){case pn:{const _=Tt._createFromPositionAndShift(o.sourcePosition,o.howMany),j=_.containsPosition(c.start)||_.start.isEqual(c.start),_e=_.containsPosition(c.end)||_.end.isEqual(c.end);(j||_e)&&!_.containsRange(c)&&this._setRelation(e,o,{side:j?"left":"right",path:j?c.start.path.slice():c.end.path.slice()});break}case Ln:{const _=c.start.isEqual(o.targetPosition),j=c.start.isEqual(o.deletionPosition),_e=c.end.isEqual(o.deletionPosition),et=c.end.isEqual(o.sourcePosition);(_||j||_e||et)&&this._setRelation(e,o,{wasInLeftElement:_,wasStartBeforeMergedElement:j,wasEndBeforeMergedElement:_e,wasInRightElement:et});break}}break}}}getContext(e,o,c){return{aIsStrong:c,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(o),abRelation:this._useRelations?this._getRelation(e,o):null,baRelation:this._useRelations?this._getRelation(o,e):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(e){const o=this.originalOperations.get(e);return o.wasUndone||this._history.isUndoneOperation(o)}_getRelation(e,o){const c=this.originalOperations.get(o),_=this._history.getUndoneOperation(c);if(!_)return null;const j=this.originalOperations.get(e),_e=this._relations.get(j);return _e&&_e.get(_)||null}_setRelation(e,o,c){const _=this.originalOperations.get(e),j=this.originalOperations.get(o);let _e=this._relations.get(_);_e||(_e=new Map,this._relations.set(_,_e)),_e.set(j,c)}}function Yv(h,e){for(const o of h)o.baseVersion=e++}cn(Nn,Nn,(h,e,o)=>{if(h.key===e.key){const c=h.range.getDifference(e.range).map(j=>new Nn(j,h.key,h.oldValue,h.newValue,0)),_=h.range.getIntersection(e.range);return _&&o.aIsStrong&&c.push(new Nn(_,e.key,e.newValue,h.newValue,0)),c.length==0?[new Wn(0)]:c}else return[h]}),cn(Nn,Fn,(h,e)=>{if(h.range.start.hasSameParentAs(e.position)&&h.range.containsPosition(e.position)){const c=h.range._getTransformedByInsertion(e.position,e.howMany,!e.shouldReceiveAttributes).map(_=>new Nn(_,h.key,h.oldValue,h.newValue,h.baseVersion));if(e.shouldReceiveAttributes){const _=Qv(e,h.key,h.oldValue);_&&c.unshift(_)}return c}return h.range=h.range._getTransformedByInsertion(e.position,e.howMany,!1)[0],[h]});function Qv(h,e,o){const _=h.nodes.getNode(0).getAttribute(e);if(_==o)return null;const j=new Tt(h.position,h.position.getShiftedBy(h.howMany));return new Nn(j,e,_,o,0)}cn(Nn,Ln,(h,e)=>{const o=[];h.range.start.hasSameParentAs(e.deletionPosition)&&(h.range.containsPosition(e.deletionPosition)||h.range.start.isEqual(e.deletionPosition))&&o.push(Tt._createFromPositionAndShift(e.graveyardPosition,1));const c=h.range._getTransformedByMergeOperation(e);return c.isCollapsed||o.push(c),o.map(_=>new Nn(_,h.key,h.oldValue,h.newValue,h.baseVersion))}),cn(Nn,pn,(h,e)=>pL(h.range,e).map(c=>new Nn(c,h.key,h.oldValue,h.newValue,h.baseVersion)));function pL(h,e){const o=Tt._createFromPositionAndShift(e.sourcePosition,e.howMany);let c=null,_=[];o.containsRange(h,!0)?c=h:h.start.hasSameParentAs(o.start)?(_=h.getDifference(o),c=h.getIntersection(o)):_=[h];const j=[];for(let _e of _){_e=_e._getTransformedByDeletion(e.sourcePosition,e.howMany);const et=e.getMovedRangeStart(),nt=_e.start.hasSameParentAs(et);_e=_e._getTransformedByInsertion(et,e.howMany,nt),j.push(..._e)}return c&&j.push(c._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,!1)[0]),j}cn(Nn,_n,(h,e)=>{if(h.range.end.isEqual(e.insertionPosition))return e.graveyardPosition||h.range.end.offset++,[h];if(h.range.start.hasSameParentAs(e.splitPosition)&&h.range.containsPosition(e.splitPosition)){const o=h.clone();return o.range=new Tt(e.moveTargetPosition.clone(),h.range.end._getCombined(e.splitPosition,e.moveTargetPosition)),h.range.end=e.splitPosition.clone(),h.range.end.stickiness="toPrevious",[h,o]}return h.range=h.range._getTransformedBySplitOperation(e),[h]}),cn(Fn,Nn,(h,e)=>{const o=[h];if(h.shouldReceiveAttributes&&h.position.hasSameParentAs(e.range.start)&&e.range.containsPosition(h.position)){const c=Qv(h,e.key,e.newValue);c&&o.push(c)}return o}),cn(Fn,Fn,(h,e,o)=>h.position.isEqual(e.position)&&o.aIsStrong?[h]:(h.position=h.position._getTransformedByInsertOperation(e),[h])),cn(Fn,pn,(h,e)=>(h.position=h.position._getTransformedByMoveOperation(e),[h])),cn(Fn,_n,(h,e)=>(h.position=h.position._getTransformedBySplitOperation(e),[h])),cn(Fn,Ln,(h,e)=>(h.position=h.position._getTransformedByMergeOperation(e),[h])),cn(Zn,Fn,(h,e)=>(h.oldRange&&(h.oldRange=h.oldRange._getTransformedByInsertOperation(e)[0]),h.newRange&&(h.newRange=h.newRange._getTransformedByInsertOperation(e)[0]),[h])),cn(Zn,Zn,(h,e,o)=>{if(h.name==e.name)if(o.aIsStrong)h.oldRange=e.newRange?e.newRange.clone():null;else return[new Wn(0)];return[h]}),cn(Zn,Ln,(h,e)=>(h.oldRange&&(h.oldRange=h.oldRange._getTransformedByMergeOperation(e)),h.newRange&&(h.newRange=h.newRange._getTransformedByMergeOperation(e)),[h])),cn(Zn,pn,(h,e,o)=>{if(h.oldRange&&(h.oldRange=Tt._createFromRanges(h.oldRange._getTransformedByMoveOperation(e))),h.newRange){if(o.abRelation){const c=Tt._createFromRanges(h.newRange._getTransformedByMoveOperation(e));if(o.abRelation.side=="left"&&e.targetPosition.isEqual(h.newRange.start))return h.newRange.start.path=o.abRelation.path,h.newRange.end=c.end,[h];if(o.abRelation.side=="right"&&e.targetPosition.isEqual(h.newRange.end))return h.newRange.start=c.start,h.newRange.end.path=o.abRelation.path,[h]}h.newRange=Tt._createFromRanges(h.newRange._getTransformedByMoveOperation(e))}return[h]}),cn(Zn,_n,(h,e,o)=>{if(h.oldRange&&(h.oldRange=h.oldRange._getTransformedBySplitOperation(e)),h.newRange){if(o.abRelation){const c=h.newRange._getTransformedBySplitOperation(e);return h.newRange.start.isEqual(e.splitPosition)&&o.abRelation.wasStartBeforeMergedElement?h.newRange.start=Mt._createAt(e.insertionPosition):h.newRange.start.isEqual(e.splitPosition)&&!o.abRelation.wasInLeftElement&&(h.newRange.start=Mt._createAt(e.moveTargetPosition)),h.newRange.end.isEqual(e.splitPosition)&&o.abRelation.wasInRightElement?h.newRange.end=Mt._createAt(e.moveTargetPosition):h.newRange.end.isEqual(e.splitPosition)&&o.abRelation.wasEndBeforeMergedElement?h.newRange.end=Mt._createAt(e.insertionPosition):h.newRange.end=c.end,[h]}h.newRange=h.newRange._getTransformedBySplitOperation(e)}return[h]}),cn(Ln,Fn,(h,e)=>(h.sourcePosition.hasSameParentAs(e.position)&&(h.howMany+=e.howMany),h.sourcePosition=h.sourcePosition._getTransformedByInsertOperation(e),h.targetPosition=h.targetPosition._getTransformedByInsertOperation(e),[h])),cn(Ln,Ln,(h,e,o)=>{if(h.sourcePosition.isEqual(e.sourcePosition)&&h.targetPosition.isEqual(e.targetPosition))if(o.bWasUndone){const c=e.graveyardPosition.path.slice();return c.push(0),h.sourcePosition=new Mt(e.graveyardPosition.root,c),h.howMany=0,[h]}else return[new Wn(0)];if(h.sourcePosition.isEqual(e.sourcePosition)&&!h.targetPosition.isEqual(e.targetPosition)&&!o.bWasUndone&&o.abRelation!="splitAtSource"){const c=h.targetPosition.root.rootName=="$graveyard",_=e.targetPosition.root.rootName=="$graveyard";if(_&&!c||!(c&&!_)&&o.aIsStrong){const nt=e.targetPosition._getTransformedByMergeOperation(e),st=h.targetPosition._getTransformedByMergeOperation(e);return[new pn(nt,h.howMany,st,0)]}else return[new Wn(0)]}return h.sourcePosition.hasSameParentAs(e.targetPosition)&&(h.howMany+=e.howMany),h.sourcePosition=h.sourcePosition._getTransformedByMergeOperation(e),h.targetPosition=h.targetPosition._getTransformedByMergeOperation(e),(!h.graveyardPosition.isEqual(e.graveyardPosition)||!o.aIsStrong)&&(h.graveyardPosition=h.graveyardPosition._getTransformedByMergeOperation(e)),[h]}),cn(Ln,pn,(h,e,o)=>{const c=Tt._createFromPositionAndShift(e.sourcePosition,e.howMany);return e.type=="remove"&&!o.bWasUndone&&!o.forceWeakRemove&&h.deletionPosition.hasSameParentAs(e.sourcePosition)&&c.containsPosition(h.sourcePosition)?[new Wn(0)]:(h.sourcePosition.hasSameParentAs(e.targetPosition)&&(h.howMany+=e.howMany),h.sourcePosition.hasSameParentAs(e.sourcePosition)&&(h.howMany-=e.howMany),h.sourcePosition=h.sourcePosition._getTransformedByMoveOperation(e),h.targetPosition=h.targetPosition._getTransformedByMoveOperation(e),h.graveyardPosition.isEqual(e.targetPosition)||(h.graveyardPosition=h.graveyardPosition._getTransformedByMoveOperation(e)),[h])}),cn(Ln,_n,(h,e,o)=>{if(e.graveyardPosition&&(h.graveyardPosition=h.graveyardPosition._getTransformedByDeletion(e.graveyardPosition,1),h.deletionPosition.isEqual(e.graveyardPosition)&&(h.howMany=e.howMany)),h.targetPosition.isEqual(e.splitPosition)){const c=e.howMany!=0,_=e.graveyardPosition&&h.deletionPosition.isEqual(e.graveyardPosition);if(c||_||o.abRelation=="mergeTargetNotMoved")return h.sourcePosition=h.sourcePosition._getTransformedBySplitOperation(e),[h]}if(h.sourcePosition.isEqual(e.splitPosition)){if(o.abRelation=="mergeSourceNotMoved")return h.howMany=0,h.targetPosition=h.targetPosition._getTransformedBySplitOperation(e),[h];if(o.abRelation=="mergeSameElement"||h.sourcePosition.offset>0)return h.sourcePosition=e.moveTargetPosition.clone(),h.targetPosition=h.targetPosition._getTransformedBySplitOperation(e),[h]}return h.sourcePosition.hasSameParentAs(e.splitPosition)&&(h.howMany=e.splitPosition.offset),h.sourcePosition=h.sourcePosition._getTransformedBySplitOperation(e),h.targetPosition=h.targetPosition._getTransformedBySplitOperation(e),[h]}),cn(pn,Fn,(h,e)=>{const c=Tt._createFromPositionAndShift(h.sourcePosition,h.howMany)._getTransformedByInsertOperation(e,!1)[0];return h.sourcePosition=c.start,h.howMany=c.end.offset-c.start.offset,h.targetPosition.isEqual(e.position)||(h.targetPosition=h.targetPosition._getTransformedByInsertOperation(e)),[h]}),cn(pn,pn,(h,e,o)=>{const c=Tt._createFromPositionAndShift(h.sourcePosition,h.howMany),_=Tt._createFromPositionAndShift(e.sourcePosition,e.howMany);let j=o.aIsStrong,_e=!o.aIsStrong;o.abRelation=="insertBefore"||o.baRelation=="insertAfter"?_e=!0:(o.abRelation=="insertAfter"||o.baRelation=="insertBefore")&&(_e=!1);let et;if(h.targetPosition.isEqual(e.targetPosition)&&_e?et=h.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany):et=h.targetPosition._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Jv(h,e)&&Jv(e,h))return[e.getReversed()];if(c.containsPosition(e.targetPosition)&&c.containsRange(_,!0))return c.start=c.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),c.end=c.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Ts([c],et);if(_.containsPosition(h.targetPosition)&&_.containsRange(c,!0))return c.start=c.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),c.end=c.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),Ts([c],et);const at=Yn(h.sourcePosition.getParentPath(),e.sourcePosition.getParentPath());if(at=="prefix"||at=="extension")return c.start=c.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),c.end=c.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Ts([c],et);h.type=="remove"&&e.type!="remove"&&!o.aWasUndone&&!o.forceWeakRemove?j=!0:h.type!="remove"&&e.type=="remove"&&!o.bWasUndone&&!o.forceWeakRemove&&(j=!1);const ct=[],dt=c.getDifference(_);for(const kt of dt){kt.start=kt.start._getTransformedByDeletion(e.sourcePosition,e.howMany),kt.end=kt.end._getTransformedByDeletion(e.sourcePosition,e.howMany);const Ct=Yn(kt.start.getParentPath(),e.getMovedRangeStart().getParentPath())=="same",Nt=kt._getTransformedByInsertion(e.getMovedRangeStart(),e.howMany,Ct);ct.push(...Nt)}const gt=c.getIntersection(_);return gt!==null&&j&&(gt.start=gt.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),gt.end=gt.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),ct.length===0?ct.push(gt):ct.length==1?_.start.isBefore(c.start)||_.start.isEqual(c.start)?ct.unshift(gt):ct.push(gt):ct.splice(1,0,gt)),ct.length===0?[new Wn(h.baseVersion)]:Ts(ct,et)}),cn(pn,_n,(h,e,o)=>{let c=h.targetPosition.clone();(!h.targetPosition.isEqual(e.insertionPosition)||!e.graveyardPosition||o.abRelation=="moveTargetAfter")&&(c=h.targetPosition._getTransformedBySplitOperation(e));const _=Tt._createFromPositionAndShift(h.sourcePosition,h.howMany);if(_.end.isEqual(e.insertionPosition))return e.graveyardPosition||h.howMany++,h.targetPosition=c,[h];if(_.start.hasSameParentAs(e.splitPosition)&&_.containsPosition(e.splitPosition)){let et=new Tt(e.splitPosition,_.end);et=et._getTransformedBySplitOperation(e);const nt=[new Tt(_.start,e.splitPosition),et];return Ts(nt,c)}h.targetPosition.isEqual(e.splitPosition)&&o.abRelation=="insertAtSource"&&(c=e.moveTargetPosition),h.targetPosition.isEqual(e.insertionPosition)&&o.abRelation=="insertBetween"&&(c=h.targetPosition);const _e=[_._getTransformedBySplitOperation(e)];if(e.graveyardPosition){const et=_.start.isEqual(e.graveyardPosition)||_.containsPosition(e.graveyardPosition);h.howMany>1&&et&&!o.aWasUndone&&_e.push(Tt._createFromPositionAndShift(e.insertionPosition,1))}return Ts(_e,c)}),cn(pn,Ln,(h,e,o)=>{const c=Tt._createFromPositionAndShift(h.sourcePosition,h.howMany);if(e.deletionPosition.hasSameParentAs(h.sourcePosition)&&c.containsPosition(e.sourcePosition)){if(h.type=="remove"&&!o.forceWeakRemove){if(!o.aWasUndone){const _e=[];let et=e.graveyardPosition.clone(),nt=e.targetPosition._getTransformedByMergeOperation(e);h.howMany>1&&(_e.push(new pn(h.sourcePosition,h.howMany-1,h.targetPosition,0)),et=et._getTransformedByMove(h.sourcePosition,h.targetPosition,h.howMany-1),nt=nt._getTransformedByMove(h.sourcePosition,h.targetPosition,h.howMany-1));const st=e.deletionPosition._getCombined(h.sourcePosition,h.targetPosition),at=new pn(et,1,st,0),ct=at.getMovedRangeStart().path.slice();ct.push(0);const dt=new Mt(at.targetPosition.root,ct);nt=nt._getTransformedByMove(et,st,1);const gt=new pn(nt,e.howMany,dt,0);return _e.push(at),_e.push(gt),_e}}else if(h.howMany==1)return o.bWasUndone?(h.sourcePosition=e.graveyardPosition.clone(),h.targetPosition=h.targetPosition._getTransformedByMergeOperation(e),[h]):[new Wn(0)]}const j=Tt._createFromPositionAndShift(h.sourcePosition,h.howMany)._getTransformedByMergeOperation(e);return h.sourcePosition=j.start,h.howMany=j.end.offset-j.start.offset,h.targetPosition=h.targetPosition._getTransformedByMergeOperation(e),[h]}),cn(_i,Fn,(h,e)=>(h.position=h.position._getTransformedByInsertOperation(e),[h])),cn(_i,Ln,(h,e)=>h.position.isEqual(e.deletionPosition)?(h.position=e.graveyardPosition.clone(),h.position.stickiness="toNext",[h]):(h.position=h.position._getTransformedByMergeOperation(e),[h])),cn(_i,pn,(h,e)=>(h.position=h.position._getTransformedByMoveOperation(e),[h])),cn(_i,_i,(h,e,o)=>{if(h.position.isEqual(e.position))if(o.aIsStrong)h.oldName=e.newName;else return[new Wn(0)];return[h]}),cn(_i,_n,(h,e)=>{const o=h.position.path,c=e.splitPosition.getParentPath();if(Yn(o,c)=="same"&&!e.graveyardPosition){const _=new _i(h.position.getShiftedBy(1),h.oldName,h.newName,0);return[h,_]}return h.position=h.position._getTransformedBySplitOperation(e),[h]}),cn(Nr,Nr,(h,e,o)=>{if(h.root===e.root&&h.key===e.key){if(!o.aIsStrong||h.newValue===e.newValue)return[new Wn(0)];h.oldValue=e.newValue}return[h]}),cn(_n,Fn,(h,e)=>(h.splitPosition.hasSameParentAs(e.position)&&h.splitPosition.offset<e.position.offset&&(h.howMany+=e.howMany),h.splitPosition=h.splitPosition._getTransformedByInsertOperation(e),h.insertionPosition=_n.getInsertionPosition(h.splitPosition),[h])),cn(_n,Ln,(h,e,o)=>{if(!h.graveyardPosition&&!o.bWasUndone&&h.splitPosition.hasSameParentAs(e.sourcePosition)){const c=e.graveyardPosition.path.slice();c.push(0);const _=new Mt(e.graveyardPosition.root,c),j=_n.getInsertionPosition(new Mt(e.graveyardPosition.root,c)),_e=new _n(_,0,null,0);return _e.insertionPosition=j,h.splitPosition=h.splitPosition._getTransformedByMergeOperation(e),h.insertionPosition=_n.getInsertionPosition(h.splitPosition),h.graveyardPosition=_e.insertionPosition.clone(),h.graveyardPosition.stickiness="toNext",[_e,h]}return h.splitPosition.hasSameParentAs(e.deletionPosition)&&!h.splitPosition.isAfter(e.deletionPosition)&&h.howMany--,h.splitPosition.hasSameParentAs(e.targetPosition)&&(h.howMany+=e.howMany),h.splitPosition=h.splitPosition._getTransformedByMergeOperation(e),h.insertionPosition=_n.getInsertionPosition(h.splitPosition),h.graveyardPosition&&(h.graveyardPosition=h.graveyardPosition._getTransformedByMergeOperation(e)),[h]}),cn(_n,pn,(h,e,o)=>{const c=Tt._createFromPositionAndShift(e.sourcePosition,e.howMany);if(h.graveyardPosition){const j=c.start.isEqual(h.graveyardPosition)||c.containsPosition(h.graveyardPosition);if(!o.bWasUndone&&j){const _e=h.splitPosition._getTransformedByMoveOperation(e),et=h.graveyardPosition._getTransformedByMoveOperation(e),nt=et.path.slice();nt.push(0);const st=new Mt(et.root,nt);return[new pn(_e,h.howMany,st,0)]}h.graveyardPosition=h.graveyardPosition._getTransformedByMoveOperation(e)}if(h.splitPosition.hasSameParentAs(e.sourcePosition)&&c.containsPosition(h.splitPosition)){const j=e.howMany-(h.splitPosition.offset-e.sourcePosition.offset);return h.howMany-=j,h.splitPosition.hasSameParentAs(e.targetPosition)&&h.splitPosition.offset<e.targetPosition.offset&&(h.howMany+=e.howMany),h.splitPosition=e.sourcePosition.clone(),h.insertionPosition=_n.getInsertionPosition(h.splitPosition),[h]}return h.splitPosition.isEqual(e.targetPosition)&&(o.baRelation=="insertAtSource"||o.abRelation=="splitBefore")?(h.howMany+=e.howMany,h.splitPosition=h.splitPosition._getTransformedByDeletion(e.sourcePosition,e.howMany),h.insertionPosition=_n.getInsertionPosition(h.splitPosition),[h]):(e.sourcePosition.isEqual(e.targetPosition)||(h.splitPosition.hasSameParentAs(e.sourcePosition)&&h.splitPosition.offset<=e.sourcePosition.offset&&(h.howMany-=e.howMany),h.splitPosition.hasSameParentAs(e.targetPosition)&&h.splitPosition.offset<e.targetPosition.offset&&(h.howMany+=e.howMany)),h.splitPosition.stickiness="toNone",h.splitPosition=h.splitPosition._getTransformedByMoveOperation(e),h.splitPosition.stickiness="toNext",h.graveyardPosition?h.insertionPosition=h.insertionPosition._getTransformedByMoveOperation(e):h.insertionPosition=_n.getInsertionPosition(h.splitPosition),[h])}),cn(_n,_n,(h,e,o)=>{if(h.splitPosition.isEqual(e.splitPosition)){if(!h.graveyardPosition&&!e.graveyardPosition)return[new Wn(0)];if(h.graveyardPosition&&e.graveyardPosition&&h.graveyardPosition.isEqual(e.graveyardPosition))return[new Wn(0)];if(o.abRelation=="splitBefore")return h.howMany=0,h.graveyardPosition=h.graveyardPosition._getTransformedBySplitOperation(e),[h]}if(h.graveyardPosition&&e.graveyardPosition&&h.graveyardPosition.isEqual(e.graveyardPosition)){const c=h.splitPosition.root.rootName=="$graveyard",_=e.splitPosition.root.rootName=="$graveyard";if(_&&!c||!(c&&!_)&&o.aIsStrong){const nt=[];return e.howMany&&nt.push(new pn(e.moveTargetPosition,e.howMany,e.splitPosition,0)),h.howMany&&nt.push(new pn(h.splitPosition,h.howMany,h.moveTargetPosition,0)),nt}else return[new Wn(0)]}if(h.graveyardPosition&&(h.graveyardPosition=h.graveyardPosition._getTransformedBySplitOperation(e)),h.splitPosition.isEqual(e.insertionPosition)&&o.abRelation=="splitBefore")return h.howMany++,[h];if(e.splitPosition.isEqual(h.insertionPosition)&&o.baRelation=="splitBefore"){const c=e.insertionPosition.path.slice();c.push(0);const _=new Mt(e.insertionPosition.root,c),j=new pn(h.insertionPosition,1,_,0);return[h,j]}return h.splitPosition.hasSameParentAs(e.splitPosition)&&h.splitPosition.offset<e.splitPosition.offset&&(h.howMany-=e.howMany),h.splitPosition=h.splitPosition._getTransformedBySplitOperation(e),h.insertionPosition=_n.getInsertionPosition(h.splitPosition),[h]});function Jv(h,e){return h.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany)===null}function Ts(h,e){const o=[];for(let c=0;c<h.length;c++){const _=h[c],j=new pn(_.start,_.end.offset-_.start.offset,e,0);o.push(j);for(let _e=c+1;_e<h.length;_e++)h[_e]=h[_e]._getTransformedByMove(j.sourcePosition,j.targetPosition,j.howMany)[0];e=e._getTransformedByMove(j.sourcePosition,j.targetPosition,j.howMany)}return o}class Xv extends hn{constructor(e){super(e),this._stack=[],this._createdBatches=new WeakSet,this.refresh()}refresh(){this.isEnabled=this._stack.length>0}addBatch(e){const o=this.editor.model.document.selection,c={ranges:o.hasOwnRange?Array.from(o.getRanges()):[],isBackward:o.isBackward};this._stack.push({batch:e,selection:c}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,o,c){const _=this.editor.model,j=_.document,_e=[];for(const et of e){const st=mL(et,c).find(at=>at.start.root!=j.graveyard);st&&_e.push(st)}_e.length&&_.change(et=>{et.setSelection(_e,{backward:o})})}_undo(e,o){const c=this.editor.model,_=c.document;this._createdBatches.add(o);const j=e.operations.slice().filter(_e=>_e.isDocumentOperation);j.reverse();for(const _e of j){const et=_e.baseVersion+1,nt=Array.from(_.history.getOperations(et)),at=hL([_e.getReversed()],nt,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;for(const ct of at)o.addOperation(ct),c.applyOperation(ct),_.history.setOperationAsUndone(_e,ct)}}}function mL(h,e){const o=h.getTransformedByOperations(e);o.sort((c,_)=>c.start.isBefore(_.start)?-1:1);for(let c=1;c<o.length;c++){const _=o[c-1],j=o[c];_.end.isTouching(j.start)&&(_.end=j.end,o.splice(c,1),c--)}return o}class gL extends Xv{execute(e=null){const o=e?this._stack.findIndex(j=>j.batch==e):this._stack.length-1,c=this._stack.splice(o,1)[0],_=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(_,()=>{this._undo(c.batch,_);const j=this.editor.model.document.history.getOperations(c.batch.baseVersion);this._restoreSelection(c.selection.ranges,c.selection.isBackward,j),this.fire("revert",c.batch,_)}),this.refresh()}}class _L extends Xv{execute(){const e=this._stack.pop(),o=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(o,()=>{const _=e.batch.operations[e.batch.operations.length-1].baseVersion+1,j=this.editor.model.document.history.getOperations(_);this._restoreSelection(e.selection.ranges,e.selection.isBackward,j),this._undo(e.batch,o)}),this.refresh()}}class wL extends Ut{static get pluginName(){return"UndoEditing"}constructor(e){super(e),this._batchRegistry=new WeakSet}init(){const e=this.editor;this._undoCommand=new gL(e),this._redoCommand=new _L(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",(o,c)=>{const _=c[0];if(!_.isDocumentOperation)return;const j=_.batch,_e=this._redoCommand._createdBatches.has(j),et=this._undoCommand._createdBatches.has(j);this._batchRegistry.has(j)||j.type=="transparent"&&!_e&&!et||(_e?this._undoCommand.addBatch(j):et||(this._undoCommand.addBatch(j),this._redoCommand.clearStack()),this._batchRegistry.add(j))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(o,c,_)=>{this._redoCommand.addBatch(_)}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo")}}var Zv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.042 9.367l2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',_b='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M14.958 9.367l-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>';class vL extends Ut{init(){const e=this.editor,o=e.locale,c=e.t,_=o.uiLanguageDirection=="ltr"?Zv:_b,j=o.uiLanguageDirection=="ltr"?_b:Zv;this._addButton("undo",c("bb"),"CTRL+Z",_),this._addButton("redo",c("bc"),"CTRL+Y",j)}_addButton(e,o,c,_){const j=this.editor;j.ui.componentFactory.add(e,_e=>{const et=j.commands.get(e),nt=new Sn(_e);return nt.set({label:o,icon:_,keystroke:c,tooltip:!0}),nt.bind("isEnabled").to(et,"isEnabled"),this.listenTo(nt,"execute",()=>{j.execute(e),j.editing.view.focus()}),nt})}}class ey extends Ut{static get requires(){return[wL,vL]}static get pluginName(){return"Undo"}}const bL=/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w.-]+)+[\w\-._~:/?#[\]@!$&'()*+,;=]+$/;class yL extends Ut{static get requires(){return[Es,ey]}static get pluginName(){return"AutoMediaEmbed"}constructor(e){super(e),this._timeoutId=null,this._positionToInsert=null}init(){const e=this.editor,o=e.model.document;this.listenTo(e.plugins.get(Es),"inputTransformation",()=>{const c=o.selection.getFirstRange(),_=Gn.fromPosition(c.start);_.stickiness="toPrevious";const j=Gn.fromPosition(c.end);j.stickiness="toNext",o.once("change:data",()=>{this._embedMediaBetweenPositions(_,j),_.detach(),j.detach()},{priority:"high"})}),e.commands.get("undo").on("execute",()=>{this._timeoutId&&(jn.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)},{priority:"high"})}_embedMediaBetweenPositions(e,o){const c=this.editor,_=c.plugins.get(qo).registry,j=new $r(e,o),_e=j.getWalker({ignoreElementEnd:!0});let et="";for(const st of _e)st.item.is("textProxy")&&(et+=st.item.data);et=et.trim(),!(!et.match(bL)||!_.hasMedia(et)||!c.commands.get("mediaEmbed").isEnabled)&&(this._positionToInsert=Gn.fromPosition(e),this._timeoutId=jn.window.setTimeout(()=>{c.model.change(st=>{this._timeoutId=null,st.remove(j);let at;this._positionToInsert.root.rootName!=="$graveyard"&&(at=this._positionToInsert),Gv(c.model,et,at),this._positionToInsert.detach(),this._positionToInsert=null})},100))}}a(81);class kL extends sn{constructor(e,o){super(o);const c=o.t;this.focusTracker=new _r,this.keystrokes=new Wr,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(c("bd"),Yu,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(c("be"),Qu,"ck-button-cancel","cancel"),this._focusables=new ns,this._focusCycler=new bs({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this._validators=e,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form"],tabindex:"-1"},children:[this.urlInputView,this.saveButtonView,this.cancelButtonView]})}render(){super.render(),Ku({view:this}),[this.urlInputView,this.saveButtonView,this.cancelButtonView].forEach(c=>{this._focusables.add(c),this.focusTracker.add(c.element)}),this.keystrokes.listenTo(this.element);const o=c=>c.stopPropagation();this.keystrokes.set("arrowright",o),this.keystrokes.set("arrowleft",o),this.keystrokes.set("arrowup",o),this.keystrokes.set("arrowdown",o),this.listenTo(this.urlInputView.element,"selectstart",(c,_)=>{_.stopPropagation()},{priority:"high"})}focus(){this._focusCycler.focusFirst()}get url(){return this.urlInputView.inputView.element.value.trim()}set url(e){this.urlInputView.inputView.element.value=e.trim()}isValid(){this.resetFormStatus();for(const e of this._validators){const o=e(this);if(o)return this.urlInputView.errorText=o,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault}_createUrlInput(){const e=this.locale.t,o=new Gu(this.locale,qu),c=o.inputView;return this._urlInputViewInfoDefault=e("bm"),this._urlInputViewInfoTip=e("bn"),o.label=e("bo"),o.infoText=this._urlInputViewInfoDefault,c.placeholder="https://example.com",c.on("input",()=>{o.infoText=c.element.value?this._urlInputViewInfoTip:this._urlInputViewInfoDefault}),o}_createButton(e,o,c,_){const j=new Sn(this.locale);return j.set({label:e,icon:o,tooltip:!0}),j.extendTemplate({attributes:{class:c}}),_&&j.delegate("execute").to(this,_),j}}var xL=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M18.68 3.03c.6 0 .59-.03.59.55v12.84c0 .59.01.56-.59.56H1.29c-.6 0-.59.03-.59-.56V3.58c0-.58-.01-.55.6-.55h17.38zM15.77 15V5H4.2v10h11.57zM2 4v1h1V4H2zm0 2v1h1V6H2zm0 2v1h1V8H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zM17 4v1h1V4h-1zm0 2v1h1V6h-1zm0 2v1h1V8h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zM7.5 7.177a.4.4 0 01.593-.351l5.133 2.824a.4.4 0 010 .7l-5.133 2.824a.4.4 0 01-.593-.35V7.176v.001z"/></svg>
`;class EL extends Ut{static get requires(){return[qo]}static get pluginName(){return"MediaEmbedUI"}init(){const e=this.editor,o=e.commands.get("mediaEmbed"),c=e.plugins.get(qo).registry;this.form=new kL(CL(e.t,c),e.locale),e.ui.componentFactory.add("mediaEmbed",_=>{const j=Ys(_);return this._setUpDropdown(j,this.form,o,e),this._setUpForm(this.form,j,o),j})}_setUpDropdown(e,o,c){const _=this.editor,j=_.t,_e=e.buttonView;e.bind("isEnabled").to(c),e.panelView.children.add(o),_e.set({label:j("n"),icon:xL,tooltip:!0}),_e.on("open",()=>{o.url=c.value||"",o.urlInputView.select(),o.focus()},{priority:"low"}),e.on("submit",()=>{o.isValid()&&(_.execute("mediaEmbed",o.url),et())}),e.on("change:isOpen",()=>o.resetFormStatus()),e.on("cancel",()=>et());function et(){_.editing.view.focus(),e.isOpen=!1}}_setUpForm(e,o,c){e.delegate("submit","cancel").to(o),e.urlInputView.bind("value").to(c,"value"),e.urlInputView.bind("isReadOnly").to(c,"isEnabled",_=>!_),e.saveButtonView.bind("isEnabled").to(c)}}function CL(h,e){return[o=>{if(!o.url.length)return h("o")},o=>{if(!e.hasMedia(o.url))return h("p")}]}a(83);class TL extends Ut{static get requires(){return[qo,EL,yL,$o]}static get pluginName(){return"MediaEmbed"}}function AL(h,e){for(const o of h.getChildren())if(o.is("b")&&o.getStyle("font-weight")==="normal"){const c=h.getChildIndex(o);e.remove(o),e.insertChild(c,o.getChildren(),h)}}function SL(h,e){if(!h.childCount)return;const o=new Xs(h.document),c=PL(h,o);if(!c.length)return;let _=null,j=1;c.forEach((_e,et)=>{const nt=jL(c[et-1],_e),st=nt?null:c[et-1],at=DL(st,_e);if(nt&&(_=null,j=1),!_||at!==0){const dt=RL(_e,e);if(!_)_=ty(dt,_e.element,o);else if(_e.indent>j){const gt=_.getChild(_.childCount-1),kt=gt.getChild(gt.childCount-1);_=ty(dt,kt,o),j+=1}else if(_e.indent<j){const gt=j-_e.indent;_=FL(_,gt),j=parseInt(_e.indent)}_e.indent<=j&&(_.is(dt.type)||(_=o.rename(dt.type,_)))}const ct=NL(_e.element,o);o.appendChild(ct,_)})}function IL(h,e){for(const o of e.createRangeIn(h)){const c=o.item;if(c.is("li")){const _=c.getChild(0);_.is("p")&&e.unwrapElement(_)}}}function PL(h,e){const o=e.createRangeIn(h),c=new Sr({name:/^p|h\d+$/,styles:{"mso-list":/.*/}}),_=[];for(const j of o)if(j.type==="elementStart"&&c.match(j.item)){const _e=OL(j.item);_.push({element:j.item,id:_e.id,order:_e.order,indent:_e.indent})}return _}function RL(h,e){const o=new RegExp(`@list l${h.id}:level${h.indent}\\s*({[^}]*)`,"gi"),c=/mso-level-number-format:([^;]*);/gi,_=o.exec(e);let j="decimal";if(_&&_[1]){const _e=c.exec(_[1]);_e&&_e[1]&&(j=_e[1].trim())}return{type:j!=="bullet"&&j!=="image"?"ol":"ul",style:j}}function ty(h,e,o){const c=e.parent,_=o.createElement(h.type),j=c.getChildIndex(e)+1;return o.insertChild(j,_,c),_}function NL(h,e){return ML(h,e),e.rename("li",h)}function OL(h){const e={},o=h.getStyle("mso-list");if(o){const c=o.match(/(^|\s+)l(\d+)/i),_=o.match(/\s*lfo(\d+)/i),j=o.match(/\s*level(\d+)/i);c&&_&&j&&(e.id=c[2],e.order=_[1],e.indent=j[1])}return e}function ML(h,e){const o=new Sr({name:"span",styles:{"mso-list":"Ignore"}}),c=e.createRangeIn(h);for(const _ of c)_.type==="elementStart"&&o.match(_.item)&&e.remove(_.item)}function jL(h,e){if(!h||h.id!==e.id)return!0;const o=e.element.previousSibling;return o?!LL(o):!0}function LL(h){return h.is("ol")||h.is("ul")}function DL(h,e){return h?e.indent-h.indent:e.indent-1}function FL(h,e){const o=h.getAncestors({parentFirst:!0});let c=null,_=0;for(const j of o)if((j.name==="ul"||j.name==="ol")&&_++,_===e){c=j;break}return c}const BL=/id=("|')docs-internal-guid-[-0-9a-f]+("|')/i;class zL{constructor(e){this.document=e}isActive(e){return BL.test(e)}execute(e){const o=new Xs(this.document);AL(e.content,o),IL(e.content,o)}}function VL(h){return ny(ny(h)).replace(/(<span\s+style=['"]mso-spacerun:yes['"]>[\s]*?)[\r\n]+(\s*<\/span>)/g,"$1$2").replace(/<span\s+style=['"]mso-spacerun:yes['"]><\/span>/g,"").replace(/ <\//g,"</").replace(/ <o:p><\/o:p>/g,"<o:p></o:p>").replace(/<o:p>(&nbsp;|\u00A0)<\/o:p>/g,"").replace(/>(\s*[\r\n]\s*)</g,"><")}function $L(h){h.querySelectorAll("span[style*=spacerun]").forEach(e=>{const o=e.childNodes&&e.childNodes[0]&&e.childNodes[0].data&&e.childNodes[0].data.length||0;e.innerHTML=Array(o+1).join(" ").substr(0,o)})}function ny(h){return h.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(e,o)=>o.length===1?" ":Array(o.length+1).join(" ").substr(0,o.length))}function UL(h){const e=new DOMParser;h=h.replace(/<!--\[if gte vml 1]>/g,"");const o=VL(GL(h)),c=e.parseFromString(o,"text/html");$L(c);const _=c.body.innerHTML,j=WL(c),_e=HL(c);return{body:j,bodyString:_,styles:_e.styles,stylesString:_e.stylesString}}function WL(h){const e=new vo(new um),o=new Fs(e,{blockFillerMode:"nbsp"}),c=h.createDocumentFragment(),_=h.body.childNodes;for(;_.length>0;)c.appendChild(_[0]);return o.domToView(c)}function HL(h){const e=[],o=[],c=Array.from(h.getElementsByTagName("style"));for(const _ of c)_.sheet&&_.sheet.cssRules&&_.sheet.cssRules.length&&(e.push(_.sheet),o.push(_.innerHTML));return{styles:e,stylesString:o.join(" ")}}function GL(h){const e=/<\/body>(.*?)(<\/html>|$)/,o=h.match(e);return o&&o[1]&&(h=h.slice(0,o.index)+h.slice(o.index).replace(o[1],"")),h}function qL(h,e){if(!h.childCount)return;const o=new Xs,c=YL(h,o);QL(c,h,o),JL(h,o);const _=XL(h,o);_.length&&eD(_,ZL(e),o)}function KL(h){return btoa(h.match(/\w{2}/g).map(e=>String.fromCharCode(parseInt(e,16))).join(""))}function YL(h,e){const o=e.createRangeIn(h),c=new Sr({name:/v:(.+)/}),_=[];for(const j of o){const _e=j.item,et=_e.previousSibling&&_e.previousSibling.name||null;c.match(_e)&&_e.getAttribute("o:gfxdata")&&et!=="v:shapetype"&&_.push(j.item.getAttribute("id"))}return _}function QL(h,e,o){const c=o.createRangeIn(e),_=new Sr({name:"img"}),j=[];for(const _e of c)if(_.match(_e.item)){const et=_e.item,nt=et.getAttribute("v:shapes")?et.getAttribute("v:shapes").split(" "):[];nt.length&&nt.every(st=>h.indexOf(st)>-1)?j.push(et):et.getAttribute("src")||j.push(et)}for(const _e of j)o.remove(_e)}function JL(h,e){const o=e.createRangeIn(h),c=new Sr({name:/v:(.+)/}),_=[];for(const j of o)c.match(j.item)&&_.push(j.item);for(const j of _)e.remove(j)}function XL(h,e){const o=e.createRangeIn(h),c=new Sr({name:"img"}),_=[];for(const j of o)c.match(j.item)&&j.item.getAttribute("src").startsWith("file://")&&_.push(j.item);return _}function ZL(h){if(!h)return[];const e=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,o=new RegExp("(?:("+e.source+"))([\\da-fA-F\\s]+)\\}","g"),c=h.match(o),_=[];if(c)for(const j of c){let _e=!1;j.includes("\\pngblip")?_e="image/png":j.includes("\\jpegblip")&&(_e="image/jpeg"),_e&&_.push({hex:j.replace(e,"").replace(/[^\da-fA-F]/g,""),type:_e})}return _}function eD(h,e,o){if(h.length===e.length)for(let c=0;c<h.length;c++){const _=`data:${e[c].type};base64,${KL(e[c].hex)}`;o.setAttribute("src",_,h[c])}}const tD=/<meta\s*name="?generator"?\s*content="?microsoft\s*word\s*\d+"?\/?>/i,nD=/xmlns:o="urn:schemas-microsoft-com/i;class iD{isActive(e){return tD.test(e)||nD.test(e)}execute(e){const{body:o,stylesString:c}=UL(e.dataTransfer.getData("text/html"));SL(o,c),qL(o,e.dataTransfer.getData("text/rtf")),e.content=o}}class rD extends Ut{static get pluginName(){return"PasteFromOffice"}static get requires(){return[Es]}init(){const e=this.editor,o=[];o.push(new iD),o.push(new zL(e.editing.view.document)),e.plugins.get("Clipboard").on("inputTransformation",(c,_)=>{if(_.isTransformedWithPasteFromOffice)return;const j=_.dataTransfer.getData("text/html"),_e=o.find(et=>et.isActive(j));_e&&(_e.execute(_),_.isTransformedWithPasteFromOffice=!0)},{priority:"high"})}}function ur(h,e){let o=e.parent;for(;o;){if(o.name===h)return o;o=o.parent}}function ir(h,e,o,c,_=1){e>_?c.setAttribute(h,e,o):c.removeAttribute(h,o)}function Ko(h,e,o={}){const c=h.createElement("tableCell",o);h.insertElement("paragraph",c),h.insert(c,e)}function ip(h,e){const o=e.parent.parent,c=parseInt(o.getAttribute("headingColumns")||0),{column:_}=h.getCellLocation(e);return!!c&&_<c}function sD(){return h=>{h.on("element:table",(e,o,c)=>{const _=o.viewItem;if(!c.consumable.test(_,{name:!0}))return;const{rows:j,headingRows:_e,headingColumns:et}=oD(_),nt={};et&&(nt.headingColumns=et),_e&&(nt.headingRows=_e);const st=c.writer.createElement("table",nt),at=c.splitToAllowedParent(st,o.modelCursor);if(at){if(c.writer.insert(st,at.position),c.consumable.consume(_,{name:!0}),j.length)j.forEach(ct=>c.convertItem(ct,c.writer.createPositionAt(st,"end")));else{const ct=c.writer.createElement("tableRow");c.writer.insert(ct,c.writer.createPositionAt(st,"end")),Ko(c.writer,c.writer.createPositionAt(ct,"end"))}o.modelRange=c.writer.createRange(c.writer.createPositionBefore(st),c.writer.createPositionAfter(st)),at.cursorParent?o.modelCursor=c.writer.createPositionAt(at.cursorParent,0):o.modelCursor=o.modelRange.end}})}}function iy(h){return e=>{e.on(`element:${h}`,(o,c,_)=>{const j=c.viewItem;if(!_.consumable.test(j,{name:!0}))return;const _e=_.writer.createElement("tableCell"),et=_.splitToAllowedParent(_e,c.modelCursor);if(!et)return;_.writer.insert(_e,et.position),_.consumable.consume(j,{name:!0});const nt=_.writer.createPositionAt(_e,0);_.convertChildren(j,nt),_e.childCount||_.writer.insertElement("paragraph",nt),c.modelRange=_.writer.createRange(_.writer.createPositionBefore(_e),_.writer.createPositionAfter(_e)),c.modelCursor=c.modelRange.end})}}function oD(h){const e={headingRows:0,headingColumns:0},o=[],c=[];let _;for(const j of Array.from(h.getChildren()))if(j.name==="tbody"||j.name==="thead"||j.name==="tfoot"){j.name==="thead"&&!_&&(_=j);const _e=Array.from(j.getChildren()).filter(et=>et.is("element","tr"));for(const et of _e)if(et.parent.name==="thead"&&et.parent===_)e.headingRows++,o.push(et);else{c.push(et);const nt=aD(et);nt>e.headingColumns&&(e.headingColumns=nt)}}return e.rows=[...o,...c],e}function aD(h){let e=0,o=0;const c=Array.from(h.getChildren()).filter(_=>_.name==="th"||_.name==="td");for(;o<c.length&&c[o].name==="th";){const _=c[o],j=parseInt(_.getAttribute("colspan")||1);e=e+j,o++}return e}class An{constructor(e,o={}){this.table=e,this.startRow=o.startRow||0,this.endRow=typeof o.endRow=="number"?o.endRow:void 0,this.includeSpanned=!!o.includeSpanned,this.column=typeof o.column=="number"?o.column:void 0,this._skipRows=new Set,this._row=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){const e=this.table.getChild(this._row);if(!e||this._isOverEndRow())return{done:!0};let o,c,_;if(this._isSpanned(this._row,this._column))o=this._getSpanned(this._row,this._column),c=!this.includeSpanned||this._shouldSkipRow()||this._shouldSkipColumn(),_=this._formatOutValue(o,this._column,!0);else{if(o=e.getChild(this._cellIndex),!o)return this._row++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next();const j=parseInt(o.getAttribute("colspan")||1),_e=parseInt(o.getAttribute("rowspan")||1);(j>1||_e>1)&&this._recordSpans(this._row,this._column,_e,j,o),this._nextCellAtColumn=this._column+j,c=this._shouldSkipRow()||this._shouldSkipColumn(),_=this._formatOutValue(o,this._column,!1,_e,j)}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,c?this.next():_}skipRow(e){this._skipRows.add(e)}_isOverEndRow(){return this.endRow!==void 0&&this._row>this.endRow}_formatOutValue(e,o,c,_=1,j=1){return{done:!1,value:{cell:e,row:this._row,column:o,isSpanned:c,rowspan:_,colspan:j,cellIndex:this._cellIndex}}}_shouldSkipRow(){const e=this._row<this.startRow,o=this._skipRows.has(this._row);return e||o}_shouldSkipColumn(){return this.column===void 0?!1:this.column!=this._column}_isSpanned(e,o){return this._spannedCells.has(e)?this._spannedCells.get(e).has(o):!1}_getSpanned(e,o){return this._spannedCells.get(e).get(o)}_recordSpans(e,o,c,_,j){for(let _e=o+1;_e<=o+_-1;_e++)this._markSpannedCell(e,_e,j);for(let _e=e+1;_e<e+c;_e++)for(let et=o;et<=o+_-1;et++)this._markSpannedCell(_e,et,j)}_markSpannedCell(e,o,c){this._spannedCells.has(e)||this._spannedCells.set(e,new Map),this._spannedCells.get(e).set(o,c)}}function lD(h,e){return e.setCustomProperty("table",!0,h),Bo(h,e,{hasSelectionHandle:!0})}function ry(h){return!!h.getCustomProperty("table")&&Hr(h)}function cD(h){const e=h.getSelectedElement();return e&&ry(e)?e:null}function uD(h){const e=ur("table",h.getFirstPosition());return e&&ry(e.parent)?e.parent:null}function rp(h){const e=[];for(const o of dD(h.getRanges())){const c=o.getContainedElement();c&&c.is("tableCell")&&e.push(c)}return e}function Zs(h){const e=[];for(const o of h.getRanges()){const c=ur("tableCell",o.start);c&&e.push(c)}return e}function Er(h){const e=rp(h);return e.length?e:Zs(h)}function dD(h){return Array.from(h).sort(hD)}function hD(h,e){const o=h.start,c=e.start;return o.isEqual(c)?0:o.isBefore(c)?-1:1}function sy(h={}){return e=>e.on("insert:table",(o,c,_)=>{const j=c.item;if(!_.consumable.consume(j,"insert"))return;_.consumable.consume(j,"attribute:headingRows:table"),_.consumable.consume(j,"attribute:headingColumns:table");const _e=h&&h.asWidget,et=_.writer.createContainerElement("figure",{class:"table"}),nt=_.writer.createContainerElement("table");_.writer.insert(_.writer.createPositionAt(et,0),nt);let st;_e&&(st=lD(et,_.writer));const at=new An(j),ct={headingRows:j.getAttribute("headingRows")||0,headingColumns:j.getAttribute("headingColumns")||0},dt=new Map;for(const kt of at){const{row:Ct,cell:Nt}=kt,Wt=Yo(py(Ct,ct),nt,_),tn=j.getChild(Ct),nn=dt.get(Ct)||hy(tn,Ct,Wt,_);dt.set(Ct,nn),_.consumable.consume(Nt,"insert");const un=_.writer.createPositionAt(nn,"end");sp(kt,ct,un,_,h)}const gt=_.mapper.toViewPosition(c.range.start);_.mapper.bindElements(j,_e?st:et),_.writer.insert(gt,_e?st:et)})}function oy(h={}){return e=>e.on("insert:tableRow",(o,c,_)=>{const j=c.item;if(!_.consumable.consume(j,"insert"))return;const _e=j.parent,et=_.mapper.toViewElement(_e),nt=wy(et),st=_e.getChildIndex(j),at=new An(_e,{startRow:st,endRow:st}),ct={headingRows:_e.getAttribute("headingRows")||0,headingColumns:_e.getAttribute("headingColumns")||0},dt=new Map;for(const gt of at){const kt=Yo(py(st,ct),nt,_),Ct=dt.get(st)||hy(j,st,kt,_);dt.set(st,Ct),_.consumable.consume(gt.cell,"insert");const Nt=_.writer.createPositionAt(Ct,"end");sp(gt,ct,Nt,_,h)}})}function ay(h={}){return e=>e.on("insert:tableCell",(o,c,_)=>{const j=c.item;if(!_.consumable.consume(j,"insert"))return;const _e=j.parent,et=_e.parent,nt=et.getChildIndex(_e),st=new An(et,{startRow:nt,endRow:nt}),at={headingRows:et.getAttribute("headingRows")||0,headingColumns:et.getAttribute("headingColumns")||0};for(const ct of st)if(ct.cell===j){const dt=_.mapper.toViewElement(_e),gt=_.writer.createPositionAt(dt,_e.getChildIndex(j));sp(ct,at,gt,_,h);return}})}function ly(h={}){const e=!!h.asWidget;return o=>o.on("attribute:headingRows:table",(c,_,j)=>{const _e=_.item;if(!j.consumable.consume(_.item,c.name))return;const et=j.mapper.toViewElement(_e),nt=wy(et),st=_.attributeOldValue,at=_.attributeNewValue;if(at>st){const dt=Array.from(_e.getChildren()).filter(({index:kt})=>ct(kt,st-1,at)),gt=Yo("thead",nt,j);_y(dt,gt,j,"end");for(const kt of dt)for(const Ct of kt.getChildren())uy(Ct,"th",j,e);gy("tbody",nt,j)}else{const dt=Array.from(_e.getChildren()).filter(({index:Nt})=>ct(Nt,at-1,st)).reverse(),gt=Yo("tbody",nt,j);_y(dt,gt,j,0);const kt=new An(_e,{startRow:at&&at-1,endRow:st-1}),Ct={headingRows:_e.getAttribute("headingRows")||0,headingColumns:_e.getAttribute("headingColumns")||0};for(const Nt of kt)dy(Nt,Ct,j,e);gy("thead",nt,j)}function ct(dt,gt,kt){return dt>gt&&dt<kt}})}function cy(h={}){const e=!!h.asWidget;return o=>o.on("attribute:headingColumns:table",(c,_,j)=>{const _e=_.item;if(!j.consumable.consume(_.item,c.name))return;const et={headingRows:_e.getAttribute("headingRows")||0,headingColumns:_e.getAttribute("headingColumns")||0},nt=_.attributeOldValue,st=_.attributeNewValue,at=(nt>st?nt:st)-1;for(const ct of new An(_e))ct.column>at||dy(ct,et,j,e)})}function fD(){return h=>h.on("remove:tableRow",(e,o,c)=>{e.stop();const _=c.writer,j=c.mapper,et=j.toViewPosition(o.position).getLastMatchingPosition(ct=>!ct.item.is("tr")).nodeAfter,nt=et.parent,st=_.createRangeOn(et),at=_.remove(st);for(const ct of _.createRangeIn(at).getItems())j.unbindViewElement(ct);nt.childCount||_.remove(_.createRangeOn(nt))},{priority:"higher"})}function uy(h,e,o,c){const _=o.writer,j=o.mapper.toViewElement(h);if(!j)return;let _e;if(c){const et=_.createEditableElement(e,j.getAttributes());_e=Ou(et,_),_.insert(_.createPositionAfter(j),_e),_.move(_.createRangeIn(j),_.createPositionAt(_e,0)),_.remove(_.createRangeOn(j))}else _e=_.rename(e,j);o.mapper.unbindViewElement(j),o.mapper.bindElements(h,_e)}function dy(h,e,o,c){const{cell:_}=h,j=fy(h,e),_e=o.mapper.toViewElement(_);_e&&_e.name!==j&&uy(_,j,o,c)}function sp(h,e,o,c,_){const j=_&&_.asWidget,_e=fy(h,e),et=j?Ou(c.writer.createEditableElement(_e),c.writer):c.writer.createContainerElement(_e),nt=h.cell,st=nt.getChild(0),at=nt.childCount===1&&st.name==="paragraph";if(c.writer.insert(o,et),at&&!mD(st)){const ct=nt.getChild(0),dt=c.writer.createPositionAt(et,"end");if(c.consumable.consume(ct,"insert"),_.asWidget){const gt=c.writer.createContainerElement("span",{style:"display:inline-block"});c.mapper.bindElements(ct,gt),c.writer.insert(dt,gt),c.mapper.bindElements(nt,et)}else c.mapper.bindElements(nt,et),c.mapper.bindElements(ct,et)}else c.mapper.bindElements(nt,et)}function hy(h,e,o,c){c.consumable.consume(h,"insert");const _=c.writer.createContainerElement("tr");c.mapper.bindElements(h,_);const j=h.parent.getAttribute("headingRows")||0,_e=j>0&&e>=j?e-j:e,et=c.writer.createPositionAt(o,_e);return c.writer.insert(et,_),_}function fy(h,e){const{row:o,column:c}=h,{headingColumns:_,headingRows:j}=e;return j&&j>o||_&&_>c?"th":"td"}function py(h,e){return h<e.headingRows?"thead":"tbody"}function Yo(h,e,o){const c=my(h,e);return c||pD(h,e,o)}function my(h,e){for(const o of e.getChildren())if(o.name==h)return o}function pD(h,e,o){const c=o.writer.createContainerElement(h),_=o.writer.createPositionAt(e,h=="tbody"?"end":0);return o.writer.insert(_,c),c}function gy(h,e,o){const c=my(h,e);c&&c.childCount===0&&o.writer.remove(o.writer.createRangeOn(c))}function _y(h,e,o,c){for(const _ of h){const j=o.mapper.toViewElement(_);j&&o.writer.move(o.writer.createRangeOn(j),o.writer.createPositionAt(e,c))}}function wy(h){for(const e of h.getChildren())if(e.name==="table")return e}function mD(h){return!![...h.getAttributeKeys()].length}class gD extends hn{refresh(){const e=this.editor.model,o=e.document.selection,c=e.schema,_=_D(o.getFirstPosition());this.isEnabled=c.checkChild(_,"table")}execute(e={}){const o=this.editor.model,c=o.document.selection,_=this.editor.plugins.get("TableUtils"),j=parseInt(e.rows)||2,_e=parseInt(e.columns)||2,et=zo(c,o);o.change(nt=>{const st=_.createTable(nt,j,_e);o.insertContent(st,et),nt.setSelection(nt.createPositionAt(st.getNodeByPath([0,0,0]),0))})}}function _D(h){const e=h.parent;return e===e.root?e:e.parent}class vy extends hn{constructor(e,o={}){super(e),this.order=o.order||"below"}refresh(){const e=this.editor.model.document.selection,o=ur("table",e.getFirstPosition());this.isEnabled=!!o}execute(){const e=this.editor,o=e.model.document.selection,c=e.plugins.get("TableUtils"),_=this.order==="above",j=_?o.getFirstPosition():o.getLastPosition(),nt=((_?o.getFirstRange():o.getLastRange()).getContainedElement()||ur("tableCell",j)).parent,st=nt.parent,at=st.getChildIndex(nt);c.insertRows(st,{rows:1,at:this.order==="below"?at+1:at})}}class by extends hn{constructor(e,o={}){super(e),this.order=o.order||"right"}refresh(){const e=this.editor.model.document.selection,o=ur("table",e.getFirstPosition());this.isEnabled=!!o}execute(){const e=this.editor,o=e.model.document.selection,c=e.plugins.get("TableUtils"),_=this.order==="left",j=_?o.getFirstPosition():o.getLastPosition(),et=(_?o.getFirstRange():o.getLastRange()).getContainedElement()||ur("tableCell",j),nt=et.parent.parent,{column:st}=c.getCellLocation(et);c.insertColumns(nt,{columns:1,at:_?st:st+1})}}class yy extends hn{constructor(e,o={}){super(e),this.direction=o.direction||"horizontally"}refresh(){const e=Er(this.editor.model.document.selection);this.isEnabled=e.length===1}execute(){const e=Er(this.editor.model.document.selection)[0],o=this.direction==="horizontally",c=this.editor.plugins.get("TableUtils");o?c.splitCellHorizontally(e,2):c.splitCellVertically(e,2)}}class Qo extends hn{constructor(e,o){super(e),this.direction=o.direction,this.isHorizontal=this.direction=="right"||this.direction=="left"}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,o=e.document,c=Zs(o.selection)[0],_=this.value,j=this.direction;e.change(_e=>{const et=j=="right"||j=="down",nt=et?c:_,st=et?_:c,at=st.parent;yD(st,nt,_e);const ct=this.isHorizontal?"colspan":"rowspan",dt=parseInt(c.getAttribute(ct)||1),gt=parseInt(_.getAttribute(ct)||1);_e.setAttribute(ct,dt+gt,nt),_e.setSelection(_e.createRangeIn(nt)),at.childCount||bD(at,_e)})}_getMergeableCell(){const o=this.editor.model.document,c=Zs(o.selection)[0];if(!c)return;const _=this.editor.plugins.get("TableUtils"),j=this.isHorizontal?wD(c,this.direction,_):vD(c,this.direction);if(!j)return;const _e=this.isHorizontal?"rowspan":"colspan",et=parseInt(c.getAttribute(_e)||1);if(parseInt(j.getAttribute(_e)||1)===et)return j}}function wD(h,e,o){const _=h.parent.parent,j=e=="right"?h.nextSibling:h.previousSibling,_e=(_.getAttribute("headingColumns")||0)>0;if(!j)return;const et=e=="right"?h:j,nt=e=="right"?j:h,{column:st}=o.getCellLocation(et),{column:at}=o.getCellLocation(nt),ct=parseInt(et.getAttribute("colspan")||1),dt=ip(o,et),gt=ip(o,nt);return _e&&dt!=gt?void 0:st+ct===at?j:void 0}function vD(h,e){const o=h.parent,c=o.parent,_=c.getChildIndex(o);if(e=="down"&&_===c.childCount-1||e=="up"&&_===0)return;const j=parseInt(h.getAttribute("rowspan")||1),_e=c.getAttribute("headingRows")||0,et=e=="down"&&_+j===_e,nt=e=="up"&&_===_e;if(_e&&(et||nt))return;const st=parseInt(h.getAttribute("rowspan")||1),at=e=="down"?_+st:_,ct=[...new An(c,{endRow:at})],gt=ct.find(Ct=>Ct.cell===h).column,kt=ct.find(({row:Ct,rowspan:Nt,column:Wt})=>Wt!==gt?!1:e=="down"?Ct===at:at===Ct+Nt);return kt&&kt.cell}function bD(h,e){const o=h.parent,c=o.getChildIndex(h);for(const{cell:_,row:j,rowspan:_e}of new An(o,{endRow:c}))j+_e-1>=c&&ir("rowspan",_e-1,_,e);e.remove(h)}function yD(h,e,o){ky(h)||(ky(e)&&o.remove(o.createRangeIn(e)),o.move(o.createRangeIn(h),o.createPositionAt(e,"end"))),o.remove(h)}function ky(h){return h.childCount==1&&h.getChild(0).is("paragraph")&&h.getChild(0).isEmpty}class kD extends hn{refresh(){const e=Er(this.editor.model.document.selection),o=e[0];if(o){const c=o.parent.parent,_=this.editor.plugins.get("TableUtils").getRows(c),_e=[...new An(c)].filter(st=>e.includes(st.cell)).map(st=>st.row),et=_e[0],nt=_e[_e.length-1];this.isEnabled=nt-et<_-1}else this.isEnabled=!1}execute(){const e=Er(this.editor.model.document.selection),o=xD(e),c=e[0],_=c.parent.parent,j=[...new An(_,{endRow:o.last})],_e=this.editor.model.createBatch(),et=CD(j,c);this.editor.model.enqueueChange(_e,st=>{st.setSelection(st.createSelection(_,"on"))});let nt;for(let st=o.last;st>=o.first;st--)this.editor.model.enqueueChange(_e,at=>{const ct=st;this._removeRow(ct,_,at,j),nt=ED(_,ct,et)});this.editor.model.enqueueChange(_e,st=>{st.setSelection(st.createPositionAt(nt,0))})}_removeRow(e,o,c,_){const j=new Map,_e=o.getChild(e),et=o.getAttribute("headingRows")||0;et&&e<et&&ir("headingRows",et-1,o,c,0),_.filter(({row:ct,rowspan:dt})=>ct===e&&dt>1).forEach(({column:ct,cell:dt,rowspan:gt})=>j.set(ct,{cell:dt,rowspanToSet:gt-1})),_.filter(({row:ct,rowspan:dt})=>ct<=e-1&&ct+dt>e).forEach(({cell:ct,rowspan:dt})=>ir("rowspan",dt-1,ct,c));const nt=e+1,st=new An(o,{includeSpanned:!0,startRow:nt,endRow:nt});let at;for(const{row:ct,column:dt,cell:gt}of[...st])if(j.has(dt)){const{cell:kt,rowspanToSet:Ct}=j.get(dt),Nt=at?c.createPositionAfter(at):c.createPositionAt(o.getChild(ct),0);c.move(c.createRangeOn(kt),Nt),ir("rowspan",Ct,kt,c),at=kt}else at=gt;c.remove(_e)}}function xD(h){const e=h.map(o=>o.parent.index).sort();return{first:e[0],last:e[e.length-1]}}function ED(h,e,o){const c=h.getChild(e)||h.getChild(h.childCount-1);let _=c.getChild(0),j=0;for(const _e of c.getChildren()){if(j>o)return _;_=_e,j+=parseInt(_e.getAttribute("colspan")||1)}return _}function CD(h,e){return h.find(c=>c.cell===e).column}class TD extends hn{refresh(){const e=Er(this.editor.model.document.selection),o=e[0];if(o){const c=o.parent.parent,_=this.editor.plugins.get("TableUtils").getColumns(c),_e=[...new An(c)].filter(st=>e.includes(st.cell)).map(st=>st.column).sort(),et=_e[0],nt=_e[_e.length-1];this.isEnabled=nt-et<_-1}else this.isEnabled=!1}execute(){const[e,o]=ID(this.editor.model.document.selection),c=e.parent.parent,_=[...new An(c)],j={first:_.find(et=>et.cell===e).column,last:_.find(et=>et.cell===o).column},_e=SD(_,e,o,j);this.editor.model.change(et=>{et.setSelection(et.createRangeOn(c)),AD(c,j,et);for(let nt=j.last;nt>=j.first;nt--)for(const{cell:st,column:at,colspan:ct}of _)if(at<=nt&&ct>1&&at+ct>nt)ir("colspan",ct-1,st,et);else if(at===nt){const dt=st.parent;et.remove(st),dt.childCount||et.remove(dt)}et.setSelection(et.createPositionAt(_e,0))})}}function AD(h,e,o){const c=h.getAttribute("headingColumns")||0;if(c&&e.first<=c){const _=Math.min(c-1,e.last)-e.first+1;o.setAttribute("headingColumns",c-_,h)}}function SD(h,e,o,c){return parseInt(o.getAttribute("colspan")||1)>1?o:e.previousSibling||o.nextSibling?o.nextSibling||e.previousSibling:c.first?h.reverse().find(({column:j})=>j<c.first).cell:h.reverse().find(({column:j})=>j>c.last).cell}function ID(h){const e=Er(h),o=e[0],c=e.pop(),_=[o,c];return o.isBefore(c)?_:_.reverse()}class PD extends hn{refresh(){const e=this.editor.model,o=Er(e.document.selection),c=o.length>0;this.isEnabled=c,this.value=c&&o.every(_=>this._isInHeading(_,_.parent.parent))}execute(e={}){const o=this.editor.model,c=Er(o.document.selection),_=c[0],j=c[c.length-1],_e=_.parent.parent,et=_e.getAttribute("headingRows")||0,[nt,st]=[_.parent.index,j.parent.index].sort();if(e.forceValue===this.value)return;const at=this.value?nt:st+1;o.change(ct=>{if(at){const dt=RD(_e,at,et);for(const gt of dt)ND(gt,at,ct)}ir("headingRows",at,_e,ct,0)})}_isInHeading(e,o){const c=parseInt(o.getAttribute("headingRows")||0);return!!c&&e.parent.index<c}}function RD(h,e,o){const c=[],_=e>o?o:0,j=e-1,_e=new An(h,{startRow:_,endRow:j});for(const{row:et,rowspan:nt,cell:st}of _e)nt>1&&et+nt>e&&c.push(st);return c}function ND(h,e,o){const c=h.parent,_=c.parent,j=c.index,_e=parseInt(h.getAttribute("rowspan")),et=e-j,nt={},st=_e-et;st>1&&(nt.rowspan=st);const at=parseInt(h.getAttribute("colspan")||1);at>1&&(nt.colspan=at);const ct=_.getChildIndex(c),dt=ct+et,gt=[...new An(_,{startRow:ct,endRow:dt,includeSpanned:!0})];let kt;for(const{row:Ct,column:Nt,cell:Wt,cellIndex:tn}of gt)if(Wt===h&&kt===void 0&&(kt=Nt),kt!==void 0&&kt===Nt&&Ct===dt){const nn=_.getChild(Ct),un=o.createPositionAt(nn,tn);Ko(o,un,nt)}ir("rowspan",et,h,o)}class OD extends hn{refresh(){const e=this.editor.model,o=Er(e.document.selection),c=this.editor.plugins.get("TableUtils"),_=o.length>0;this.isEnabled=_,this.value=_&&o.every(j=>ip(c,j))}execute(e={}){const o=this.editor.model,c=this.editor.plugins.get("TableUtils"),_=Er(o.document.selection),j=_[0],_e=_[_.length-1],nt=j.parent.parent,[st,at]=[c.getCellLocation(j).column,c.getCellLocation(_e).column].sort();if(e.forceValue===this.value)return;const ct=this.value?st:at+1;o.change(dt=>{ir("headingColumns",ct,nt,dt,0)})}}class xy extends Ut{static get pluginName(){return"TableUtils"}getCellLocation(e){const o=e.parent,c=o.parent,_=c.getChildIndex(o),j=new An(c,{startRow:_,endRow:_});for(const{cell:_e,row:et,column:nt}of j)if(_e===e)return{row:et,column:nt}}createTable(e,o,c){const _=e.createElement("table");return Jo(e,_,0,o,c),_}insertRows(e,o={}){const c=this.editor.model,_=o.at||0,j=o.rows||1;c.change(_e=>{const et=e.getAttribute("headingRows")||0;if(et>_&&_e.setAttribute("headingRows",et+j,e),_===0||_===e.childCount){Jo(_e,e,_,j,this.getColumns(e));return}const nt=new An(e,{endRow:_});let st=0;for(const{row:at,rowspan:ct,colspan:dt,cell:gt}of nt){const kt=at<_,Ct=at+ct>_;kt&&Ct&&_e.setAttribute("rowspan",ct+j,gt),at===_&&(st+=dt)}Jo(_e,e,_,j,st)})}insertColumns(e,o={}){const c=this.editor.model,_=o.at||0,j=o.columns||1;c.change(_e=>{const et=e.getAttribute("headingColumns");_<et&&_e.setAttribute("headingColumns",et+j,e);const nt=this.getColumns(e);if(_===0||nt===_){for(const at of e.getChildren())As(j,_e,_e.createPositionAt(at,_?"end":0));return}const st=new An(e,{column:_,includeSpanned:!0});for(const{row:at,cell:ct,cellIndex:dt}of st){const gt=parseInt(ct.getAttribute("rowspan")||1),kt=parseInt(ct.getAttribute("colspan")||1);if(ct.index!==_&&kt>1){if(_e.setAttribute("colspan",kt+j,ct),st.skipRow(at),gt>1)for(let Ct=at+1;Ct<at+gt;Ct++)st.skipRow(Ct)}else{const Ct=_e.createPositionAt(e.getChild(at),dt);As(j,_e,Ct)}}})}splitCellVertically(e,o=2){const c=this.editor.model,j=e.parent.parent,_e=parseInt(e.getAttribute("rowspan")||1),et=parseInt(e.getAttribute("colspan")||1);c.change(nt=>{if(et>1){const{newCellsSpan:st,updatedSpan:at}=Ey(et,o);ir("colspan",at,e,nt);const ct={};st>1&&(ct.colspan=st),_e>1&&(ct.rowspan=_e);const dt=et>o?o-1:et-1;As(dt,nt,nt.createPositionAfter(e),ct)}if(et<o){const st=o-et,at=[...new An(j)],{column:ct}=at.find(({cell:Ct})=>Ct===e),dt=at.filter(({cell:Ct,colspan:Nt,column:Wt})=>{const tn=Ct!==e&&Wt===ct,nn=Wt<ct&&Wt+Nt>ct;return tn||nn});for(const{cell:Ct,colspan:Nt}of dt)nt.setAttribute("colspan",Nt+st,Ct);const gt={};_e>1&&(gt.rowspan=_e),As(st,nt,nt.createPositionAfter(e),gt);const kt=j.getAttribute("headingColumns")||0;kt>ct&&ir("headingColumns",kt+st,j,nt)}})}splitCellHorizontally(e,o=2){const c=this.editor.model,_=e.parent,j=_.parent,_e=j.getChildIndex(_),et=parseInt(e.getAttribute("rowspan")||1),nt=parseInt(e.getAttribute("colspan")||1);c.change(st=>{if(et>1){const at=[...new An(j,{startRow:_e,endRow:_e+et-1,includeSpanned:!0})],{newCellsSpan:ct,updatedSpan:dt}=Ey(et,o);ir("rowspan",dt,e,st);const{column:gt}=at.find(({cell:Ct})=>Ct===e),kt={};ct>1&&(kt.rowspan=ct),nt>1&&(kt.colspan=nt);for(const{column:Ct,row:Nt,cellIndex:Wt}of at){const tn=Nt>=_e+dt,nn=Ct===gt,un=(Nt+_e+dt)%ct===0;if(tn&&nn&&un){const rr=st.createPositionAt(j.getChild(Nt),Wt);As(1,st,rr,kt)}}}if(et<o){const at=o-et,ct=[...new An(j,{startRow:0,endRow:_e})];for(const{cell:kt,rowspan:Ct,row:Nt}of ct)if(kt!==e&&Nt+Ct>_e){const Wt=Ct+at;st.setAttribute("rowspan",Wt,kt)}const dt={};nt>1&&(dt.colspan=nt),Jo(st,j,_e+1,at,1,dt);const gt=j.getAttribute("headingRows")||0;gt>_e&&ir("headingRows",gt+at,j,st)}})}getColumns(e){return[...e.getChild(0).getChildren()].reduce((c,_)=>{const j=parseInt(_.getAttribute("colspan")||1);return c+j},0)}getRows(e){return e.childCount}}function Jo(h,e,o,c,_,j={}){for(let _e=0;_e<c;_e++){const et=h.createElement("tableRow");h.insert(et,e,o),As(_,h,h.createPositionAt(et,"end"),j)}}function As(h,e,o,c={}){for(let _=0;_<h;_++)Ko(e,o,c)}function Ey(h,e){if(h<e)return{newCellsSpan:1,updatedSpan:1};const o=Math.floor(h/e),c=h-o*e+o;return{newCellsSpan:o,updatedSpan:c}}function MD(h){h.document.registerPostFixer(e=>jD(e,h))}function jD(h,e){const o=e.document.differ.getChanges();let c=!1;const _=new Set;for(const j of o){let _e;j.name=="table"&&j.type=="insert"&&(_e=j.position.nodeAfter),(j.name=="tableRow"||j.name=="tableCell")&&(_e=ur("table",j.position)),zD(j)&&(_e=ur("table",j.range.start)),_e&&!_.has(_e)&&(c=LD(_e,h)||c,c=DD(_e,h)||c,_.add(_e))}return c}function LD(h,e){let o=!1;const c=FD(h);if(c.length){o=!0;for(const _ of c)ir("rowspan",_.rowspan,_.cell,e,1)}return o}function DD(h,e){let o=!1;const c=BD(h),_=c[0];if(!Object.values(c).every(_e=>_e===_)){const _e=Object.values(c).reduce((et,nt)=>nt>et?nt:et,0);for(const[et,nt]of Object.entries(c)){const st=_e-nt;if(st){for(let at=0;at<st;at++)Ko(e,e.createPositionAt(h.getChild(et),"end"));o=!0}}}return o}function FD(h){const e=parseInt(h.getAttribute("headingRows")||0),o=h.childCount,c=[];for(const{row:_,rowspan:j,cell:_e}of new An(h)){if(j<2)continue;const nt=_<e?e:o;if(_+j>nt){const st=nt-_;c.push({cell:_e,rowspan:st})}}return c}function BD(h){const e={};for(const{row:o}of new An(h,{includeSpanned:!0}))e[o]||(e[o]=0),e[o]+=1;return e}function zD(h){const e=h.type==="attribute",o=h.attributeKey;return e&&(o==="headingRows"||o==="colspan"||o==="rowspan")}function VD(h){h.document.registerPostFixer(e=>$D(e,h))}function $D(h,e){const o=e.document.differ.getChanges();let c=!1;for(const _ of o)_.type=="insert"&&_.name=="table"&&(c=UD(_.position.nodeAfter,h)||c),_.type=="insert"&&_.name=="tableRow"&&(c=Cy(_.position.nodeAfter,h)||c),_.type=="insert"&&_.name=="tableCell"&&(c=op(_.position.nodeAfter,h)||c),WD(_)&&(c=op(_.position.parent,h)||c);return c}function UD(h,e){let o=!1;for(const c of h.getChildren())o=Cy(c,e)||o;return o}function Cy(h,e){let o=!1;for(const c of h.getChildren())o=op(c,e)||o;return o}function op(h,e){if(h.childCount==0)return e.insertElement("paragraph",h),!0;const o=Array.from(h.getChildren()).filter(c=>c.is("text"));for(const c of o)e.wrap(e.createRangeOn(c),"paragraph");return!!o.length}function WD(h){return!h.position||!h.position.parent.is("tableCell")?!1:h.type=="insert"&&h.name=="$text"||h.type=="remove"}function HD(h){h.document.registerPostFixer(()=>GD(h))}function GD(h){const e=h.document.differ,o=new Set;for(const c of e.getChanges()){const _=c.type=="insert"||c.type=="remove"?c.position.parent:c.range.start.parent;_.is("tableCell")&&qD(_,c.type)&&o.add(_)}if(o.size){for(const c of o.values())e.refreshItem(c);return!0}return!1}function qD(h,e){if(!Array.from(h.getChildren()).some(c=>c.is("paragraph")))return!1;if(e=="attribute"){const c=Array.from(h.getChild(0).getAttributeKeys()).length;return h.childCount===1&&c<2}return h.childCount<=(e=="insert"?2:1)}a(85);class KD extends Ut{static get pluginName(){return"TableEditing"}init(){const e=this.editor,o=e.model,c=o.schema,_=e.conversion;c.register("table",{allowWhere:"$block",allowAttributes:["headingRows","headingColumns"],isLimit:!0,isObject:!0,isBlock:!0}),c.register("tableRow",{allowIn:"table",isLimit:!0}),c.register("tableCell",{allowIn:"tableRow",allowAttributes:["colspan","rowspan"],isObject:!0}),c.extend("$block",{allowIn:"tableCell"}),c.addChildCheck((j,_e)=>{if(_e.name=="table"&&Array.from(j.getNames()).includes("table"))return!1}),_.for("upcast").add(sD()),_.for("editingDowncast").add(sy({asWidget:!0})),_.for("dataDowncast").add(sy()),_.for("upcast").elementToElement({model:"tableRow",view:"tr"}),_.for("editingDowncast").add(oy({asWidget:!0})),_.for("dataDowncast").add(oy()),_.for("downcast").add(fD()),_.for("upcast").add(iy("td")),_.for("upcast").add(iy("th")),_.for("editingDowncast").add(ay({asWidget:!0})),_.for("dataDowncast").add(ay()),_.attributeToAttribute({model:"colspan",view:"colspan"}),_.attributeToAttribute({model:"rowspan",view:"rowspan"}),_.for("editingDowncast").add(cy({asWidget:!0})),_.for("dataDowncast").add(cy()),_.for("editingDowncast").add(ly({asWidget:!0})),_.for("dataDowncast").add(ly()),e.commands.add("insertTable",new gD(e)),e.commands.add("insertTableRowAbove",new vy(e,{order:"above"})),e.commands.add("insertTableRowBelow",new vy(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new by(e,{order:"left"})),e.commands.add("insertTableColumnRight",new by(e,{order:"right"})),e.commands.add("removeTableRow",new kD(e)),e.commands.add("removeTableColumn",new TD(e)),e.commands.add("splitTableCellVertically",new yy(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new yy(e,{direction:"horizontally"})),e.commands.add("mergeTableCellRight",new Qo(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new Qo(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new Qo(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new Qo(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new OD(e)),e.commands.add("setTableRowHeader",new PD(e)),MD(o),HD(o),VD(o),this.editor.keystrokes.set("Tab",(...j)=>this._handleTabOnSelectedTable(...j),{priority:"low"}),this.editor.keystrokes.set("Tab",this._getTabHandler(!0),{priority:"low"}),this.editor.keystrokes.set("Shift+Tab",this._getTabHandler(!1),{priority:"low"})}static get requires(){return[xy]}_handleTabOnSelectedTable(e,o){const c=this.editor,_=c.model.document.selection;if(!_.isCollapsed&&_.rangeCount===1&&_.getFirstRange().isFlat){const j=_.getSelectedElement();if(!j||!j.is("table"))return;o(),c.model.change(_e=>{_e.setSelection(_e.createRangeIn(j.getChild(0).getChild(0)))})}}_getTabHandler(e){const o=this.editor;return(c,_)=>{const j=o.model.document.selection,_e=Zs(j)[0];if(!_e)return;_();const et=_e.parent,nt=et.parent,st=nt.getChildIndex(et),at=et.getChildIndex(_e),ct=at===0;if(!e&&ct&&st===0)return;const dt=at===et.childCount-1,gt=st===nt.childCount-1;if(e&&gt&&dt&&(o.execute("insertTableRowBelow"),st===nt.childCount-1))return;let kt;if(e&&dt)kt=nt.getChild(st+1).getChild(0);else if(!e&&ct){const Ct=nt.getChild(st-1);kt=Ct.getChild(Ct.childCount-1)}else kt=et.getChild(at+(e?1:-1));o.model.change(Ct=>{Ct.setSelection(Ct.createRangeIn(kt))})}}}a(87);class YD extends sn{constructor(e){super(e);const o=this.bindTemplate;this.items=this.createCollection(),this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",(c,_)=>`${_}  ${c}`),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},children:this.items},{tag:"div",attributes:{class:["ck-insert-table-dropdown__label"]},children:[{text:o.to("label")}]}],on:{mousedown:o.to(c=>{c.preventDefault()}),click:o.to(()=>{this.fire("execute")})}});for(let c=0;c<100;c++){const _=new QD;_.on("over",()=>{const j=Math.floor(c/10),_e=c%10;this.set("rows",j+1),this.set("columns",_e+1)}),this.items.add(_)}this.on("change:columns",()=>{this._highlightGridBoxes()}),this.on("change:rows",()=>{this._highlightGridBoxes()})}focus(){}focusLast(){}_highlightGridBoxes(){const e=this.rows,o=this.columns;this.items.map((c,_)=>{const j=Math.floor(_/10),_e=_%10,et=j<e&&_e<o;c.set("isOn",et)})}}class QD extends sn{constructor(e){super(e);const o=this.bindTemplate;this.set("isOn",!1),this.setTemplate({tag:"div",attributes:{class:["ck-insert-table-dropdown-grid-box",o.if("isOn","ck-on")]},on:{mouseover:o.to("over")}})}}var JD='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v3h4V6H3zm0 4v3h4v-3H3zm0 4v3h4v-3H3zm5 3h4v-3H8v3zm5 0h4v-3h-4v3zm4-4v-3h-4v3h4zm0-4V6h-4v3h4zm1.5 8a1.5 1.5 0 0 1-1.5 1.5H3A1.5 1.5 0 0 1 1.5 17V4c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13zM12 13v-3H8v3h4zm0-4V6H8v3h4z"/></svg>',XD='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',ZD='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',e2='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>';class t2 extends Ut{init(){const e=this.editor,o=this.editor.t,_=e.locale.contentLanguageDirection==="ltr";e.ui.componentFactory.add("insertTable",j=>{const _e=e.commands.get("insertTable"),et=Ys(j);et.bind("isEnabled").to(_e),et.buttonView.set({icon:JD,label:o("q"),tooltip:!0});let nt;return et.on("change:isOpen",()=>{nt||(nt=new YD(j),et.panelView.children.add(nt),nt.delegate("execute").to(et),et.buttonView.on("open",()=>{nt.rows=0,nt.columns=0}),et.on("execute",()=>{e.execute("insertTable",{rows:nt.rows,columns:nt.columns}),e.editing.view.focus()}))}),et}),e.ui.componentFactory.add("tableColumn",j=>{const _e=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:o("r"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:_?"insertTableColumnLeft":"insertTableColumnRight",label:o("s")}},{type:"button",model:{commandName:_?"insertTableColumnRight":"insertTableColumnLeft",label:o("t")}},{type:"button",model:{commandName:"removeTableColumn",label:o("u")}}];return this._prepareDropdown(o("v"),XD,_e,j)}),e.ui.componentFactory.add("tableRow",j=>{const _e=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:o("w"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowBelow",label:o("x")}},{type:"button",model:{commandName:"insertTableRowAbove",label:o("y")}},{type:"button",model:{commandName:"removeTableRow",label:o("z")}}];return this._prepareDropdown(o("aa"),ZD,_e,j)}),e.ui.componentFactory.add("mergeTableCells",j=>{const _e=[{type:"button",model:{commandName:"mergeTableCellUp",label:o("ab")}},{type:"button",model:{commandName:_?"mergeTableCellRight":"mergeTableCellLeft",label:o("ac")}},{type:"button",model:{commandName:"mergeTableCellDown",label:o("ad")}},{type:"button",model:{commandName:_?"mergeTableCellLeft":"mergeTableCellRight",label:o("ae")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:o("af")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:o("ag")}}];return this._prepareDropdown(o("ah"),e2,_e,j)})}_prepareDropdown(e,o,c,_){const j=this.editor,_e=Ys(_),et=[],nt=new or;for(const st of c)n2(st,j,et,nt);return _w(_e,nt,j.ui.componentFactory),_e.buttonView.set({label:e,icon:o,tooltip:!0}),_e.bind("isEnabled").toMany(et,"isEnabled",(...st)=>st.some(at=>at)),this.listenTo(_e,"execute",st=>{j.execute(st.source.commandName),j.editing.view.focus()}),_e}}function n2(h,e,o,c){const _=h.model=new Hu(h.model),{commandName:j,bindIsOn:_e}=h.model;if(h.type==="button"||h.type==="switchbutton"){const et=e.commands.get(j);o.push(et),_.set({commandName:j}),_.bind("isEnabled").to(et),_e&&_.bind("isOn").to(et,"value")}_.set({withText:!0}),c.add(h)}class i2 extends Vr{constructor(e){super(e),this.domEventType=["mousemove","mouseup","mouseleave"]}onDomEvent(e){this.fire(e.type,e)}}function r2(h,e,o){const c=Array.from(h),_=c[0],j=c[c.length-1],{row:_e,column:et}=e.getCellLocation(_),nt=s2(c,et,o,e),{row:st,column:at}=e.getCellLocation(j),ct=at-et+1,dt=st-_e+1;a2(nt,ct,dt,o,e);const gt=ur("table",_);return l2(nt,gt,_e,et,o),nt}function s2(h,e,o,c){const _=o.createElement("table"),j=new Map,_e=new Map;for(const et of h){const nt=ur("tableRow",et);if(!j.has(nt)){const ct=nt._clone();o.append(ct,_),j.set(nt,ct)}const st=et._clone(!0),{column:at}=c.getCellLocation(et);_e.set(st,at),o.append(st,j.get(nt))}return o2(_,e,_e,o,c),_}function o2(h,e,o,c,_){for(const j of h.getChildren())for(const _e of Array.from(j.getChildren())){const{column:et}=_.getCellLocation(_e),st=o.get(_e)-e;if(et!==st)for(let at=0;at<st-et;at++){const ct=c.createElement("tableCell");c.insert(ct,c.createPositionBefore(_e));const dt=c.createElement("paragraph");c.insert(dt,ct,0),c.insertText("",dt,0)}}}function a2(h,e,o,c,_){for(const j of h.getChildren())for(const _e of j.getChildren()){const et=parseInt(_e.getAttribute("colspan")||1),nt=parseInt(_e.getAttribute("rowspan")||1),{row:st,column:at}=_.getCellLocation(_e);if(at+et>e){const ct=e-at;ct>1?c.setAttribute("colspan",ct,_e):c.removeAttribute("colspan",_e)}if(st+nt>o){const ct=o-st;ct>1?c.setAttribute("rowspan",ct,_e):c.removeAttribute("rowspan",_e)}}}function l2(h,e,o,c,_){const j=parseInt(e.getAttribute("headingRows")||0);if(j>0){const et=j-o;_.setAttribute("headingRows",et,h)}const _e=parseInt(e.getAttribute("headingColumns")||0);if(_e>0){const et=_e-c;_.setAttribute("headingColumns",et,h)}}a(89);class Ty extends Ut{static get pluginName(){return"TableSelection"}static get requires(){return[xy]}init(){const e=this.editor,o=e.model;this.listenTo(o,"deleteContent",(c,_)=>this._handleDeleteContent(c,_),{priority:"high"}),e.editing.view.addObserver(i2),this._defineSelectionConverter(),this._enableShiftClickSelection(),this._enableMouseDragSelection()}getSelectedTableCells(){const e=this.editor.model.document.selection,o=rp(e);return o.length==0?null:o}getSelectionAsFragment(){const e=this.getSelectedTableCells();return e?this.editor.model.change(o=>{const c=o.createDocumentFragment(),_=r2(e,this.editor.plugins.get("TableUtils"),o);return o.insert(_,c,0),c}):null}_defineSelectionConverter(){const e=this.editor,o=new Set;e.conversion.for("editingDowncast").add(_=>_.on("selection",(j,_e,et)=>{const nt=et.writer;c(nt);const st=this.getSelectedTableCells();if(!st)return;for(const ct of st){const dt=et.mapper.toViewElement(ct);nt.addClass("ck-editor__editable_selected",dt),o.add(dt)}const at=et.mapper.toViewElement(st[st.length-1]);nt.setSelection(at,0)},{priority:"lowest"}));function c(_){for(const j of o)_.removeClass("ck-editor__editable_selected",j);o.clear()}}_enableShiftClickSelection(){const e=this.editor;let o=!1;this.listenTo(e.editing.view.document,"mousedown",(c,_)=>{if(!this.isEnabled||!_.domEvent.shiftKey)return;const j=Zs(e.model.document.selection)[0];if(!j)return;const _e=this._getModelTableCellFromDomEvent(_);_e&&Ay(j,_e)&&(o=!0,this._setCellSelection(j,_e),_.preventDefault())}),this.listenTo(e.editing.view.document,"mouseup",()=>{o=!1}),this.listenTo(e.editing.view.document,"selectionChange",c=>{o&&c.stop()},{priority:"highest"})}_enableMouseDragSelection(){const e=this.editor;let o,c,_=!1,j=!1;this.listenTo(e.editing.view.document,"mousedown",(_e,et)=>{this.isEnabled&&(et.domEvent.shiftKey||et.domEvent.ctrlKey||et.domEvent.altKey||(o=this._getModelTableCellFromDomEvent(et)))}),this.listenTo(e.editing.view.document,"mousemove",(_e,et)=>{if(!et.domEvent.buttons||!o)return;const nt=this._getModelTableCellFromDomEvent(et);nt&&Ay(o,nt)&&(c=nt,!_&&c!=o&&(_=!0)),_&&(j=!0,this._setCellSelection(o,c),et.preventDefault())}),this.listenTo(e.editing.view.document,"mouseup",()=>{_=!1,j=!1,o=null,c=null}),this.listenTo(e.editing.view.document,"selectionChange",_e=>{j&&_e.stop()},{priority:"highest"})}_handleDeleteContent(e,o){const[c,_]=o,j=this.editor.model,_e=!_||_.direction=="backward",et=rp(c);et.length&&(e.stop(),j.change(nt=>{const st=et[_e?et.length-1:0];j.change(ct=>{for(const dt of et)j.deleteContent(ct.createSelection(dt,"in"))});const at=j.schema.getNearestSelectionRange(nt.createPositionAt(st,0));at&&(c.is("documentSelection")?nt.setSelection(at):c.setTo(at))}))}_setCellSelection(e,o){const c=this._getCellsToSelect(e,o);this.editor.model.change(_=>{_.setSelection(c.cells.map(j=>_.createRangeOn(j)),{backward:c.backward})})}_getModelTableCellFromDomEvent(e){const o=e.target,c=this.editor.editing.view.createPositionAt(o,0),j=this.editor.editing.mapper.toModelPosition(c).parent;if(j)return j.is("tableCell")?j:ur("tableCell",j)}_getCellsToSelect(e,o){const c=this.editor.plugins.get("TableUtils"),_=c.getCellLocation(e),j=c.getCellLocation(o),_e=Math.min(_.row,j.row),et=Math.max(_.row,j.row),nt=Math.min(_.column,j.column),st=Math.max(_.column,j.column),at=[];for(const ct of new An(ur("table",e),{startRow:_e,endRow:et}))ct.column>=nt&&ct.column<=st&&at.push(ct.cell);return c2(_,j)?{cells:at.reverse(),backward:!0}:{cells:at,backward:!1}}}function c2(h,e){return h.row>e.row||h.row==e.row&&h.column>e.column}function Ay(h,e){return h.parent.parent==e.parent.parent}class u2 extends Ut{static get pluginName(){return"TableClipboard"}static get requires(){return[Ty]}init(){const o=this.editor.editing.view.document;this.listenTo(o,"copy",(c,_)=>this._onCopyCut(c,_)),this.listenTo(o,"cut",(c,_)=>this._onCopyCut(c,_))}_onCopyCut(e,o){const c=this.editor.plugins.get("TableSelection");if(!c.getSelectedTableCells()||e.name=="cut"&&this.editor.isReadOnly)return;o.preventDefault(),e.stop();const _=this.editor.data,j=this.editor.editing.view.document,_e=_.toView(c.getSelectionAsFragment());j.fire("clipboardOutput",{dataTransfer:o.dataTransfer,content:_e,method:e.name})}}a(91);class d2 extends Ut{static get requires(){return[KD,t2,Ty,u2,$o]}static get pluginName(){return"Table"}}class h2 extends Ut{static get requires(){return[Go]}static get pluginName(){return"TableToolbar"}afterInit(){const e=this.editor,o=e.t,c=e.plugins.get(Go),_=e.config.get("table.contentToolbar"),j=e.config.get("table.tableToolbar");_&&c.register("tableContent",{ariaLabel:o("c"),items:_,getRelatedElement:uD}),j&&c.register("table",{ariaLabel:o("c"),items:j,getRelatedElement:cD})}}class f2{constructor(e,o={}){this.namespaces=o.namespaces||[],this._domParser=new DOMParser,this._domConverter=new Fs(e,{blockFillerMode:"nbsp"}),this._htmlWriter=new K_}toData(e){const o=this._domConverter.viewToDom(e,document);return this._htmlWriter.getHtml(o)}toView(e){const o=this._toDom(e);return this._domConverter.domToView(o,{keepOriginalCase:!0})}_toDom(e){e=`<xml ${this.namespaces.map(et=>`xmlns:${et}="nsp"`).join(" ")}>${e}</xml>`;const c=this._domParser.parseFromString(e,"text/xml"),_=c.querySelector("parsererror");if(_)throw new Error("Parse error - "+_.textContent);const j=c.createDocumentFragment(),_e=c.documentElement.childNodes;for(;_e.length>0;)j.appendChild(_e[0]);return j}}class en{static get safeXmlCharactersEntities(){return{tagOpener:"&laquo;",tagCloser:"&raquo;",doubleQuote:"&uml;",realDoubleQuote:"&quot;"}}static get safeBadBlackboardCharacters(){return{ltElement:"mo</mo",gtElement:"mo>/mo",ampElement:"mo&/mo"}}static get safeGoodBlackboardCharacters(){return{ltElement:"molt;/mo",gtElement:"mogt;/mo",ampElement:"moamp;/mo"}}static get xmlCharacters(){return{id:"xmlCharacters",tagOpener:"<",tagCloser:">",doubleQuote:'"',ampersand:"&",quote:"'"}}static get safeXmlCharacters(){return{id:"safeXmlCharacters",tagOpener:"",tagCloser:"",doubleQuote:"",ampersand:"",quote:"`",realDoubleQuote:""}}}class fn{static isMathmlInAttribute(e,o){const et=`^['"][\\s]*=[\\s]*[\\w-]+('[\\s]*("[^"]*"|'[^']*')[\\s]*=[\\s]*[\\w-]+[\\s]*')*[\\s]+gmi<`,nt=new RegExp(et),at=e.substring(0,o).split("").reverse().join("");return nt.test(at)}static safeXmlDecode(e){let{tagOpener:o}=en.safeXmlCharactersEntities,{tagCloser:c}=en.safeXmlCharactersEntities,{doubleQuote:_}=en.safeXmlCharactersEntities,{realDoubleQuote:j}=en.safeXmlCharactersEntities;e=e.split(o).join(en.safeXmlCharacters.tagOpener),e=e.split(c).join(en.safeXmlCharacters.tagCloser),e=e.split(_).join(en.safeXmlCharacters.doubleQuote),e=e.split(j).join(en.safeXmlCharacters.realDoubleQuote);const{ltElement:_e}=en.safeBadBlackboardCharacters,{gtElement:et}=en.safeBadBlackboardCharacters,{ampElement:nt}=en.safeBadBlackboardCharacters;"_wrs_blackboard"in window&&window._wrs_blackboard&&(e=e.split(_e).join(en.safeGoodBlackboardCharacters.ltElement),e=e.split(et).join(en.safeGoodBlackboardCharacters.gtElement),e=e.split(nt).join(en.safeGoodBlackboardCharacters.ampElement)),{tagOpener:o}=en.safeXmlCharacters,{tagCloser:c}=en.safeXmlCharacters,{doubleQuote:_}=en.safeXmlCharacters,{realDoubleQuote:j}=en.safeXmlCharacters;const{ampersand:st}=en.safeXmlCharacters,{quote:at}=en.safeXmlCharacters;e=e.split(o).join(en.xmlCharacters.tagOpener),e=e.split(c).join(en.xmlCharacters.tagCloser),e=e.split(_).join(en.xmlCharacters.doubleQuote),e=e.split(st).join(en.xmlCharacters.ampersand),e=e.split(at).join(en.xmlCharacters.quote);let ct="",dt=null;for(let gt=0;gt<e.length;gt+=1){const kt=e.charAt(gt);dt==null?kt==="$"?dt="":ct+=kt:kt===";"?(ct+=`&${dt}`,dt=null):kt.match(/([a-zA-Z0-9#._-] | '-')/)?dt+=kt:(ct+=`$${dt}`,dt=null,gt-=1)}return ct}static safeXmlEncode(e){const{tagOpener:o}=en.xmlCharacters,{tagCloser:c}=en.xmlCharacters,{doubleQuote:_}=en.xmlCharacters,{ampersand:j}=en.xmlCharacters,{quote:_e}=en.xmlCharacters;return e=e.split(o).join(en.safeXmlCharacters.tagOpener),e=e.split(c).join(en.safeXmlCharacters.tagCloser),e=e.split(_).join(en.safeXmlCharacters.doubleQuote),e=e.split(j).join(en.safeXmlCharacters.ampersand),e=e.split(_e).join(en.safeXmlCharacters.quote),e}static mathMLEntities(e){let o="";for(let c=0;c<e.length;c+=1){const _=e.charAt(c);if(e.codePointAt(c)>128)o+=`&#${e.codePointAt(c)};`,e.codePointAt(c)>65535&&(c+=1);else if(_==="&"){const j=e.indexOf(";",c+1);if(j>=0){const _e=document.createElement("span");_e.innerHTML=e.substring(c,j+1),o+=`&#${At.fixedCharCodeAt(_e.textContent||_e.innerText,0)};`,c=j}else o+=_}else o+=_}return o}static addCustomEditorClassAttribute(e,o){let c="";const _=e.indexOf("<math");if(_===0){const j=e.indexOf(">");if(e.indexOf("class")===-1)return c=`${e.substr(_,j)} class="wrs_${o}">`,c+=e.substr(j+1,e.length),c}return e}static removeCustomEditorClassAttribute(e,o){return e.indexOf("class")===-1||e.indexOf(`wrs_${o}`)===-1?e:e.indexOf(`class="wrs_${o}"`)!==-1?e.replace(`class="wrs_${o}"`,""):e.replace(`wrs_${o}`,"")}static addAnnotation(e,o,c){const _=e.indexOf("<annotation");let j="";if(_!==-1){const _e=e.indexOf("</semantics>");j=`${e.substring(0,_e)}<annotation encoding="${c}">${o}</annotation>${e.substring(_e)}`}else if(fn.isEmpty(e)){const _e=e.indexOf("/>"),et=e.indexOf(">"),nt=et===_e?_e:et;j=`${e.substring(0,nt)}><semantics><annotation encoding="${c}">${o}</annotation></semantics></math>`}else{const _e=e.indexOf(">")+1,et=e.lastIndexOf("</math>"),nt=e.substring(_e,et);j=`${e.substring(0,_e)}<semantics>${nt}<annotation encoding="${c}">${o}</annotation></semantics></math>`}return j}static removeAnnotation(e,o){let c=e;const _=`<annotation encoding="${o}">`,j="</annotation>",_e=e.indexOf(_);if(_e!==-1){let et=!1,nt=e.indexOf("<annotation");for(;nt!==-1;)nt!==_e&&(et=!0),nt=e.indexOf("<annotation",nt+1);if(et){const at=e.indexOf(j,_e)+j.length;c=e.substring(0,_e)+e.substring(at)}else c=fn.removeSemantics(e)}return c}static removeSemantics(e){const o="</math>",c="<semantics>",_="<annotation";let j=e;const _e=e.indexOf(c);if(_e!==-1){const et=e.indexOf(_,_e+c.length);et!==-1&&(j=e.substring(0,_e)+e.substring(_e+c.length,et)+o)}return j}static removeSemanticsOcurrences(e,o=en.xmlCharacters){const c=`${o.tagOpener}math`,_=`${o.tagOpener}/math${o.tagCloser}`,j=`/${o.tagCloser}`,{tagCloser:_e}=o,et=`${o.tagOpener}semantics${o.tagCloser}`,nt=`${o.tagOpener}annotation encoding=`;let st="",at=e.indexOf(c),ct=0;for(;at!==-1;){st+=e.substring(ct,at);const dt=e.indexOf(_,at),gt=e.indexOf(j,at),kt=e.indexOf(_e,at);dt!==-1?ct=dt:gt===kt-1&&(ct=gt);const Ct=e.indexOf(et,at);if(Ct!==-1){const Nt=e.substring(at,Ct),Wt=e.indexOf(nt,at);if(Wt!==-1){const tn=Ct+et.length,nn=e.substring(tn,Wt);st+=Nt+nn+_,at=e.indexOf(c,at+c.length),ct+=_.length}else ct=at,at=e.indexOf(c,at+c.length)}else ct=at,at=e.indexOf(c,at+c.length)}return st+=e.substring(ct,e.length),st}static containClass(e,o){const c=e.indexOf("class");if(c===-1)return!1;const _=e.indexOf(">",c);return e.substring(c,_).indexOf(o)!==-1}static isEmpty(e){const o=">",c="/>",_=e.indexOf(o),j=e.indexOf(c);let _e=!1;if(j!==-1&&j===_-1&&(_e=!0),!_e){const nt=new RegExp("</(.+:)?math>").exec(e);nt&&(_e=_+1===nt.index)}return _e}static encodeProperties(e){const o=/\w+=".*?"/g,c=j=>{const _e=j.indexOf('"'),et=j.substring(_e+1,j.length-1),nt=At.htmlEntities(et);return`${j.substring(0,_e+1)}${nt}"`};return e.replace(o,c)}}class zt{static addConfiguration(e){Object.assign(zt.properties,e)}static get properties(){return zt._properties}static set properties(e){zt._properties=e}static get(e){return Object.prototype.hasOwnProperty.call(zt.properties,e)?zt.properties[e]:Object.prototype.hasOwnProperty.call(zt.properties,"_wrs_conf_")?zt.properties[`_wrs_conf_${e}`]:!1}static set(e,o){zt.properties[e]=o}static update(e,o){if(!zt.get(e))zt.set(e,o);else{const c=Object.assign(zt.get(e),o);zt.set(e,c)}}}zt._properties={};class Sy{constructor(){this.cache=[]}populate(e,o){this.cache[e]=o}get(e){return Object.prototype.hasOwnProperty.call(this.cache,e)?this.cache[e]:!1}}class wr{constructor(){this.listeners=[]}add(e){this.listeners.push(e)}fire(e,o){for(let c=0;c<this.listeners.length&&!o.cancelled;c+=1)this.listeners[c].eventName===e&&this.listeners[c].callback(o);return o.defaultPrevented}static newListener(e,o){const c={};return c.eventName=e,c.callback=o,c}}class Kt{static get listeners(){return Kt._listeners}static addListener(e){Kt.listeners.add(e)}static fireEvent(e,o){Kt.listeners.fire(e,o)}static get parameters(){return Kt._parameters}static set parameters(e){Kt._parameters=e}static get servicePaths(){return Kt._servicePaths}static set servicePaths(e){Kt._servicePaths=e}static setServicePath(e,o){Kt.servicePaths[e]=o}static getServicePath(e){return Kt.servicePaths[e]}static get integrationPath(){return Kt._integrationPath}static set integrationPath(e){Kt._integrationPath=e}static getServerURL(){const o=window.location.href.split("/");return`${o[0]}//${o[2]}`}static init(e){Kt.parameters=e;let o=Kt.createServiceURI("configurationjs"),c=Kt.createServiceURI("createimage"),_=Kt.createServiceURI("showimage"),j=Kt.createServiceURI("getmathml"),_e=Kt.createServiceURI("service");if(Kt.parameters.URI.indexOf("/")===0){const et=Kt.getServerURL();o=et+o,_=et+_,c=et+c,j=et+j,_e=et+_e}Kt.setServicePath("configurationjs",o),Kt.setServicePath("showimage",_),Kt.setServicePath("createimage",c),Kt.setServicePath("service",_e),Kt.setServicePath("getmathml",j),Kt.setServicePath("configurationjs",o),Kt.listeners.fire("onInit",{})}static getUrl(e,o){const c=window.location.toString().substr(0,window.location.toString().lastIndexOf("/")+1),_=At.createHttpRequest();return _?(typeof o>"u"||typeof o>"u"?_.open("GET",e,!1):e.substr(0,1)==="/"||e.substr(0,7)==="http://"||e.substr(0,8)==="https://"?_.open("POST",e,!1):_.open("POST",c+e,!1),typeof o<"u"&&o?(_.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),_.send(At.httpBuildQuery(o))):_.send(null),_.responseText):""}static getService(e,o,c){let _;if(c===!0){const j=`${Kt.getServicePath(e)}?${o}`;_=Kt.getUrl(j)}else{const j=Kt.getServicePath(e);_=Kt.getUrl(j,o)}return _}static getServerLanguageFromService(e){return e.indexOf(".php")!==-1?"php":e.indexOf(".aspx")!==-1?"aspx":e.indexOf("wirispluginengine")!==-1?"ruby":"java"}static createServiceURI(e){const o=Kt.serverExtension();return At.concatenateUrl(Kt.parameters.URI,e)+o}static serverExtension(){return Kt.parameters.server.indexOf("php")!==-1?".php":Kt.parameters.server.indexOf("aspx")!==-1?".aspx":""}}Kt._servicePaths={},Kt._integrationPath="",Kt._listeners=new wr,Kt._parameters={};class Bn{static get cache(){return Bn._cache}static set cache(e){Bn._cache=e}static getLatexFromMathML(e){const o=fn.removeSemantics(e),{cache:c}=Bn,_={service:"mathml2latex",mml:o},j=JSON.parse(Kt.getService("service",_));let _e="";if(j.status==="ok"){_e=j.result.text;const et=At.htmlEntities(_e),nt=fn.addAnnotation(e,et,"LaTeX");c.populate(_e,nt)}return _e}static getMathMLFromLatex(e,o){const c=Bn.cache;if(Bn.cache.get(e))return Bn.cache.get(e);const _={service:"latex2mathml",latex:e};o&&(_.saveLatex="");const j=JSON.parse(Kt.getService("service",_));let _e;if(j.status==="ok"){let et=j.result.text;et=et.split("\r").join("").split(`
`).join(" "),et.indexOf("semantics")===-1&&et.indexOf("annotation")===-1&&(et=fn.addAnnotation(et,e,"LaTeX")),_e=et,c.get(e)||c.populate(e,et)}else _e=`$$${e}$$`;return _e}static parseMathmlToLatex(e,o){let c="";const _=`${o.tagOpener}math`,j=`${o.tagOpener}/math${o.tagCloser}`,_e=`${o.tagOpener}annotation encoding=${o.doubleQuote}LaTeX${o.doubleQuote}${o.tagCloser}`,et=`${o.tagOpener}/annotation${o.tagCloser}`;let nt=e.indexOf(_),st=0,at,ct,dt;for(;nt!==-1;){if(c+=e.substring(st,nt),st=e.indexOf(j,nt),st===-1?st=e.length-1:st+=j.length,at=e.substring(nt,st),ct=at.indexOf(_e),ct!==-1){ct+=_e.length,dt=at.indexOf(et);let gt=at.substring(ct,dt);o===en.safeXmlCharacters&&(gt=fn.safeXmlDecode(gt)),c+=`$$${gt}$$`,Bn.cache.populate(gt,at)}else c+=at;nt=e.indexOf(_,st)}return c+=e.substring(st,e.length),c}static getLatexFromTextNode(e,o,c){const _={open:"$$",close:"$$"};(typeof c>"u"||c==null)&&(c=_);let j=e;for(;j.previousSibling&&j.previousSibling.nodeType===3;)j=j.previousSibling;function _e(dt,gt,kt){let Ct=dt.nodeValue.indexOf(kt,gt);for(;Ct===-1;){if(dt=dt.nextSibling,!dt)return null;Ct=dt.nodeValue?dt.nodeValue.indexOf(c.close):-1}return{node:dt,position:Ct}}function et(dt,gt,kt,Ct){if(dt===kt)return gt<=Ct;for(;dt&&dt!==kt;)dt=dt.nextSibling;return dt===kt}let nt,st={node:j,position:0};const at=c.open.length;do{if(nt=_e(st.node,st.position,c.open),nt==null||et(e,o,nt.node,nt.position)||(st=_e(nt.node,nt.position+at,c.close),st==null))return null;st.position+=at}while(et(st.node,st.position,e,o));let ct;if(nt.node===st.node)ct=nt.node.nodeValue.substring(nt.position+at,st.position-at);else{const dt=nt.position+at;ct=nt.node.nodeValue.substring(dt,nt.node.nodeValue.length);let gt=nt.node;do gt=gt.nextSibling,gt===st.node?ct+=st.node.nodeValue.substring(0,st.position-at):ct+=gt.nodeValue?gt.nodeValue:"";while(gt!==st.node)}return{latex:ct,startNode:nt.node,startPosition:nt.position,endNode:st.node,endPosition:st.position}}}Bn._cache=new Sy;var p2=a(13);class zn{constructor(){throw new Error("Static class StringManager can not be instantiated.")}static get(e){let{language:o}=this;return o in this.strings||(console.warn(`Unknown language ${o} set in StringManager.`),o="en"),e in this.strings[o]?this.strings[o][e]:(console.warn(`Unknown key ${e} in StringManager.`),e)}}zn.strings=p2,zn.language="en";class At{static fireEvent(e,o){if(document.createEvent){const _=document.createEvent("HTMLEvents");return _.initEvent(o,!0,!0),!e.dispatchEvent(_)}const c=document.createEventObject();return e.fireEvent(`on${o}`,c)}static addEvent(e,o,c){e.addEventListener?e.addEventListener(o,c,!0):e.attachEvent&&e.attachEvent(`on${o}`,c)}static removeEvent(e,o,c){e.removeEventListener?e.removeEventListener(o,c,!0):e.detachEvent&&e.detachEvent(`on${o}`,c)}static addElementEvents(e,o,c,_){o&&At.addEvent(e,"dblclick",j=>{const _e=j||window.event,et=_e.srcElement?_e.srcElement:_e.target;o(et,_e)}),c&&At.addEvent(e,"mousedown",j=>{const _e=j||window.event,et=_e.srcElement?_e.srcElement:_e.target;c(et,_e)}),_&&At.addEvent(e,"mouseup",j=>{const _e=j||window.event,et=_e.srcElement?_e.srcElement:_e.target;_(et,_e)})}static addClass(e,o){At.containsClass(e,o)||(e.className+=` ${o}`)}static containsClass(e,o){if(e==null||!("className"in e))return!1;const c=e.className.split(" ");for(let _=c.length-1;_>=0;_-=1)if(c[_]===o)return!0;return!1}static removeClass(e,o){let c="";const _=e.className.split(" ");for(let j=0;j<_.length;j+=1)_[j]!==o&&(c+=`${_[j]} `);e.className=c.trim()}static convertOldXmlinitialtextAttribute(e){const o="value=",c=e.indexOf("xmlinitialtext"),_=e.indexOf(o,c),j=e.charAt(_+o.length),_e=_+o.length+1,et=e.indexOf(j,_e),nt=e.substring(_e,et);let st=nt.split("").join("lt;");return st=st.split("").join("gt;"),st=st.split("&").join(""),st=st.split("").join("quot;"),e=e.split(nt).join(st),e}static createElement(e,o,c){o===void 0&&(o={}),c===void 0&&(c=document);let _;try{let j=`<${e}`;Object.keys(o).forEach(_e=>{j+=` ${_e}="${At.htmlEntities(o[_e])}"`}),j+=">",_=c.createElement(j)}catch{_=c.createElement(e),Object.keys(o).forEach(_e=>{_.setAttribute(_e,o[_e])})}return _}static createObject(e,o){o===void 0&&(o=document),e=e.split("<applet ").join('<span wirisObject="WirisApplet" ').split("<APPLET ").join('<span wirisObject="WirisApplet" '),e=e.split("</applet>").join("</span>").split("</APPLET>").join("</span>"),e=e.split("<param ").join('<br wirisObject="WirisParam" ').split("<PARAM ").join('<br wirisObject="WirisParam" '),e=e.split("</param>").join("</br>").split("</PARAM>").join("</br>");const c=At.createElement("div",{},o);c.innerHTML=e;function _(j){if(j.getAttribute&&j.getAttribute("wirisObject")==="WirisParam"){const _e={};for(let nt=0;nt<j.attributes.length;nt+=1)j.attributes[nt].nodeValue!==null&&(_e[j.attributes[nt].nodeName]=j.attributes[nt].nodeValue);const et=At.createElement("param",_e,o);et.NAME&&(et.name=et.NAME,et.value=et.VALUE),et.removeAttribute("wirisObject"),j.parentNode.replaceChild(et,j)}else if(j.getAttribute&&j.getAttribute("wirisObject")==="WirisApplet"){const _e={};for(let nt=0;nt<j.attributes.length;nt+=1)j.attributes[nt].nodeValue!==null&&(_e[j.attributes[nt].nodeName]=j.attributes[nt].nodeValue);const et=At.createElement("applet",_e,o);et.removeAttribute("wirisObject");for(let nt=0;nt<j.childNodes.length;nt+=1)_(j.childNodes[nt]),j.childNodes[nt].nodeName.toLowerCase()==="param"&&(et.appendChild(j.childNodes[nt]),nt-=1);j.parentNode.replaceChild(et,j)}else for(let _e=0;_e<j.childNodes.length;_e+=1)_(j.childNodes[_e])}return _(c),c.firstChild}static createObjectCode(e){if(typeof e>"u"||e===null)return null;if(e.nodeType===1){let o=`<${e.tagName}`;for(let c=0;c<e.attributes.length;c+=1)e.attributes[c].specified&&(o+=` ${e.attributes[c].name}="${At.htmlEntities(e.attributes[c].value)}"`);if(e.childNodes.length>0){o+=">";for(let c=0;c<e.childNodes.length;c+=1)o+=At.createObject(e.childNodes[c]);o+=`</${e.tagName}>`}else e.nodeName==="DIV"||e.nodeName==="SCRIPT"?o+=`></${e.tagName}>`:o+="/>";return o}return e.nodeType===3?At.htmlEntities(e.nodeValue):""}static concatenateUrl(e,o){let c="";return e.indexOf("/")!==e.length&&o.indexOf("/")!==0&&(c="/"),(e+c+o).replace(/([^:]\/)\/+/g,"$1")}static htmlEntities(e){return e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;")}static htmlEntitiesDecode(e){const o=document.createElement("textarea");return o.innerHTML=e,o.value}static createHttpRequest(){if(window.location.toString().substr(0,window.location.toString().lastIndexOf("/")+1).substr(0,7)==="file://")throw zn.get("exception_cross_site");if(typeof XMLHttpRequest<"u")return new XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP")}catch{try{return new ActiveXObject("Microsoft.XMLHTTP")}catch{return null}}}static httpBuildQuery(e){let o="";return Object.keys(e).forEach(c=>{e[c]!=null&&(o+=`${At.urlEncode(c)}=${At.urlEncode(e[c])}&`)}),o.substring(o.length-1)==="&"&&(o=o.substring(0,o.length-1)),o}static propertiesToString(e){const o=[];Object.keys(e).forEach(j=>{Object.prototype.hasOwnProperty.call(e,j)&&o.push(j)});const c=o.length;for(let j=0;j<c;j+=1)for(let _e=j+1;_e<c;_e+=1){const et=o[j],nt=o[_e];At.compareStrings(et,nt)>0&&(o[j]=nt,o[_e]=et)}let _="";for(let j=0;j<c;j+=1){const _e=o[j];_+=_e,_+="=";let et=e[_e];et=et.replace("\\","\\\\"),et=et.replace(`
`,"\\n"),et=et.replace("\r","\\r"),et=et.replace("	","\\t"),_+=et,_+=`
`}return _}static compareStrings(e,o){let c;const _=e.length,j=o.length,_e=_>j?j:_;for(c=0;c<_e;c+=1){const et=At.fixedCharCodeAt(e,c)-At.fixedCharCodeAt(o,c);if(et!==0)return et}return e.length-o.length}static fixedCharCodeAt(e,o){o=o||0;const c=e.charCodeAt(o);let _,j;if(c>=55296&&c<=56319){if(_=c,j=e.charCodeAt(o+1),Number.isNaN(j))throw zn.get("exception_high_surrogate");return(_-55296)*1024+(j-56320)+65536}return c>=56320&&c<=57343?!1:c}static urlToAssArray(e){let o;if(o=e.indexOf("?"),o>0){const _=e.substring(o+1).split("&"),j={};for(o=0;o<_.length;o+=1){const et=_[o].split("=");et.length>1&&(j[et[0]]=decodeURIComponent(et[1].replace(/\+/g," ")))}return j}return{}}static urlEncode(e){let o="";return o=encodeURIComponent(e),o}static getWIRISImageOutput(e,o,c){const _=At.createObject(e);if(_&&(_.className===zt.get("imageClassName")||_.getAttribute(zt.get("imageMathmlAttribute")))){if(!o)return e;const j=_.getAttribute(zt.get("imageMathmlAttribute"));let _e=fn.safeXmlDecode(j);return zt.get("saveHandTraces")||(_e=fn.removeAnnotation(_e,"application/json")),_e==null&&(_e=_.getAttribute("alt")),c?fn.safeXmlEncode(_e):_e}return e}static getNodeLength(e){const o={IMG:1,BR:1};if(e.nodeType===3)return e.nodeValue.length;if(e.nodeType===1){let c=o[e.nodeName.toUpperCase()];c===void 0&&(c=0);for(let _=0;_<e.childNodes.length;_+=1)c+=At.getNodeLength(e.childNodes[_]);return c}return 0}static getSelectedItem(e,o,c){let _;if(o?(_=e.contentWindow,_.focus()):(_=window,e.focus()),document.selection&&!c){const j=_.document.selection.createRange();if(j.parentElement){if(j.htmlText.length>0)return j.text.length===0?At.getSelectedItem(e,o,!0):null;_.document.execCommand("InsertImage",!1,"#");let _e=j.parentElement();_e.nodeName.toUpperCase()!=="IMG"&&(j.pasteHTML('<span id="wrs_openEditorWindow_temporalObject"></span>'),_e=_.document.getElementById("wrs_openEditorWindow_temporalObject"));let et,nt;return _e.nextSibling&&_e.nextSibling.nodeType===3?(et=_e.nextSibling,nt=0):_e.previousSibling&&_e.previousSibling.nodeType===3?(et=_e.previousSibling,nt=et.nodeValue.length):(et=_.document.createTextNode(""),_e.parentNode.insertBefore(et,_e),nt=0),_e.parentNode.removeChild(_e),{node:et,caretPosition:nt}}return j.length>1?null:{node:j.item(0)}}if(_.getSelection){let j;const _e=_.getSelection();try{j=_e.getRangeAt(0)}catch{j=_.document.createRange()}const et=j.startContainer;if(et.nodeType===3)return{node:et,caretPosition:j.startOffset};if(et!==j.endContainer)return null;if(et.nodeType===1){const nt=j.startOffset;if(et.childNodes[nt])return{node:et.childNodes[nt]}}}return null}static getSelectedItemOnTextarea(e){const o=document.createTextNode(e.value),c=Bn.getLatexFromTextNode(o,e.selectionStart);return c===null?null:{node:o,caretPosition:e.selectionStart,startPosition:c.startPosition,endPosition:c.endPosition}}static getElementsByNameFromString(e,o,c){const _=[];e=e.toLowerCase(),o=o.toLowerCase();let j=e.indexOf(`<${o} `);for(;j!==-1;){let _e;c?_e=">":_e=`</${o}>`;let et=e.indexOf(_e,j);et!==-1?(et+=_e.length,_.push({start:j,end:et})):et=j+1,j=e.indexOf(`<${o} `,et)}return _}static decode64(e){const st=e.charCodeAt(0);return st===43||st===45?62:st===47||st===95?63:st<48?-1:st<58?st-48+26+26:st<91?st-65:st<123?st-97+26:null}static b64ToByteArray(e,o){let c;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");const _=[];let j,_e;o?j=o:(e.charAt(e.length-2)==="="?_e=2:e.charAt(e.length-1)==="="?_e=1:_e=0,j=_e>0?e.length-4:e.length);let et;for(et=0;et<j;et+=4)c=At.decode64(e.charAt(et))<<18|At.decode64(e.charAt(et+1))<<12|At.decode64(e.charAt(et+2))<<6|At.decode64(e.charAt(et+3)),_.push(c>>16&255),_.push(c>>8&255),_.push(c&255);return _e&&(_e===2?(c=At.decode64(e.charAt(et))<<2|At.decode64(e.charAt(et+1))>>4,_.push(c&255)):_e===1&&(c=At.decode64(e.charAt(et))<<10|At.decode64(e.charAt(et+1))<<4|At.decode64(e.charAt(et+2))>>2,_.push(c>>8&255),_.push(c&255))),_}static readInt32(e){if(e.length<4)return!1;const o=e.splice(0,4);return o[0]<<24|o[1]<<16|o[2]<<8|o[3]<<0}static readByte(e){return e.shift()<<0}static readBytes(e,o,c){return e.splice(o,c)}static updateTextArea(e,o){if(e&&o)if(e.focus(),e.selectionStart!=null){const{selectionEnd:c}=e,_=e.value.substring(0,e.selectionStart),j=e.value.substring(c,e.value.length);e.value=_+o+j,e.selectionEnd=c+o.length}else{const c=document.selection.createRange();c.text=o}}static updateExistingTextOnTextarea(e,o,c,_){e.focus();const j=e.value.substring(0,c);e.value=j+o+e.value.substring(_,e.value.length),e.selectionEnd=c+o.length}static addArgument(e,o,c){let _;return e.indexOf("?")>0?_="&":_="?",`${e+_+o}=${c}`}}class er{static removeImgDataAttributes(e){const o=[],{attributes:c}=e;Object.keys(c).forEach(_=>{const j=c[_];j.name.indexOf("data-")===0&&o.push(j.name)}),o.forEach(_=>{e.removeAttribute(_)})}static clone(e,o){const c=zt.get("imageCustomEditorName");e.hasAttribute(c)||o.removeAttribute(c),[zt.get("imageMathmlAttribute"),c,"alt","height","width","style","src","role"].forEach(_e=>{const et=e.getAttribute(_e);et&&o.setAttribute(_e,et)})}static setImgSize(e,o,c){let _,j,_e,et;if(c)if(zt.get("imageFormat")==="svg")if(zt.get("saveMode")!=="base64")_=er.getMetricsFromSvgString(o);else{j=e.src.substr(e.src.indexOf("base64,")+7,e.src.length),et="",_e=At.b64ToByteArray(j,j.length);for(let dt=0;dt<_e.length;dt+=1)et+=String.fromCharCode(_e[dt]);_=er.getMetricsFromSvgString(et)}else j=e.src.substr(e.src.indexOf("base64,")+7,e.src.length),_e=At.b64ToByteArray(j,88),_=er.getMetricsFromBytes(_e);else _=At.urlToAssArray(o);let nt=_.cw;if(!nt)return;let st=_.ch,at=_.cb;const{dpi:ct}=_;ct&&(nt=nt*96/ct,st=st*96/ct,at=at*96/ct),e.width=nt,e.height=st,e.style.verticalAlign=`-${st-at}px`}static fixAfterResize(e){if(e.removeAttribute("style"),e.removeAttribute("width"),e.removeAttribute("height"),e.style.maxWidth="none",e.src.indexOf("data:image")!==-1)if(zt.get("imageFormat")==="svg"){const o=decodeURIComponent(e.src.substring(32,e.src.length));er.setImgSize(e,o,!0)}else{const o=e.src.substring(22,e.src.length);er.setImgSize(e,o,!0)}else er.setImgSize(e,e.src)}static getMetricsFromSvgString(e){let o=e.indexOf('height="'),c=e.indexOf('"',o+8,e.length);const _=e.substring(o+8,c);o=e.indexOf('width="'),c=e.indexOf('"',o+7,e.length);const j=e.substring(o+7,c);o=e.indexOf('wrs:baseline="'),c=e.indexOf('"',o+14,e.length);const _e=e.substring(o+14,c);if(typeof j<"u"){const et=[];return et.cw=j,et.ch=_,typeof _e<"u"&&(et.cb=_e),et}return[]}static getMetricsFromBytes(e){At.readBytes(e,0,8);let o,c,_,j,_e;for(;e.length>=4;)_=At.readInt32(e),_===1229472850?(o=At.readInt32(e),c=At.readInt32(e),At.readInt32(e),At.readByte(e)):_===1650545477?j=At.readInt32(e):_===1883789683&&(_e=At.readInt32(e),_e=Math.round(_e/39.37),At.readInt32(e),At.readByte(e)),At.readInt32(e);if(typeof o<"u"){const et=[];return et.cw=o,et.ch=c,et.dpi=_e,j&&(et.cb=j),et}return[]}}class Mr{static get cache(){return Mr._cache}static set cache(e){Mr._cache=e}static mathMLToAccessible(e,o,c){typeof o>"u"&&(o="en"),fn.containClass(e,"wrs_chemistry")&&(c.mode="chemistry");let _="";if(Mr.cache.get(e))_=Mr.cache.get(e);else{c.service="mathml2accessible",c.lang=o;const j=JSON.parse(Kt.getService("service",c));j.status!=="error"?(_=j.result.text,Mr.cache.populate(e,_)):_=zn.get("error_convert_accessibility")}return _}}Mr._cache=new Sy,a(93);class yn{static mathmlToImgObject(e,o,c,_){const j=e.createElement("img");j.align="middle",j.style.maxWidth="none";const _e=c||{};if(_e.mml=o,_e.lang=_,_e.metrics="true",_e.centerbaseline="false",zt.get("saveMode")==="base64"&&zt.get("base64savemode")==="default"&&(_e.base64=!0),j.className=zt.get("imageClassName"),o.indexOf('class="')!==-1){let et=o.substring(o.indexOf('class="')+7,o.length);et=et.substring(0,et.indexOf('"')),et=et.substring(4,et.length),j.setAttribute(zt.get("imageCustomEditorName"),et)}if(zt.get("wirisPluginPerformance")&&(zt.get("saveMode")==="xml"||zt.get("saveMode")==="safeXml")){let et=JSON.parse(yn.createShowImageSrc(_e,_));if(et.status==="warning")try{et=JSON.parse(Kt.getService("showimage",_e))}catch{return null}({result:et}=et),et.format==="png"?j.src=`data:image/png;base64,${et.content}`:j.src=`data:image/svg+xml;charset=utf8,${At.urlEncode(et.content)}`,j.setAttribute(zt.get("imageMathmlAttribute"),fn.safeXmlEncode(o)),er.setImgSize(j,et.content,!0),zt.get("enableAccessibility")&&(typeof et.alt>"u"?j.alt=Mr.mathMLToAccessible(o,_,_e):j.alt=et.alt)}else{const et=yn.createImageSrc(o,_e);j.setAttribute(zt.get("imageMathmlAttribute"),fn.safeXmlEncode(o)),j.src=et,er.setImgSize(j,et,zt.get("saveMode")==="base64"&&zt.get("base64savemode")==="default"),zt.get("enableAccessibility")&&(j.alt=Mr.mathMLToAccessible(o,_,_e))}return typeof yn.observer<"u"&&yn.observer.observe(j),j.setAttribute("role","math"),j}static createImageSrc(e,o){zt.get("saveMode")==="base64"&&zt.get("base64savemode")==="default"&&(o.base64=!0);let c=Kt.getService("createimage",o);if(c.indexOf("@BASE@")!==-1){const _=Kt.getServicePath("createimage").split("/");_.pop(),c=c.split("@BASE@").join(_.join("/"))}return c}static initParse(e,o){return e=yn.initParseSaveMode(e,o),yn.initParseEditMode(e)}static initParseSaveMode(e,o){return zt.get("saveMode")&&(e=Bn.parseMathmlToLatex(e,en.safeXmlCharacters),e=Bn.parseMathmlToLatex(e,en.xmlCharacters),e=yn.parseMathmlToImg(e,en.safeXmlCharacters,o),e=yn.parseMathmlToImg(e,en.xmlCharacters,o),zt.get("saveMode")==="base64"&&zt.get("base64savemode")==="image"&&(e=yn.codeImgTransform(e,"base642showimage"))),e}static initParseEditMode(e){if(zt.get("parseModes").indexOf("latex")!==-1){const o=At.getElementsByNameFromString(e,"img",!0),c='encoding="LaTeX">';let _=0;for(let j=0;j<o.length;j+=1){const _e=e.substring(o[j].start+_,o[j].end+_);if(_e.indexOf(` class="${zt.get("imageClassName")}"`)!==-1){let et=` ${zt.get("imageMathmlAttribute")}="`,nt=_e.indexOf(et);if(nt===-1&&(et=' alt="',nt=_e.indexOf(et)),nt!==-1){nt+=et.length;const st=_e.indexOf('"',nt),at=fn.safeXmlDecode(_e.substring(nt,st));let ct=at.indexOf(c);if(ct!==-1){ct+=c.length;const dt=at.indexOf("</annotation>",ct),gt=at.substring(ct,dt),kt=`$$${At.htmlEntitiesDecode(gt)}$$`,Ct=e.substring(0,o[j].start+_),Nt=e.substring(o[j].end+_);e=Ct+kt+Nt,_+=kt.length-(o[j].end-o[j].start)}}}}}return e}static endParse(e){const o=yn.endParseEditMode(e);return yn.endParseSaveMode(o)}static endParseEditMode(e){if(zt.get("parseModes").indexOf("latex")!==-1){let o="",c=0,_=e.indexOf("$$");for(;_!==-1;){if(o+=e.substring(c,_),c=e.indexOf("$$",_+2),c!==-1){const j=e.substring(_+2,c),_e=At.htmlEntitiesDecode(j);let et=Bn.getMathMLFromLatex(_e,!0);zt.get("saveHandTraces")||(et=fn.removeAnnotation(et,"application/json")),o+=et,c+=2}else o+="$$",c=_+2;_=e.indexOf("$$",c)}o+=e.substring(c,e.length),e=o}return e}static endParseSaveMode(e){return zt.get("saveMode")&&(zt.get("saveMode")==="safeXml"||zt.get("saveMode")==="xml"?e=yn.codeImgTransform(e,"img2mathml"):zt.get("saveMode")==="base64"&&zt.get("base64savemode")==="image"&&(e=yn.codeImgTransform(e,"img264"))),e}static createShowImageSrc(e,o){const c=[],_=["mml","color","centerbaseline","zoom","dpi","fontSize","fontFamily","defaultStretchy","backgroundColor","format"];_.forEach(et=>{const nt=_[et];typeof e[nt]<"u"&&(c[nt]=e[nt])});const j={};return Object.keys(e).forEach(et=>{et!=="mml"&&(j[et]=e[et])}),j.formula=com.wiris.js.JsPluginTools.md5encode(At.propertiesToString(c)),j.lang=typeof o>"u"?"en":o,j.version=zt.get("version"),Kt.getService("showimage",At.httpBuildQuery(j),!0)}static codeImgTransform(e,o){let c="",_=0;const j=/<img/gi,_e=j.source.length;for(;j.test(e);){const et=j.lastIndex-_e;c+=e.substring(_,et);let nt=et+1;for(;nt<e.length&&_<=et;){const kt=e.charAt(nt);if(kt==='"'||kt==="'"){const Ct=e.indexOf(kt,nt+1);Ct===-1?nt=e.length:nt=Ct}else kt===">"&&(_=nt+1);nt+=1}if(_<et)return c+=e.substring(et,e.length),c;let st=e.substring(et,_);const at=At.createObject(st);let ct=at.getAttribute(zt.get("imageMathmlAttribute")),dt,gt;if(o==="base642showimage")ct==null&&(ct=at.getAttribute("alt")),ct=fn.safeXmlDecode(ct),st=yn.mathmlToImgObject(document,ct,null,null),c+=At.createObjectCode(st);else if(o==="img2mathml")zt.get("saveMode")&&(zt.get("saveMode")==="safeXml"?(dt=!0,gt=!0):zt.get("saveMode")==="xml"&&(dt=!0,gt=!1)),c+=At.getWIRISImageOutput(st,dt,gt);else if(o==="img264"){ct===null&&(ct=at.getAttribute("alt")),ct=fn.safeXmlDecode(ct);const kt={};kt.base64="true",st=yn.mathmlToImgObject(document,ct,kt,null),er.setImgSize(st,st.src,!0),c+=At.createObjectCode(st)}}return c+=e.substring(_,e.length),c}static parseMathmlToImg(e,o,c){let _="";const j=`${o.tagOpener}math`,_e=`${o.tagOpener}/math${o.tagCloser}`;let et=e.indexOf(j),nt=0;for(;et!==-1;){_+=e.substring(nt,et);const st=e.indexOf(zt.get("imageMathmlAttribute"));if(nt=e.indexOf(_e,et),nt===-1?nt=e.length-1:st!==-1?nt+=e.indexOf("/>",et):nt+=_e.length,!fn.isMathmlInAttribute(e,et)&&st===-1){let at=e.substring(et,nt);at=o.id===en.safeXmlCharacters.id?fn.safeXmlDecode(at):fn.mathMLEntities(at),_+=At.createObjectCode(yn.mathmlToImgObject(document,at,null,c))}else _+=e.substring(et,nt);et=e.indexOf(j,nt)}return _+=e.substring(nt,e.length),_}}if(typeof MutationObserver<"u"){const h=new MutationObserver(e=>{e.forEach(o=>{o.oldValue===zt.get("imageClassName")&&o.attributeName==="class"&&o.target.className.indexOf(zt.get("imageClassName"))===-1&&(o.target.className=zt.get("imageClassName"))})});yn.observer=Object.create(h),yn.observer.Config={attributes:!0,attributeOldValue:!0},yn.observer.observe=function(o){Object.getPrototypeOf(this).observe(o,this.Config)}}class m2{constructor(){this.isContentChanged=!1,this.waitingForChanges=!1}setIsContentChanged(e){this.isContentChanged=e}getIsContentChanged(){return this.isContentChanged}setWaitingForChanges(e){this.waitingForChanges=e}caretPositionChanged(e){}clipboardChanged(e){}contentChanged(e){this.waitingForChanges===!0&&this.isContentChanged===!1&&(this.isContentChanged=!0)}styleChanged(e){}transformationReceived(e){}}class ap{constructor(e){if(this.editorAttributes={},"editorAttributes"in e)this.editorAttributes=e.editorAttributes;else throw new Error("ContentManager constructor error: editorAttributes property missed.");if(this.customEditors=null,"customEditors"in e&&(this.customEditors=e.customEditors),this.environment={},"environment"in e)this.environment=e.environment;else throw new Error("ContentManager constructor error: environment property missed");if(this.language="","language"in e)this.language=e.language;else throw new Error("ContentManager constructor error: language property missed");this.editorListener=new m2,this.editor=null,this.ua=navigator.userAgent.toLowerCase(),this.deviceProperties={},this.deviceProperties.isAndroid=this.ua.indexOf("android")>-1,this.deviceProperties.isIOS=this.ua.indexOf("ipad")>-1||this.ua.indexOf("iphone")>-1,this.toolbar=null,this.modalDialogInstance=null,this.listeners=new wr,this.mathML=null,this.isNewElement=!0,this.integrationModel=null,this.isEditorLoaded=!1}addListener(e){this.listeners.add(e)}setIntegrationModel(e){this.integrationModel=e}setModalDialogInstance(e){this.modalDialogInstance=e}insert(){this.updateTitle(this.modalDialogInstance),this.insertEditor(this.modalDialogInstance)}insertEditor(){if(window.com&&window.com.wiris&&window.com.wiris.jsEditor&&window.com.wiris.jsEditor.JsEditor&&window.com.wiris.jsEditor.JsEditor.newInstance){if(this.editor=window.com.wiris.jsEditor.JsEditor.newInstance(this.editorAttributes),this.editor.insertInto(this.modalDialogInstance.contentContainer),this.editor.focus(),this.modalDialogInstance.rtl&&this.editor.action("rtl"),this.editor.getEditorModel().isRTL()&&(this.editor.element.style.direction="rtl"),this.editor.getEditorModel().addEditorListener(this.editorListener),this.modalDialogInstance.deviceProperties.isIOS){setTimeout(function(){this.modalDialogInstance.hideKeyboard()},400);const e=document.getElementsByClassName("wrs_formulaDisplay")[0];At.addEvent(e,"focus",this.modalDialogInstance.handleOpenedIosSoftkeyboard),At.addEvent(e,"blur",this.modalDialogInstance.handleClosedIosSoftkeyboard)}this.listeners.fire("onLoad",{}),this.isEditorLoaded=!0}else setTimeout(ap.prototype.insertEditor.bind(this),100)}init(){const e=document.createElement("script");e.type="text/javascript";let o=zt.get("editorUrl");const c=document.createElement("a");c.href=o,window.location.href.indexOf("https://")===0&&c.protocol==="http:"&&(c.protocol="https:"),c.port==="80"||c.port==="443"?o=`${c.protocol}//${c.hostname}/${c.pathname}`:o=`${c.protocol}//${c.hostname}:${c.port}/${c.pathname}`;const _={};"editor"in this.environment?_.editor=this.environment.editor:_.editor="unknown","mode"in this.environment?_.mode=this.environment.mode:_.mode=zt.get("saveMode"),"version"in this.environment?_.version=this.environment.version:_.version=zt.get("version"),e.src=`${o}?lang=${this.language}&stats-editor=${_.editor}&stats-mode=${_.mode}&stats-version=${_.version}`,document.getElementsByTagName("head")[0].appendChild(e)}setInitialContent(){this.isNewElement||this.setMathML(this.mathML)}setMathML(e,o){typeof o>"u"&&(o=!1),this.editor.setMathMLWithCallback(e,()=>{this.editorListener.setWaitingForChanges(!0)}),setTimeout(()=>{this.editorListener.setIsContentChanged(!1)},500),o||this.onFocus()}onFocus(){typeof this.editor<"u"&&this.editor!=null&&this.editor.focus()}submitAction(){if(this.editor.isFormulaEmpty())this.integrationModel.updateFormula(null);else{let e=this.editor.getMathMLWithSemantics();if(this.customEditors.getActiveEditor()!==null){const{toolbar:c}=this.customEditors.getActiveEditor();e=fn.addCustomEditorClassAttribute(e,c)}else Object.keys(this.customEditors.editors).forEach(c=>{e=fn.removeCustomEditorClassAttribute(e,c)});const o=fn.mathMLEntities(e);this.integrationModel.updateFormula(o)}this.customEditors.disable(),this.integrationModel.notifyWindowClosed(),this.setEmptyMathML(),this.customEditors.disable()}setEmptyMathML(){this.deviceProperties.isAndroid||this.deviceProperties.isIOS?this.editor.getEditorModel().isRTL()?this.setMathML('<math dir="rtl"><semantics><annotation encoding="application/json">[]</annotation></semantics></math>',!0):this.setMathML('<math><semantics><annotation encoding="application/json">[]</annotation></semantics></math>',!0):this.editor.getEditorModel().isRTL()?this.setMathML('<math dir="rtl"/>',!0):this.setMathML("<math/>",!0)}onOpen(){this.isNewElement?this.setEmptyMathML():this.setMathML(this.mathML),this.updateToolbar(),this.onFocus()}updateToolbar(){this.updateTitle(this.modalDialogInstance);const e=this.customEditors.getActiveEditor();if(e){const o=e.toolbar?e.toolbar:_wrs_int_wirisProperties.toolbar;(this.toolbar==null||this.toolbar!==o)&&this.setToolbar(o)}else{const o=this.getToolbar();(this.toolbar==null||this.toolbar!==o)&&(this.setToolbar(o),this.customEditors.disable())}}updateTitle(){const e=this.customEditors.getActiveEditor();e?this.modalDialogInstance.setTitle(e.title):this.modalDialogInstance.setTitle("MathType")}getToolbar(){let e="general";return"toolbar"in this.editorAttributes&&({toolbar:e}=this.editorAttributes),e==="general"&&(e=typeof _wrs_int_wirisProperties>"u"||typeof _wrs_int_wirisProperties.toolbar>"u"?"general":_wrs_int_wirisProperties.toolbar),e}setToolbar(e){this.toolbar=e,this.editor.setParams({toolbar:this.toolbar})}hasChanges(){return!this.editor.isFormulaEmpty()&&this.editorListener.getIsContentChanged()}onKeyDown(e){if(e.key!==void 0&&e.repeat===!1)if(e.key==="Escape"||e.key==="Esc"){let o=document.getElementsByClassName("wrs_expandButton wrs_expandButtonFor3RowsLayout wrs_pressed");o.length===0&&(o=document.getElementsByClassName("wrs_expandButton wrs_expandButtonFor2RowsLayout wrs_pressed"),o.length===0&&(o=document.getElementsByClassName("wrs_select wrs_pressed"),o.length===0&&(this.modalDialogInstance.cancelAction(),e.stopPropagation(),e.preventDefault())))}else if(e.shiftKey&&e.key==="Tab")if(document.activeElement===this.modalDialogInstance.submitButton)this.editor.focus(),e.stopPropagation(),e.preventDefault();else{const o=document.querySelector('[title="Manual"]');document.activeElement===o&&(this.modalDialogInstance.cancelButton.focus(),e.stopPropagation(),e.preventDefault())}else e.key==="Tab"&&(document.activeElement===this.modalDialogInstance.cancelButton?(document.querySelector('[title="Manual"]').focus(),e.stopPropagation(),e.preventDefault()):document.getElementsByClassName("wrs_formulaDisplay")[0].getAttribute("class")==="wrs_formulaDisplay wrs_focused"&&(this.modalDialogInstance.submitButton.focus(),e.stopPropagation(),e.preventDefault()))}}class g2{constructor(){this.editors=[],this.activeEditor="default"}addEditor(e,o){const c={};c.name=o.name,c.toolbar=o.toolbar,c.icon=o.icon,c.confVariable=o.confVariable,c.title=o.title,c.tooltip=o.tooltip,this.editors[e]=c}enable(e){this.activeEditor=e}disable(){this.activeEditor="default"}getActiveEditor(){return this.activeEditor!=="default"?this.editors[this.activeEditor]:null}}var _2={imageCustomEditorName:"data-custom-editor",imageClassName:"Wirisformula",CASClassName:"Wiriscas"};class lp{constructor(){this.cancelled=!1,this.defaultPrevented=!1}cancel(){this.cancelled=!0}preventDefault(){this.defaultPrevented=!0}}class w2{constructor(e){this.overlayElement=e.overlayElement,this.callbacks=e.callbacks,this.overlayWrapper=this.overlayElement.appendChild(document.createElement("div")),this.overlayWrapper.setAttribute("class","wrs_popupmessage_overlay_envolture"),this.message=this.overlayWrapper.appendChild(document.createElement("div")),this.message.id="wrs_popupmessage",this.message.setAttribute("class","wrs_popupmessage_panel"),this.message.setAttribute("role","dialog"),this.message.setAttribute("aria-describedby","description_txt");const o=document.createElement("p"),c=document.createTextNode(e.strings.message);o.appendChild(c),o.id="description_txt",this.message.appendChild(o);const _=this.overlayWrapper.appendChild(document.createElement("div"));_.setAttribute("class","wrs_popupmessage_overlay"),_.addEventListener("click",this.cancelAction.bind(this)),this.buttonArea=this.message.appendChild(document.createElement("div")),this.buttonArea.setAttribute("class","wrs_popupmessage_button_area"),this.buttonArea.id="wrs_popup_button_area";const j={class:"wrs_button_accept",innerHTML:e.strings.submitString,id:"wrs_popup_accept_button"};this.closeButton=this.createButton(j,this.closeAction.bind(this)),this.buttonArea.appendChild(this.closeButton);const _e={class:"wrs_button_cancel",innerHTML:e.strings.cancelString,id:"wrs_popup_cancel_button"};this.cancelButton=this.createButton(_e,this.cancelAction.bind(this)),this.buttonArea.appendChild(this.cancelButton)}createButton(e,o){let c={};return c=document.createElement("button"),c.setAttribute("id",e.id),c.setAttribute("class",e.class),c.innerHTML=e.innerHTML,c.addEventListener("click",o),c}show(){this.overlayWrapper.style.display!=="block"?(document.activeElement.blur(),this.overlayWrapper.style.display="block",this.closeButton.focus()):(this.overlayWrapper.style.display="none",_wrs_modalWindow.focus())}cancelAction(){this.overlayWrapper.style.display="none",typeof this.callbacks.cancelCallback<"u"&&this.callbacks.cancelCallback()}closeAction(){this.cancelAction(),typeof this.callbacks.closeCallback<"u"&&this.callbacks.closeCallback()}onKeyDown(e){e.key!==void 0&&(e.key==="Escape"||e.key==="Esc"?(this.cancelAction(),e.stopPropagation(),e.preventDefault()):e.key==="Tab"&&(document.activeElement===this.closeButton?this.cancelButton.focus():this.closeButton.focus(),e.stopPropagation(),e.preventDefault()))}}var v2=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   viewBox="0 0 13.76 13.76"
   height="13.76"
   width="13.76"
   id="svg3783"
   version="1.1">
  <metadata
     id="metadata3789">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs3787" />
  <image
     y="0"
     x="0"
     id="image3791"
     xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAACXBIWXMAAC4jAAAuIwF4pT92AAAB
vklEQVRYw83Z23GDMBAF0AsNhBIowSVQgjuISnAJKSEdZNOBS6CDOBUkqSC4gs2PyGhAQg92se4M
4w8bccYW2hVumBmRdAB6ADfopQcw2SOYNoIkAL8APgB8AzgLI0/2S/iy1xkt3B9m9h0dM9/YHxM4
J/c4MfPkGX+y763OyYVKgUPQTXAJdC84Bg2CS6Gl4FSoF7wHmgvOhbrgzsW+8L4YJegccrEj749R
gs7ZXGdz8wbAeNbREcDTzrHvblEgBbAUFACuy6JALJeL0E/P9sbvmBnNojcgAM+oJ58AhrlnWM5Z
A+C9RmiokakBvIJuNTLSc7hojqY0Mo8EB6Ep2CPBm9BU7BHgKDQHqwlOguZiNcDJ0JLe4FV4iaLY
JjF16dLqnoob+EdDs8A1QJPBtUCTwDVBo+DaoJvgNvBIR6rDl9wirbA1QIPgVgl6VwHb+dAr7Jkk
S/Pg3mCkVOslxxV9yBFqSqTA/3N2Utkzye3pftw5OxzQ5tHeddcdzGj3o4VgClUwowgtAVOs3BpF
aA6YUnsDowhNAVNu12UUoVtgCn2+ifxp1wO42Ner4KPR5dJ2tsse2ZLvTQxbVf4AmC2z7WnSvpIA
AAAASUVORK5CYII=
"
     style="image-rendering:optimizeQuality"
     preserveAspectRatio="none"
     height="13.76"
     width="13.76" />
</svg>
`,b2=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   viewBox="0 0 13.76 13.76"
   height="13.76"
   width="13.76"
   id="svg2"
   version="1.1">
  <metadata
     id="metadata8">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs6" />
  <image
     y="0"
     x="0"
     id="image10"
     xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAACXBIWXMAAC4jAAAuIwF4pT92AAAB
2ElEQVRYw9XZoXPCMBTH8S+5KfDzQ29606CH3/SmQTO96aGHHn/F0Himh8eDZSblQknSJH2F0DtE
Qw8+12vyfulr7XY7LuW4qvj+DugD18AC+AE2woa+/mz07y9cF7Y8d7YPDEtjK2AsCB4BvdLYHPi0
XawioAA3wAfQaQiKHhuFYl1QSbAL6gWrSKgEuArqBKsEaB1wKNQKVsasHybcpRhwLNQED0zsoMbz
FwJOhWL6Cmzd2e0D14Wi1/k9di2wFNnAEtBifd9jv4GtIPgaeBOCAkzLFayr/6idWSSY6DJ8sHT9
6VK6zRFqKwo5gQ+grnKbA/gI6gsy5wRboT7sucBOaBX21GAvNAR7KnAlNBTbNDgIGoMtwO/C0Gko
NBZbN525tk+dJrAj4F4YGxXgVQS019DkCgarM0OjwCoDaDBYZQINAquMoJVglRnUC1YZQp1g1RB0
Jryn65jYJ0HoRGPHguDX8hsZ6VAiGX4eUrJBbHqSArdN7LLBmCcBnpvYWfHWo6E8Wge8Ar7Kj8E4
ARwcnBPBB20BE7uJBMdAU8BH/YvyBAsFp0BjwNZGi201qALXgYaAnR0hX2upAzwDj/p8raFL5I4u
8ALc6vNfvc+ztq5al9Rh/AfwZZ/LmlMllAAAAABJRU5ErkJggg==
"
     style="image-rendering:optimizeQuality"
     preserveAspectRatio="none"
     height="13.76"
     width="13.76" />
</svg>
`,y2=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   viewBox="0 0 13.76 13.76"
   height="13.76"
   width="13.76"
   id="svg3793"
   version="1.1">
  <metadata
     id="metadata3799">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs3797" />
  <image
     y="0"
     x="0"
     id="image3801"
     xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAAAXNSR0IArs4c6QAAAARnQU1BAACx
jwv8YQUAAAAJcEhZcwAALiMAAC4jAXilP3YAAAG4SURBVFhHvZnhUYNAEEbRBkwH2oGUkA40FWgJ
KSEdaAmxA0vQDmIHKSFWgPuAHZkEAnd8y5v5kuNHMm+WY1mSm6qqCiGlZdUspXzxopY9Wu6bpZQf
SxlRWapwVx9p2dy2CxUHy9ryWx9pKdWyECYcIQshwlGyIBeOlAWpcLQsyISXkAWEX5tlPkvJwnP7
ns1SsnvLS7PMZwlZiShEy8pEIVJWKgpRsnJRiJBNFf2wbCzjfZgRUZi9JYWDxT9bWk6WIXbKym4t
KRVloObO5oze6ZClWX9a5jyOcOrfmuUkXPRUH/1zVRhZpvsnCxN+jnDqHh0SdQaFu9vg0ZIqrBZ1
eoXP92yKcJSocyHcd4FNEY4WdbrCR1rGrukMF9BWVhZvLZ7U9rS2nH9HVvoq63iFu+RUlOpIuCYL
CCPIqVjq1A9j5R3aBnMY2kKzMlbZHPQVbVHLhomCUjZUFFSy35ZQUVDIMo+Gi4JCltFwERSy75Y5
4+VkFLLcKHLHyyRUF1jOeJmMShbChZWy0Df8yFDLgg8/cpCN6I9cdHJhZHmy7X2anAnCtDUZ/j/Y
g2X2j709MHhTDAFF8QdK9SRpUl2yFgAAAABJRU5ErkJggg==
"
     style="image-rendering:optimizeQuality"
     preserveAspectRatio="none"
     height="13.76"
     width="13.76" />
</svg>
`,k2=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   viewBox="0 0 13.76 13.76"
   height="13.76"
   width="13.76"
   id="svg12"
   version="1.1">
  <metadata
     id="metadata18">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs16" />
  <image
     y="0"
     x="0"
     id="image20"
     xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAAAXNSR0IArs4c6QAAAARnQU1BAACx
jwv8YQUAAAAJcEhZcwAALiMAAC4jAXilP3YAAAGMSURBVFhHvdk7TsNAFIVhQ0l6elLDJqCGngXQ
U7MA6rALahZATQ81C6APrXP/jEaKHD/i8TnzS1eaICF/2I4f4qxt20bYOmaVlrK2Mb8s1Nj3mIu0
lPYZszlPa1kvMf9pKe02Zq3Gcrhc4JUaSzawA0sWsAtLcrATS1KwG0sycA0sAd6kZXm1sNzVHtOy
vBpYoK8xV/tPC3JjZVByYqVQcmHlUHJgLVBSY0ugPP7xO5PXYSW2FMr19ytm8sahxD7ElEBzk3c6
sFysn/afymKPvsXMueh3oblRMNibmPuYZ34wsyWHfqhB8OFpwKvDHLADmusFd8/ZU8FOaO4I3PcF
mwLXgOYOwVtexdnwdUy3vg2UQPnD2eji+vZsrruHS/eoBEpjWMpgrhi1Dv1gY6fBkuRQmtqzJVmg
pMbaoKTEWqGkwtqhpMBWgZICWwVKCuwpzxKSFNi5T2vFqb5gVcAqLNnBSixZwWos2cBg/9JSmgUM
9iMt5QFe8tZ8VP6n3WXMHQtxPzHfabm0ptkBwWhpthzMp7YAAAAASUVORK5CYII=
"
     style="image-rendering:optimizeQuality"
     preserveAspectRatio="none"
     height="13.76"
     width="13.76" />
</svg>
`,cp=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   viewBox="0 0 13.76 13.76"
   height="13.76"
   width="13.76"
   id="svg3813"
   version="1.1">
  <metadata
     id="metadata3819">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs3817" />
  <image
     y="0"
     x="0"
     id="image3821"
     xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAACXBIWXMAAC4jAAAuIwF4pT92AAAA
nUlEQVRYw+3Z0QnCMBSF4T/FATqCG1g3cISO0NE6iiPoCE5gneD40ohPvgkJ/AcC9/EjHELgliT0
koGOIlasWLFixYoVK1asWLFixYoVK1bsjxy+5hlYgLEx47ofSEKSJW1nTUJJMgLPDlpwHoCpk8rO
vgZixf4Zu3Vi3cq+WroBp4ahL+BYa3AB7o1CH7vvc7M1U4N/g2sdSk8bxjfDaMNdr+hmAQAAAABJ
RU5ErkJggg==
"
     style="image-rendering:optimizeQuality"
     preserveAspectRatio="none"
     height="13.76"
     width="13.76" />
</svg>
`,up=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   viewBox="0 0 13.76 13.76"
   height="13.76"
   width="13.76"
   id="svg32"
   version="1.1">
  <metadata
     id="metadata38">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs36" />
  <image
     y="0"
     x="0"
     id="image40"
     xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAACXBIWXMAAC4jAAAuIwF4pT92AAAA
pklEQVRYw+3ZLQ4CMRCG4bcbFOvXg99T7FG4BafAw1VALx7dWyy2mIoGgSOZJu/n6p70ZybppFIK
vWSgo4gVK1asWLFixYoVK1asWLFixYoV+yO7r/UMHIAxiO8FZGBrsUfgDEwBN/QNXIA11S/PW1Bo
Cz4N9ein4Nd1Dyw9PbDR0iVW7J+xudax6HkOtZVdg0MfQE7N0G4GlmANYgNW4A6QepowfgDMXB26
b1V6LAAAAABJRU5ErkJggg==
"
     style="image-rendering:optimizeQuality"
     preserveAspectRatio="none"
     height="13.76"
     width="13.76" />
</svg>
`,x2=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   viewBox="0 0 13.76 13.76"
   height="13.76"
   width="13.76"
   id="svg3823"
   version="1.1">
  <metadata
     id="metadata3829">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs3827" />
  <image
     y="0"
     x="0"
     id="image3831"
     xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAAAXNSR0IArs4c6QAAAARnQU1BAACx
jwv8YQUAAAAJcEhZcwAALiMAAC4jAXilP3YAAAHOSURBVFhH1ZiLUcMwEEQNDcQl0AEuISVABZhO
UkroICVAB6ECoINQgdmVfR5FlmQrkZzjzezEzsc8NPqcdNd1XfVfuB9ec3NAmv4yiRo5ImzBlm+c
wZYtEHJCGsT3eSgHxKZFxs/tL+aMkCK8R3yMwu4PcsVmiXBIVDDCvh/miEtMeE5UaEsNMJcN8o64
g26PvPSXs9S+/zRHQtgtvLRFCb9blZpnYw/9Rb6RR3M3zxtiprFbyKYwipK1+uwlnIkSrbITUaJR
1itKtMkGRYk2WRZAQbTNBpzWtggrrwnaWja00hk0DrCgsEZZ4hXWKksmwjLAHobkgOv+V3+ZhXHQ
iWxKqXYLKNyILDdqbPKlldASPhA+Mxc7uwatkSOSix1iP//q2APshLBvfJo7hbizgQj/mDtl+KYu
Cj8h7NSqCM2zXJvZwqqEY4uCOuGYLKEwJ3kVzMlyscg5915FTFbdqhaSVbn8+mTV1gmurOqCxpZN
EeUu9BlZd1obioTkQ7IhPGTjYZuPIoUMK/GUFrX39asuHJTlH3w1d3FCBxCrCUufZX+NCUdPSsAq
wu4A8wnPiQrFhW1Z4govFRWKCoeOjzjoZF92CdwpZy6AquoPvJRHJxB8bJ8AAAAASUVORK5CYII=
"
     style="image-rendering:optimizeQuality"
     preserveAspectRatio="none"
     height="13.76"
     width="13.76" />
</svg>
`,E2=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   viewBox="0 0 13.76 13.76"
   height="13.76"
   width="13.76"
   id="svg42"
   version="1.1">
  <metadata
     id="metadata48">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs46" />
  <image
     y="0"
     x="0"
     id="image50"
     xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAAAAXNSR0IArs4c6QAAAARnQU1BAACx
jwv8YQUAAAAJcEhZcwAALiMAAC4jAXilP3YAAAG/SURBVFhH1ZgxUsMwEEUNJRyAGmp6qKGn5xRQ
Q08NNfRQQw11DpAaanIAWrMv8WaELSlexhLLm/mRnImiF48jr7zVtm3zX9ju2ik5llxLdpdHNg4k
T5I7yWB8Cdl9yZHkRmIRRpQxOxK+YzC+hKwSnTBBKKoMxpeUBSbkksgRE1V+CJeWhUPJ5ao7ICeq
rIVryMKJpC88RlTZk1SThVDYIvoluZIsSqyz511SfEg4UxbRdw5qnlmFa9AsCn8hO4aBKHiUjYqC
N9mkKHiSzYqCJ9lPSVIUPMmySqTudEu8XbOxO90ab7KQFPYoC1Fhr7IwENbagMLCUtXnoCTM1QZW
3iS3dFT2mRfHvEjuVfZUckFnQh67dgqo1GYqC1MLn3XtZIR/sFcJW2C39FcD18KxpcutcGqddSmc
uykg/LDq+iAnC/OudUFOVrfLbkjJWvb11YjJuhSFvqxbUQhlXYuCylpE2YXy2SkLlVEgaxVluzyT
IEutWQ1kKZYtouF2maK4mjCyFN6bJsw9gKgmrNdsbsKNT0qEKsIqC7EJx4gqxYVDWQgntIgqRYXD
bY3CLpcVgmdPC974BYy3/MgRNM03hR9ubFTHT48AAAAASUVORK5CYII=
"
     style="image-rendering:optimizeQuality"
     preserveAspectRatio="none"
     height="13.76"
     width="13.76" />
</svg>
`,C2=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   viewBox="0 0 13.44 13.76"
   height="13.76"
   width="13.44"
   id="svg3803"
   version="1.1">
  <metadata
     id="metadata3809">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs3807" />
  <image
     y="0"
     x="0"
     id="image3811"
     xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAArCAYAAAAOnxr+AAAACXBIWXMAAC4jAAAuIwF4pT92AAAA
vElEQVRYw+3ZSw0CMRSF4b8T9iAFB4wDkDAWcICEkTA4GAeAA3AADurgsCkbAgsSMrmFczZNd1/a
3vSVJFFDGipJNdBZaRdAB2wC2TIwAgNAkrQEjsA86GBegDZJGoF18JnfJtVR9idXvaGGGmrod/b6
V9kD14k9LbD6FDqUM8CU2b2Deo0aaqihhhpqqKGGGhr1hH/wiP469FaBMzflEhc9PZKQ1CtmsqRO
EunpHbeNNN3A+dFJ/mf6V+gduGPIoUgKLbAAAAAASUVORK5CYII=
"
     style="image-rendering:optimizeQuality"
     preserveAspectRatio="none"
     height="13.76"
     width="13.44" />
</svg>
`,T2=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   viewBox="0 0 13.44 13.76"
   height="13.76"
   width="13.44"
   id="svg22"
   version="1.1">
  <metadata
     id="metadata28">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs26" />
  <image
     y="0"
     x="0"
     id="image30"
     xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAArCAYAAAAOnxr+AAAACXBIWXMAAC4jAAAuIwF4pT92AAAA
vUlEQVRYw+3ZsQ3CMBCF4d8WFekZgBqWIDUDZACmYBQWYIn0pGYAegZIexROERHRIBTdhXeVy08+
yT4/JzMjQmWCVBjoarSugK0z3/0degKODjeyBy5Am8ysARrnnT8nM7sCa+fQLgdAAlQ6ngQVVFBB
fzeUTK6t8VAwU328ztV6QQUVVFBBBRVUUEG9Ds41sJvZs/8GelDrlw7tAjhvmZLo9o6RD4bEGUp+
X1My/I0T4HN4rrcASf9M/wp9ASNzIKYYz2hAAAAAAElFTkSuQmCC
"
     style="image-rendering:optimizeQuality"
     preserveAspectRatio="none"
     height="13.76"
     width="13.44" />
</svg>
`;class A2{constructor(e){this.attributes=e;const o=navigator.userAgent.toLowerCase(),c=o.indexOf("android")>-1,_=o.indexOf("ipad")>-1||o.indexOf("iphone")>-1;this.iosSoftkeyboardOpened=!1,this.iosMeasureUnit=o.indexOf("crios")===-1?"%":"vh",this.iosDivHeight=`100%${this.iosMeasureUnit}`;const j=window.outerWidth,_e=window.outerHeight,et=j>_e,nt=j<_e,st=et&&this.attributes.height>_e,at=nt&&this.attributes.width>j,ct=st||at;this.instanceId=document.getElementsByClassName("wrs_modal_dialogContainer").length,this.deviceProperties={orientation:et?"landscape":"portait",isAndroid:c,isIOS:_,isMobile:ct,isDesktop:!ct&&!_&&!c},this.properties={created:!1,state:"",previousState:"",position:{bottom:0,right:10},size:{height:338,width:580}},this.websiteBeforeLockParameters=null;let dt={};dt.class="wrs_modal_overlay",dt.id=this.getElementId(dt.class),this.overlay=At.createElement("div",dt),dt={},dt.class="wrs_modal_title_bar",dt.id=this.getElementId(dt.class),this.titleBar=At.createElement("div",dt),dt={},dt.class="wrs_modal_title",dt.id=this.getElementId(dt.class),this.title=At.createElement("div",dt),this.title.innerHTML="",dt={},dt.class="wrs_modal_close_button",dt.id=this.getElementId(dt.class),dt.title=zn.get("close"),dt.style={},this.closeDiv=At.createElement("a",dt),this.closeDiv.setAttribute("role","button");let gt=`background-size: 10px; background-image: url(data:image/svg+xml;base64,${window.btoa(v2)})`,kt=`background-size: 10px; background-image: url(data:image/svg+xml;base64,${window.btoa(b2)})`;this.closeDiv.setAttribute("style",gt),this.closeDiv.setAttribute("onmouseover",`this.style = "${kt}";`),this.closeDiv.setAttribute("onmouseout",`this.style = "${gt}";`),dt={},dt.class="wrs_modal_stack_button",dt.id=this.getElementId(dt.class),dt.title=zn.get("exit_fullscreen"),this.stackDiv=At.createElement("a",dt),this.stackDiv.setAttribute("role","button"),gt=`background-size: 10px; background-image: url(data:image/svg+xml;base64,${window.btoa(x2)})`,kt=`background-size: 10px; background-image: url(data:image/svg+xml;base64,${window.btoa(E2)})`,this.stackDiv.setAttribute("style",gt),this.stackDiv.setAttribute("onmouseover",`this.style = "${kt}";`),this.stackDiv.setAttribute("onmouseout",`this.style = "${gt}";`),dt={},dt.class="wrs_modal_maximize_button",dt.id=this.getElementId(dt.class),dt.title=zn.get("fullscreen"),this.maximizeDiv=At.createElement("a",dt),this.maximizeDiv.setAttribute("role","button"),gt=`background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(y2)})`,kt=`background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(k2)})`,this.maximizeDiv.setAttribute("style",gt),this.maximizeDiv.setAttribute("onmouseover",`this.style = "${kt}";`),this.maximizeDiv.setAttribute("onmouseout",`this.style = "${gt}";`),dt={},dt.class="wrs_modal_minimize_button",dt.id=this.getElementId(dt.class),dt.title=zn.get("minimize"),this.minimizeDiv=At.createElement("a",dt),this.minimizeDiv.setAttribute("role","button"),gt=`background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(cp)})`,kt=`background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(up)})`,this.minimizeDiv.setAttribute("style",gt),this.minimizeDiv.setAttribute("onmouseover",`this.style = "${kt}";`),this.minimizeDiv.setAttribute("onmouseout",`this.style = "${gt}";`),dt={},dt.class="wrs_modal_dialogContainer",dt.id=this.getElementId(dt.class),dt.role="dialog",this.container=At.createElement("div",dt),this.container.setAttribute("aria-labeledby","wrs_modal_title[0]"),dt={},dt.class="wrs_modal_wrapper",dt.id=this.getElementId(dt.class),this.wrapper=At.createElement("div",dt),dt={},dt.class="wrs_content_container",dt.id=this.getElementId(dt.class),this.contentContainer=At.createElement("div",dt),dt={},dt.class="wrs_modal_controls",dt.id=this.getElementId(dt.class),this.controls=At.createElement("div",dt),dt={},dt.class="wrs_modal_buttons_container",dt.id=this.getElementId(dt.class),this.buttonContainer=At.createElement("div",dt),this.submitButton=this.createSubmitButton({id:this.getElementId("wrs_modal_button_accept"),class:"wrs_modal_button_accept",innerHTML:zn.get("accept")},this.submitAction.bind(this)),this.cancelButton=this.createSubmitButton({id:this.getElementId("wrs_modal_button_cancel"),class:"wrs_modal_button_cancel",innerHTML:zn.get("cancel")},this.cancelAction.bind(this)),this.contentManager=null;const Ct={cancelString:zn.get("cancel"),submitString:zn.get("close"),message:zn.get("close_modal_warning")},Nt={closeCallback:()=>{this.close()},cancelCallback:()=>{this.focus()}},Wt={overlayElement:this.container,callbacks:Nt,strings:Ct};this.popup=new w2(Wt),this.rtl=!1,"rtl"in this.attributes&&(this.rtl=this.attributes.rtl),this.handleOpenedIosSoftkeyboard=this.handleOpenedIosSoftkeyboard.bind(this),this.handleClosedIosSoftkeyboard=this.handleClosedIosSoftkeyboard.bind(this)}setContentManager(e){this.contentManager=e}getContentManager(){return this.contentManager}submitAction(){typeof this.contentManager.submitAction<"u"&&this.contentManager.submitAction(),this.close()}cancelAction(){typeof this.contentManager.hasChanges>"u"?this.close():this.contentManager.hasChanges()?this.showPopUpMessage():this.close()}createSubmitButton(e,o){class c{constructor(){this.element=document.createElement("button"),this.element.id=e.id,this.element.className=e.class,this.element.innerHTML=e.innerHTML,At.addEvent(this.element,"click",o)}getElement(){return this.element}}return new c(e,o).getElement()}create(){this.titleBar.appendChild(this.closeDiv),this.titleBar.appendChild(this.stackDiv),this.titleBar.appendChild(this.maximizeDiv),this.titleBar.appendChild(this.minimizeDiv),this.titleBar.appendChild(this.title),this.deviceProperties.isDesktop&&this.container.appendChild(this.titleBar),this.wrapper.appendChild(this.contentContainer),this.wrapper.appendChild(this.controls),this.controls.appendChild(this.buttonContainer),this.buttonContainer.appendChild(this.submitButton),this.buttonContainer.appendChild(this.cancelButton),this.container.appendChild(this.wrapper),this.recalculateScrollBar(),document.body.appendChild(this.container),document.body.appendChild(this.overlay),this.deviceProperties.isDesktop?(this.createModalWindowDesktop(),this.createResizeButtons(),this.addListeners(),zt.get("modalWindowFullScreen")&&this.maximize()):this.deviceProperties.isAndroid?this.createModalWindowAndroid():this.deviceProperties.isIOS&&!this.deviceProperties.isMobile&&this.createModalWindowIos(),this.contentManager!=null&&this.contentManager.insert(this),this.properties.open=!0,this.properties.created=!0,this.isRTL()&&(this.container.style.right=`${window.innerWidth-this.scrollbarWidth-this.container.offsetWidth}px`,this.container.className+=" wrs_modal_rtl")}createResizeButtons(){this.resizerBR=document.createElement("div"),this.resizerBR.className="wrs_bottom_right_resizer",this.resizerBR.innerHTML="",this.resizerTL=document.createElement("div"),this.resizerTL.className="wrs_bottom_left_resizer",this.container.appendChild(this.resizerBR),this.titleBar.appendChild(this.resizerTL),At.addEvent(this.resizerBR,"mousedown",this.activateResizeStateBR.bind(this)),At.addEvent(this.resizerTL,"mousedown",this.activateResizeStateTL.bind(this))}activateResizeStateBR(e){this.initializeResizeProperties(e,!1)}activateResizeStateTL(e){this.initializeResizeProperties(e,!0)}initializeResizeProperties(e,o){At.addClass(document.body,"wrs_noselect"),At.addClass(this.overlay,"wrs_overlay_active"),this.resizeDataObject={x:this.eventClient(e).X,y:this.eventClient(e).Y},this.initialWidth=parseInt(this.container.style.width,10),this.initialHeight=parseInt(this.container.style.height,10),o?this.leftScale=!0:(this.initialRight=parseInt(this.container.style.right,10),this.initialBottom=parseInt(this.container.style.bottom,10)),this.initialRight||(this.initialRight=0),this.initialBottom||(this.initialBottom=0),document.body.style["user-select"]="none"}open(){this.removeClass("wrs_closed");const{isIOS:e}=this.deviceProperties,{isAndroid:o}=this.deviceProperties,{isMobile:c}=this.deviceProperties;if((e||o||c)&&(this.restoreWebsiteScale(),this.lockWebsiteScroll(),setTimeout(()=>{this.hideKeyboard()},400)),this.properties.created?(this.properties.open||(this.properties.open=!0,!this.deviceProperties.isAndroid&&!this.deviceProperties.isIOS&&this.restoreState()),this.deviceProperties.isDesktop&&zt.get("modalWindowFullScreen")&&this.maximize(),this.deviceProperties.isIOS&&(this.iosSoftkeyboardOpened=!1,this.setContainerHeight(`${100+this.iosMeasureUnit}`))):this.create(),this.contentManager.isEditorLoaded===!1){const _=wr.newListener("onLoad",()=>{this.contentManager.onOpen(this)});this.contentManager.addListener(_)}else this.contentManager.onOpen(this)}close(){this.removeClass("wrs_maximized"),this.removeClass("wrs_minimized"),this.removeClass("wrs_stack"),this.addClass("wrs_closed"),this.saveModalProperties(),this.unlockWebsiteScroll(),this.properties.open=!1}restoreWebsiteScale(){let e=document.querySelector("meta[name=viewport]");const o=["initial-scale=","minimum-scale=","maximum-scale="],c=["1.0","1.0","1.0"],_=(j,_e)=>{const et=j.getAttribute("content");if(et){const nt=et.split(",");let st="";const at=[];for(let ct=0;ct<nt.length;ct+=1){let dt=!1,gt=0;for(;!dt&&gt<_e.length;)nt[ct].indexOf(_e[gt])&&(dt=!0),gt+=1;dt||at.push(nt[ct])}for(let ct=0;ct<_e.length;ct+=1){const dt=_e[ct]+c[ct];st+=ct===0?dt:`,${dt}`}for(let ct=0;ct<at.length;ct+=1)st+=`,${at[ct]}`;j.setAttribute("content",st),j.setAttribute("content",""),j.setAttribute("content",et)}else j.setAttribute("content","initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"),j.removeAttribute("content")};e?_(e,o):(e=document.createElement("meta"),document.getElementsByTagName("head")[0].appendChild(e),_(e,o),e.remove())}lockWebsiteScroll(){this.websiteBeforeLockParameters={bodyStylePosition:document.body.style.position?document.body.style.position:"",bodyStyleOverflow:document.body.style.overflow?document.body.style.overflow:"",htmlStyleOverflow:document.documentElement.style.overflow?document.documentElement.style.overflow:"",windowScrollX:window.scrollX,windowScrollY:window.scrollY}}unlockWebsiteScroll(){if(this.websiteBeforeLockParameters){document.body.style.position=this.websiteBeforeLockParameters.bodyStylePosition,document.body.style.overflow=this.websiteBeforeLockParameters.bodyStyleOverflow,document.documentElement.style.overflow=this.websiteBeforeLockParameters.htmlStyleOverflow;const{windowScrollX:e}=this.websiteBeforeLockParameters,{windowScrollY:o}=this.websiteBeforeLockParameters;window.scrollTo(e,o),this.websiteBeforeLockParameters=null}}isIE11(){return navigator.userAgent.search("Msie/")>=0||navigator.userAgent.search("Trident/")>=0||navigator.userAgent.search("Edge/")>=0}isRTL(){return this.attributes.language==="ar"||this.attributes.language==="he"?!0:this.rtl}addClass(e){At.addClass(this.overlay,e),At.addClass(this.titleBar,e),At.addClass(this.overlay,e),At.addClass(this.container,e),At.addClass(this.contentContainer,e),At.addClass(this.stackDiv,e),At.addClass(this.minimizeDiv,e),At.addClass(this.maximizeDiv,e),At.addClass(this.wrapper,e)}removeClass(e){At.removeClass(this.overlay,e),At.removeClass(this.titleBar,e),At.removeClass(this.overlay,e),At.removeClass(this.container,e),At.removeClass(this.contentContainer,e),At.removeClass(this.stackDiv,e),At.removeClass(this.minimizeDiv,e),At.removeClass(this.maximizeDiv,e),At.removeClass(this.wrapper,e)}createModalWindowDesktop(){this.addClass("wrs_modal_desktop"),this.stack()}createModalWindowAndroid(){this.addClass("wrs_modal_android"),window.addEventListener("resize",this.orientationChangeAndroidSoftkeyboard.bind(this))}createModalWindowIos(){this.addClass("wrs_modal_ios"),window.addEventListener("resize",this.orientationChangeIosSoftkeyboard.bind(this))}restoreState(){this.properties.state==="maximized"?this.maximize():this.properties.state==="minimized"?(this.properties.state=this.properties.previousState,this.properties.previousState="",this.minimize()):this.stack()}stack(){this.properties.previousState=this.properties.state,this.properties.state="stack",this.removeClass("wrs_maximized"),this.minimizeDiv.title=zn.get("minimize"),this.removeClass("wrs_minimized"),this.addClass("wrs_stack");const e=`background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(cp)})`,o=`background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(up)})`;this.minimizeDiv.setAttribute("style",e),this.minimizeDiv.setAttribute("onmouseover",`this.style = "${o}";`),this.minimizeDiv.setAttribute("onmouseout",`this.style = "${e}";`),this.restoreModalProperties(),typeof this.resizerBR<"u"&&typeof this.resizerTL<"u"&&this.setResizeButtonsVisibility(),this.recalculateScrollBar(),this.recalculatePosition(),this.recalculateScale(),this.focus()}minimize(){if(this.saveModalProperties(),this.title.style.cursor="pointer",this.properties.state==="minimized"&&this.properties.previousState==="stack")this.stack();else if(this.properties.state==="minimized"&&this.properties.previousState==="maximized")this.maximize();else{this.container.style.height="30px",this.container.style.width="250px",this.container.style.bottom="0px",this.container.style.right="10px",this.removeListeners(),this.properties.previousState=this.properties.state,this.properties.state="minimized",this.setResizeButtonsVisibility(),this.minimizeDiv.title=zn.get("maximize"),At.containsClass(this.overlay,"wrs_stack")?this.removeClass("wrs_stack"):this.removeClass("wrs_maximized"),this.addClass("wrs_minimized");const e=`background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(C2)})`,o=`background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(T2)})`;this.minimizeDiv.setAttribute("style",e),this.minimizeDiv.setAttribute("onmouseover",`this.style = "${o}";`),this.minimizeDiv.setAttribute("onmouseout",`this.style = "${e}";`)}}maximize(){this.saveModalProperties(),this.properties.state!=="maximized"&&(this.properties.previousState=this.properties.state,this.properties.state="maximized"),this.setResizeButtonsVisibility(),At.containsClass(this.overlay,"wrs_minimized")?(this.minimizeDiv.title=zn.get("minimize"),this.removeClass("wrs_minimized")):At.containsClass(this.overlay,"wrs_stack")&&(this.container.style.left=null,this.container.style.top=null,this.removeClass("wrs_stack")),this.addClass("wrs_maximized");const e=`background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(cp)})`,o=`background-size: 10px; background-repeat: no-repeat; background-image: url(data:image/svg+xml;base64,${window.btoa(up)})`;this.minimizeDiv.setAttribute("style",e),this.minimizeDiv.setAttribute("onmouseover",`this.style = "${o}";`),this.minimizeDiv.setAttribute("onmouseout",`this.style = "${e}";`),this.setSize(parseInt(window.innerHeight*.8,10),parseInt(window.innerWidth*.8,10)),this.container.clientHeight>700&&(this.container.style.height="700px"),this.container.clientWidth>1200&&(this.container.style.width="1200px");const{innerHeight:c}=window,{innerWidth:_}=window,{offsetHeight:j}=this.container,{offsetWidth:_e}=this.container,et=c/2-j/2,nt=_/2-_e/2;this.setPosition(et,nt),this.recalculateScale(),this.recalculatePosition(),this.recalculateSize(),this.focus()}reExpand(){this.properties.state==="minimized"&&(this.properties.previousState==="maximized"?this.maximize():this.stack(),this.title.style.cursor="")}setSize(e,o){this.container.style.height=`${e}px`,this.container.style.width=`${o}px`,this.recalculateSize()}setPosition(e,o){this.container.style.bottom=`${e}px`,this.container.style.right=`${o}px`}saveModalProperties(){this.properties.state==="stack"&&(this.properties.position.bottom=parseInt(this.container.style.bottom,10),this.properties.position.right=parseInt(this.container.style.right,10),this.properties.size.width=parseInt(this.container.style.width,10),this.properties.size.height=parseInt(this.container.style.height,10))}restoreModalProperties(){this.properties.state==="stack"&&(this.setPosition(this.properties.position.bottom,this.properties.position.right),this.setSize(this.properties.size.height,this.properties.size.width))}recalculateSize(){this.wrapper.style.width=`${this.container.clientWidth-12}px`,this.wrapper.style.height=`${this.container.clientHeight-38}px`,this.contentContainer.style.height=`${parseInt(this.wrapper.offsetHeight-50,10)}px`}setResizeButtonsVisibility(){this.properties.state==="stack"?(this.resizerTL.style.visibility="visible",this.resizerBR.style.visibility="visible"):(this.resizerTL.style.visibility="hidden",this.resizerBR.style.visibility="hidden")}addListeners(){this.maximizeDiv.addEventListener("click",this.maximize.bind(this),!0),this.stackDiv.addEventListener("click",this.stack.bind(this),!0),this.minimizeDiv.addEventListener("click",this.minimize.bind(this),!0),this.closeDiv.addEventListener("click",this.cancelAction.bind(this)),this.title.addEventListener("click",this.reExpand.bind(this)),this.overlay.addEventListener("click",this.cancelAction.bind(this)),At.addEvent(window,"mousedown",this.startDrag.bind(this)),At.addEvent(window,"mouseup",this.stopDrag.bind(this)),At.addEvent(window,"mousemove",this.drag.bind(this)),At.addEvent(window,"resize",this.onWindowResize.bind(this)),At.addEvent(this.container,"keydown",this.onKeyDown.bind(this))}removeListeners(){At.removeEvent(window,"mousedown",this.startDrag),At.removeEvent(window,"mouseup",this.stopDrag),At.removeEvent(window,"mousemove",this.drag),At.removeEvent(window,"resize",this.onWindowResize),At.removeEvent(this.container,"keydown",this.onKeyDown)}eventClient(e){return typeof e.clientX>"u"&&e.changedTouches?{X:e.changedTouches[0].clientX,Y:e.changedTouches[0].clientY}:{X:e.clientX,Y:e.clientY}}startDrag(e){this.properties.state!=="minimized"&&e.target===this.title&&(typeof this.dragDataObject>"u"||this.dragDataObject===null)&&(this.dragDataObject={x:this.eventClient(e).X,y:this.eventClient(e).Y},this.lastDrag={x:"0px",y:"0px"},this.container.style.right===""&&(this.container.style.right="0px"),this.container.style.bottom===""&&(this.container.style.bottom="0px"),this.isIE11(),At.addClass(document.body,"wrs_noselect"),At.addClass(this.overlay,"wrs_overlay_active"),this.limitWindow=this.getLimitWindow())}drag(e){if(this.dragDataObject){e.preventDefault();let o=Math.min(this.eventClient(e).Y,this.limitWindow.minPointer.y);o=Math.max(this.limitWindow.maxPointer.y,o);let c=Math.min(this.eventClient(e).X,this.limitWindow.minPointer.x);c=Math.max(this.limitWindow.maxPointer.x,c);const _=`${c-this.dragDataObject.x}px`,j=`${o-this.dragDataObject.y}px`;this.lastDrag={x:_,y:j},this.container.style.transform=`translate3d(${_},${j},0)`}if(this.resizeDataObject){const{innerWidth:o}=window,{innerHeight:c}=window;let _=Math.min(this.eventClient(e).X,o-this.scrollbarWidth-7),j=Math.min(this.eventClient(e).Y,c-7);_<0&&(_=0),j<0&&(j=0);let _e;this.leftScale?_e=-1:_e=1,this.container.style.width=`${this.initialWidth+_e*(_-this.resizeDataObject.x)}px`,this.container.style.height=`${this.initialHeight+_e*(j-this.resizeDataObject.y)}px`,this.leftScale||(this.resizeDataObject.x-_-this.initialWidth<-580?this.container.style.right=`${this.initialRight-(_-this.resizeDataObject.x)}px`:(this.container.style.right=`${this.initialRight+this.initialWidth-580}px`,this.container.style.width="580px"),this.resizeDataObject.y-j<this.initialHeight-338?this.container.style.bottom=`${this.initialBottom-(j-this.resizeDataObject.y)}px`:(this.container.style.bottom=`${this.initialBottom+this.initialHeight-338}px`,this.container.style.height="338px")),this.recalculateScale(),this.recalculatePosition()}}getLimitWindow(){const e=window.innerWidth,o=window.innerHeight,{offsetHeight:c}=this.container,_=parseInt(this.container.style.bottom,10),j=parseInt(this.container.style.right,10),{pageXOffset:_e}=window,et=this.dragDataObject.y,nt=this.dragDataObject.x,st=c+_-(o-(et-_e)),at=e-this.scrollbarWidth-(nt-_e)-j,ct=o-this.container.offsetHeight+st,dt=this.title.offsetHeight-(this.title.offsetHeight-st),gt=e-at-this.scrollbarWidth,kt=this.container.offsetWidth-at;return{minPointer:{x:gt,y:ct},maxPointer:{x:kt,y:dt}}}getScrollBarWidth(){const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const o=document.createElement("div");o.style.position="absolute",o.style.top="0px",o.style.left="0px",o.style.visibility="hidden",o.style.width="200px",o.style.height="150px",o.style.overflow="hidden",o.appendChild(e),document.body.appendChild(o);const c=e.offsetWidth;o.style.overflow="scroll";let _=e.offsetWidth;return c===_&&(_=o.clientWidth),document.body.removeChild(o),c-_}stopDrag(){(this.dragDataObject||this.resizeDataObject)&&(this.container.style.transform="",this.dragDataObject&&(this.container.style.right=`${parseInt(this.container.style.right,10)-parseInt(this.lastDrag.x,10)}px`,this.container.style.bottom=`${parseInt(this.container.style.bottom,10)-parseInt(this.lastDrag.y,10)}px`),this.focus(),document.body.style["user-select"]="",this.isIE11(),At.removeClass(document.body,"wrs_noselect"),At.removeClass(this.overlay,"wrs_overlay_active")),this.dragDataObject=null,this.resizeDataObject=null,this.initialWidth=null,this.leftScale=null}onWindowResize(){this.recalculateScrollBar(),this.recalculatePosition(),this.recalculateScale()}onKeyDown(e){e.key!==void 0&&(this.popup.overlayWrapper.style.display!=="block"?e.key==="Escape"||e.key==="Esc"?this.properties.open&&this.contentManager.onKeyDown(e):e.shiftKey&&e.key==="Tab"?document.activeElement===this.cancelButton?(this.submitButton.focus(),e.stopPropagation(),e.preventDefault()):this.contentManager.onKeyDown(e):e.key==="Tab"&&(document.activeElement===this.submitButton?(this.cancelButton.focus(),e.stopPropagation(),e.preventDefault()):this.contentManager.onKeyDown(e)):this.popup.onKeyDown(e))}recalculatePosition(){this.container.style.right=`${Math.min(parseInt(this.container.style.right,10),window.innerWidth-this.scrollbarWidth-this.container.offsetWidth)}px`,parseInt(this.container.style.right,10)<0&&(this.container.style.right="0px"),this.container.style.bottom=`${Math.min(parseInt(this.container.style.bottom,10),window.innerHeight-this.container.offsetHeight)}px`,parseInt(this.container.style.bottom,10)<0&&(this.container.style.bottom="0px")}recalculateScale(){let e=!1;parseInt(this.container.style.width,10)>580?(this.container.style.width=`${Math.min(parseInt(this.container.style.width,10),window.innerWidth-this.scrollbarWidth)}px`,e=!0):(this.container.style.width="580px",e=!0),parseInt(this.container.style.height,10)>338?(this.container.style.height=`${Math.min(parseInt(this.container.style.height,10),window.innerHeight)}px`,e=!0):(this.container.style.height="338px",e=!0),e&&this.recalculateSize()}recalculateScrollBar(){this.hasScrollBar=window.innerWidth>document.documentElement.clientWidth,this.hasScrollBar?this.scrollbarWidth=this.getScrollBarWidth():this.scrollbarWidth=0}hideKeyboard(){const e=document.createElement("input");this.container.appendChild(e),e.focus(),e.blur(),e.remove()}focus(){this.contentManager!=null&&typeof this.contentManager.onFocus<"u"&&this.contentManager.onFocus()}portraitMode(){return window.innerHeight>window.innerWidth}handleOpenedIosSoftkeyboard(){!this.iosSoftkeyboardOpened&&this.iosDivHeight!=null&&this.iosDivHeight===`100${this.iosMeasureUnit}`&&(this.portraitMode()?this.setContainerHeight(`63${this.iosMeasureUnit}`):this.setContainerHeight(`40${this.iosMeasureUnit}`)),this.iosSoftkeyboardOpened=!0}handleClosedIosSoftkeyboard(){this.iosSoftkeyboardOpened=!1,this.setContainerHeight(`100${this.iosMeasureUnit}`)}orientationChangeIosSoftkeyboard(){this.iosSoftkeyboardOpened?this.portraitMode()?this.setContainerHeight(`63${this.iosMeasureUnit}`):this.setContainerHeight(`40${this.iosMeasureUnit}`):this.setContainerHeight(`100${this.iosMeasureUnit}`)}orientationChangeAndroidSoftkeyboard(){this.setContainerHeight("100%")}setContainerHeight(e){this.iosDivHeight=e,this.wrapper.style.height=e}showPopUpMessage(){this.properties.state==="minimized"&&this.stack(),this.popup.show()}setTitle(e){this.title.innerHTML=e}getElementId(e){return`${e}[${this.instanceId}]`}}/*! http://mths.be/codepointat v0.1.0 by @mathias */String.prototype.codePointAt||function(){var h=function(e){if(this==null)throw TypeError();var o=String(this),c=o.length,_=e?Number(e):0;if(_!=_&&(_=0),!(_<0||_>=c)){var j=o.charCodeAt(_),_e;return j>=55296&&j<=56319&&c>_+1&&(_e=o.charCodeAt(_+1),_e>=56320&&_e<=57343)?(j-55296)*1024+_e-56320+65536:j}};Object.defineProperty?Object.defineProperty(String.prototype,"codePointAt",{value:h,configurable:!0,writable:!0}):String.prototype.codePointAt=h}(),typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(e,o){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(e),_=1;_<arguments.length;_++){var j=arguments[_];if(j!=null)for(var _e in j)Object.prototype.hasOwnProperty.call(j,_e)&&(c[_e]=j[_e])}return c},writable:!0,configurable:!0}),a(94);class tr{constructor(e){this.language="en",this.editMode="images",this.modalDialog=null,this.customEditors=new g2;const o={name:"Chemistry",toolbar:"chemistry",icon:"chem.png",confVariable:"chemEnabled",title:"ChemType",tooltip:"Insert a chemistry formula - ChemType"};if(this.customEditors.addEditor("chemistry",o),this.environment={},this.editionProperties={},this.editionProperties.isNewElement=!0,this.editionProperties.temporalImage=null,this.editionProperties.latexRange=null,this.editionProperties.range=null,this.integrationModel=null,this.contentManager=null,this.browser=(()=>{const c=navigator.userAgent;let _="none";return c.search("Edge/")>=0?_="EDGE":c.search("Chrome/")>=0?_="CHROME":c.search("Trident/")>=0?_="IE":c.search("Firefox/")>=0?_="FIREFOX":c.search("Safari/")>=0&&(_="SAFARI"),_})(),this.listeners=new wr,this.serviceProviderProperties={},"serviceProviderProperties"in e)this.serviceProviderProperties=e.serviceProviderProperties;else throw new Error("serviceProviderProperties property missing.")}static get globalListeners(){return tr._globalListeners}static set globalListeners(e){tr._globalListeners=e}static get initialized(){return tr._initialized}static set initialized(e){tr._initialized=e}setIntegrationModel(e){this.integrationModel=e}setEnvironment(e){"editor"in e&&(this.environment.editor=e.editor),"mode"in e&&(this.environment.mode=e.mode),"version"in e&&(this.environment.version=e.version)}getModalDialog(){return this.modalDialog}init(){if(tr.initialized)this.listeners.fire("onLoad",{});else{const e=wr.newListener("onInit",()=>{const o=Kt.getService("configurationjs","","get"),c=JSON.parse(o);zt.addConfiguration(c),zt.addConfiguration(_2),zn.language=this.language,this.listeners.fire("onLoad",{})});Kt.addListener(e),Kt.init(this.serviceProviderProperties),tr.initialized=!0}}addListener(e){this.listeners.add(e)}static addGlobalListener(e){tr.globalListeners.add(e)}beforeUpdateFormula(e,o){const c=new lp;return c.mathml=e,c.wirisProperties={},o!=null&&Object.keys(o).forEach(_=>{c.wirisProperties[_]=o[_]}),c.language=this.language,c.editMode=this.editMode,this.listeners.fire("onBeforeFormulaInsertion",c)?{}:tr.globalListeners.fire("onBeforeFormulaInsertion",c)?{}:{mathml:c.mathml,wirisProperties:c.wirisProperties}}insertFormula(e,o,c,_){const j={};if(!c)this.insertElementOnSelection(null,e,o);else if(this.editMode==="latex"){if(j.latex=Bn.getLatexFromMathML(c),this.integrationModel.fillNonLatexNode&&!j.latex){const _e=new lp;_e.editMode=this.editMode,_e.windowTarget=o,_e.focusElement=e,_e.latex=j.latex,this.integrationModel.fillNonLatexNode(_e,o,c)}else j.node=o.document.createTextNode(`$$${j.latex}$$`);this.insertElementOnSelection(j.node,e,o)}else j.node=yn.mathmlToImgObject(o.document,c,_,this.language),this.insertElementOnSelection(j.node,e,o);return j}afterUpdateFormula(e,o,c,_){const j=new lp;return j.editMode=this.editMode,j.windowTarget=o,j.focusElement=e,j.node=c,j.latex=_,this.listeners.fire("onAfterFormulaInsertion",j)?{}:tr.globalListeners.fire("onAfterFormulaInsertion",j)?{}:{}}placeCaretAfterNode(e){this.integrationModel.getSelection();const o=e.ownerDocument;if(typeof o.getSelection<"u"&&e.parentElement){const c=o.createRange();c.setStartAfter(e),c.collapse(!0);const _=o.getSelection();_.removeAllRanges(),_.addRange(c),o.body.focus()}}insertElementOnSelection(e,o,c){if(this.editionProperties.isNewElement)if(e)if(o.type==="textarea")At.updateTextArea(o,e.textContent);else if(document.selection&&document.getSelection===0){let _=c.document.selection.createRange();if(c.document.execCommand("InsertImage",!1,e.src),"parentElement"in _||(c.document.execCommand("delete",!1),_=c.document.selection.createRange(),c.document.execCommand("InsertImage",!1,e.src)),"parentElement"in _){const j=_.parentElement();j.nodeName.toUpperCase()==="IMG"?j.parentNode.replaceChild(e,j):_.pasteHTML(At.createObjectCode(e))}}else{const _=this.integrationModel.getSelection();let j=null;this.editionProperties.range?({range:j}=this.editionProperties,this.editionProperties.range=null):j=_.getRangeAt(0),j.deleteContents();let _e=j.startContainer;const et=j.startOffset;_e.nodeType===3?(_e=_e.splitText(et),_e.parentNode.insertBefore(e,_e)):_e.nodeType===1&&_e.insertBefore(e,_e.childNodes[et]),this.placeCaretAfterNode(e)}else if(o.type==="textarea")o.focus();else{const _=this.integrationModel.getSelection();if(_.removeAllRanges(),this.editionProperties.range){const{range:j}=this.editionProperties;this.editionProperties.range=null,_.addRange(j)}}else if(this.editionProperties.latexRange)document.selection&&document.getSelection===0?(this.editionProperties.isNewElement=!0,this.editionProperties.latexRange.select(),this.insertElementOnSelection(e,o,c)):(this.editionProperties.latexRange.deleteContents(),this.editionProperties.latexRange.insertNode(e),this.placeCaretAfterNode(e));else if(o.type==="textarea"){let _;typeof this.integrationModel.getSelectedItem<"u"?_=this.integrationModel.getSelectedItem(o,!1):_=At.getSelectedItemOnTextarea(o),At.updateExistingTextOnTextarea(o,e.textContent,_.startPosition,_.endPosition)}else e&&e.nodeName.toLowerCase()==="img"?(er.removeImgDataAttributes(this.editionProperties.temporalImage),er.clone(e,this.editionProperties.temporalImage)):this.editionProperties.temporalImage.remove(),this.placeCaretAfterNode(this.editionProperties.temporalImage)}openModalDialog(e,o){this.editMode="images";try{if(o){e.contentWindow.focus();const st=e.contentWindow.getSelection();this.editionProperties.range=st.getRangeAt(0)}else{e.focus();const st=getSelection();this.editionProperties.range=st.getRangeAt(0)}}catch{this.editionProperties.range=null}if(o===void 0&&(o=!0),this.editionProperties.latexRange=null,e){let st;if(typeof this.integrationModel.getSelectedItem<"u"?st=this.integrationModel.getSelectedItem(e,o):st=At.getSelectedItem(e,o),st){if(!st.caretPosition&&At.containsClass(st.node,zt.get("imageClassName")))this.editionProperties.temporalImage=st.node,this.editionProperties.isNewElement=!1;else if(st.node.nodeType===3)if(this.integrationModel.getMathmlFromTextNode){const at=this.integrationModel.getMathmlFromTextNode(st.node,st.caretPosition);at&&(this.editMode="latex",this.editionProperties.isNewElement=!1,this.editionProperties.temporalImage=document.createElement("img"),this.editionProperties.temporalImage.setAttribute(zt.get("imageMathmlAttribute"),fn.safeXmlEncode(at)))}else{const at=Bn.getLatexFromTextNode(st.node,st.caretPosition);if(at){const ct=Bn.getMathMLFromLatex(at.latex);this.editMode="latex",this.editionProperties.isNewElement=!1,this.editionProperties.temporalImage=document.createElement("img"),this.editionProperties.temporalImage.setAttribute(zt.get("imageMathmlAttribute"),fn.safeXmlEncode(ct));const dt=o?e.contentWindow:window;if(e.tagName.toLowerCase()!=="textarea")if(document.selection){let gt=0,kt=at.startNode.previousSibling;for(;kt;)gt+=At.getNodeLength(kt),kt=kt.previousSibling;this.editionProperties.latexRange=dt.document.selection.createRange(),this.editionProperties.latexRange.moveToElementText(at.startNode.parentNode),this.editionProperties.latexRange.move("character",gt+at.startPosition),this.editionProperties.latexRange.moveEnd("character",at.latex.length+4)}else this.editionProperties.latexRange=dt.document.createRange(),this.editionProperties.latexRange.setStart(at.startNode,at.startPosition),this.editionProperties.latexRange.setEnd(at.endNode,at.endPosition)}}}else e.tagName.toLowerCase()==="textarea"&&(this.editMode="latex")}const c=zt.get("editorAttributes").split(", "),_={};for(let st=0,at=c.length;st<at;st+=1){const ct=c[st].split("="),dt=ct[0],gt=ct[1];_[dt]=gt}const j={},_e=zt.get("editorParameters"),et=this.integrationModel.editorParameters;Object.assign(j,_,_e),Object.assign(j,_,et),j.language=this.language,j.rtl=this.integrationModel.rtl;const nt={};if(nt.editorAttributes=j,nt.language=this.language,nt.customEditors=this.customEditors,nt.environment=this.environment,this.modalDialog==null){this.modalDialog=new A2(j),this.contentManager=new ap(nt);const st=wr.newListener("onLoad",()=>{if(this.contentManager.isNewElement=this.editionProperties.isNewElement,this.editionProperties.temporalImage!=null){const at=fn.safeXmlDecode(this.editionProperties.temporalImage.getAttribute(zt.get("imageMathmlAttribute")));this.contentManager.mathML=at}});this.contentManager.addListener(st),this.contentManager.init(),this.modalDialog.setContentManager(this.contentManager),this.contentManager.setModalDialogInstance(this.modalDialog)}else if(this.contentManager.isNewElement=this.editionProperties.isNewElement,this.editionProperties.temporalImage!=null){const st=fn.safeXmlDecode(this.editionProperties.temporalImage.getAttribute(zt.get("imageMathmlAttribute")));this.contentManager.mathML=st}this.contentManager.setIntegrationModel(this.integrationModel),this.modalDialog.open()}getCustomEditors(){return this.customEditors}}tr._globalListeners=new wr,tr._initialized=!1;class qr{constructor(e){if(this.language="en",this.serviceProviderProperties={},"serviceProviderProperties"in e&&(this.serviceProviderProperties=e.serviceProviderProperties),this.configurationService="","configurationService"in e&&(this.serviceProviderProperties.URI=e.configurationService,console.warn("Deprecated property configurationService. Use serviceParameters on instead.",[e.configurationService])),this.version="version"in e?e.version:"",this.target=null,"target"in e)this.target=e.target;else throw new Error("IntegrationModel constructor error: target property missed.");"scriptName"in e&&(this.scriptName=e.scriptName),this.callbackMethodArguments={},"callbackMethodArguments"in e&&(this.callbackMethodArguments=e.callbackMethodArguments),this.environment={},"environment"in e&&(this.environment=e.environment),this.isIframe=!1,this.target!=null&&(this.isIframe=this.target.tagName.toUpperCase()==="IFRAME"),this.editorObject=null,"editorObject"in e&&(this.editorObject=e.editorObject),this.rtl=!1,"rtl"in e&&(this.rtl=e.rtl),this.managesLanguage=!1,"managesLanguage"in e&&(this.managesLanguage=e.managesLanguage),this.temporalImageResizing=!1,this.core=null,this.listeners=new wr,"integrationParameters"in e&&qr.integrationParameters.forEach(o=>{if(o in e.integrationParameters){const c=e.integrationParameters[o];Object.keys(c).length!==0&&(this[o]=c)}})}init(){this.language=this.getLanguage();const e=wr.newListener("onLoad",()=>{this.callbackFunction(this.callbackMethodArguments)});if(this.serviceProviderProperties.URI.indexOf("configuration")!==-1){const _=this.serviceProviderProperties.URI,j=Kt.getServerLanguageFromService(_);this.serviceProviderProperties.server=j;const _e=this.serviceProviderProperties.URI.indexOf("configuration"),et=this.serviceProviderProperties.URI.substring(0,_e);this.serviceProviderProperties.URI=et}let o=this.serviceProviderProperties.URI;o=o.indexOf("/")===0||o.indexOf("http")===0?o:At.concatenateUrl(this.getPath(),o),this.serviceProviderProperties.URI=o;const c={};c.serviceProviderProperties=this.serviceProviderProperties,this.setCore(new tr(c)),this.core.addListener(e),this.core.language=this.language,this.core.init(),this.core.setEnvironment(this.environment)}getPath(){if(typeof this.scriptName>"u")throw new Error("scriptName property needed for getPath.");const e=document.getElementsByTagName("script");let o="";for(let c=0;c<e.length;c+=1){const _=e[c].src.lastIndexOf(this.scriptName);_>=0&&(o=e[c].src.substr(0,_-1))}return o}setLanguage(e){this.language=e}setCore(e){this.core=e,e.setIntegrationModel(this)}getCore(){return this.core}setTarget(e){this.target=e,this.isIframe=this.target.tagName.toUpperCase()==="IFRAME"}setEditorObject(e){this.editorObject=e}openNewFormulaEditor(){this.core.editionProperties.isNewElement=!0,this.core.openModalDialog(this.target,this.isIframe)}openExistingFormulaEditor(){this.core.editionProperties.isNewElement=!1,this.core.openModalDialog(this.target,this.isIframe)}updateFormula(e){this.editorParameters&&(e=com.wiris.editor.util.EditorUtils.addAnnotation(e,"application/vnd.wiris.mtweb-params+json",JSON.stringify(this.editorParameters)));let o,c;const _=null;this.isIframe?(o=this.target.contentWindow,c=this.target.contentWindow):(o=this.target,c=window);let j=this.core.beforeUpdateFormula(e,_);return!j||(j=this.insertFormula(o,c,j.mathml,j.wirisProperties),!j)?"":this.core.afterUpdateFormula(j.focusElement,j.windowTarget,j.node,j.latex)}insertFormula(e,o,c,_){return this.core.insertFormula(e,o,c,_)}getSelection(){return this.isIframe?(this.target.contentWindow.focus(),this.target.contentWindow.getSelection()):(this.target.focus(),window.getSelection())}addEvents(){const e=this.isIframe?this.target.contentWindow.document:this.target;At.addElementEvents(e,(o,c)=>{this.doubleClickHandler(o,c)},(o,c)=>{this.mousedownHandler(o,c)},(o,c)=>{this.mouseupHandler(o,c)})}doubleClickHandler(e){if(e.nodeName.toLowerCase()==="img"){this.core.getCustomEditors().disable();const o=zt.get("imageCustomEditorName");if(e.hasAttribute(o)){const c=e.getAttribute(o);this.core.getCustomEditors().enable(c)}At.containsClass(e,zt.get("imageClassName"))&&(this.core.editionProperties.temporalImage=e,this.core.editionProperties.isNewElement=!0,this.openExistingFormulaEditor())}}mouseupHandler(){this.temporalImageResizing&&setTimeout(()=>{er.fixAfterResize(this.temporalImageResizing)},10)}mousedownHandler(e){e.nodeName.toLowerCase()==="img"&&At.containsClass(e,zt.get("imageClassName"))&&(this.temporalImageResizing=e)}getLanguage(){return this.getBrowserLanguage()}getBrowserLanguage(){let e="en";return navigator.userLanguage?e=navigator.userLanguage.substring(0,2):navigator.language?e=navigator.language.substring(0,2):e="en",e}callbackFunction(){const e=wr.newListener("onTargetReady",()=>{this.addEvents(this.target)});this.listeners.add(e)}notifyWindowClosed(){}getMathmlFromTextNode(e,o){}fillNonLatexNode(e,o,c){}getSelectedItem(e,o){}}qr.prototype.getMathmlFromTextNode=void 0,qr.prototype.fillNonLatexNode=void 0,qr.prototype.getSelectedItem=void 0,qr.integrationParameters=["serviceProviderProperties","editorParameters"];class Iy extends qr{constructor(e){const o=e.editorObject;typeof o.config<"u"&&typeof o.config.get("mathTypeParameters")<"u"&&(e.integrationParameters=o.config.get("mathTypeParameters")),super(e),this.integrationFolderName="ckeditor_wiris"}getLanguage(){return this.editorObject.config.get("language")}addEditorListeners(){const e=this.editorObject;(typeof e.config.wirislistenersdisabled>"u"||!e.config.wirislistenersdisabled)&&this.checkElement()}checkElement(){const o=this.editorObject.sourceElement;o.wirisActive||(this.setTarget(o),this.addEvents(),o.wirisActive=!0)}doubleClickHandler(e,o){if(e.nodeName.toLowerCase()=="img"&&At.containsClass(e,zt.get("imageClassName"))){typeof o.stopPropagation<"u"?o.stopPropagation():o.returnValue=!1,this.core.getCustomEditors().disable();const c=e.getAttribute(zt.get("imageCustomEditorName"));c&&this.core.getCustomEditors().enable(c),this.core.editionProperties.temporalImage=e,this.openExistingFormulaEditor()}}getCorePath(){return null}callbackFunction(){super.callbackFunction(),this.addEditorListeners()}openNewFormulaEditor(){return this.core.editionProperties.selection=this.editorObject.editing.view.document.selection,super.openNewFormulaEditor()}insertMathml(e){return this.editorObject.model.change(o=>{const c=this.getCore(),_=o.createElement("mathml",{formula:e});if(c.editionProperties.isNewElement){if(!e)return;let j=this.core.editionProperties.selection||this.editorObject.editing.view.document.selection,_e=this.editorObject.editing.mapper.toModelPosition(j.getLastPosition());if(o.insert(_,_e),!j.isCollapsed)for(const et of j.getRanges())o.remove(this.editorObject.editing.mapper.toModelRange(et))}else{const j=c.editionProperties.temporalImage,_e=this.editorObject.editing.view.domConverter.domToView(j).parent,et=this.editorObject.editing.mapper.toModelElement(_e),nt=this.editorObject.model.createPositionBefore(et);e&&o.insert(_,nt),o.remove(et)}return _})}findText(e){let o=e,c;for(;!c;)c=this.editorObject.editing.mapper.toModelElement(this.editorObject.editing.view.domConverter.domToView(o)),o=o.parentElement;const _=this.editorObject.model.createRangeIn(c),j=Array.from(_.getItems());for(const _e of j)if(_e.is("textProxy")&&_e.data==e.data.replace(""," "))return _e.textNode}insertFormula(e,o,c,_){let j={};return c?this.core.editMode=="latex"?(j.latex=Bn.getLatexFromMathML(c),j.node=o.document.createTextNode("$$"+j.latex+"$$"),this.editorObject.model.change(_e=>{const et=this.core.editionProperties.latexRange,nt=this.findText(et.startContainer),st=this.findText(et.endContainer),at=_e.createPositionAt(nt.parent,nt.startOffset+et.startOffset),ct=_e.createPositionAt(st.parent,st.startOffset+et.endOffset),dt=_e.createRange(at,ct);_e.remove(dt),_e.insertText("$$"+j.latex+"$$",nt.getAttributes(),at)})):j.node=this.editorObject.editing.view.domConverter.viewToDom(this.editorObject.editing.mapper.toViewElement(this.insertMathml(c)),o.document):this.insertMathml(""),j}notifyWindowClosed(){this.editorObject.editing.view.focus()}}class Py extends hn{constructor(e){super(e)}execute(e={}){if(!e.hasOwnProperty("integration")||!(e.integration instanceof Iy))throw'Must pass a valid CKEditor5Integration instance as attribute "integration" of options';this.integration=e.integration,this.setEditor(),this.openEditor()}setEditor(){this.integration.core.getCustomEditors().disable()}openEditor(){const e=this._getSelectedImage();typeof e<"u"&&e!==null&&e.classList.contains(WirisPlugin.Configuration.get("imageClassName"))?(this.integration.core.editionProperties.temporalImage=e,this.integration.openExistingFormulaEditor()):this.integration.openNewFormulaEditor()}_getSelectedImage(){const e=this.editor.editing.view.document.selection;if(e.isCollapsed||e.rangeCount!==1)return;const o=e.getFirstRange();let c;for(const _ of o){if(_.item.name!=="span")return;c=_.item.getChild(0);break}if(c)return this.editor.editing.view.domConverter.mapViewToDom(c)}}class S2 extends Py{setEditor(){this.integration.core.getCustomEditors().enable("chemistry")}}var I2=`<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 22.0.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 300 261.7" style="enable-background:new 0 0 300 261.7;" xml:space="preserve">
<style type="text/css">
	.st0{fill:#FFFFFF;}
	.st1{fill:#EF4A5F;}
	.st2{fill:#C8202F;}
</style>
<path class="st0" d="M300,32.8c0-16.4-13.4-29.7-29.9-29.7c-2.9,0-7.2,0.8-7.2,0.8c-37.9,9.1-71.3,14-112,14c-0.3,0-0.6,0-1,0
	c-16.5,0-29.9,13.3-29.9,29.7c0,16.4,13.4,29.7,29.9,29.7l0,0c45.3,0,83.1-5.3,125.3-15.3h0C289.3,59.5,300,47.4,300,32.8"/>
<path class="st0" d="M90.2,257.7c-11.4,0-21.9-6.4-27-16.7l-60-119.9c-7.5-14.9-1.4-33.1,13.5-40.5c14.9-7.5,33.1-1.4,40.5,13.5
	l27.3,54.7L121.1,39c5.3-15.8,22.4-24.4,38.2-19.1c15.8,5.3,24.4,22.4,19.1,38.2l-59.6,179c-3.9,11.6-14.3,19.7-26.5,20.6
	C91.6,257.7,90.9,257.7,90.2,257.7"/>
<g>
	<g>
		<path class="st1" d="M90.2,257.7c-11.4,0-21.9-6.4-27-16.7l-60-119.9c-7.5-14.9-1.4-33.1,13.5-40.5c14.9-7.5,33.1-1.4,40.5,13.5
			l27.3,54.7L121.1,39c5.3-15.8,22.4-24.4,38.2-19.1c15.8,5.3,24.4,22.4,19.1,38.2l-59.6,179c-3.9,11.6-14.3,19.7-26.5,20.6
			C91.6,257.7,90.9,257.7,90.2,257.7"/>
	</g>
</g>
<g>
	<g>
		<path class="st2" d="M300,32.8c0-16.4-13.4-29.7-29.9-29.7c-2.9,0-7.2,0.8-7.2,0.8c-37.9,9.1-71.3,14-112,14c-0.3,0-0.6,0-1,0
			c-16.5,0-29.9,13.3-29.9,29.7c0,16.4,13.4,29.7,29.9,29.7l0,0c45.3,0,83.1-5.3,125.3-15.3h0C289.3,59.5,300,47.4,300,32.8"/>
	</g>
</g>
</svg>
`,P2=`<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 22.0.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 40.3 49.5" style="enable-background:new 0 0 40.3 49.5;" xml:space="preserve">
<style type="text/css">
	.st0{fill:#A4CF61;}
</style>
<path class="st0" d="M39.2,12.1c0-1.9-1.1-3.6-2.7-4.4L24.5,0.9l0,0c-0.7-0.4-1.5-0.6-2.4-0.6c-0.9,0-1.7,0.2-2.4,0.6l0,0L2.3,10.8
	l0,0C0.9,11.7,0,13.2,0,14.9h0v19.6h0c0,1.7,0.9,3.3,2.3,4.1l0,0l17.4,9.9l0,0c0.7,0.4,1.5,0.6,2.4,0.6c0.9,0,1.7-0.2,2.4-0.6l0,0
	l12.2-6.9h0c1.5-0.8,2.6-2.5,2.6-4.3c0-2.7-2.2-4.9-4.9-4.9c-0.9,0-1.8,0.3-2.5,0.7l0,0l-9.7,5.6l-12.3-7V17.8l12.3-7l9.9,5.7l0,0
	c0.7,0.4,1.5,0.6,2.4,0.6C37,17,39.2,14.8,39.2,12.1"/>
</svg>
`;class R2 extends Ut{static get requires(){return[$o]}static get pluginName(){return"MathType"}init(){const e=this._addIntegration();this._addCommands(),this._addViews(e),this._addSchema(),this._addConverters(),this._exposeWiris()}_addIntegration(){const e=this.editor,o={};o.environment={},o.environment.editor="CKEditor5",o.editorObject=e,o.serviceProviderProperties={},o.serviceProviderProperties.URI="https://www.wiris.net/demo/plugins/app",o.serviceProviderProperties.server="java",o.target=e.sourceElement,o.scriptName="bundle.js",o.managesLanguage=!0;let c;return o.target&&(c=new Iy(o),c.init(),c.listeners.fire("onTargetReady",{}),c.checkElement(),this.listenTo(e.editing.view.document,"click",(_,j)=>{j.domEvent.detail==2&&(c.doubleClickHandler(j.domTarget,j.domEvent),_.stop())},{priority:"highest"})),c}_addCommands(){const e=this.editor;e.commands.add("MathType",new Py(e)),e.commands.add("ChemType",new S2(e))}_addViews(e){const o=this.editor;o.ui.componentFactory.add("MathType",c=>{const _=new Sn(c);return _.bind("isEnabled").to(o.commands.get("MathType"),"isEnabled"),_.set({label:"Insert a math equation - MathType",icon:I2,tooltip:!0}),_.on("execute",()=>{o.execute("MathType",{integration:e})}),_}),o.ui.componentFactory.add("ChemType",c=>{const _=new Sn(c);return _.bind("isEnabled").to(o.commands.get("ChemType"),"isEnabled"),_.set({label:"Insert a chemistry formula - ChemType",icon:P2,tooltip:!0}),_.on("execute",()=>{o.execute("ChemType",{integration:e})}),_}),o.editing.view.addObserver(Iv)}_addSchema(){this.editor.model.schema.register("mathml",{allowWhere:"$text",isObject:!0,isInline:!0,allowAttributes:["formula"]})}_addConverters(){const e=this.editor;e.conversion.for("upcast").elementToElement({view:{name:"span",classes:"ck-math-widget"},model:(et,nt)=>{const st=fn.safeXmlDecode(et.getChild(0).getAttribute("data-mathml"));return nt.createElement("mathml",{formula:st})}}),e.data.upcastDispatcher.on("element:math",(et,nt,st)=>{const{consumable:at,writer:ct}=st,dt=nt.viewItem;if(!at.test(dt,{name:!0}))return;let gt=o(dt);const kt=new f2(e.editing.view.document),Nt=new Xs(e.editing.view.document).createDocumentFragment(dt.getChildren()),Wt=[...dt.getAttributes()].map(([Cn,Vn])=>` ${Cn}="${Vn}"`).join("");let tn=kt.toData(Nt)||"";tn=`<math${Wt}>${tn}</math>`;const nn=gt?ct.createText(yn.initParse(tn,e.config.get("language"))):ct.createElement("mathml",{formula:tn}),un=st.splitToAllowedParent(nn,nt.modelCursor);if(!un)return;st.writer.insert(nn,un.position),at.consume(dt,{name:!0});const rr=st.getSplitParts(nn);nt.modelRange=ct.createRange(st.writer.createPositionBefore(nn),st.writer.createPositionAfter(rr[rr.length-1])),un.cursorParent?nt.modelCursor=st.writer.createPositionAt(un.cursorParent,0):nt.modelCursor=nt.modelRange.end});function o(et){const nt=et.getChild(0);if(!nt||nt.name!=="semantics")return!1;for(const st of nt.getChildren())if(st.name==="annotation"&&st.getAttribute("encoding")==="LaTeX")return!0;return!1}e.conversion.for("editingDowncast").elementToElement({model:"mathml",view:j}),e.conversion.for("dataDowncast").elementToElement({model:"mathml",view:_});function c(et,nt){if(nt.is("text"))return et.createText(nt.data);if(nt.is("element")){if(nt.is("emptyElement"))return et.createEmptyElement(nt.name,nt.getAttributes());{const st=et.createContainerElement(nt.name,nt.getAttributes());for(const at of nt.getChildren())et.insert(et.createPositionAt(st,"end"),c(et,at));return st}}throw new Exception("Given node has unsupported type.")}function _(et,nt){const st=new No(nt.document);let at=yn.endParseSaveMode(et.getAttribute("formula"));zt.get("saveHandTraces")||(at=fn.removeAnnotation(at,"application/json"));const ct=st.toView(at).getChild(0);return c(nt,ct)}function j(et,nt){const st=nt.createContainerElement("span",{class:"ck-math-widget"}),at=_e(et,nt);return nt.insert(nt.createPositionAt(st,0),at),Bo(st,nt)}function _e(et,nt){const st=new No(nt.document),at=et.getAttribute("formula"),ct=yn.initParse(at,e.config.get("language")),dt=st.toView(ct).getChild(0);return nt.createEmptyElement("img",dt.getAttributes())}}_exposeWiris(){window.WirisPlugin={Core:tr,Parser:yn,Image:er,MathML:fn,Util:At,Configuration:zt,Listeners:wr,IntegrationModel:qr,Latex:Bn}}}function*Ry(h,e){for(const o of e)o&&h.getAttributeProperties(o[0]).copyOnEnter&&(yield o)}class N2 extends hn{execute(){const e=this.editor.model,o=e.document;e.change(c=>{O2(this.editor.model,c,o.selection,e.schema),this.fire("afterExecute",{writer:c})})}}function O2(h,e,o,c){const _=o.isCollapsed,j=o.getFirstRange(),_e=j.start.parent,et=j.end.parent;if(c.isLimit(_e)||c.isLimit(et)){!_&&_e==et&&h.deleteContent(o);return}if(_){const nt=Ry(e.model.schema,o.getAttributes());Ny(e,j.start),e.setSelectionAttribute(nt)}else{const nt=!(j.start.isAtStart&&j.end.isAtEnd),st=_e==et;h.deleteContent(o,{leaveUnmerged:nt}),nt&&(st?Ny(e,o.focus):e.setSelection(et,0))}}function Ny(h,e){h.split(e),h.setSelection(e.parent.nextSibling,0)}class Oy extends zr{constructor(e){super(e);const o=this.document;o.on("keydown",(c,_)=>{if(this.isEnabled&&_.keyCode==mn.enter){let j;o.once("enter",_e=>j=_e,{priority:"highest"}),o.fire("enter",new au(o,_.domEvent,{isSoft:_.shiftKey})),j&&j.stop.called&&c.stop()}})}observe(){}}class M2 extends Ut{static get pluginName(){return"Enter"}init(){const e=this.editor,o=e.editing.view,c=o.document;o.addObserver(Oy),e.commands.add("enter",new N2(e)),this.listenTo(c,"enter",(_,j)=>{j.preventDefault(),!j.isSoft&&(e.execute("enter"),o.scrollToTheSelection())},{priority:"low"})}}class j2 extends hn{execute(){const e=this.editor.model,o=e.document;e.change(c=>{D2(e,c,o.selection),this.fire("afterExecute",{writer:c})})}refresh(){const e=this.editor.model,o=e.document;this.isEnabled=L2(e.schema,o.selection)}}function L2(h,e){if(e.rangeCount>1)return!1;const o=e.anchor;if(!o||!h.checkChild(o,"softBreak"))return!1;const c=e.getFirstRange(),_=c.start.parent,j=c.end.parent;return!((dp(_,h)||dp(j,h))&&_!==j)}function D2(h,e,o){const c=o.isCollapsed,_=o.getFirstRange(),j=_.start.parent,_e=_.end.parent,et=j==_e;if(c){const nt=Ry(h.schema,o.getAttributes());My(h,e,_.end),e.removeSelectionAttribute(o.getAttributeKeys()),e.setSelectionAttribute(nt)}else{const nt=!(_.start.isAtStart&&_.end.isAtEnd);h.deleteContent(o,{leaveUnmerged:nt}),et?My(h,e,o.focus):nt&&e.setSelection(_e,0)}}function My(h,e,o){const c=e.createElement("softBreak");h.insertContent(c,o),e.setSelection(c,"after")}function dp(h,e){return h.is("rootElement")?!1:e.isLimit(h)||dp(h.parent,e)}class F2 extends Ut{static get pluginName(){return"ShiftEnter"}init(){const e=this.editor,o=e.model.schema,c=e.conversion,_=e.editing.view,j=_.document;o.register("softBreak",{allowWhere:"$text",isInline:!0}),c.for("upcast").elementToElement({model:"softBreak",view:"br"}),c.for("downcast").elementToElement({model:"softBreak",view:(_e,et)=>et.createEmptyElement("br")}),_.addObserver(Oy),e.commands.add("shiftEnter",new j2(e)),this.listenTo(j,"enter",(_e,et)=>{et.preventDefault(),et.isSoft&&(e.execute("shiftEnter"),_.scrollToTheSelection())},{priority:"low"})}}class jy{constructor(e,o=20){this.model=e,this.size=0,this.limit=o,this.isLocked=!1,this._changeCallback=(c,_)=>{_.type!="transparent"&&_!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch()),this._batch}input(e){this.size+=e,this.size>=this.limit&&this._reset(!0)}lock(){this.isLocked=!0}unlock(){this.isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e){(!this.isLocked||e)&&(this._batch=null,this.size=0)}}class B2 extends hn{constructor(e,o){super(e),this._buffer=new jy(e.model,o),this._batches=new WeakSet}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const o=this.editor.model,c=o.document,_=e.text||"",j=_.length,_e=e.range?o.createSelection(e.range):c.selection,et=e.resultRange;o.enqueueChange(this._buffer.batch,nt=>{this._buffer.lock(),o.deleteContent(_e),_&&o.insertContent(nt.createText(_,c.selection.getAttributes()),_e),et?nt.setSelection(et):_e.is("documentSelection")||nt.setSelection(_e),this._buffer.unlock(),this._buffer.input(j),this._batches.add(this._buffer.batch)})}}function z2(h){let e=null;const o=h.model,c=h.editing.view,_=h.commands.get("input");ar.isAndroid?c.document.on("beforeinput",(nt,st)=>j(st),{priority:"lowest"}):c.document.on("keydown",(nt,st)=>j(st),{priority:"lowest"}),c.document.on("compositionstart",_e,{priority:"lowest"}),c.document.on("compositionend",()=>{e=o.createSelection(o.document.selection)},{priority:"lowest"});function j(nt){const st=o.document,at=c.document.isComposing,ct=e&&e.isEqual(st.selection);e=null,_.isEnabled&&(V2(nt)||st.selection.isCollapsed||at&&nt.keyCode===229||!at&&nt.keyCode===229&&ct||et())}function _e(){const nt=o.document,st=nt.selection.rangeCount===1?nt.selection.getFirstRange().isFlat:!0;nt.selection.isCollapsed||st||et()}function et(){const nt=_.buffer;nt.lock(),o.enqueueChange(nt.batch,()=>{o.deleteContent(o.document.selection)}),nt.unlock()}}const Ly=[Ir("arrowUp"),Ir("arrowRight"),Ir("arrowDown"),Ir("arrowLeft"),9,16,17,18,19,20,27,33,34,35,36,45,91,93,144,145,173,174,175,176,177,178,179,255];for(let h=112;h<=135;h++)Ly.push(h);function V2(h){return h.ctrlKey?!0:Ly.includes(h.keyCode)}function $2(h,e){const o=[];let c=0,_;return h.forEach(et=>{et=="equal"?(j(),c++):et=="insert"?(_e("insert")?_.values.push(e[c]):(j(),_={type:"insert",index:c,values:[e[c]]}),c++):_e("delete")?_.howMany++:(j(),_={type:"delete",index:c,howMany:1})}),j(),o;function j(){_&&(o.push(_),_=null)}function _e(et){return _&&_.type==et}}function U2(h){if(h.length==0)return!1;for(const e of h)if(e.type==="children"&&!Dy(e))return!0;return!1}function Dy(h){if(h.newChildren.length-h.oldChildren.length!=1)return;const e=Br(h.oldChildren,h.newChildren,W2),o=$2(e,h.newChildren);if(o.length>1)return;const c=o[0];if(c.values[0]&&c.values[0].is("text"))return c}function W2(h,e){return h&&h.is("text")&&e&&e.is("text")?h.data===e.data:h===e}function H2(h){h.editing.view.document.on("mutations",(e,o,c)=>{new G2(h).handle(o,c)})}class G2{constructor(e){this.editor=e,this.editing=this.editor.editing}handle(e,o){if(U2(e))this._handleContainerChildrenMutations(e,o);else for(const c of e)this._handleTextMutation(c,o),this._handleTextNodeInsertion(c)}_handleContainerChildrenMutations(e,o){const c=q2(e);if(!c)return;const j=this.editor.editing.view.domConverter.mapViewToDom(c),_e=new Fs(this.editor.editing.view.document),et=this.editor.data.toModel(_e.domToView(j)).getChild(0),nt=this.editor.editing.mapper.toModelElement(c);if(!nt)return;const st=Array.from(et.getChildren()),at=Array.from(nt.getChildren()),ct=st[st.length-1],dt=at[at.length-1];ct&&ct.is("softBreak")&&dt&&!dt.is("softBreak")&&st.pop();const gt=this.editor.model.schema;if(!Fy(st,gt)||!Fy(at,gt))return;const kt=st.map(Vn=>Vn.is("text")?Vn.data:"@").join("").replace(/\u00A0/g," "),Ct=at.map(Vn=>Vn.is("text")?Vn.data:"@").join("").replace(/\u00A0/g," ");if(Ct===kt)return;const Nt=Br(Ct,kt),{firstChangeAt:Wt,insertions:tn,deletions:nn}=By(Nt);let un=null;o&&(un=this.editing.mapper.toModelRange(o.getFirstRange()));const rr=kt.substr(Wt,tn),Cn=this.editor.model.createRange(this.editor.model.createPositionAt(nt,Wt),this.editor.model.createPositionAt(nt,Wt+nn));this.editor.execute("input",{text:rr,range:Cn,resultRange:un})}_handleTextMutation(e,o){if(e.type!="text")return;const c=e.newText.replace(/\u00A0/g," "),_=e.oldText.replace(/\u00A0/g," ");if(_===c)return;const j=Br(_,c),{firstChangeAt:_e,insertions:et,deletions:nt}=By(j);let st=null;o&&(st=this.editing.mapper.toModelRange(o.getFirstRange()));const at=this.editing.view.createPositionAt(e.node,_e),ct=this.editing.mapper.toModelPosition(at),dt=this.editor.model.createRange(ct,ct.getShiftedBy(nt)),gt=c.substr(_e,et);this.editor.execute("input",{text:gt,range:dt,resultRange:st})}_handleTextNodeInsertion(e){if(e.type!="children")return;const o=Dy(e),c=this.editing.view.createPositionAt(e.node,o.index),_=this.editing.mapper.toModelPosition(c),j=o.values[0].data;this.editor.execute("input",{text:j.replace(/\u00A0/g," "),range:this.editor.model.createRange(_)})}}function q2(h){const e=h.map(o=>o.node).reduce((o,c)=>o.getCommonAncestor(c,{includeSelf:!0}));if(e)return e.getAncestors({includeSelf:!0,parentFirst:!0}).find(o=>o.is("containerElement")||o.is("rootElement"))}function Fy(h,e){return h.every(o=>e.isInline(o))}function By(h){let e=null,o=null;for(let j=0;j<h.length;j++)h[j]!="equal"&&(e=e===null?j:e,o=j);let c=0,_=0;for(let j=e;j<=o;j++)h[j]!="insert"&&c++,h[j]!="delete"&&_++;return{insertions:_,deletions:c,firstChangeAt:e}}class K2 extends Ut{static get pluginName(){return"Input"}init(){const e=this.editor,o=new B2(e,e.config.get("typing.undoStep")||20);e.commands.add("input",o),z2(e),H2(e)}isInput(e){return this.editor.commands.get("input")._batches.has(e)}}class zy extends hn{constructor(e,o){super(e),this.direction=o,this._buffer=new jy(e.model,e.config.get("typing.undoStep"))}get buffer(){return this._buffer}execute(e={}){const o=this.editor.model,c=o.document;o.enqueueChange(this._buffer.batch,_=>{this._buffer.lock();const j=_.createSelection(e.selection||c.selection),_e=j.isCollapsed;if(j.isCollapsed&&o.modifySelection(j,{direction:this.direction,unit:e.unit}),this._shouldEntireContentBeReplacedWithParagraph(e.sequence||1)){this._replaceEntireContentWithParagraph(_);return}if(j.isCollapsed)return;let et=0;j.getFirstRange().getMinimalFlatRanges().forEach(nt=>{et+=Xl(nt.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),o.deleteContent(j,{doNotResetEntireContent:_e,direction:this.direction}),this._buffer.input(et),_.setSelection(j),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const o=this.editor.model,_=o.document.selection,j=o.schema.getLimitElement(_);if(!(_.isCollapsed&&_.containsEntireContent(j))||!o.schema.checkChild(j,"paragraph"))return!1;const et=j.getChild(0);return!(et&&et.name==="paragraph")}_replaceEntireContentWithParagraph(e){const o=this.editor.model,_=o.document.selection,j=o.schema.getLimitElement(_),_e=e.createElement("paragraph");e.remove(e.createRangeIn(j)),e.insert(_e,j),e.setSelection(_e,0)}}class Y2 extends zr{constructor(e){super(e);const o=e.document;let c=0;o.on("keyup",(j,_e)=>{(_e.keyCode==mn.delete||_e.keyCode==mn.backspace)&&(c=0)}),o.on("keydown",(j,_e)=>{const et={};if(_e.keyCode==mn.delete)et.direction="forward",et.unit="character";else if(_e.keyCode==mn.backspace)et.direction="backward",et.unit="codePoint";else return;const nt=ar.isMac?_e.altKey:_e.ctrlKey;et.unit=nt?"word":et.unit,et.sequence=++c,_(j,_e.domEvent,et)}),ar.isAndroid&&o.on("beforeinput",(j,_e)=>{if(_e.domEvent.inputType!="deleteContentBackward")return;const et={unit:"codepoint",direction:"backward",sequence:1},nt=_e.domTarget.ownerDocument.defaultView.getSelection();nt.anchorNode==nt.focusNode&&nt.anchorOffset+1!=nt.focusOffset&&(et.selectionToRemove=e.domConverter.domSelectionToView(nt)),_(j,_e.domEvent,et)});function _(j,_e,et){let nt;o.once("delete",st=>nt=st,{priority:Number.POSITIVE_INFINITY}),o.fire("delete",new au(o,_e,et)),nt&&nt.stop.called&&j.stop()}}observe(){}}class Q2 extends Ut{static get pluginName(){return"Delete"}init(){const e=this.editor,o=e.editing.view,c=o.document;if(o.addObserver(Y2),e.commands.add("forwardDelete",new zy(e,"forward")),e.commands.add("delete",new zy(e,"backward")),this.listenTo(c,"delete",(_,j)=>{const _e={unit:j.unit,sequence:j.sequence};if(j.selectionToRemove){const et=e.model.createSelection(),nt=[];for(const st of j.selectionToRemove.getRanges())nt.push(e.editing.mapper.toModelRange(st));et.setTo(nt),_e.selection=et}e.execute(j.direction=="forward"?"forwardDelete":"delete",_e),j.preventDefault(),o.scrollToTheSelection()}),ar.isAndroid){let _=null;this.listenTo(c,"delete",(j,_e)=>{const et=_e.domTarget.ownerDocument.defaultView.getSelection();_={anchorNode:et.anchorNode,anchorOffset:et.anchorOffset,focusNode:et.focusNode,focusOffset:et.focusOffset}},{priority:"lowest"}),this.listenTo(c,"keyup",(j,_e)=>{if(_){const et=_e.domTarget.ownerDocument.defaultView.getSelection();et.collapse(_.anchorNode,_.anchorOffset),et.extend(_.focusNode,_.focusOffset),_=null}})}}}class J2 extends Ut{static get requires(){return[K2,Q2]}static get pluginName(){return"Typing"}}class X2 extends Ut{static get requires(){return[Es,M2,F2,J2,ey]}static get pluginName(){return"Essentials"}}class Vy extends Iu{}Vy.builtinPlugins=[MR,BR,UR,cO,Zw,mO,MO,BO,qO,YO,EM,AM,RM,FM,iL,TL,rD,d2,h2,R2,X2,xs]}]).default})})(ckeditor,ckeditor.exports);var ckeditorExports=ckeditor.exports;const ClassicEditor=getDefaultExportFromCjs(ckeditorExports);function Editor(){return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{children:"Using CKEditor5 build in React"}),jsxRuntimeExports.jsx(distExports.CKEditor,{editor:ClassicEditor,config:{toolbar:{items:["heading","MathType","ChemType","|","bold","italic","link","bulletedList","numberedList","imageUpload","mediaEmbed","insertTable","blockQuote","undo","redo"]}},data:"<p>Hello from CKEditor 5 with MathType!</p>",onInit:s=>{}})]})}function Card({image:s,exam_name:i,exam_def:a,url:d}){return jsxRuntimeExports.jsxs("div",{className:"card sm:min-w-96 w-auto bg-base-100 shadow-xl",children:[jsxRuntimeExports.jsx("figure",{className:"px-10 pt-10",children:jsxRuntimeExports.jsx("img",{src:s,alt:"Shoes",className:" w-32 h-32 rounded-xl"})}),jsxRuntimeExports.jsxs("div",{className:"card-body items-center text-center",children:[jsxRuntimeExports.jsx("h2",{className:"card-title",children:i}),jsxRuntimeExports.jsx("p",{children:a}),jsxRuntimeExports.jsx("div",{className:"card-actions",children:jsxRuntimeExports.jsx(NavLink,{to:d,children:jsxRuntimeExports.jsx("button",{className:"btn btn-primary",children:"Questions"})})})]})]})}function Exam(){return jsxRuntimeExports.jsx("div",{className:"mx-8 my-4",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full lg:flex-row",children:[jsxRuntimeExports.jsx("div",{className:"grid flex-grow h-auto card rounded-box place-items-center",children:jsxRuntimeExports.jsx(Card,{exam_name:"JEE Mains",exam_def:"Joint Entrance Exam Mains",image:"https://static.theprint.in/wp-content/uploads/2022/03/xxcsdcsd2022031012283320220310140153.jpg",url:"/mains"})}),jsxRuntimeExports.jsx("div",{className:"divider lg:divider-horizontal",children:"OR"}),jsxRuntimeExports.jsx("div",{className:"grid flex-grow h-auto card rounded-box place-items-center",children:jsxRuntimeExports.jsx(Card,{exam_name:"JEE Advance",exam_def:"Joint Entrance Exam Advanced",image:"https://education.sakshi.com/sites/default/files/images/2022/04/15/jee-advanced-1650010868.png",url:"/advance"})}),jsxRuntimeExports.jsx("div",{className:"divider lg:divider-horizontal",children:"OR"}),jsxRuntimeExports.jsx("div",{className:"grid flex-grow h-auto card rounded-box place-items-center",children:jsxRuntimeExports.jsx(Card,{exam_name:"NEET",exam_def:"National Eligibility cum Entrance Test",image:"https://theshillongtimes.com/wp-content/uploads/2020/10/NEET-logo.jpg",url:"/neet"})})]})})}function Year(){return jsxRuntimeExports.jsx("div",{children:"Year"})}var define_process_env_default$1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const assert=function(s,i){if(!s)throw assertionError(i)},assertionError=function(s){return new Error("Firebase Database ("+CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+s)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(s){const i=[];let a=0;for(let d=0;d<s.length;d++){let g=s.charCodeAt(d);g<128?i[a++]=g:g<2048?(i[a++]=g>>6|192,i[a++]=g&63|128):(g&64512)===55296&&d+1<s.length&&(s.charCodeAt(d+1)&64512)===56320?(g=65536+((g&1023)<<10)+(s.charCodeAt(++d)&1023),i[a++]=g>>18|240,i[a++]=g>>12&63|128,i[a++]=g>>6&63|128,i[a++]=g&63|128):(i[a++]=g>>12|224,i[a++]=g>>6&63|128,i[a++]=g&63|128)}return i},byteArrayToString=function(s){const i=[];let a=0,d=0;for(;a<s.length;){const g=s[a++];if(g<128)i[d++]=String.fromCharCode(g);else if(g>191&&g<224){const b=s[a++];i[d++]=String.fromCharCode((g&31)<<6|b&63)}else if(g>239&&g<365){const b=s[a++],$=s[a++],tt=s[a++],it=((g&7)<<18|(b&63)<<12|($&63)<<6|tt&63)-65536;i[d++]=String.fromCharCode(55296+(it>>10)),i[d++]=String.fromCharCode(56320+(it&1023))}else{const b=s[a++],$=s[a++];i[d++]=String.fromCharCode((g&15)<<12|(b&63)<<6|$&63)}}return i.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,i){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const a=i?this.byteToCharMapWebSafe_:this.byteToCharMap_,d=[];for(let g=0;g<s.length;g+=3){const b=s[g],$=g+1<s.length,tt=$?s[g+1]:0,it=g+2<s.length,rt=it?s[g+2]:0,ot=b>>2,lt=(b&3)<<4|tt>>4;let ut=(tt&15)<<2|rt>>6,pt=rt&63;it||(pt=64,$||(ut=64)),d.push(a[ot],a[lt],a[ut],a[pt])}return d.join("")},encodeString(s,i){return this.HAS_NATIVE_SUPPORT&&!i?btoa(s):this.encodeByteArray(stringToByteArray$1(s),i)},decodeString(s,i){return this.HAS_NATIVE_SUPPORT&&!i?atob(s):byteArrayToString(this.decodeStringToByteArray(s,i))},decodeStringToByteArray(s,i){this.init_();const a=i?this.charToByteMapWebSafe_:this.charToByteMap_,d=[];for(let g=0;g<s.length;){const b=a[s.charAt(g++)],tt=g<s.length?a[s.charAt(g)]:0;++g;const rt=g<s.length?a[s.charAt(g)]:64;++g;const lt=g<s.length?a[s.charAt(g)]:64;if(++g,b==null||tt==null||rt==null||lt==null)throw new DecodeBase64StringError;const ut=b<<2|tt>>4;if(d.push(ut),rt!==64){const pt=tt<<4&240|rt>>2;if(d.push(pt),lt!==64){const _t=rt<<6&192|lt;d.push(_t)}}}return d},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(s){const i=stringToByteArray$1(s);return base64.encodeByteArray(i,!0)},base64urlEncodeWithoutPadding=function(s){return base64Encode(s).replace(/\./g,"")},base64Decode=function(s){try{return base64.decodeString(s,!0)}catch(i){console.error("base64Decode failed: ",i)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function deepCopy(s){return deepExtend(void 0,s)}function deepExtend(s,i){if(!(i instanceof Object))return i;switch(i.constructor){case Date:const a=i;return new Date(a.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return i}for(const a in i)!i.hasOwnProperty(a)||!isValidKey$1(a)||(s[a]=deepExtend(s[a],i[a]));return s}function isValidKey$1(s){return s!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal$1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal$1().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process>"u"||typeof define_process_env_default$1>"u")return;const s=define_process_env_default$1.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},getDefaultsFromCookie=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const i=s&&base64Decode(s[1]);return i&&JSON.parse(i)},getDefaults=()=>{try{return getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},getDefaultEmulatorHost=s=>{var i,a;return(a=(i=getDefaults())===null||i===void 0?void 0:i.emulatorHosts)===null||a===void 0?void 0:a[s]},getDefaultEmulatorHostnameAndPort=s=>{const i=getDefaultEmulatorHost(s);if(!i)return;const a=i.lastIndexOf(":");if(a<=0||a+1===i.length)throw new Error(`Invalid host ${i} with no separate hostname and port!`);const d=parseInt(i.substring(a+1),10);return i[0]==="["?[i.substring(1,a-1),d]:[i.substring(0,a),d]},getDefaultAppConfig=()=>{var s;return(s=getDefaults())===null||s===void 0?void 0:s.config},getExperimentalSetting=s=>{var i;return(i=getDefaults())===null||i===void 0?void 0:i[`_${s}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Deferred$1=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((i,a)=>{this.resolve=i,this.reject=a})}wrapCallback(i){return(a,d)=>{a?this.reject(a):this.resolve(d),typeof i=="function"&&(this.promise.catch(()=>{}),i.length===1?i(a):i(a,d))}}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(s,i){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const a={alg:"none",type:"JWT"},d=i||"demo-project",g=s.iat||0,b=s.sub||s.user_id;if(!b)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const $=Object.assign({iss:`https://securetoken.google.com/${d}`,aud:d,iat:g,exp:g+3600,auth_time:g,sub:b,user_id:b,firebase:{sign_in_provider:"custom",identities:{}}},s);return[base64urlEncodeWithoutPadding(JSON.stringify(a)),base64urlEncodeWithoutPadding(JSON.stringify($)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isBrowserExtension(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function isReactNative(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isIE(){const s=getUA();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function isNodeSdk(){return CONSTANTS.NODE_ADMIN===!0}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((s,i)=>{try{let a=!0;const d="validate-browser-context-for-indexeddb-analytics-module",g=self.indexedDB.open(d);g.onsuccess=()=>{g.result.close(),a||self.indexedDB.deleteDatabase(d),s(!0)},g.onupgradeneeded=()=>{a=!1},g.onerror=()=>{var b;i(((b=g.error)===null||b===void 0?void 0:b.message)||"")}}catch(a){i(a)}})}function areCookiesEnabled(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(i,a,d){super(a),this.code=i,this.customData=d,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(i,a,d){this.service=i,this.serviceName=a,this.errors=d}create(i,...a){const d=a[0]||{},g=`${this.service}/${i}`,b=this.errors[i],$=b?replaceTemplate(b,d):"Error",tt=`${this.serviceName}: ${$} (${g}).`;return new FirebaseError(g,tt,d)}}function replaceTemplate(s,i){return s.replace(PATTERN,(a,d)=>{const g=i[d];return g!=null?String(g):`<${d}?>`})}const PATTERN=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jsonEval(s){return JSON.parse(s)}function stringify(s){return JSON.stringify(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const decode=function(s){let i={},a={},d={},g="";try{const b=s.split(".");i=jsonEval(base64Decode(b[0])||""),a=jsonEval(base64Decode(b[1])||""),g=b[2],d=a.d||{},delete a.d}catch{}return{header:i,claims:a,data:d,signature:g}},isValidFormat=function(s){const i=decode(s),a=i.claims;return!!a&&typeof a=="object"&&a.hasOwnProperty("iat")},isAdmin=function(s){const i=decode(s).claims;return typeof i=="object"&&i.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function contains(s,i){return Object.prototype.hasOwnProperty.call(s,i)}function safeGet(s,i){if(Object.prototype.hasOwnProperty.call(s,i))return s[i]}function isEmpty(s){for(const i in s)if(Object.prototype.hasOwnProperty.call(s,i))return!1;return!0}function map(s,i,a){const d={};for(const g in s)Object.prototype.hasOwnProperty.call(s,g)&&(d[g]=i.call(a,s[g],g,s));return d}function deepEqual(s,i){if(s===i)return!0;const a=Object.keys(s),d=Object.keys(i);for(const g of a){if(!d.includes(g))return!1;const b=s[g],$=i[g];if(isObject(b)&&isObject($)){if(!deepEqual(b,$))return!1}else if(b!==$)return!1}for(const g of d)if(!a.includes(g))return!1;return!0}function isObject(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(s){const i=[];for(const[a,d]of Object.entries(s))Array.isArray(d)?d.forEach(g=>{i.push(encodeURIComponent(a)+"="+encodeURIComponent(g))}):i.push(encodeURIComponent(a)+"="+encodeURIComponent(d));return i.length?"&"+i.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sha1{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let i=1;i<this.blockSize;++i)this.pad_[i]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(i,a){a||(a=0);const d=this.W_;if(typeof i=="string")for(let lt=0;lt<16;lt++)d[lt]=i.charCodeAt(a)<<24|i.charCodeAt(a+1)<<16|i.charCodeAt(a+2)<<8|i.charCodeAt(a+3),a+=4;else for(let lt=0;lt<16;lt++)d[lt]=i[a]<<24|i[a+1]<<16|i[a+2]<<8|i[a+3],a+=4;for(let lt=16;lt<80;lt++){const ut=d[lt-3]^d[lt-8]^d[lt-14]^d[lt-16];d[lt]=(ut<<1|ut>>>31)&4294967295}let g=this.chain_[0],b=this.chain_[1],$=this.chain_[2],tt=this.chain_[3],it=this.chain_[4],rt,ot;for(let lt=0;lt<80;lt++){lt<40?lt<20?(rt=tt^b&($^tt),ot=1518500249):(rt=b^$^tt,ot=1859775393):lt<60?(rt=b&$|tt&(b|$),ot=2400959708):(rt=b^$^tt,ot=3395469782);const ut=(g<<5|g>>>27)+rt+it+ot+d[lt]&4294967295;it=tt,tt=$,$=(b<<30|b>>>2)&4294967295,b=g,g=ut}this.chain_[0]=this.chain_[0]+g&4294967295,this.chain_[1]=this.chain_[1]+b&4294967295,this.chain_[2]=this.chain_[2]+$&4294967295,this.chain_[3]=this.chain_[3]+tt&4294967295,this.chain_[4]=this.chain_[4]+it&4294967295}update(i,a){if(i==null)return;a===void 0&&(a=i.length);const d=a-this.blockSize;let g=0;const b=this.buf_;let $=this.inbuf_;for(;g<a;){if($===0)for(;g<=d;)this.compress_(i,g),g+=this.blockSize;if(typeof i=="string"){for(;g<a;)if(b[$]=i.charCodeAt(g),++$,++g,$===this.blockSize){this.compress_(b),$=0;break}}else for(;g<a;)if(b[$]=i[g],++$,++g,$===this.blockSize){this.compress_(b),$=0;break}}this.inbuf_=$,this.total_+=a}digest(){const i=[];let a=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let g=this.blockSize-1;g>=56;g--)this.buf_[g]=a&255,a/=256;this.compress_(this.buf_);let d=0;for(let g=0;g<5;g++)for(let b=24;b>=0;b-=8)i[d]=this.chain_[g]>>b&255,++d;return i}}function createSubscribe(s,i){const a=new ObserverProxy(s,i);return a.subscribe.bind(a)}class ObserverProxy{constructor(i,a){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=a,this.task.then(()=>{i(this)}).catch(d=>{this.error(d)})}next(i){this.forEachObserver(a=>{a.next(i)})}error(i){this.forEachObserver(a=>{a.error(i)}),this.close(i)}complete(){this.forEachObserver(i=>{i.complete()}),this.close()}subscribe(i,a,d){let g;if(i===void 0&&a===void 0&&d===void 0)throw new Error("Missing Observer.");implementsAnyMethods(i,["next","error","complete"])?g=i:g={next:i,error:a,complete:d},g.next===void 0&&(g.next=noop$2),g.error===void 0&&(g.error=noop$2),g.complete===void 0&&(g.complete=noop$2);const b=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?g.error(this.finalError):g.complete()}catch{}}),this.observers.push(g),b}unsubscribeOne(i){this.observers===void 0||this.observers[i]===void 0||(delete this.observers[i],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(i){if(!this.finalized)for(let a=0;a<this.observers.length;a++)this.sendOne(a,i)}sendOne(i,a){this.task.then(()=>{if(this.observers!==void 0&&this.observers[i]!==void 0)try{a(this.observers[i])}catch(d){typeof console<"u"&&console.error&&console.error(d)}})}close(i){this.finalized||(this.finalized=!0,i!==void 0&&(this.finalError=i),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function implementsAnyMethods(s,i){if(typeof s!="object"||s===null)return!1;for(const a of i)if(a in s&&typeof s[a]=="function")return!0;return!1}function noop$2(){}function errorPrefix(s,i){return`${s} failed: ${i} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray=function(s){const i=[];let a=0;for(let d=0;d<s.length;d++){let g=s.charCodeAt(d);if(g>=55296&&g<=56319){const b=g-55296;d++,assert(d<s.length,"Surrogate pair missing trail surrogate.");const $=s.charCodeAt(d)-56320;g=65536+(b<<10)+$}g<128?i[a++]=g:g<2048?(i[a++]=g>>6|192,i[a++]=g&63|128):g<65536?(i[a++]=g>>12|224,i[a++]=g>>6&63|128,i[a++]=g&63|128):(i[a++]=g>>18|240,i[a++]=g>>12&63|128,i[a++]=g>>6&63|128,i[a++]=g&63|128)}return i},stringLength=function(s){let i=0;for(let a=0;a<s.length;a++){const d=s.charCodeAt(a);d<128?i++:d<2048?i+=2:d>=55296&&d<=56319?(i+=4,a++):i+=3}return i};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_INTERVAL_MILLIS=1e3,DEFAULT_BACKOFF_FACTOR=2,MAX_VALUE_MILLIS=4*60*60*1e3,RANDOM_FACTOR=.5;function calculateBackoffMillis(s,i=DEFAULT_INTERVAL_MILLIS,a=DEFAULT_BACKOFF_FACTOR){const d=i*Math.pow(a,s),g=Math.round(RANDOM_FACTOR*d*(Math.random()-.5)*2);return Math.min(MAX_VALUE_MILLIS,d+g)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(s){return s&&s._delegate?s._delegate:s}class Component{constructor(i,a,d){this.name=i,this.instanceFactory=a,this.type=d,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(i){return this.instantiationMode=i,this}setMultipleInstances(i){return this.multipleInstances=i,this}setServiceProps(i){return this.serviceProps=i,this}setInstanceCreatedCallback(i){return this.onInstanceCreated=i,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Provider{constructor(i,a){this.name=i,this.container=a,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(i){const a=this.normalizeInstanceIdentifier(i);if(!this.instancesDeferred.has(a)){const d=new Deferred$1;if(this.instancesDeferred.set(a,d),this.isInitialized(a)||this.shouldAutoInitialize())try{const g=this.getOrInitializeService({instanceIdentifier:a});g&&d.resolve(g)}catch{}}return this.instancesDeferred.get(a).promise}getImmediate(i){var a;const d=this.normalizeInstanceIdentifier(i==null?void 0:i.identifier),g=(a=i==null?void 0:i.optional)!==null&&a!==void 0?a:!1;if(this.isInitialized(d)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:d})}catch(b){if(g)return null;throw b}else{if(g)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(i){if(i.name!==this.name)throw Error(`Mismatching Component ${i.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=i,!!this.shouldAutoInitialize()){if(isComponentEager(i))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch{}for(const[a,d]of this.instancesDeferred.entries()){const g=this.normalizeInstanceIdentifier(a);try{const b=this.getOrInitializeService({instanceIdentifier:g});d.resolve(b)}catch{}}}}clearInstance(i=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(i),this.instancesOptions.delete(i),this.instances.delete(i)}async delete(){const i=Array.from(this.instances.values());await Promise.all([...i.filter(a=>"INTERNAL"in a).map(a=>a.INTERNAL.delete()),...i.filter(a=>"_delete"in a).map(a=>a._delete())])}isComponentSet(){return this.component!=null}isInitialized(i=DEFAULT_ENTRY_NAME$1){return this.instances.has(i)}getOptions(i=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(i)||{}}initialize(i={}){const{options:a={}}=i,d=this.normalizeInstanceIdentifier(i.instanceIdentifier);if(this.isInitialized(d))throw Error(`${this.name}(${d}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const g=this.getOrInitializeService({instanceIdentifier:d,options:a});for(const[b,$]of this.instancesDeferred.entries()){const tt=this.normalizeInstanceIdentifier(b);d===tt&&$.resolve(g)}return g}onInit(i,a){var d;const g=this.normalizeInstanceIdentifier(a),b=(d=this.onInitCallbacks.get(g))!==null&&d!==void 0?d:new Set;b.add(i),this.onInitCallbacks.set(g,b);const $=this.instances.get(g);return $&&i($,g),()=>{b.delete(i)}}invokeOnInitCallbacks(i,a){const d=this.onInitCallbacks.get(a);if(d)for(const g of d)try{g(i,a)}catch{}}getOrInitializeService({instanceIdentifier:i,options:a={}}){let d=this.instances.get(i);if(!d&&this.component&&(d=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(i),options:a}),this.instances.set(i,d),this.instancesOptions.set(i,a),this.invokeOnInitCallbacks(d,i),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,i,d)}catch{}return d||null}normalizeInstanceIdentifier(i=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?i:DEFAULT_ENTRY_NAME$1:i}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function normalizeIdentifierForFactory(s){return s===DEFAULT_ENTRY_NAME$1?void 0:s}function isComponentEager(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor(i){this.name=i,this.providers=new Map}addComponent(i){const a=this.getProvider(i.name);if(a.isComponentSet())throw new Error(`Component ${i.name} has already been registered with ${this.name}`);a.setComponent(i)}addOrOverwriteComponent(i){this.getProvider(i.name).isComponentSet()&&this.providers.delete(i.name),this.addComponent(i)}getProvider(i){if(this.providers.has(i))return this.providers.get(i);const a=new Provider(i,this);return this.providers.set(i,a),a}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LogLevel;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(s,i,...a)=>{if(i<s.logLevel)return;const d=new Date().toISOString(),g=ConsoleMethod[i];if(g)console[g](`[${d}]  ${s.name}:`,...a);else throw new Error(`Attempted to log a message with an invalid logType (value: ${i})`)};class Logger{constructor(i){this.name=i,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(i){if(!(i in LogLevel))throw new TypeError(`Invalid value "${i}" assigned to \`logLevel\``);this._logLevel=i}setLogLevel(i){this._logLevel=typeof i=="string"?levelStringToEnum[i]:i}get logHandler(){return this._logHandler}set logHandler(i){if(typeof i!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=i}get userLogHandler(){return this._userLogHandler}set userLogHandler(i){this._userLogHandler=i}debug(...i){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...i),this._logHandler(this,LogLevel.DEBUG,...i)}log(...i){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...i),this._logHandler(this,LogLevel.VERBOSE,...i)}info(...i){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...i),this._logHandler(this,LogLevel.INFO,...i)}warn(...i){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...i),this._logHandler(this,LogLevel.WARN,...i)}error(...i){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...i),this._logHandler(this,LogLevel.ERROR,...i)}}const instanceOfAny=(s,i)=>i.some(a=>s instanceof a);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(s){const i=new Promise((a,d)=>{const g=()=>{s.removeEventListener("success",b),s.removeEventListener("error",$)},b=()=>{a(wrap(s.result)),g()},$=()=>{d(s.error),g()};s.addEventListener("success",b),s.addEventListener("error",$)});return i.then(a=>{a instanceof IDBCursor&&cursorRequestMap.set(a,s)}).catch(()=>{}),reverseTransformCache.set(i,s),i}function cacheDonePromiseForTransaction(s){if(transactionDoneMap.has(s))return;const i=new Promise((a,d)=>{const g=()=>{s.removeEventListener("complete",b),s.removeEventListener("error",$),s.removeEventListener("abort",$)},b=()=>{a(),g()},$=()=>{d(s.error||new DOMException("AbortError","AbortError")),g()};s.addEventListener("complete",b),s.addEventListener("error",$),s.addEventListener("abort",$)});transactionDoneMap.set(s,i)}let idbProxyTraps={get(s,i,a){if(s instanceof IDBTransaction){if(i==="done")return transactionDoneMap.get(s);if(i==="objectStoreNames")return s.objectStoreNames||transactionStoreNamesMap.get(s);if(i==="store")return a.objectStoreNames[1]?void 0:a.objectStore(a.objectStoreNames[0])}return wrap(s[i])},set(s,i,a){return s[i]=a,!0},has(s,i){return s instanceof IDBTransaction&&(i==="done"||i==="store")?!0:i in s}};function replaceTraps(s){idbProxyTraps=s(idbProxyTraps)}function wrapFunction(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(i,...a){const d=s.call(unwrap(this),i,...a);return transactionStoreNamesMap.set(d,i.sort?i.sort():[i]),wrap(d)}:getCursorAdvanceMethods().includes(s)?function(...i){return s.apply(unwrap(this),i),wrap(cursorRequestMap.get(this))}:function(...i){return wrap(s.apply(unwrap(this),i))}}function transformCachableValue(s){return typeof s=="function"?wrapFunction(s):(s instanceof IDBTransaction&&cacheDonePromiseForTransaction(s),instanceOfAny(s,getIdbProxyableTypes())?new Proxy(s,idbProxyTraps):s)}function wrap(s){if(s instanceof IDBRequest)return promisifyRequest(s);if(transformCache.has(s))return transformCache.get(s);const i=transformCachableValue(s);return i!==s&&(transformCache.set(s,i),reverseTransformCache.set(i,s)),i}const unwrap=s=>reverseTransformCache.get(s);function openDB(s,i,{blocked:a,upgrade:d,blocking:g,terminated:b}={}){const $=indexedDB.open(s,i),tt=wrap($);return d&&$.addEventListener("upgradeneeded",it=>{d(wrap($.result),it.oldVersion,it.newVersion,wrap($.transaction),it)}),a&&$.addEventListener("blocked",it=>a(it.oldVersion,it.newVersion,it)),tt.then(it=>{b&&it.addEventListener("close",()=>b()),g&&it.addEventListener("versionchange",rt=>g(rt.oldVersion,rt.newVersion,rt))}).catch(()=>{}),tt}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(s,i){if(!(s instanceof IDBDatabase&&!(i in s)&&typeof i=="string"))return;if(cachedMethods.get(i))return cachedMethods.get(i);const a=i.replace(/FromIndex$/,""),d=i!==a,g=writeMethods.includes(a);if(!(a in(d?IDBIndex:IDBObjectStore).prototype)||!(g||readMethods.includes(a)))return;const b=async function($,...tt){const it=this.transaction($,g?"readwrite":"readonly");let rt=it.store;return d&&(rt=rt.index(tt.shift())),(await Promise.all([rt[a](...tt),g&&it.done]))[0]};return cachedMethods.set(i,b),b}replaceTraps(s=>({...s,get:(i,a,d)=>getMethod(i,a)||s.get(i,a,d),has:(i,a)=>!!getMethod(i,a)||s.has(i,a)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(i){this.container=i}getPlatformInfoString(){return this.container.getProviders().map(a=>{if(isVersionServiceProvider(a)){const d=a.getImmediate();return`${d.library}/${d.version}`}else return null}).filter(a=>a).join(" ")}}function isVersionServiceProvider(s){const i=s.getComponent();return(i==null?void 0:i.type)==="VERSION"}const name$p="@firebase/app",version$1$1="0.10.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger$2=new Logger("@firebase/app"),name$o="@firebase/app-compat",name$n="@firebase/analytics-compat",name$m="@firebase/analytics",name$l="@firebase/app-check-compat",name$k="@firebase/app-check",name$j="@firebase/auth",name$i="@firebase/auth-compat",name$h="@firebase/database",name$g="@firebase/database-compat",name$f="@firebase/functions",name$e="@firebase/functions-compat",name$d="@firebase/installations",name$c="@firebase/installations-compat",name$b="@firebase/messaging",name$a="@firebase/messaging-compat",name$9="@firebase/performance",name$8="@firebase/performance-compat",name$7="@firebase/remote-config",name$6="@firebase/remote-config-compat",name$5="@firebase/storage",name$4$1="@firebase/storage-compat",name$3$1="@firebase/firestore",name$2$1="@firebase/vertexai-preview",name$1$1="@firebase/firestore-compat",name$q="firebase",version$a="10.12.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$p]:"fire-core",[name$o]:"fire-core-compat",[name$m]:"fire-analytics",[name$n]:"fire-analytics-compat",[name$k]:"fire-app-check",[name$l]:"fire-app-check-compat",[name$j]:"fire-auth",[name$i]:"fire-auth-compat",[name$h]:"fire-rtdb",[name$g]:"fire-rtdb-compat",[name$f]:"fire-fn",[name$e]:"fire-fn-compat",[name$d]:"fire-iid",[name$c]:"fire-iid-compat",[name$b]:"fire-fcm",[name$a]:"fire-fcm-compat",[name$9]:"fire-perf",[name$8]:"fire-perf-compat",[name$7]:"fire-rc",[name$6]:"fire-rc-compat",[name$5]:"fire-gcs",[name$4$1]:"fire-gcs-compat",[name$3$1]:"fire-fst",[name$1$1]:"fire-fst-compat",[name$2$1]:"fire-vertex","fire-js":"fire-js",[name$q]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_serverApps=new Map,_components=new Map;function _addComponent(s,i){try{s.container.addComponent(i)}catch(a){logger$2.debug(`Component ${i.name} failed to register with FirebaseApp ${s.name}`,a)}}function _registerComponent(s){const i=s.name;if(_components.has(i))return logger$2.debug(`There were multiple attempts to register component ${i}.`),!1;_components.set(i,s);for(const a of _apps.values())_addComponent(a,s);for(const a of _serverApps.values())_addComponent(a,s);return!0}function _getProvider(s,i){const a=s.container.getProvider("heartbeat").getImmediate({optional:!0});return a&&a.triggerHeartbeat(),s.container.getProvider(i)}function _isFirebaseServerApp(s){return s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS$1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ERROR_FACTORY$2=new ErrorFactory("app","Firebase",ERRORS$1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor(i,a,d){this._isDeleted=!1,this._options=Object.assign({},i),this._config=Object.assign({},a),this._name=a.name,this._automaticDataCollectionEnabled=a.automaticDataCollectionEnabled,this._container=d,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(i){this.checkDestroyed(),this._automaticDataCollectionEnabled=i}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(i){this._isDeleted=i}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY$2.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION$1=version$a;function initializeApp(s,i={}){let a=s;typeof i!="object"&&(i={name:i});const d=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!1},i),g=d.name;if(typeof g!="string"||!g)throw ERROR_FACTORY$2.create("bad-app-name",{appName:String(g)});if(a||(a=getDefaultAppConfig()),!a)throw ERROR_FACTORY$2.create("no-options");const b=_apps.get(g);if(b){if(deepEqual(a,b.options)&&deepEqual(d,b.config))return b;throw ERROR_FACTORY$2.create("duplicate-app",{appName:g})}const $=new ComponentContainer(g);for(const it of _components.values())$.addComponent(it);const tt=new FirebaseAppImpl(a,d,$);return _apps.set(g,tt),tt}function getApp(s=DEFAULT_ENTRY_NAME){const i=_apps.get(s);if(!i&&s===DEFAULT_ENTRY_NAME&&getDefaultAppConfig())return initializeApp();if(!i)throw ERROR_FACTORY$2.create("no-app",{appName:s});return i}function registerVersion(s,i,a){var d;let g=(d=PLATFORM_LOG_STRING[s])!==null&&d!==void 0?d:s;a&&(g+=`-${a}`);const b=g.match(/\s|\//),$=i.match(/\s|\//);if(b||$){const tt=[`Unable to register library "${g}" with version "${i}":`];b&&tt.push(`library name "${g}" contains illegal characters (whitespace or "/")`),b&&$&&tt.push("and"),$&&tt.push(`version name "${i}" contains illegal characters (whitespace or "/")`),logger$2.warn(tt.join(" "));return}_registerComponent(new Component(`${g}-version`,()=>({library:g,version:i}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME$1="firebase-heartbeat-database",DB_VERSION$1=1,STORE_NAME="firebase-heartbeat-store";let dbPromise$1=null;function getDbPromise$1(){return dbPromise$1||(dbPromise$1=openDB(DB_NAME$1,DB_VERSION$1,{upgrade:(s,i)=>{switch(i){case 0:try{s.createObjectStore(STORE_NAME)}catch(a){console.warn(a)}}}}).catch(s=>{throw ERROR_FACTORY$2.create("idb-open",{originalErrorMessage:s.message})})),dbPromise$1}async function readHeartbeatsFromIndexedDB(s){try{const a=(await getDbPromise$1()).transaction(STORE_NAME),d=await a.objectStore(STORE_NAME).get(computeKey(s));return await a.done,d}catch(i){if(i instanceof FirebaseError)logger$2.warn(i.message);else{const a=ERROR_FACTORY$2.create("idb-get",{originalErrorMessage:i==null?void 0:i.message});logger$2.warn(a.message)}}}async function writeHeartbeatsToIndexedDB(s,i){try{const d=(await getDbPromise$1()).transaction(STORE_NAME,"readwrite");await d.objectStore(STORE_NAME).put(i,computeKey(s)),await d.done}catch(a){if(a instanceof FirebaseError)logger$2.warn(a.message);else{const d=ERROR_FACTORY$2.create("idb-set",{originalErrorMessage:a==null?void 0:a.message});logger$2.warn(d.message)}}}function computeKey(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,STORED_HEARTBEAT_RETENTION_MAX_MILLIS=30*24*60*60*1e3;class HeartbeatServiceImpl{constructor(i){this.container=i,this._heartbeatsCache=null;const a=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(a),this._heartbeatsCachePromise=this._storage.read().then(d=>(this._heartbeatsCache=d,d))}async triggerHeartbeat(){var i,a;const g=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),b=getUTCDateString();if(!(((i=this._heartbeatsCache)===null||i===void 0?void 0:i.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((a=this._heartbeatsCache)===null||a===void 0?void 0:a.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===b||this._heartbeatsCache.heartbeats.some($=>$.date===b)))return this._heartbeatsCache.heartbeats.push({date:b,agent:g}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter($=>{const tt=new Date($.date).valueOf();return Date.now()-tt<=STORED_HEARTBEAT_RETENTION_MAX_MILLIS}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var i;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((i=this._heartbeatsCache)===null||i===void 0?void 0:i.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const a=getUTCDateString(),{heartbeatsToSend:d,unsentEntries:g}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),b=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:d}));return this._heartbeatsCache.lastSentHeartbeatDate=a,g.length>0?(this._heartbeatsCache.heartbeats=g,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),b}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(s,i=MAX_HEADER_BYTES){const a=[];let d=s.slice();for(const g of s){const b=a.find($=>$.agent===g.agent);if(b){if(b.dates.push(g.date),countBytes(a)>i){b.dates.pop();break}}else if(a.push({agent:g.agent,dates:[g.date]}),countBytes(a)>i){a.pop();break}d=d.slice(1)}return{heartbeatsToSend:a,unsentEntries:d}}class HeartbeatStorageImpl{constructor(i){this.app=i,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const a=await readHeartbeatsFromIndexedDB(this.app);return a!=null&&a.heartbeats?a:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(i){var a;if(await this._canUseIndexedDBPromise){const g=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(a=i.lastSentHeartbeatDate)!==null&&a!==void 0?a:g.lastSentHeartbeatDate,heartbeats:i.heartbeats})}else return}async add(i){var a;if(await this._canUseIndexedDBPromise){const g=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(a=i.lastSentHeartbeatDate)!==null&&a!==void 0?a:g.lastSentHeartbeatDate,heartbeats:[...g.heartbeats,...i.heartbeats]})}else return}}function countBytes(s){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:s})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(s){_registerComponent(new Component("platform-logger",i=>new PlatformLoggerServiceImpl(i),"PRIVATE")),_registerComponent(new Component("heartbeat",i=>new HeartbeatServiceImpl(i),"PRIVATE")),registerVersion(name$p,version$1$1,s),registerVersion(name$p,version$1$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");var define_process_env_default={};const name$4="@firebase/database",version$9="1.0.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SDK_VERSION="";function setSDKVersion(s){SDK_VERSION=s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DOMStorageWrapper{constructor(i){this.domStorage_=i,this.prefix_="firebase:"}set(i,a){a==null?this.domStorage_.removeItem(this.prefixedName_(i)):this.domStorage_.setItem(this.prefixedName_(i),stringify(a))}get(i){const a=this.domStorage_.getItem(this.prefixedName_(i));return a==null?null:jsonEval(a)}remove(i){this.domStorage_.removeItem(this.prefixedName_(i))}prefixedName_(i){return this.prefix_+i}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MemoryStorage{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(i,a){a==null?delete this.cache_[i]:this.cache_[i]=a}get(i){return contains(this.cache_,i)?this.cache_[i]:null}remove(i){delete this.cache_[i]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const createStoragefor=function(s){try{if(typeof window<"u"&&typeof window[s]<"u"){const i=window[s];return i.setItem("firebase:sentinel","cache"),i.removeItem("firebase:sentinel"),new DOMStorageWrapper(i)}}catch{}return new MemoryStorage},PersistentStorage=createStoragefor("localStorage"),SessionStorage=createStoragefor("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient$1=new Logger("@firebase/database"),LUIDGenerator=function(){let s=1;return function(){return s++}}(),sha1=function(s){const i=stringToByteArray(s),a=new Sha1;a.update(i);const d=a.digest();return base64.encodeByteArray(d)},buildLogMessage_=function(...s){let i="";for(let a=0;a<s.length;a++){const d=s[a];Array.isArray(d)||d&&typeof d=="object"&&typeof d.length=="number"?i+=buildLogMessage_.apply(null,d):typeof d=="object"?i+=stringify(d):i+=d,i+=" "}return i};let logger$1=null,firstLog_=!0;const enableLogging$1=function(s,i){assert(!i,"Can't turn on custom loggers persistently."),logClient$1.logLevel=LogLevel.VERBOSE,logger$1=logClient$1.log.bind(logClient$1)},log=function(...s){if(firstLog_===!0&&(firstLog_=!1,logger$1===null&&SessionStorage.get("logging_enabled")===!0&&enableLogging$1()),logger$1){const i=buildLogMessage_.apply(null,s);logger$1(i)}},logWrapper=function(s){return function(...i){log(s,...i)}},error=function(...s){const i="FIREBASE INTERNAL ERROR: "+buildLogMessage_(...s);logClient$1.error(i)},fatal=function(...s){const i=`FIREBASE FATAL ERROR: ${buildLogMessage_(...s)}`;throw logClient$1.error(i),new Error(i)},warn=function(...s){const i="FIREBASE WARNING: "+buildLogMessage_(...s);logClient$1.warn(i)},warnIfPageIsSecure=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&warn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},isInvalidJSONNumber=function(s){return typeof s=="number"&&(s!==s||s===Number.POSITIVE_INFINITY||s===Number.NEGATIVE_INFINITY)},executeWhenDOMReady=function(s){if(document.readyState==="complete")s();else{let i=!1;const a=function(){if(!document.body){setTimeout(a,Math.floor(10));return}i||(i=!0,s())};document.addEventListener?(document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",a,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&a()}),window.attachEvent("onload",a))}},MIN_NAME="[MIN_NAME]",MAX_NAME="[MAX_NAME]",nameCompare=function(s,i){if(s===i)return 0;if(s===MIN_NAME||i===MAX_NAME)return-1;if(i===MIN_NAME||s===MAX_NAME)return 1;{const a=tryParseInt(s),d=tryParseInt(i);return a!==null?d!==null?a-d===0?s.length-i.length:a-d:-1:d!==null?1:s<i?-1:1}},stringCompare=function(s,i){return s===i?0:s<i?-1:1},requireKey=function(s,i){if(i&&s in i)return i[s];throw new Error("Missing required key ("+s+") in object: "+stringify(i))},ObjectToUniqueKey=function(s){if(typeof s!="object"||s===null)return stringify(s);const i=[];for(const d in s)i.push(d);i.sort();let a="{";for(let d=0;d<i.length;d++)d!==0&&(a+=","),a+=stringify(i[d]),a+=":",a+=ObjectToUniqueKey(s[i[d]]);return a+="}",a},splitStringBySize=function(s,i){const a=s.length;if(a<=i)return[s];const d=[];for(let g=0;g<a;g+=i)g+i>a?d.push(s.substring(g,a)):d.push(s.substring(g,g+i));return d};function each(s,i){for(const a in s)s.hasOwnProperty(a)&&i(a,s[a])}const doubleToIEEE754String=function(s){assert(!isInvalidJSONNumber(s),"Invalid JSON number");const i=11,a=52,d=(1<<i-1)-1;let g,b,$,tt,it;s===0?(b=0,$=0,g=1/s===-1/0?1:0):(g=s<0,s=Math.abs(s),s>=Math.pow(2,1-d)?(tt=Math.min(Math.floor(Math.log(s)/Math.LN2),d),b=tt+d,$=Math.round(s*Math.pow(2,a-tt)-Math.pow(2,a))):(b=0,$=Math.round(s/Math.pow(2,1-d-a))));const rt=[];for(it=a;it;it-=1)rt.push($%2?1:0),$=Math.floor($/2);for(it=i;it;it-=1)rt.push(b%2?1:0),b=Math.floor(b/2);rt.push(g?1:0),rt.reverse();const ot=rt.join("");let lt="";for(it=0;it<64;it+=8){let ut=parseInt(ot.substr(it,8),2).toString(16);ut.length===1&&(ut="0"+ut),lt=lt+ut}return lt.toLowerCase()},isChromeExtensionContentScript=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},isWindowsStoreApp=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function errorForServerCode(s,i){let a="Unknown Error";s==="too_big"?a="The data requested exceeds the maximum size that can be accessed with a single request.":s==="permission_denied"?a="Client doesn't have permission to access the desired data.":s==="unavailable"&&(a="The service is unavailable");const d=new Error(s+" at "+i._path.toString()+": "+a);return d.code=s.toUpperCase(),d}const INTEGER_REGEXP_=new RegExp("^-?(0*)\\d{1,10}$"),INTEGER_32_MIN=-2147483648,INTEGER_32_MAX=2147483647,tryParseInt=function(s){if(INTEGER_REGEXP_.test(s)){const i=Number(s);if(i>=INTEGER_32_MIN&&i<=INTEGER_32_MAX)return i}return null},exceptionGuard=function(s){try{s()}catch(i){setTimeout(()=>{const a=i.stack||"";throw warn("Exception was thrown by user callback.",a),i},Math.floor(0))}},beingCrawled=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},setTimeoutNonBlocking=function(s,i){const a=setTimeout(s,i);return typeof a=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(a):typeof a=="object"&&a.unref&&a.unref(),a};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AppCheckTokenProvider{constructor(i,a){this.appName_=i,this.appCheckProvider=a,this.appCheck=a==null?void 0:a.getImmediate({optional:!0}),this.appCheck||a==null||a.get().then(d=>this.appCheck=d)}getToken(i){return this.appCheck?this.appCheck.getToken(i):new Promise((a,d)=>{setTimeout(()=>{this.appCheck?this.getToken(i).then(a,d):a(null)},0)})}addTokenChangeListener(i){var a;(a=this.appCheckProvider)===null||a===void 0||a.get().then(d=>d.addTokenListener(i))}notifyForInvalidToken(){warn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAuthTokenProvider{constructor(i,a,d){this.appName_=i,this.firebaseOptions_=a,this.authProvider_=d,this.auth_=null,this.auth_=d.getImmediate({optional:!0}),this.auth_||d.onInit(g=>this.auth_=g)}getToken(i){return this.auth_?this.auth_.getToken(i).catch(a=>a&&a.code==="auth/token-not-initialized"?(log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(a)):new Promise((a,d)=>{setTimeout(()=>{this.auth_?this.getToken(i).then(a,d):a(null)},0)})}addTokenChangeListener(i){this.auth_?this.auth_.addAuthTokenListener(i):this.authProvider_.get().then(a=>a.addAuthTokenListener(i))}removeTokenChangeListener(i){this.authProvider_.get().then(a=>a.removeAuthTokenListener(i))}notifyForInvalidToken(){let i='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?i+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?i+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':i+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',warn(i)}}class EmulatorTokenProvider{constructor(i){this.accessToken=i}getToken(i){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(i){i(this.accessToken)}removeTokenChangeListener(i){}notifyForInvalidToken(){}}EmulatorTokenProvider.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PROTOCOL_VERSION="5",VERSION_PARAM="v",TRANSPORT_SESSION_PARAM="s",REFERER_PARAM="r",FORGE_REF="f",FORGE_DOMAIN_RE=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,LAST_SESSION_PARAM="ls",APPLICATION_ID_PARAM="p",APP_CHECK_TOKEN_PARAM="ac",WEBSOCKET="websocket",LONG_POLLING="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RepoInfo{constructor(i,a,d,g,b=!1,$="",tt=!1,it=!1){this.secure=a,this.namespace=d,this.webSocketOnly=g,this.nodeAdmin=b,this.persistenceKey=$,this.includeNamespaceInQueryParams=tt,this.isUsingEmulator=it,this._host=i.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=PersistentStorage.get("host:"+i)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(i){i!==this.internalHost&&(this.internalHost=i,this.isCacheableHost()&&PersistentStorage.set("host:"+this._host,this.internalHost))}toString(){let i=this.toURLString();return this.persistenceKey&&(i+="<"+this.persistenceKey+">"),i}toURLString(){const i=this.secure?"https://":"http://",a=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${i}${this.host}/${a}`}}function repoInfoNeedsQueryParam(s){return s.host!==s.internalHost||s.isCustomHost()||s.includeNamespaceInQueryParams}function repoInfoConnectionURL(s,i,a){assert(typeof i=="string","typeof type must == string"),assert(typeof a=="object","typeof params must == object");let d;if(i===WEBSOCKET)d=(s.secure?"wss://":"ws://")+s.internalHost+"/.ws?";else if(i===LONG_POLLING)d=(s.secure?"https://":"http://")+s.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+i);repoInfoNeedsQueryParam(s)&&(a.ns=s.namespace);const g=[];return each(a,(b,$)=>{g.push(b+"="+$)}),d+g.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StatsCollection{constructor(){this.counters_={}}incrementCounter(i,a=1){contains(this.counters_,i)||(this.counters_[i]=0),this.counters_[i]+=a}get(){return deepCopy(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const collections={},reporters={};function statsManagerGetCollection(s){const i=s.toString();return collections[i]||(collections[i]=new StatsCollection),collections[i]}function statsManagerGetOrCreateReporter(s,i){const a=s.toString();return reporters[a]||(reporters[a]=i()),reporters[a]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PacketReceiver{constructor(i){this.onMessage_=i,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(i,a){this.closeAfterResponse=i,this.onClose=a,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(i,a){for(this.pendingResponses[i]=a;this.pendingResponses[this.currentResponseNum];){const d=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let g=0;g<d.length;++g)d[g]&&exceptionGuard(()=>{this.onMessage_(d[g])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIREBASE_LONGPOLL_START_PARAM="start",FIREBASE_LONGPOLL_CLOSE_COMMAND="close",FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",FIREBASE_LONGPOLL_ID_PARAM="id",FIREBASE_LONGPOLL_PW_PARAM="pw",FIREBASE_LONGPOLL_SERIAL_PARAM="ser",FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",FIREBASE_LONGPOLL_DATA_PARAM="d",FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe",MAX_URL_DATA_SIZE=1870,SEG_HEADER_SIZE=30,MAX_PAYLOAD_SIZE=MAX_URL_DATA_SIZE-SEG_HEADER_SIZE,KEEPALIVE_REQUEST_INTERVAL=25e3,LP_CONNECT_TIMEOUT=3e4;class BrowserPollConnection{constructor(i,a,d,g,b,$,tt){this.connId=i,this.repoInfo=a,this.applicationId=d,this.appCheckToken=g,this.authToken=b,this.transportSessionId=$,this.lastSessionId=tt,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=logWrapper(i),this.stats_=statsManagerGetCollection(a),this.urlFn=it=>(this.appCheckToken&&(it[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),repoInfoConnectionURL(a,LONG_POLLING,it))}open(i,a){this.curSegmentNum=0,this.onDisconnect_=a,this.myPacketOrderer=new PacketReceiver(i),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(LP_CONNECT_TIMEOUT)),executeWhenDOMReady(()=>{if(this.isClosed_)return;this.scriptTagHolder=new FirebaseIFrameScriptHolder((...b)=>{const[$,tt,it,rt,ot]=b;if(this.incrementIncomingBytes_(b),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,$===FIREBASE_LONGPOLL_START_PARAM)this.id=tt,this.password=it;else if($===FIREBASE_LONGPOLL_CLOSE_COMMAND)tt?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(tt,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+$)},(...b)=>{const[$,tt]=b;this.incrementIncomingBytes_(b),this.myPacketOrderer.handleResponse($,tt)},()=>{this.onClosed_()},this.urlFn);const d={};d[FIREBASE_LONGPOLL_START_PARAM]="t",d[FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(d[FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=this.scriptTagHolder.uniqueCallbackIdentifier),d[VERSION_PARAM]=PROTOCOL_VERSION,this.transportSessionId&&(d[TRANSPORT_SESSION_PARAM]=this.transportSessionId),this.lastSessionId&&(d[LAST_SESSION_PARAM]=this.lastSessionId),this.applicationId&&(d[APPLICATION_ID_PARAM]=this.applicationId),this.appCheckToken&&(d[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),typeof location<"u"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(d[REFERER_PARAM]=FORGE_REF);const g=this.urlFn(d);this.log_("Connecting via long-poll to "+g),this.scriptTagHolder.addTag(g,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){BrowserPollConnection.forceAllow_=!0}static forceDisallow(){BrowserPollConnection.forceDisallow_=!0}static isAvailable(){return BrowserPollConnection.forceAllow_?!0:!BrowserPollConnection.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!isChromeExtensionContentScript()&&!isWindowsStoreApp()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(i){const a=stringify(i);this.bytesSent+=a.length,this.stats_.incrementCounter("bytes_sent",a.length);const d=base64Encode(a),g=splitStringBySize(d,MAX_PAYLOAD_SIZE);for(let b=0;b<g.length;b++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,g.length,g[b]),this.curSegmentNum++}addDisconnectPingFrame(i,a){this.myDisconnFrame=document.createElement("iframe");const d={};d[FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",d[FIREBASE_LONGPOLL_ID_PARAM]=i,d[FIREBASE_LONGPOLL_PW_PARAM]=a,this.myDisconnFrame.src=this.urlFn(d),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(i){const a=stringify(i).length;this.bytesReceived+=a,this.stats_.incrementCounter("bytes_received",a)}}class FirebaseIFrameScriptHolder{constructor(i,a,d,g){this.onDisconnect=d,this.urlFn=g,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=LUIDGenerator(),window[FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=i,window[FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=a,this.myIFrame=FirebaseIFrameScriptHolder.createIFrame_();let b="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(b='<script>document.domain="'+document.domain+'";<\/script>');const $="<html><body>"+b+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write($),this.myIFrame.doc.close()}catch(tt){log("frame writing exception"),tt.stack&&log(tt.stack),log(tt)}}}static createIFrame_(){const i=document.createElement("iframe");if(i.style.display="none",document.body){document.body.appendChild(i);try{i.contentWindow.document||log("No IE domain setting required")}catch{const d=document.domain;i.src="javascript:void((function(){document.open();document.domain='"+d+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return i.contentDocument?i.doc=i.contentDocument:i.contentWindow?i.doc=i.contentWindow.document:i.document&&(i.doc=i.document),i}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const i=this.onDisconnect;i&&(this.onDisconnect=null,i())}startLongPoll(i,a){for(this.myID=i,this.myPW=a,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const i={};i[FIREBASE_LONGPOLL_ID_PARAM]=this.myID,i[FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,i[FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;let a=this.urlFn(i),d="",g=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+SEG_HEADER_SIZE+d.length<=MAX_URL_DATA_SIZE;){const $=this.pendingSegs.shift();d=d+"&"+FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+g+"="+$.seg+"&"+FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+g+"="+$.ts+"&"+FIREBASE_LONGPOLL_DATA_PARAM+g+"="+$.d,g++}return a=a+d,this.addLongPollTag_(a,this.currentSerial),!0}else return!1}enqueueSegment(i,a,d){this.pendingSegs.push({seg:i,ts:a,d}),this.alive&&this.newRequest_()}addLongPollTag_(i,a){this.outstandingRequests.add(a);const d=()=>{this.outstandingRequests.delete(a),this.newRequest_()},g=setTimeout(d,Math.floor(KEEPALIVE_REQUEST_INTERVAL)),b=()=>{clearTimeout(g),d()};this.addTag(i,b)}addTag(i,a){setTimeout(()=>{try{if(!this.sendNewPolls)return;const d=this.myIFrame.doc.createElement("script");d.type="text/javascript",d.async=!0,d.src=i,d.onload=d.onreadystatechange=function(){const g=d.readyState;(!g||g==="loaded"||g==="complete")&&(d.onload=d.onreadystatechange=null,d.parentNode&&d.parentNode.removeChild(d),a())},d.onerror=()=>{log("Long-poll script failed to load: "+i),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(d)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEBSOCKET_MAX_FRAME_SIZE=16384,WEBSOCKET_KEEPALIVE_INTERVAL=45e3;let WebSocketImpl=null;typeof MozWebSocket<"u"?WebSocketImpl=MozWebSocket:typeof WebSocket<"u"&&(WebSocketImpl=WebSocket);class WebSocketConnection{constructor(i,a,d,g,b,$,tt){this.connId=i,this.applicationId=d,this.appCheckToken=g,this.authToken=b,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=logWrapper(this.connId),this.stats_=statsManagerGetCollection(a),this.connURL=WebSocketConnection.connectionURL_(a,$,tt,g,d),this.nodeAdmin=a.nodeAdmin}static connectionURL_(i,a,d,g,b){const $={};return $[VERSION_PARAM]=PROTOCOL_VERSION,typeof location<"u"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&($[REFERER_PARAM]=FORGE_REF),a&&($[TRANSPORT_SESSION_PARAM]=a),d&&($[LAST_SESSION_PARAM]=d),g&&($[APP_CHECK_TOKEN_PARAM]=g),b&&($[APPLICATION_ID_PARAM]=b),repoInfoConnectionURL(i,WEBSOCKET,$)}open(i,a){this.onDisconnect=a,this.onMessage=i,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,PersistentStorage.set("previous_websocket_failure",!0);try{let d;isNodeSdk(),this.mySock=new WebSocketImpl(this.connURL,[],d)}catch(d){this.log_("Error instantiating WebSocket.");const g=d.message||d.data;g&&this.log_(g),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=d=>{this.handleIncomingFrame(d)},this.mySock.onerror=d=>{this.log_("WebSocket error.  Closing connection.");const g=d.message||d.data;g&&this.log_(g),this.onClosed_()}}start(){}static forceDisallow(){WebSocketConnection.forceDisallow_=!0}static isAvailable(){let i=!1;if(typeof navigator<"u"&&navigator.userAgent){const a=/Android ([0-9]{0,}\.[0-9]{0,})/,d=navigator.userAgent.match(a);d&&d.length>1&&parseFloat(d[1])<4.4&&(i=!0)}return!i&&WebSocketImpl!==null&&!WebSocketConnection.forceDisallow_}static previouslyFailed(){return PersistentStorage.isInMemoryStorage||PersistentStorage.get("previous_websocket_failure")===!0}markConnectionHealthy(){PersistentStorage.remove("previous_websocket_failure")}appendFrame_(i){if(this.frames.push(i),this.frames.length===this.totalFrames){const a=this.frames.join("");this.frames=null;const d=jsonEval(a);this.onMessage(d)}}handleNewFrameCount_(i){this.totalFrames=i,this.frames=[]}extractFrameCount_(i){if(assert(this.frames===null,"We already have a frame buffer"),i.length<=6){const a=Number(i);if(!isNaN(a))return this.handleNewFrameCount_(a),null}return this.handleNewFrameCount_(1),i}handleIncomingFrame(i){if(this.mySock===null)return;const a=i.data;if(this.bytesReceived+=a.length,this.stats_.incrementCounter("bytes_received",a.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(a);else{const d=this.extractFrameCount_(a);d!==null&&this.appendFrame_(d)}}send(i){this.resetKeepAlive();const a=stringify(i);this.bytesSent+=a.length,this.stats_.incrementCounter("bytes_sent",a.length);const d=splitStringBySize(a,WEBSOCKET_MAX_FRAME_SIZE);d.length>1&&this.sendString_(String(d.length));for(let g=0;g<d.length;g++)this.sendString_(d[g])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL))}sendString_(i){try{this.mySock.send(i)}catch(a){this.log_("Exception thrown from WebSocket.send():",a.message||a.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}WebSocketConnection.responsesRequiredToBeHealthy=2;WebSocketConnection.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransportManager{constructor(i){this.initTransports_(i)}static get ALL_TRANSPORTS(){return[BrowserPollConnection,WebSocketConnection]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(i){const a=WebSocketConnection&&WebSocketConnection.isAvailable();let d=a&&!WebSocketConnection.previouslyFailed();if(i.webSocketOnly&&(a||warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),d=!0),d)this.transports_=[WebSocketConnection];else{const g=this.transports_=[];for(const b of TransportManager.ALL_TRANSPORTS)b&&b.isAvailable()&&g.push(b);TransportManager.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}TransportManager.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UPGRADE_TIMEOUT=6e4,DELAY_BEFORE_SENDING_EXTRA_REQUESTS=5e3,BYTES_SENT_HEALTHY_OVERRIDE=10*1024,BYTES_RECEIVED_HEALTHY_OVERRIDE=100*1024,MESSAGE_TYPE="t",MESSAGE_DATA="d",CONTROL_SHUTDOWN="s",CONTROL_RESET="r",CONTROL_ERROR="e",CONTROL_PONG="o",SWITCH_ACK="a",END_TRANSMISSION="n",PING="p",SERVER_HELLO="h";class Connection{constructor(i,a,d,g,b,$,tt,it,rt,ot){this.id=i,this.repoInfo_=a,this.applicationId_=d,this.appCheckToken_=g,this.authToken_=b,this.onMessage_=$,this.onReady_=tt,this.onDisconnect_=it,this.onKill_=rt,this.lastSessionId=ot,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=logWrapper("c:"+this.id+":"),this.transportManager_=new TransportManager(a),this.log_("Connection created"),this.start_()}start_(){const i=this.transportManager_.initialTransport();this.conn_=new i(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=i.responsesRequiredToBeHealthy||0;const a=this.connReceiver_(this.conn_),d=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(a,d)},Math.floor(0));const g=i.healthyTimeout||0;g>0&&(this.healthyTimeout_=setTimeoutNonBlocking(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>BYTES_RECEIVED_HEALTHY_OVERRIDE?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>BYTES_SENT_HEALTHY_OVERRIDE?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(g)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(i){return a=>{i===this.conn_?this.onConnectionLost_(a):i===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(i){return a=>{this.state_!==2&&(i===this.rx_?this.onPrimaryMessageReceived_(a):i===this.secondaryConn_?this.onSecondaryMessageReceived_(a):this.log_("message on old connection"))}}sendRequest(i){const a={t:"d",d:i};this.sendData_(a)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(i){if(MESSAGE_TYPE in i){const a=i[MESSAGE_TYPE];a===SWITCH_ACK?this.upgradeIfSecondaryHealthy_():a===CONTROL_RESET?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):a===CONTROL_PONG&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(i){const a=requireKey("t",i),d=requireKey("d",i);if(a==="c")this.onSecondaryControl_(d);else if(a==="d")this.pendingDataMessages.push(d);else throw new Error("Unknown protocol layer: "+a)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:PING,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:SWITCH_ACK,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:END_TRANSMISSION,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(i){const a=requireKey("t",i),d=requireKey("d",i);a==="c"?this.onControl_(d):a==="d"&&this.onDataMessage_(d)}onDataMessage_(i){this.onPrimaryResponse_(),this.onMessage_(i)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(i){const a=requireKey(MESSAGE_TYPE,i);if(MESSAGE_DATA in i){const d=i[MESSAGE_DATA];if(a===SERVER_HELLO){const g=Object.assign({},d);this.repoInfo_.isUsingEmulator&&(g.h=this.repoInfo_.host),this.onHandshake_(g)}else if(a===END_TRANSMISSION){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let g=0;g<this.pendingDataMessages.length;++g)this.onDataMessage_(this.pendingDataMessages[g]);this.pendingDataMessages=[],this.tryCleanupConnection()}else a===CONTROL_SHUTDOWN?this.onConnectionShutdown_(d):a===CONTROL_RESET?this.onReset_(d):a===CONTROL_ERROR?error("Server Error: "+d):a===CONTROL_PONG?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):error("Unknown control packet command: "+a)}}onHandshake_(i){const a=i.ts,d=i.v,g=i.h;this.sessionId=i.s,this.repoInfo_.host=g,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,a),PROTOCOL_VERSION!==d&&warn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const i=this.transportManager_.upgradeTransport();i&&this.startUpgrade_(i)}startUpgrade_(i){this.secondaryConn_=new i(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=i.responsesRequiredToBeHealthy||0;const a=this.connReceiver_(this.secondaryConn_),d=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(a,d),setTimeoutNonBlocking(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(UPGRADE_TIMEOUT))}onReset_(i){this.log_("Reset packet received.  New host: "+i),this.repoInfo_.host=i,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(i,a){this.log_("Realtime connection established."),this.conn_=i,this.state_=1,this.onReady_&&(this.onReady_(a,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):setTimeoutNonBlocking(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:PING,d:{}}}))}onSecondaryConnectionLost_(){const i=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===i||this.rx_===i)&&this.close()}onConnectionLost_(i){this.conn_=null,!i&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(i){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(i),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(i){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(i)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ServerActions{put(i,a,d,g){}merge(i,a,d,g){}refreshAuthToken(i){}refreshAppCheckToken(i){}onDisconnectPut(i,a,d){}onDisconnectMerge(i,a,d){}onDisconnectCancel(i,a){}reportStats(i){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventEmitter{constructor(i){this.allowedEvents_=i,this.listeners_={},assert(Array.isArray(i)&&i.length>0,"Requires a non-empty array")}trigger(i,...a){if(Array.isArray(this.listeners_[i])){const d=[...this.listeners_[i]];for(let g=0;g<d.length;g++)d[g].callback.apply(d[g].context,a)}}on(i,a,d){this.validateEventType_(i),this.listeners_[i]=this.listeners_[i]||[],this.listeners_[i].push({callback:a,context:d});const g=this.getInitialEvent(i);g&&a.apply(d,g)}off(i,a,d){this.validateEventType_(i);const g=this.listeners_[i]||[];for(let b=0;b<g.length;b++)if(g[b].callback===a&&(!d||d===g[b].context)){g.splice(b,1);return}}validateEventType_(i){assert(this.allowedEvents_.find(a=>a===i),"Unknown event: "+i)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OnlineMonitor extends EventEmitter{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!isMobileCordova()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new OnlineMonitor}getInitialEvent(i){return assert(i==="online","Unknown event type: "+i),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_PATH_DEPTH=32,MAX_PATH_LENGTH_BYTES=768;class Path{constructor(i,a){if(a===void 0){this.pieces_=i.split("/");let d=0;for(let g=0;g<this.pieces_.length;g++)this.pieces_[g].length>0&&(this.pieces_[d]=this.pieces_[g],d++);this.pieces_.length=d,this.pieceNum_=0}else this.pieces_=i,this.pieceNum_=a}toString(){let i="";for(let a=this.pieceNum_;a<this.pieces_.length;a++)this.pieces_[a]!==""&&(i+="/"+this.pieces_[a]);return i||"/"}}function newEmptyPath(){return new Path("")}function pathGetFront(s){return s.pieceNum_>=s.pieces_.length?null:s.pieces_[s.pieceNum_]}function pathGetLength(s){return s.pieces_.length-s.pieceNum_}function pathPopFront(s){let i=s.pieceNum_;return i<s.pieces_.length&&i++,new Path(s.pieces_,i)}function pathGetBack(s){return s.pieceNum_<s.pieces_.length?s.pieces_[s.pieces_.length-1]:null}function pathToUrlEncodedString(s){let i="";for(let a=s.pieceNum_;a<s.pieces_.length;a++)s.pieces_[a]!==""&&(i+="/"+encodeURIComponent(String(s.pieces_[a])));return i||"/"}function pathSlice(s,i=0){return s.pieces_.slice(s.pieceNum_+i)}function pathParent(s){if(s.pieceNum_>=s.pieces_.length)return null;const i=[];for(let a=s.pieceNum_;a<s.pieces_.length-1;a++)i.push(s.pieces_[a]);return new Path(i,0)}function pathChild(s,i){const a=[];for(let d=s.pieceNum_;d<s.pieces_.length;d++)a.push(s.pieces_[d]);if(i instanceof Path)for(let d=i.pieceNum_;d<i.pieces_.length;d++)a.push(i.pieces_[d]);else{const d=i.split("/");for(let g=0;g<d.length;g++)d[g].length>0&&a.push(d[g])}return new Path(a,0)}function pathIsEmpty(s){return s.pieceNum_>=s.pieces_.length}function newRelativePath(s,i){const a=pathGetFront(s),d=pathGetFront(i);if(a===null)return i;if(a===d)return newRelativePath(pathPopFront(s),pathPopFront(i));throw new Error("INTERNAL ERROR: innerPath ("+i+") is not within outerPath ("+s+")")}function pathEquals(s,i){if(pathGetLength(s)!==pathGetLength(i))return!1;for(let a=s.pieceNum_,d=i.pieceNum_;a<=s.pieces_.length;a++,d++)if(s.pieces_[a]!==i.pieces_[d])return!1;return!0}function pathContains(s,i){let a=s.pieceNum_,d=i.pieceNum_;if(pathGetLength(s)>pathGetLength(i))return!1;for(;a<s.pieces_.length;){if(s.pieces_[a]!==i.pieces_[d])return!1;++a,++d}return!0}class ValidationPath{constructor(i,a){this.errorPrefix_=a,this.parts_=pathSlice(i,0),this.byteLength_=Math.max(1,this.parts_.length);for(let d=0;d<this.parts_.length;d++)this.byteLength_+=stringLength(this.parts_[d]);validationPathCheckValid(this)}}function validationPathPush(s,i){s.parts_.length>0&&(s.byteLength_+=1),s.parts_.push(i),s.byteLength_+=stringLength(i),validationPathCheckValid(s)}function validationPathPop(s){const i=s.parts_.pop();s.byteLength_-=stringLength(i),s.parts_.length>0&&(s.byteLength_-=1)}function validationPathCheckValid(s){if(s.byteLength_>MAX_PATH_LENGTH_BYTES)throw new Error(s.errorPrefix_+"has a key path longer than "+MAX_PATH_LENGTH_BYTES+" bytes ("+s.byteLength_+").");if(s.parts_.length>MAX_PATH_DEPTH)throw new Error(s.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+MAX_PATH_DEPTH+") or object contains a cycle "+validationPathToErrorString(s))}function validationPathToErrorString(s){return s.parts_.length===0?"":"in property '"+s.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VisibilityMonitor extends EventEmitter{constructor(){super(["visible"]);let i,a;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(a="visibilitychange",i="hidden"):typeof document.mozHidden<"u"?(a="mozvisibilitychange",i="mozHidden"):typeof document.msHidden<"u"?(a="msvisibilitychange",i="msHidden"):typeof document.webkitHidden<"u"&&(a="webkitvisibilitychange",i="webkitHidden")),this.visible_=!0,a&&document.addEventListener(a,()=>{const d=!document[i];d!==this.visible_&&(this.visible_=d,this.trigger("visible",d))},!1)}static getInstance(){return new VisibilityMonitor}getInitialEvent(i){return assert(i==="visible","Unknown event type: "+i),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RECONNECT_MIN_DELAY=1e3,RECONNECT_MAX_DELAY_DEFAULT=60*5*1e3,RECONNECT_MAX_DELAY_FOR_ADMINS=30*1e3,RECONNECT_DELAY_MULTIPLIER=1.3,RECONNECT_DELAY_RESET_TIMEOUT=3e4,SERVER_KILL_INTERRUPT_REASON="server_kill",INVALID_TOKEN_THRESHOLD=3;class PersistentConnection extends ServerActions{constructor(i,a,d,g,b,$,tt,it){if(super(),this.repoInfo_=i,this.applicationId_=a,this.onDataUpdate_=d,this.onConnectStatus_=g,this.onServerInfoUpdate_=b,this.authTokenProvider_=$,this.appCheckTokenProvider_=tt,this.authOverride_=it,this.id=PersistentConnection.nextPersistentConnectionId_++,this.log_=logWrapper("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=RECONNECT_MIN_DELAY,this.maxReconnectDelay_=RECONNECT_MAX_DELAY_DEFAULT,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,it&&!isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");VisibilityMonitor.getInstance().on("visible",this.onVisible_,this),i.host.indexOf("fblocal")===-1&&OnlineMonitor.getInstance().on("online",this.onOnline_,this)}sendRequest(i,a,d){const g=++this.requestNumber_,b={r:g,a:i,b:a};this.log_(stringify(b)),assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(b),d&&(this.requestCBHash_[g]=d)}get(i){this.initConnection_();const a=new Deferred$1,g={action:"g",request:{p:i._path.toString(),q:i._queryObject},onComplete:$=>{const tt=$.d;$.s==="ok"?a.resolve(tt):a.reject(tt)}};this.outstandingGets_.push(g),this.outstandingGetCount_++;const b=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(b),a.promise}listen(i,a,d,g){this.initConnection_();const b=i._queryIdentifier,$=i._path.toString();this.log_("Listen called for "+$+" "+b),this.listens.has($)||this.listens.set($,new Map),assert(i._queryParams.isDefault()||!i._queryParams.loadsAllData(),"listen() called for non-default but complete query"),assert(!this.listens.get($).has(b),"listen() called twice for same path/queryId.");const tt={onComplete:g,hashFn:a,query:i,tag:d};this.listens.get($).set(b,tt),this.connected_&&this.sendListen_(tt)}sendGet_(i){const a=this.outstandingGets_[i];this.sendRequest("g",a.request,d=>{delete this.outstandingGets_[i],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),a.onComplete&&a.onComplete(d)})}sendListen_(i){const a=i.query,d=a._path.toString(),g=a._queryIdentifier;this.log_("Listen on "+d+" for "+g);const b={p:d},$="q";i.tag&&(b.q=a._queryObject,b.t=i.tag),b.h=i.hashFn(),this.sendRequest($,b,tt=>{const it=tt.d,rt=tt.s;PersistentConnection.warnOnListenWarnings_(it,a),(this.listens.get(d)&&this.listens.get(d).get(g))===i&&(this.log_("listen response",tt),rt!=="ok"&&this.removeListen_(d,g),i.onComplete&&i.onComplete(rt,it))})}static warnOnListenWarnings_(i,a){if(i&&typeof i=="object"&&contains(i,"w")){const d=safeGet(i,"w");if(Array.isArray(d)&&~d.indexOf("no_index")){const g='".indexOn": "'+a._queryParams.getIndex().toString()+'"',b=a._path.toString();warn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${g} at ${b} to your security rules for better performance.`)}}}refreshAuthToken(i){this.authToken_=i,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(i)}reduceReconnectDelayIfAdminCredential_(i){(i&&i.length===40||isAdmin(i))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS)}refreshAppCheckToken(i){this.appCheckToken_=i,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const i=this.authToken_,a=isValidFormat(i)?"auth":"gauth",d={cred:i};this.authOverride_===null?d.noauth=!0:typeof this.authOverride_=="object"&&(d.authvar=this.authOverride_),this.sendRequest(a,d,g=>{const b=g.s,$=g.d||"error";this.authToken_===i&&(b==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(b,$))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},i=>{const a=i.s,d=i.d||"error";a==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(a,d)})}unlisten(i,a){const d=i._path.toString(),g=i._queryIdentifier;this.log_("Unlisten called for "+d+" "+g),assert(i._queryParams.isDefault()||!i._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(d,g)&&this.connected_&&this.sendUnlisten_(d,g,i._queryObject,a)}sendUnlisten_(i,a,d,g){this.log_("Unlisten on "+i+" for "+a);const b={p:i},$="n";g&&(b.q=d,b.t=g),this.sendRequest($,b)}onDisconnectPut(i,a,d){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",i,a,d):this.onDisconnectRequestQueue_.push({pathString:i,action:"o",data:a,onComplete:d})}onDisconnectMerge(i,a,d){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",i,a,d):this.onDisconnectRequestQueue_.push({pathString:i,action:"om",data:a,onComplete:d})}onDisconnectCancel(i,a){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",i,null,a):this.onDisconnectRequestQueue_.push({pathString:i,action:"oc",data:null,onComplete:a})}sendOnDisconnect_(i,a,d,g){const b={p:a,d};this.log_("onDisconnect "+i,b),this.sendRequest(i,b,$=>{g&&setTimeout(()=>{g($.s,$.d)},Math.floor(0))})}put(i,a,d,g){this.putInternal("p",i,a,d,g)}merge(i,a,d,g){this.putInternal("m",i,a,d,g)}putInternal(i,a,d,g,b){this.initConnection_();const $={p:a,d};b!==void 0&&($.h=b),this.outstandingPuts_.push({action:i,request:$,onComplete:g}),this.outstandingPutCount_++;const tt=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(tt):this.log_("Buffering put: "+a)}sendPut_(i){const a=this.outstandingPuts_[i].action,d=this.outstandingPuts_[i].request,g=this.outstandingPuts_[i].onComplete;this.outstandingPuts_[i].queued=this.connected_,this.sendRequest(a,d,b=>{this.log_(a+" response",b),delete this.outstandingPuts_[i],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),g&&g(b.s,b.d)})}reportStats(i){if(this.connected_){const a={c:i};this.log_("reportStats",a),this.sendRequest("s",a,d=>{if(d.s!=="ok"){const b=d.d;this.log_("reportStats","Error sending stats: "+b)}})}}onDataMessage_(i){if("r"in i){this.log_("from server: "+stringify(i));const a=i.r,d=this.requestCBHash_[a];d&&(delete this.requestCBHash_[a],d(i.b))}else{if("error"in i)throw"A server-side error has occurred: "+i.error;"a"in i&&this.onDataPush_(i.a,i.b)}}onDataPush_(i,a){this.log_("handleServerMessage",i,a),i==="d"?this.onDataUpdate_(a.p,a.d,!1,a.t):i==="m"?this.onDataUpdate_(a.p,a.d,!0,a.t):i==="c"?this.onListenRevoked_(a.p,a.q):i==="ac"?this.onAuthRevoked_(a.s,a.d):i==="apc"?this.onAppCheckRevoked_(a.s,a.d):i==="sd"?this.onSecurityDebugPacket_(a):error("Unrecognized action received from server: "+stringify(i)+`
Are you using the latest client?`)}onReady_(i,a){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(i),this.lastSessionId=a,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(i){assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(i))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(i){i&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)),this.visible_=i}onOnline_(i){i?(this.log_("Browser went online."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>RECONNECT_DELAY_RESET_TIMEOUT&&(this.reconnectDelay_=RECONNECT_MIN_DELAY),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const i=new Date().getTime()-this.lastConnectionAttemptTime_;let a=Math.max(0,this.reconnectDelay_-i);a=Math.random()*a,this.log_("Trying to reconnect in "+a+"ms"),this.scheduleConnect_(a),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*RECONNECT_DELAY_MULTIPLIER)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const i=this.onDataMessage_.bind(this),a=this.onReady_.bind(this),d=this.onRealtimeDisconnect_.bind(this),g=this.id+":"+PersistentConnection.nextConnectionId_++,b=this.lastSessionId;let $=!1,tt=null;const it=function(){tt?tt.close():($=!0,d())},rt=function(lt){assert(tt,"sendRequest call when we're not connected not allowed."),tt.sendRequest(lt)};this.realtime_={close:it,sendRequest:rt};const ot=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[lt,ut]=await Promise.all([this.authTokenProvider_.getToken(ot),this.appCheckTokenProvider_.getToken(ot)]);$?log("getToken() completed but was canceled"):(log("getToken() completed. Creating connection."),this.authToken_=lt&&lt.accessToken,this.appCheckToken_=ut&&ut.token,tt=new Connection(g,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,i,a,d,pt=>{warn(pt+" ("+this.repoInfo_.toString()+")"),this.interrupt(SERVER_KILL_INTERRUPT_REASON)},b))}catch(lt){this.log_("Failed to get token: "+lt),$||(this.repoInfo_.nodeAdmin&&warn(lt),it())}}}interrupt(i){log("Interrupting connection for reason: "+i),this.interruptReasons_[i]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(i){log("Resuming connection for reason: "+i),delete this.interruptReasons_[i],isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(i){const a=i-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:a})}cancelSentTransactions_(){for(let i=0;i<this.outstandingPuts_.length;i++){const a=this.outstandingPuts_[i];a&&"h"in a.request&&a.queued&&(a.onComplete&&a.onComplete("disconnect"),delete this.outstandingPuts_[i],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(i,a){let d;a?d=a.map(b=>ObjectToUniqueKey(b)).join("$"):d="default";const g=this.removeListen_(i,d);g&&g.onComplete&&g.onComplete("permission_denied")}removeListen_(i,a){const d=new Path(i).toString();let g;if(this.listens.has(d)){const b=this.listens.get(d);g=b.get(a),b.delete(a),b.size===0&&this.listens.delete(d)}else g=void 0;return g}onAuthRevoked_(i,a){log("Auth token revoked: "+i+"/"+a),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(i==="invalid_token"||i==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=INVALID_TOKEN_THRESHOLD&&(this.reconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(i,a){log("App check token revoked: "+i+"/"+a),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(i==="invalid_token"||i==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=INVALID_TOKEN_THRESHOLD&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(i){this.securityDebugCallback_?this.securityDebugCallback_(i):"msg"in i&&console.log("FIREBASE: "+i.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const i of this.listens.values())for(const a of i.values())this.sendListen_(a);for(let i=0;i<this.outstandingPuts_.length;i++)this.outstandingPuts_[i]&&this.sendPut_(i);for(;this.onDisconnectRequestQueue_.length;){const i=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(i.action,i.pathString,i.data,i.onComplete)}for(let i=0;i<this.outstandingGets_.length;i++)this.outstandingGets_[i]&&this.sendGet_(i)}sendConnectStats_(){const i={};let a="js";i["sdk."+a+"."+SDK_VERSION.replace(/\./g,"-")]=1,isMobileCordova()?i["framework.cordova"]=1:isReactNative()&&(i["framework.reactnative"]=1),this.reportStats(i)}shouldReconnect_(){const i=OnlineMonitor.getInstance().currentlyOnline();return isEmpty(this.interruptReasons_)&&i}}PersistentConnection.nextPersistentConnectionId_=0;PersistentConnection.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NamedNode{constructor(i,a){this.name=i,this.node=a}static Wrap(i,a){return new NamedNode(i,a)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Index{getCompare(){return this.compare.bind(this)}indexedValueChanged(i,a){const d=new NamedNode(MIN_NAME,i),g=new NamedNode(MIN_NAME,a);return this.compare(d,g)!==0}minPost(){return NamedNode.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __EMPTY_NODE;class KeyIndex extends Index{static get __EMPTY_NODE(){return __EMPTY_NODE}static set __EMPTY_NODE(i){__EMPTY_NODE=i}compare(i,a){return nameCompare(i.name,a.name)}isDefinedOn(i){throw assertionError("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(i,a){return!1}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,__EMPTY_NODE)}makePost(i,a){return assert(typeof i=="string","KeyIndex indexValue must always be a string."),new NamedNode(i,__EMPTY_NODE)}toString(){return".key"}}const KEY_INDEX=new KeyIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedMapIterator{constructor(i,a,d,g,b=null){this.isReverse_=g,this.resultGenerator_=b,this.nodeStack_=[];let $=1;for(;!i.isEmpty();)if(i=i,$=a?d(i.key,a):1,g&&($*=-1),$<0)this.isReverse_?i=i.left:i=i.right;else if($===0){this.nodeStack_.push(i);break}else this.nodeStack_.push(i),this.isReverse_?i=i.right:i=i.left}getNext(){if(this.nodeStack_.length===0)return null;let i=this.nodeStack_.pop(),a;if(this.resultGenerator_?a=this.resultGenerator_(i.key,i.value):a={key:i.key,value:i.value},this.isReverse_)for(i=i.left;!i.isEmpty();)this.nodeStack_.push(i),i=i.right;else for(i=i.right;!i.isEmpty();)this.nodeStack_.push(i),i=i.left;return a}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const i=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(i.key,i.value):{key:i.key,value:i.value}}}class LLRBNode{constructor(i,a,d,g,b){this.key=i,this.value=a,this.color=d??LLRBNode.RED,this.left=g??SortedMap.EMPTY_NODE,this.right=b??SortedMap.EMPTY_NODE}copy(i,a,d,g,b){return new LLRBNode(i??this.key,a??this.value,d??this.color,g??this.left,b??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(i){return this.left.inorderTraversal(i)||!!i(this.key,this.value)||this.right.inorderTraversal(i)}reverseTraversal(i){return this.right.reverseTraversal(i)||i(this.key,this.value)||this.left.reverseTraversal(i)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(i,a,d){let g=this;const b=d(i,g.key);return b<0?g=g.copy(null,null,null,g.left.insert(i,a,d),null):b===0?g=g.copy(null,a,null,null,null):g=g.copy(null,null,null,null,g.right.insert(i,a,d)),g.fixUp_()}removeMin_(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;let i=this;return!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.removeMin_(),null),i.fixUp_()}remove(i,a){let d,g;if(d=this,a(i,d.key)<0)!d.left.isEmpty()&&!d.left.isRed_()&&!d.left.left.isRed_()&&(d=d.moveRedLeft_()),d=d.copy(null,null,null,d.left.remove(i,a),null);else{if(d.left.isRed_()&&(d=d.rotateRight_()),!d.right.isEmpty()&&!d.right.isRed_()&&!d.right.left.isRed_()&&(d=d.moveRedRight_()),a(i,d.key)===0){if(d.right.isEmpty())return SortedMap.EMPTY_NODE;g=d.right.min_(),d=d.copy(g.key,g.value,null,null,d.right.removeMin_())}d=d.copy(null,null,null,null,d.right.remove(i,a))}return d.fixUp_()}isRed_(){return this.color}fixUp_(){let i=this;return i.right.isRed_()&&!i.left.isRed_()&&(i=i.rotateLeft_()),i.left.isRed_()&&i.left.left.isRed_()&&(i=i.rotateRight_()),i.left.isRed_()&&i.right.isRed_()&&(i=i.colorFlip_()),i}moveRedLeft_(){let i=this.colorFlip_();return i.right.left.isRed_()&&(i=i.copy(null,null,null,null,i.right.rotateRight_()),i=i.rotateLeft_(),i=i.colorFlip_()),i}moveRedRight_(){let i=this.colorFlip_();return i.left.left.isRed_()&&(i=i.rotateRight_(),i=i.colorFlip_()),i}rotateLeft_(){const i=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,i,null)}rotateRight_(){const i=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,i)}colorFlip_(){const i=this.left.copy(null,null,!this.left.color,null,null),a=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,i,a)}checkMaxDepth_(){const i=this.check_();return Math.pow(2,i)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const i=this.left.check_();if(i!==this.right.check_())throw new Error("Black depths differ");return i+(this.isRed_()?0:1)}}LLRBNode.RED=!0;LLRBNode.BLACK=!1;class LLRBEmptyNode{copy(i,a,d,g,b){return this}insert(i,a,d){return new LLRBNode(i,a,null)}remove(i,a){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(i){return!1}reverseTraversal(i){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class SortedMap{constructor(i,a=SortedMap.EMPTY_NODE){this.comparator_=i,this.root_=a}insert(i,a){return new SortedMap(this.comparator_,this.root_.insert(i,a,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}remove(i){return new SortedMap(this.comparator_,this.root_.remove(i,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}get(i){let a,d=this.root_;for(;!d.isEmpty();){if(a=this.comparator_(i,d.key),a===0)return d.value;a<0?d=d.left:a>0&&(d=d.right)}return null}getPredecessorKey(i){let a,d=this.root_,g=null;for(;!d.isEmpty();)if(a=this.comparator_(i,d.key),a===0){if(d.left.isEmpty())return g?g.key:null;for(d=d.left;!d.right.isEmpty();)d=d.right;return d.key}else a<0?d=d.left:a>0&&(g=d,d=d.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(i){return this.root_.inorderTraversal(i)}reverseTraversal(i){return this.root_.reverseTraversal(i)}getIterator(i){return new SortedMapIterator(this.root_,null,this.comparator_,!1,i)}getIteratorFrom(i,a){return new SortedMapIterator(this.root_,i,this.comparator_,!1,a)}getReverseIteratorFrom(i,a){return new SortedMapIterator(this.root_,i,this.comparator_,!0,a)}getReverseIterator(i){return new SortedMapIterator(this.root_,null,this.comparator_,!0,i)}}SortedMap.EMPTY_NODE=new LLRBEmptyNode;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NAME_ONLY_COMPARATOR(s,i){return nameCompare(s.name,i.name)}function NAME_COMPARATOR(s,i){return nameCompare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MAX_NODE$2;function setMaxNode$1(s){MAX_NODE$2=s}const priorityHashText=function(s){return typeof s=="number"?"number:"+doubleToIEEE754String(s):"string:"+s},validatePriorityNode=function(s){if(s.isLeafNode()){const i=s.val();assert(typeof i=="string"||typeof i=="number"||typeof i=="object"&&contains(i,".sv"),"Priority must be a string or number.")}else assert(s===MAX_NODE$2||s.isEmpty(),"priority of unexpected type.");assert(s===MAX_NODE$2||s.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __childrenNodeConstructor;class LeafNode{constructor(i,a=LeafNode.__childrenNodeConstructor.EMPTY_NODE){this.value_=i,this.priorityNode_=a,this.lazyHash_=null,assert(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),validatePriorityNode(this.priorityNode_)}static set __childrenNodeConstructor(i){__childrenNodeConstructor=i}static get __childrenNodeConstructor(){return __childrenNodeConstructor}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(i){return new LeafNode(this.value_,i)}getImmediateChild(i){return i===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}getChild(i){return pathIsEmpty(i)?this:pathGetFront(i)===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(i,a){return null}updateImmediateChild(i,a){return i===".priority"?this.updatePriority(a):a.isEmpty()&&i!==".priority"?this:LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(i,a).updatePriority(this.priorityNode_)}updateChild(i,a){const d=pathGetFront(i);return d===null?a:a.isEmpty()&&d!==".priority"?this:(assert(d!==".priority"||pathGetLength(i)===1,".priority must be the last token in a path"),this.updateImmediateChild(d,LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(pathPopFront(i),a)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(i,a){return!1}val(i){return i&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let i="";this.priorityNode_.isEmpty()||(i+="priority:"+priorityHashText(this.priorityNode_.val())+":");const a=typeof this.value_;i+=a+":",a==="number"?i+=doubleToIEEE754String(this.value_):i+=this.value_,this.lazyHash_=sha1(i)}return this.lazyHash_}getValue(){return this.value_}compareTo(i){return i===LeafNode.__childrenNodeConstructor.EMPTY_NODE?1:i instanceof LeafNode.__childrenNodeConstructor?-1:(assert(i.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(i))}compareToLeafNode_(i){const a=typeof i.value_,d=typeof this.value_,g=LeafNode.VALUE_TYPE_ORDER.indexOf(a),b=LeafNode.VALUE_TYPE_ORDER.indexOf(d);return assert(g>=0,"Unknown leaf type: "+a),assert(b>=0,"Unknown leaf type: "+d),g===b?d==="object"?0:this.value_<i.value_?-1:this.value_===i.value_?0:1:b-g}withIndex(){return this}isIndexed(){return!0}equals(i){if(i===this)return!0;if(i.isLeafNode()){const a=i;return this.value_===a.value_&&this.priorityNode_.equals(a.priorityNode_)}else return!1}}LeafNode.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nodeFromJSON$1,MAX_NODE$1;function setNodeFromJSON(s){nodeFromJSON$1=s}function setMaxNode(s){MAX_NODE$1=s}class PriorityIndex extends Index{compare(i,a){const d=i.node.getPriority(),g=a.node.getPriority(),b=d.compareTo(g);return b===0?nameCompare(i.name,a.name):b}isDefinedOn(i){return!i.getPriority().isEmpty()}indexedValueChanged(i,a){return!i.getPriority().equals(a.getPriority())}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,new LeafNode("[PRIORITY-POST]",MAX_NODE$1))}makePost(i,a){const d=nodeFromJSON$1(i);return new NamedNode(a,new LeafNode("[PRIORITY-POST]",d))}toString(){return".priority"}}const PRIORITY_INDEX=new PriorityIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LOG_2=Math.log(2);class Base12Num{constructor(i){const a=b=>parseInt(Math.log(b)/LOG_2,10),d=b=>parseInt(Array(b+1).join("1"),2);this.count=a(i+1),this.current_=this.count-1;const g=d(this.count);this.bits_=i+1&g}nextBitIsOne(){const i=!(this.bits_&1<<this.current_);return this.current_--,i}}const buildChildSet=function(s,i,a,d){s.sort(i);const g=function(it,rt){const ot=rt-it;let lt,ut;if(ot===0)return null;if(ot===1)return lt=s[it],ut=a?a(lt):lt,new LLRBNode(ut,lt.node,LLRBNode.BLACK,null,null);{const pt=parseInt(ot/2,10)+it,_t=g(it,pt),wt=g(pt+1,rt);return lt=s[pt],ut=a?a(lt):lt,new LLRBNode(ut,lt.node,LLRBNode.BLACK,_t,wt)}},b=function(it){let rt=null,ot=null,lt=s.length;const ut=function(_t,wt){const vt=lt-_t,ht=lt;lt-=_t;const ft=g(vt+1,ht),mt=s[vt],bt=a?a(mt):mt;pt(new LLRBNode(bt,mt.node,wt,null,ft))},pt=function(_t){rt?(rt.left=_t,rt=_t):(ot=_t,rt=_t)};for(let _t=0;_t<it.count;++_t){const wt=it.nextBitIsOne(),vt=Math.pow(2,it.count-(_t+1));wt?ut(vt,LLRBNode.BLACK):(ut(vt,LLRBNode.BLACK),ut(vt,LLRBNode.RED))}return ot},$=new Base12Num(s.length),tt=b($);return new SortedMap(d||i,tt)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _defaultIndexMap;const fallbackObject={};class IndexMap{constructor(i,a){this.indexes_=i,this.indexSet_=a}static get Default(){return assert(fallbackObject&&PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),_defaultIndexMap=_defaultIndexMap||new IndexMap({".priority":fallbackObject},{".priority":PRIORITY_INDEX}),_defaultIndexMap}get(i){const a=safeGet(this.indexes_,i);if(!a)throw new Error("No index defined for "+i);return a instanceof SortedMap?a:null}hasIndex(i){return contains(this.indexSet_,i.toString())}addIndex(i,a){assert(i!==KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const d=[];let g=!1;const b=a.getIterator(NamedNode.Wrap);let $=b.getNext();for(;$;)g=g||i.isDefinedOn($.node),d.push($),$=b.getNext();let tt;g?tt=buildChildSet(d,i.getCompare()):tt=fallbackObject;const it=i.toString(),rt=Object.assign({},this.indexSet_);rt[it]=i;const ot=Object.assign({},this.indexes_);return ot[it]=tt,new IndexMap(ot,rt)}addToIndexes(i,a){const d=map(this.indexes_,(g,b)=>{const $=safeGet(this.indexSet_,b);if(assert($,"Missing index implementation for "+b),g===fallbackObject)if($.isDefinedOn(i.node)){const tt=[],it=a.getIterator(NamedNode.Wrap);let rt=it.getNext();for(;rt;)rt.name!==i.name&&tt.push(rt),rt=it.getNext();return tt.push(i),buildChildSet(tt,$.getCompare())}else return fallbackObject;else{const tt=a.get(i.name);let it=g;return tt&&(it=it.remove(new NamedNode(i.name,tt))),it.insert(i,i.node)}});return new IndexMap(d,this.indexSet_)}removeFromIndexes(i,a){const d=map(this.indexes_,g=>{if(g===fallbackObject)return g;{const b=a.get(i.name);return b?g.remove(new NamedNode(i.name,b)):g}});return new IndexMap(d,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EMPTY_NODE;class ChildrenNode{constructor(i,a,d){this.children_=i,this.priorityNode_=a,this.indexMap_=d,this.lazyHash_=null,this.priorityNode_&&validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return EMPTY_NODE||(EMPTY_NODE=new ChildrenNode(new SortedMap(NAME_COMPARATOR),null,IndexMap.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||EMPTY_NODE}updatePriority(i){return this.children_.isEmpty()?this:new ChildrenNode(this.children_,i,this.indexMap_)}getImmediateChild(i){if(i===".priority")return this.getPriority();{const a=this.children_.get(i);return a===null?EMPTY_NODE:a}}getChild(i){const a=pathGetFront(i);return a===null?this:this.getImmediateChild(a).getChild(pathPopFront(i))}hasChild(i){return this.children_.get(i)!==null}updateImmediateChild(i,a){if(assert(a,"We should always be passing snapshot nodes"),i===".priority")return this.updatePriority(a);{const d=new NamedNode(i,a);let g,b;a.isEmpty()?(g=this.children_.remove(i),b=this.indexMap_.removeFromIndexes(d,this.children_)):(g=this.children_.insert(i,a),b=this.indexMap_.addToIndexes(d,this.children_));const $=g.isEmpty()?EMPTY_NODE:this.priorityNode_;return new ChildrenNode(g,$,b)}}updateChild(i,a){const d=pathGetFront(i);if(d===null)return a;{assert(pathGetFront(i)!==".priority"||pathGetLength(i)===1,".priority must be the last token in a path");const g=this.getImmediateChild(d).updateChild(pathPopFront(i),a);return this.updateImmediateChild(d,g)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(i){if(this.isEmpty())return null;const a={};let d=0,g=0,b=!0;if(this.forEachChild(PRIORITY_INDEX,($,tt)=>{a[$]=tt.val(i),d++,b&&ChildrenNode.INTEGER_REGEXP_.test($)?g=Math.max(g,Number($)):b=!1}),!i&&b&&g<2*d){const $=[];for(const tt in a)$[tt]=a[tt];return $}else return i&&!this.getPriority().isEmpty()&&(a[".priority"]=this.getPriority().val()),a}hash(){if(this.lazyHash_===null){let i="";this.getPriority().isEmpty()||(i+="priority:"+priorityHashText(this.getPriority().val())+":"),this.forEachChild(PRIORITY_INDEX,(a,d)=>{const g=d.hash();g!==""&&(i+=":"+a+":"+g)}),this.lazyHash_=i===""?"":sha1(i)}return this.lazyHash_}getPredecessorChildName(i,a,d){const g=this.resolveIndex_(d);if(g){const b=g.getPredecessorKey(new NamedNode(i,a));return b?b.name:null}else return this.children_.getPredecessorKey(i)}getFirstChildName(i){const a=this.resolveIndex_(i);if(a){const d=a.minKey();return d&&d.name}else return this.children_.minKey()}getFirstChild(i){const a=this.getFirstChildName(i);return a?new NamedNode(a,this.children_.get(a)):null}getLastChildName(i){const a=this.resolveIndex_(i);if(a){const d=a.maxKey();return d&&d.name}else return this.children_.maxKey()}getLastChild(i){const a=this.getLastChildName(i);return a?new NamedNode(a,this.children_.get(a)):null}forEachChild(i,a){const d=this.resolveIndex_(i);return d?d.inorderTraversal(g=>a(g.name,g.node)):this.children_.inorderTraversal(a)}getIterator(i){return this.getIteratorFrom(i.minPost(),i)}getIteratorFrom(i,a){const d=this.resolveIndex_(a);if(d)return d.getIteratorFrom(i,g=>g);{const g=this.children_.getIteratorFrom(i.name,NamedNode.Wrap);let b=g.peek();for(;b!=null&&a.compare(b,i)<0;)g.getNext(),b=g.peek();return g}}getReverseIterator(i){return this.getReverseIteratorFrom(i.maxPost(),i)}getReverseIteratorFrom(i,a){const d=this.resolveIndex_(a);if(d)return d.getReverseIteratorFrom(i,g=>g);{const g=this.children_.getReverseIteratorFrom(i.name,NamedNode.Wrap);let b=g.peek();for(;b!=null&&a.compare(b,i)>0;)g.getNext(),b=g.peek();return g}}compareTo(i){return this.isEmpty()?i.isEmpty()?0:-1:i.isLeafNode()||i.isEmpty()?1:i===MAX_NODE?-1:0}withIndex(i){if(i===KEY_INDEX||this.indexMap_.hasIndex(i))return this;{const a=this.indexMap_.addIndex(i,this.children_);return new ChildrenNode(this.children_,this.priorityNode_,a)}}isIndexed(i){return i===KEY_INDEX||this.indexMap_.hasIndex(i)}equals(i){if(i===this)return!0;if(i.isLeafNode())return!1;{const a=i;if(this.getPriority().equals(a.getPriority()))if(this.children_.count()===a.children_.count()){const d=this.getIterator(PRIORITY_INDEX),g=a.getIterator(PRIORITY_INDEX);let b=d.getNext(),$=g.getNext();for(;b&&$;){if(b.name!==$.name||!b.node.equals($.node))return!1;b=d.getNext(),$=g.getNext()}return b===null&&$===null}else return!1;else return!1}}resolveIndex_(i){return i===KEY_INDEX?null:this.indexMap_.get(i.toString())}}ChildrenNode.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class MaxNode extends ChildrenNode{constructor(){super(new SortedMap(NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap.Default)}compareTo(i){return i===this?0:1}equals(i){return i===this}getPriority(){return this}getImmediateChild(i){return ChildrenNode.EMPTY_NODE}isEmpty(){return!1}}const MAX_NODE=new MaxNode;Object.defineProperties(NamedNode,{MIN:{value:new NamedNode(MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new NamedNode(MAX_NAME,MAX_NODE)}});KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE;LeafNode.__childrenNodeConstructor=ChildrenNode;setMaxNode$1(MAX_NODE);setMaxNode(MAX_NODE);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const USE_HINZE=!0;function nodeFromJSON(s,i=null){if(s===null)return ChildrenNode.EMPTY_NODE;if(typeof s=="object"&&".priority"in s&&(i=s[".priority"]),assert(i===null||typeof i=="string"||typeof i=="number"||typeof i=="object"&&".sv"in i,"Invalid priority type found: "+typeof i),typeof s=="object"&&".value"in s&&s[".value"]!==null&&(s=s[".value"]),typeof s!="object"||".sv"in s){const a=s;return new LeafNode(a,nodeFromJSON(i))}if(!(s instanceof Array)&&USE_HINZE){const a=[];let d=!1;if(each(s,($,tt)=>{if($.substring(0,1)!=="."){const it=nodeFromJSON(tt);it.isEmpty()||(d=d||!it.getPriority().isEmpty(),a.push(new NamedNode($,it)))}}),a.length===0)return ChildrenNode.EMPTY_NODE;const b=buildChildSet(a,NAME_ONLY_COMPARATOR,$=>$.name,NAME_COMPARATOR);if(d){const $=buildChildSet(a,PRIORITY_INDEX.getCompare());return new ChildrenNode(b,nodeFromJSON(i),new IndexMap({".priority":$},{".priority":PRIORITY_INDEX}))}else return new ChildrenNode(b,nodeFromJSON(i),IndexMap.Default)}else{let a=ChildrenNode.EMPTY_NODE;return each(s,(d,g)=>{if(contains(s,d)&&d.substring(0,1)!=="."){const b=nodeFromJSON(g);(b.isLeafNode()||!b.isEmpty())&&(a=a.updateImmediateChild(d,b))}}),a.updatePriority(nodeFromJSON(i))}}setNodeFromJSON(nodeFromJSON);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PathIndex extends Index{constructor(i){super(),this.indexPath_=i,assert(!pathIsEmpty(i)&&pathGetFront(i)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(i){return i.getChild(this.indexPath_)}isDefinedOn(i){return!i.getChild(this.indexPath_).isEmpty()}compare(i,a){const d=this.extractChild(i.node),g=this.extractChild(a.node),b=d.compareTo(g);return b===0?nameCompare(i.name,a.name):b}makePost(i,a){const d=nodeFromJSON(i),g=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,d);return new NamedNode(a,g)}maxPost(){const i=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,MAX_NODE);return new NamedNode(MAX_NAME,i)}toString(){return pathSlice(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ValueIndex extends Index{compare(i,a){const d=i.node.compareTo(a.node);return d===0?nameCompare(i.name,a.name):d}isDefinedOn(i){return!0}indexedValueChanged(i,a){return!i.equals(a)}minPost(){return NamedNode.MIN}maxPost(){return NamedNode.MAX}makePost(i,a){const d=nodeFromJSON(i);return new NamedNode(a,d)}toString(){return".value"}}const VALUE_INDEX=new ValueIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function changeValue(s){return{type:"value",snapshotNode:s}}function changeChildAdded(s,i){return{type:"child_added",snapshotNode:i,childName:s}}function changeChildRemoved(s,i){return{type:"child_removed",snapshotNode:i,childName:s}}function changeChildChanged(s,i,a){return{type:"child_changed",snapshotNode:i,childName:s,oldSnap:a}}function changeChildMoved(s,i){return{type:"child_moved",snapshotNode:i,childName:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IndexedFilter{constructor(i){this.index_=i}updateChild(i,a,d,g,b,$){assert(i.isIndexed(this.index_),"A node must be indexed if only a child is updated");const tt=i.getImmediateChild(a);return tt.getChild(g).equals(d.getChild(g))&&tt.isEmpty()===d.isEmpty()||($!=null&&(d.isEmpty()?i.hasChild(a)?$.trackChildChange(changeChildRemoved(a,tt)):assert(i.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):tt.isEmpty()?$.trackChildChange(changeChildAdded(a,d)):$.trackChildChange(changeChildChanged(a,d,tt))),i.isLeafNode()&&d.isEmpty())?i:i.updateImmediateChild(a,d).withIndex(this.index_)}updateFullNode(i,a,d){return d!=null&&(i.isLeafNode()||i.forEachChild(PRIORITY_INDEX,(g,b)=>{a.hasChild(g)||d.trackChildChange(changeChildRemoved(g,b))}),a.isLeafNode()||a.forEachChild(PRIORITY_INDEX,(g,b)=>{if(i.hasChild(g)){const $=i.getImmediateChild(g);$.equals(b)||d.trackChildChange(changeChildChanged(g,b,$))}else d.trackChildChange(changeChildAdded(g,b))})),a.withIndex(this.index_)}updatePriority(i,a){return i.isEmpty()?ChildrenNode.EMPTY_NODE:i.updatePriority(a)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RangedFilter{constructor(i){this.indexedFilter_=new IndexedFilter(i.getIndex()),this.index_=i.getIndex(),this.startPost_=RangedFilter.getStartPost_(i),this.endPost_=RangedFilter.getEndPost_(i),this.startIsInclusive_=!i.startAfterSet_,this.endIsInclusive_=!i.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(i){const a=this.startIsInclusive_?this.index_.compare(this.getStartPost(),i)<=0:this.index_.compare(this.getStartPost(),i)<0,d=this.endIsInclusive_?this.index_.compare(i,this.getEndPost())<=0:this.index_.compare(i,this.getEndPost())<0;return a&&d}updateChild(i,a,d,g,b,$){return this.matches(new NamedNode(a,d))||(d=ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(i,a,d,g,b,$)}updateFullNode(i,a,d){a.isLeafNode()&&(a=ChildrenNode.EMPTY_NODE);let g=a.withIndex(this.index_);g=g.updatePriority(ChildrenNode.EMPTY_NODE);const b=this;return a.forEachChild(PRIORITY_INDEX,($,tt)=>{b.matches(new NamedNode($,tt))||(g=g.updateImmediateChild($,ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(i,g,d)}updatePriority(i,a){return i}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(i){if(i.hasStart()){const a=i.getIndexStartName();return i.getIndex().makePost(i.getIndexStartValue(),a)}else return i.getIndex().minPost()}static getEndPost_(i){if(i.hasEnd()){const a=i.getIndexEndName();return i.getIndex().makePost(i.getIndexEndValue(),a)}else return i.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LimitedFilter{constructor(i){this.withinDirectionalStart=a=>this.reverse_?this.withinEndPost(a):this.withinStartPost(a),this.withinDirectionalEnd=a=>this.reverse_?this.withinStartPost(a):this.withinEndPost(a),this.withinStartPost=a=>{const d=this.index_.compare(this.rangedFilter_.getStartPost(),a);return this.startIsInclusive_?d<=0:d<0},this.withinEndPost=a=>{const d=this.index_.compare(a,this.rangedFilter_.getEndPost());return this.endIsInclusive_?d<=0:d<0},this.rangedFilter_=new RangedFilter(i),this.index_=i.getIndex(),this.limit_=i.getLimit(),this.reverse_=!i.isViewFromLeft(),this.startIsInclusive_=!i.startAfterSet_,this.endIsInclusive_=!i.endBeforeSet_}updateChild(i,a,d,g,b,$){return this.rangedFilter_.matches(new NamedNode(a,d))||(d=ChildrenNode.EMPTY_NODE),i.getImmediateChild(a).equals(d)?i:i.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(i,a,d,g,b,$):this.fullLimitUpdateChild_(i,a,d,b,$)}updateFullNode(i,a,d){let g;if(a.isLeafNode()||a.isEmpty())g=ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<a.numChildren()&&a.isIndexed(this.index_)){g=ChildrenNode.EMPTY_NODE.withIndex(this.index_);let b;this.reverse_?b=a.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):b=a.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let $=0;for(;b.hasNext()&&$<this.limit_;){const tt=b.getNext();if(this.withinDirectionalStart(tt))if(this.withinDirectionalEnd(tt))g=g.updateImmediateChild(tt.name,tt.node),$++;else break;else continue}}else{g=a.withIndex(this.index_),g=g.updatePriority(ChildrenNode.EMPTY_NODE);let b;this.reverse_?b=g.getReverseIterator(this.index_):b=g.getIterator(this.index_);let $=0;for(;b.hasNext();){const tt=b.getNext();$<this.limit_&&this.withinDirectionalStart(tt)&&this.withinDirectionalEnd(tt)?$++:g=g.updateImmediateChild(tt.name,ChildrenNode.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(i,g,d)}updatePriority(i,a){return i}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(i,a,d,g,b){let $;if(this.reverse_){const lt=this.index_.getCompare();$=(ut,pt)=>lt(pt,ut)}else $=this.index_.getCompare();const tt=i;assert(tt.numChildren()===this.limit_,"");const it=new NamedNode(a,d),rt=this.reverse_?tt.getFirstChild(this.index_):tt.getLastChild(this.index_),ot=this.rangedFilter_.matches(it);if(tt.hasChild(a)){const lt=tt.getImmediateChild(a);let ut=g.getChildAfterChild(this.index_,rt,this.reverse_);for(;ut!=null&&(ut.name===a||tt.hasChild(ut.name));)ut=g.getChildAfterChild(this.index_,ut,this.reverse_);const pt=ut==null?1:$(ut,it);if(ot&&!d.isEmpty()&&pt>=0)return b!=null&&b.trackChildChange(changeChildChanged(a,d,lt)),tt.updateImmediateChild(a,d);{b!=null&&b.trackChildChange(changeChildRemoved(a,lt));const wt=tt.updateImmediateChild(a,ChildrenNode.EMPTY_NODE);return ut!=null&&this.rangedFilter_.matches(ut)?(b!=null&&b.trackChildChange(changeChildAdded(ut.name,ut.node)),wt.updateImmediateChild(ut.name,ut.node)):wt}}else return d.isEmpty()?i:ot&&$(rt,it)>=0?(b!=null&&(b.trackChildChange(changeChildRemoved(rt.name,rt.node)),b.trackChildChange(changeChildAdded(a,d))),tt.updateImmediateChild(a,d).updateImmediateChild(rt.name,ChildrenNode.EMPTY_NODE)):i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryParams{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=PRIORITY_INDEX}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:MIN_NAME}hasEnd(){return this.endSet_}getIndexEndValue(){return assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:MAX_NAME}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return assert(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===PRIORITY_INDEX}copy(){const i=new QueryParams;return i.limitSet_=this.limitSet_,i.limit_=this.limit_,i.startSet_=this.startSet_,i.startAfterSet_=this.startAfterSet_,i.indexStartValue_=this.indexStartValue_,i.startNameSet_=this.startNameSet_,i.indexStartName_=this.indexStartName_,i.endSet_=this.endSet_,i.endBeforeSet_=this.endBeforeSet_,i.indexEndValue_=this.indexEndValue_,i.endNameSet_=this.endNameSet_,i.indexEndName_=this.indexEndName_,i.index_=this.index_,i.viewFrom_=this.viewFrom_,i}}function queryParamsGetNodeFilter(s){return s.loadsAllData()?new IndexedFilter(s.getIndex()):s.hasLimit()?new LimitedFilter(s):new RangedFilter(s)}function queryParamsToRestQueryStringParameters(s){const i={};if(s.isDefault())return i;let a;if(s.index_===PRIORITY_INDEX?a="$priority":s.index_===VALUE_INDEX?a="$value":s.index_===KEY_INDEX?a="$key":(assert(s.index_ instanceof PathIndex,"Unrecognized index type!"),a=s.index_.toString()),i.orderBy=stringify(a),s.startSet_){const d=s.startAfterSet_?"startAfter":"startAt";i[d]=stringify(s.indexStartValue_),s.startNameSet_&&(i[d]+=","+stringify(s.indexStartName_))}if(s.endSet_){const d=s.endBeforeSet_?"endBefore":"endAt";i[d]=stringify(s.indexEndValue_),s.endNameSet_&&(i[d]+=","+stringify(s.indexEndName_))}return s.limitSet_&&(s.isViewFromLeft()?i.limitToFirst=s.limit_:i.limitToLast=s.limit_),i}function queryParamsGetQueryObject(s){const i={};if(s.startSet_&&(i.sp=s.indexStartValue_,s.startNameSet_&&(i.sn=s.indexStartName_),i.sin=!s.startAfterSet_),s.endSet_&&(i.ep=s.indexEndValue_,s.endNameSet_&&(i.en=s.indexEndName_),i.ein=!s.endBeforeSet_),s.limitSet_){i.l=s.limit_;let a=s.viewFrom_;a===""&&(s.isViewFromLeft()?a="l":a="r"),i.vf=a}return s.index_!==PRIORITY_INDEX&&(i.i=s.index_.toString()),i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ReadonlyRestClient extends ServerActions{constructor(i,a,d,g){super(),this.repoInfo_=i,this.onDataUpdate_=a,this.authTokenProvider_=d,this.appCheckTokenProvider_=g,this.log_=logWrapper("p:rest:"),this.listens_={}}reportStats(i){throw new Error("Method not implemented.")}static getListenId_(i,a){return a!==void 0?"tag$"+a:(assert(i._queryParams.isDefault(),"should have a tag if it's not a default query."),i._path.toString())}listen(i,a,d,g){const b=i._path.toString();this.log_("Listen called for "+b+" "+i._queryIdentifier);const $=ReadonlyRestClient.getListenId_(i,d),tt={};this.listens_[$]=tt;const it=queryParamsToRestQueryStringParameters(i._queryParams);this.restRequest_(b+".json",it,(rt,ot)=>{let lt=ot;if(rt===404&&(lt=null,rt=null),rt===null&&this.onDataUpdate_(b,lt,!1,d),safeGet(this.listens_,$)===tt){let ut;rt?rt===401?ut="permission_denied":ut="rest_error:"+rt:ut="ok",g(ut,null)}})}unlisten(i,a){const d=ReadonlyRestClient.getListenId_(i,a);delete this.listens_[d]}get(i){const a=queryParamsToRestQueryStringParameters(i._queryParams),d=i._path.toString(),g=new Deferred$1;return this.restRequest_(d+".json",a,(b,$)=>{let tt=$;b===404&&(tt=null,b=null),b===null?(this.onDataUpdate_(d,tt,!1,null),g.resolve(tt)):g.reject(new Error(tt))}),g.promise}refreshAuthToken(i){}restRequest_(i,a={},d){return a.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([g,b])=>{g&&g.accessToken&&(a.auth=g.accessToken),b&&b.token&&(a.ac=b.token);const $=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+i+"?ns="+this.repoInfo_.namespace+querystring(a);this.log_("Sending REST request for "+$);const tt=new XMLHttpRequest;tt.onreadystatechange=()=>{if(d&&tt.readyState===4){this.log_("REST Response for "+$+" received. status:",tt.status,"response:",tt.responseText);let it=null;if(tt.status>=200&&tt.status<300){try{it=jsonEval(tt.responseText)}catch{warn("Failed to parse JSON response for "+$+": "+tt.responseText)}d(null,it)}else tt.status!==401&&tt.status!==404&&warn("Got unsuccessful REST response for "+$+" Status: "+tt.status),d(tt.status);d=null}},tt.open("GET",$,!0),tt.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotHolder{constructor(){this.rootNode_=ChildrenNode.EMPTY_NODE}getNode(i){return this.rootNode_.getChild(i)}updateSnapshot(i,a){this.rootNode_=this.rootNode_.updateChild(i,a)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newSparseSnapshotTree(){return{value:null,children:new Map}}function sparseSnapshotTreeRemember(s,i,a){if(pathIsEmpty(i))s.value=a,s.children.clear();else if(s.value!==null)s.value=s.value.updateChild(i,a);else{const d=pathGetFront(i);s.children.has(d)||s.children.set(d,newSparseSnapshotTree());const g=s.children.get(d);i=pathPopFront(i),sparseSnapshotTreeRemember(g,i,a)}}function sparseSnapshotTreeForEachTree(s,i,a){s.value!==null?a(i,s.value):sparseSnapshotTreeForEachChild(s,(d,g)=>{const b=new Path(i.toString()+"/"+d);sparseSnapshotTreeForEachTree(g,b,a)})}function sparseSnapshotTreeForEachChild(s,i){s.children.forEach((a,d)=>{i(d,a)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StatsListener{constructor(i){this.collection_=i,this.last_=null}get(){const i=this.collection_.get(),a=Object.assign({},i);return this.last_&&each(this.last_,(d,g)=>{a[d]=a[d]-g}),this.last_=i,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIRST_STATS_MIN_TIME=10*1e3,FIRST_STATS_MAX_TIME=30*1e3,REPORT_STATS_INTERVAL=5*60*1e3;class StatsReporter{constructor(i,a){this.server_=a,this.statsToReport_={},this.statsListener_=new StatsListener(i);const d=FIRST_STATS_MIN_TIME+(FIRST_STATS_MAX_TIME-FIRST_STATS_MIN_TIME)*Math.random();setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(d))}reportStats_(){const i=this.statsListener_.get(),a={};let d=!1;each(i,(g,b)=>{b>0&&contains(this.statsToReport_,g)&&(a[g]=b,d=!0)}),d&&this.server_.reportStats(a),setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(Math.random()*2*REPORT_STATS_INTERVAL))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var OperationType;(function(s){s[s.OVERWRITE=0]="OVERWRITE",s[s.MERGE=1]="MERGE",s[s.ACK_USER_WRITE=2]="ACK_USER_WRITE",s[s.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(OperationType||(OperationType={}));function newOperationSourceUser(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function newOperationSourceServer(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function newOperationSourceServerTaggedQuery(s){return{fromUser:!1,fromServer:!0,queryId:s,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AckUserWrite{constructor(i,a,d){this.path=i,this.affectedTree=a,this.revert=d,this.type=OperationType.ACK_USER_WRITE,this.source=newOperationSourceUser()}operationForChild(i){if(pathIsEmpty(this.path)){if(this.affectedTree.value!=null)return assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const a=this.affectedTree.subtree(new Path(i));return new AckUserWrite(newEmptyPath(),a,this.revert)}}else return assert(pathGetFront(this.path)===i,"operationForChild called for unrelated child."),new AckUserWrite(pathPopFront(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ListenComplete{constructor(i,a){this.source=i,this.path=a,this.type=OperationType.LISTEN_COMPLETE}operationForChild(i){return pathIsEmpty(this.path)?new ListenComplete(this.source,newEmptyPath()):new ListenComplete(this.source,pathPopFront(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Overwrite{constructor(i,a,d){this.source=i,this.path=a,this.snap=d,this.type=OperationType.OVERWRITE}operationForChild(i){return pathIsEmpty(this.path)?new Overwrite(this.source,newEmptyPath(),this.snap.getImmediateChild(i)):new Overwrite(this.source,pathPopFront(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Merge{constructor(i,a,d){this.source=i,this.path=a,this.children=d,this.type=OperationType.MERGE}operationForChild(i){if(pathIsEmpty(this.path)){const a=this.children.subtree(new Path(i));return a.isEmpty()?null:a.value?new Overwrite(this.source,newEmptyPath(),a.value):new Merge(this.source,newEmptyPath(),a)}else return assert(pathGetFront(this.path)===i,"Can't get a merge for a child not on the path of the operation"),new Merge(this.source,pathPopFront(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CacheNode{constructor(i,a,d){this.node_=i,this.fullyInitialized_=a,this.filtered_=d}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(i){if(pathIsEmpty(i))return this.isFullyInitialized()&&!this.filtered_;const a=pathGetFront(i);return this.isCompleteForChild(a)}isCompleteForChild(i){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(i)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventGenerator{constructor(i){this.query_=i,this.index_=this.query_._queryParams.getIndex()}}function eventGeneratorGenerateEventsForChanges(s,i,a,d){const g=[],b=[];return i.forEach($=>{$.type==="child_changed"&&s.index_.indexedValueChanged($.oldSnap,$.snapshotNode)&&b.push(changeChildMoved($.childName,$.snapshotNode))}),eventGeneratorGenerateEventsForType(s,g,"child_removed",i,d,a),eventGeneratorGenerateEventsForType(s,g,"child_added",i,d,a),eventGeneratorGenerateEventsForType(s,g,"child_moved",b,d,a),eventGeneratorGenerateEventsForType(s,g,"child_changed",i,d,a),eventGeneratorGenerateEventsForType(s,g,"value",i,d,a),g}function eventGeneratorGenerateEventsForType(s,i,a,d,g,b){const $=d.filter(tt=>tt.type===a);$.sort((tt,it)=>eventGeneratorCompareChanges(s,tt,it)),$.forEach(tt=>{const it=eventGeneratorMaterializeSingleChange(s,tt,b);g.forEach(rt=>{rt.respondsTo(tt.type)&&i.push(rt.createEvent(it,s.query_))})})}function eventGeneratorMaterializeSingleChange(s,i,a){return i.type==="value"||i.type==="child_removed"||(i.prevName=a.getPredecessorChildName(i.childName,i.snapshotNode,s.index_)),i}function eventGeneratorCompareChanges(s,i,a){if(i.childName==null||a.childName==null)throw assertionError("Should only compare child_ events.");const d=new NamedNode(i.childName,i.snapshotNode),g=new NamedNode(a.childName,a.snapshotNode);return s.index_.compare(d,g)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newViewCache(s,i){return{eventCache:s,serverCache:i}}function viewCacheUpdateEventSnap(s,i,a,d){return newViewCache(new CacheNode(i,a,d),s.serverCache)}function viewCacheUpdateServerSnap(s,i,a,d){return newViewCache(s.eventCache,new CacheNode(i,a,d))}function viewCacheGetCompleteEventSnap(s){return s.eventCache.isFullyInitialized()?s.eventCache.getNode():null}function viewCacheGetCompleteServerSnap(s){return s.serverCache.isFullyInitialized()?s.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let emptyChildrenSingleton;const EmptyChildren=()=>(emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap(stringCompare)),emptyChildrenSingleton);class ImmutableTree{constructor(i,a=EmptyChildren()){this.value=i,this.children=a}static fromObject(i){let a=new ImmutableTree(null);return each(i,(d,g)=>{a=a.set(new Path(d),g)}),a}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(i,a){if(this.value!=null&&a(this.value))return{path:newEmptyPath(),value:this.value};if(pathIsEmpty(i))return null;{const d=pathGetFront(i),g=this.children.get(d);if(g!==null){const b=g.findRootMostMatchingPathAndValue(pathPopFront(i),a);return b!=null?{path:pathChild(new Path(d),b.path),value:b.value}:null}else return null}}findRootMostValueAndPath(i){return this.findRootMostMatchingPathAndValue(i,()=>!0)}subtree(i){if(pathIsEmpty(i))return this;{const a=pathGetFront(i),d=this.children.get(a);return d!==null?d.subtree(pathPopFront(i)):new ImmutableTree(null)}}set(i,a){if(pathIsEmpty(i))return new ImmutableTree(a,this.children);{const d=pathGetFront(i),b=(this.children.get(d)||new ImmutableTree(null)).set(pathPopFront(i),a),$=this.children.insert(d,b);return new ImmutableTree(this.value,$)}}remove(i){if(pathIsEmpty(i))return this.children.isEmpty()?new ImmutableTree(null):new ImmutableTree(null,this.children);{const a=pathGetFront(i),d=this.children.get(a);if(d){const g=d.remove(pathPopFront(i));let b;return g.isEmpty()?b=this.children.remove(a):b=this.children.insert(a,g),this.value===null&&b.isEmpty()?new ImmutableTree(null):new ImmutableTree(this.value,b)}else return this}}get(i){if(pathIsEmpty(i))return this.value;{const a=pathGetFront(i),d=this.children.get(a);return d?d.get(pathPopFront(i)):null}}setTree(i,a){if(pathIsEmpty(i))return a;{const d=pathGetFront(i),b=(this.children.get(d)||new ImmutableTree(null)).setTree(pathPopFront(i),a);let $;return b.isEmpty()?$=this.children.remove(d):$=this.children.insert(d,b),new ImmutableTree(this.value,$)}}fold(i){return this.fold_(newEmptyPath(),i)}fold_(i,a){const d={};return this.children.inorderTraversal((g,b)=>{d[g]=b.fold_(pathChild(i,g),a)}),a(i,this.value,d)}findOnPath(i,a){return this.findOnPath_(i,newEmptyPath(),a)}findOnPath_(i,a,d){const g=this.value?d(a,this.value):!1;if(g)return g;if(pathIsEmpty(i))return null;{const b=pathGetFront(i),$=this.children.get(b);return $?$.findOnPath_(pathPopFront(i),pathChild(a,b),d):null}}foreachOnPath(i,a){return this.foreachOnPath_(i,newEmptyPath(),a)}foreachOnPath_(i,a,d){if(pathIsEmpty(i))return this;{this.value&&d(a,this.value);const g=pathGetFront(i),b=this.children.get(g);return b?b.foreachOnPath_(pathPopFront(i),pathChild(a,g),d):new ImmutableTree(null)}}foreach(i){this.foreach_(newEmptyPath(),i)}foreach_(i,a){this.children.inorderTraversal((d,g)=>{g.foreach_(pathChild(i,d),a)}),this.value&&a(i,this.value)}foreachChild(i){this.children.inorderTraversal((a,d)=>{d.value&&i(a,d.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CompoundWrite{constructor(i){this.writeTree_=i}static empty(){return new CompoundWrite(new ImmutableTree(null))}}function compoundWriteAddWrite(s,i,a){if(pathIsEmpty(i))return new CompoundWrite(new ImmutableTree(a));{const d=s.writeTree_.findRootMostValueAndPath(i);if(d!=null){const g=d.path;let b=d.value;const $=newRelativePath(g,i);return b=b.updateChild($,a),new CompoundWrite(s.writeTree_.set(g,b))}else{const g=new ImmutableTree(a),b=s.writeTree_.setTree(i,g);return new CompoundWrite(b)}}}function compoundWriteAddWrites(s,i,a){let d=s;return each(a,(g,b)=>{d=compoundWriteAddWrite(d,pathChild(i,g),b)}),d}function compoundWriteRemoveWrite(s,i){if(pathIsEmpty(i))return CompoundWrite.empty();{const a=s.writeTree_.setTree(i,new ImmutableTree(null));return new CompoundWrite(a)}}function compoundWriteHasCompleteWrite(s,i){return compoundWriteGetCompleteNode(s,i)!=null}function compoundWriteGetCompleteNode(s,i){const a=s.writeTree_.findRootMostValueAndPath(i);return a!=null?s.writeTree_.get(a.path).getChild(newRelativePath(a.path,i)):null}function compoundWriteGetCompleteChildren(s){const i=[],a=s.writeTree_.value;return a!=null?a.isLeafNode()||a.forEachChild(PRIORITY_INDEX,(d,g)=>{i.push(new NamedNode(d,g))}):s.writeTree_.children.inorderTraversal((d,g)=>{g.value!=null&&i.push(new NamedNode(d,g.value))}),i}function compoundWriteChildCompoundWrite(s,i){if(pathIsEmpty(i))return s;{const a=compoundWriteGetCompleteNode(s,i);return a!=null?new CompoundWrite(new ImmutableTree(a)):new CompoundWrite(s.writeTree_.subtree(i))}}function compoundWriteIsEmpty(s){return s.writeTree_.isEmpty()}function compoundWriteApply(s,i){return applySubtreeWrite(newEmptyPath(),s.writeTree_,i)}function applySubtreeWrite(s,i,a){if(i.value!=null)return a.updateChild(s,i.value);{let d=null;return i.children.inorderTraversal((g,b)=>{g===".priority"?(assert(b.value!==null,"Priority writes must always be leaf nodes"),d=b.value):a=applySubtreeWrite(pathChild(s,g),b,a)}),!a.getChild(s).isEmpty()&&d!==null&&(a=a.updateChild(pathChild(s,".priority"),d)),a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function writeTreeChildWrites(s,i){return newWriteTreeRef(i,s)}function writeTreeAddOverwrite(s,i,a,d,g){assert(d>s.lastWriteId,"Stacking an older write on top of newer ones"),g===void 0&&(g=!0),s.allWrites.push({path:i,snap:a,writeId:d,visible:g}),g&&(s.visibleWrites=compoundWriteAddWrite(s.visibleWrites,i,a)),s.lastWriteId=d}function writeTreeGetWrite(s,i){for(let a=0;a<s.allWrites.length;a++){const d=s.allWrites[a];if(d.writeId===i)return d}return null}function writeTreeRemoveWrite(s,i){const a=s.allWrites.findIndex(tt=>tt.writeId===i);assert(a>=0,"removeWrite called with nonexistent writeId.");const d=s.allWrites[a];s.allWrites.splice(a,1);let g=d.visible,b=!1,$=s.allWrites.length-1;for(;g&&$>=0;){const tt=s.allWrites[$];tt.visible&&($>=a&&writeTreeRecordContainsPath_(tt,d.path)?g=!1:pathContains(d.path,tt.path)&&(b=!0)),$--}if(g){if(b)return writeTreeResetTree_(s),!0;if(d.snap)s.visibleWrites=compoundWriteRemoveWrite(s.visibleWrites,d.path);else{const tt=d.children;each(tt,it=>{s.visibleWrites=compoundWriteRemoveWrite(s.visibleWrites,pathChild(d.path,it))})}return!0}else return!1}function writeTreeRecordContainsPath_(s,i){if(s.snap)return pathContains(s.path,i);for(const a in s.children)if(s.children.hasOwnProperty(a)&&pathContains(pathChild(s.path,a),i))return!0;return!1}function writeTreeResetTree_(s){s.visibleWrites=writeTreeLayerTree_(s.allWrites,writeTreeDefaultFilter_,newEmptyPath()),s.allWrites.length>0?s.lastWriteId=s.allWrites[s.allWrites.length-1].writeId:s.lastWriteId=-1}function writeTreeDefaultFilter_(s){return s.visible}function writeTreeLayerTree_(s,i,a){let d=CompoundWrite.empty();for(let g=0;g<s.length;++g){const b=s[g];if(i(b)){const $=b.path;let tt;if(b.snap)pathContains(a,$)?(tt=newRelativePath(a,$),d=compoundWriteAddWrite(d,tt,b.snap)):pathContains($,a)&&(tt=newRelativePath($,a),d=compoundWriteAddWrite(d,newEmptyPath(),b.snap.getChild(tt)));else if(b.children){if(pathContains(a,$))tt=newRelativePath(a,$),d=compoundWriteAddWrites(d,tt,b.children);else if(pathContains($,a))if(tt=newRelativePath($,a),pathIsEmpty(tt))d=compoundWriteAddWrites(d,newEmptyPath(),b.children);else{const it=safeGet(b.children,pathGetFront(tt));if(it){const rt=it.getChild(pathPopFront(tt));d=compoundWriteAddWrite(d,newEmptyPath(),rt)}}}else throw assertionError("WriteRecord should have .snap or .children")}}return d}function writeTreeCalcCompleteEventCache(s,i,a,d,g){if(!d&&!g){const b=compoundWriteGetCompleteNode(s.visibleWrites,i);if(b!=null)return b;{const $=compoundWriteChildCompoundWrite(s.visibleWrites,i);if(compoundWriteIsEmpty($))return a;if(a==null&&!compoundWriteHasCompleteWrite($,newEmptyPath()))return null;{const tt=a||ChildrenNode.EMPTY_NODE;return compoundWriteApply($,tt)}}}else{const b=compoundWriteChildCompoundWrite(s.visibleWrites,i);if(!g&&compoundWriteIsEmpty(b))return a;if(!g&&a==null&&!compoundWriteHasCompleteWrite(b,newEmptyPath()))return null;{const $=function(rt){return(rt.visible||g)&&(!d||!~d.indexOf(rt.writeId))&&(pathContains(rt.path,i)||pathContains(i,rt.path))},tt=writeTreeLayerTree_(s.allWrites,$,i),it=a||ChildrenNode.EMPTY_NODE;return compoundWriteApply(tt,it)}}}function writeTreeCalcCompleteEventChildren(s,i,a){let d=ChildrenNode.EMPTY_NODE;const g=compoundWriteGetCompleteNode(s.visibleWrites,i);if(g)return g.isLeafNode()||g.forEachChild(PRIORITY_INDEX,(b,$)=>{d=d.updateImmediateChild(b,$)}),d;if(a){const b=compoundWriteChildCompoundWrite(s.visibleWrites,i);return a.forEachChild(PRIORITY_INDEX,($,tt)=>{const it=compoundWriteApply(compoundWriteChildCompoundWrite(b,new Path($)),tt);d=d.updateImmediateChild($,it)}),compoundWriteGetCompleteChildren(b).forEach($=>{d=d.updateImmediateChild($.name,$.node)}),d}else{const b=compoundWriteChildCompoundWrite(s.visibleWrites,i);return compoundWriteGetCompleteChildren(b).forEach($=>{d=d.updateImmediateChild($.name,$.node)}),d}}function writeTreeCalcEventCacheAfterServerOverwrite(s,i,a,d,g){assert(d||g,"Either existingEventSnap or existingServerSnap must exist");const b=pathChild(i,a);if(compoundWriteHasCompleteWrite(s.visibleWrites,b))return null;{const $=compoundWriteChildCompoundWrite(s.visibleWrites,b);return compoundWriteIsEmpty($)?g.getChild(a):compoundWriteApply($,g.getChild(a))}}function writeTreeCalcCompleteChild(s,i,a,d){const g=pathChild(i,a),b=compoundWriteGetCompleteNode(s.visibleWrites,g);if(b!=null)return b;if(d.isCompleteForChild(a)){const $=compoundWriteChildCompoundWrite(s.visibleWrites,g);return compoundWriteApply($,d.getNode().getImmediateChild(a))}else return null}function writeTreeShadowingWrite(s,i){return compoundWriteGetCompleteNode(s.visibleWrites,i)}function writeTreeCalcIndexedSlice(s,i,a,d,g,b,$){let tt;const it=compoundWriteChildCompoundWrite(s.visibleWrites,i),rt=compoundWriteGetCompleteNode(it,newEmptyPath());if(rt!=null)tt=rt;else if(a!=null)tt=compoundWriteApply(it,a);else return[];if(tt=tt.withIndex($),!tt.isEmpty()&&!tt.isLeafNode()){const ot=[],lt=$.getCompare(),ut=b?tt.getReverseIteratorFrom(d,$):tt.getIteratorFrom(d,$);let pt=ut.getNext();for(;pt&&ot.length<g;)lt(pt,d)!==0&&ot.push(pt),pt=ut.getNext();return ot}else return[]}function newWriteTree(){return{visibleWrites:CompoundWrite.empty(),allWrites:[],lastWriteId:-1}}function writeTreeRefCalcCompleteEventCache(s,i,a,d){return writeTreeCalcCompleteEventCache(s.writeTree,s.treePath,i,a,d)}function writeTreeRefCalcCompleteEventChildren(s,i){return writeTreeCalcCompleteEventChildren(s.writeTree,s.treePath,i)}function writeTreeRefCalcEventCacheAfterServerOverwrite(s,i,a,d){return writeTreeCalcEventCacheAfterServerOverwrite(s.writeTree,s.treePath,i,a,d)}function writeTreeRefShadowingWrite(s,i){return writeTreeShadowingWrite(s.writeTree,pathChild(s.treePath,i))}function writeTreeRefCalcIndexedSlice(s,i,a,d,g,b){return writeTreeCalcIndexedSlice(s.writeTree,s.treePath,i,a,d,g,b)}function writeTreeRefCalcCompleteChild(s,i,a){return writeTreeCalcCompleteChild(s.writeTree,s.treePath,i,a)}function writeTreeRefChild(s,i){return newWriteTreeRef(pathChild(s.treePath,i),s.writeTree)}function newWriteTreeRef(s,i){return{treePath:s,writeTree:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ChildChangeAccumulator{constructor(){this.changeMap=new Map}trackChildChange(i){const a=i.type,d=i.childName;assert(a==="child_added"||a==="child_changed"||a==="child_removed","Only child changes supported for tracking"),assert(d!==".priority","Only non-priority child changes can be tracked.");const g=this.changeMap.get(d);if(g){const b=g.type;if(a==="child_added"&&b==="child_removed")this.changeMap.set(d,changeChildChanged(d,i.snapshotNode,g.snapshotNode));else if(a==="child_removed"&&b==="child_added")this.changeMap.delete(d);else if(a==="child_removed"&&b==="child_changed")this.changeMap.set(d,changeChildRemoved(d,g.oldSnap));else if(a==="child_changed"&&b==="child_added")this.changeMap.set(d,changeChildAdded(d,i.snapshotNode));else if(a==="child_changed"&&b==="child_changed")this.changeMap.set(d,changeChildChanged(d,i.snapshotNode,g.oldSnap));else throw assertionError("Illegal combination of changes: "+i+" occurred after "+g)}else this.changeMap.set(d,i)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NoCompleteChildSource_{getCompleteChild(i){return null}getChildAfterChild(i,a,d){return null}}const NO_COMPLETE_CHILD_SOURCE=new NoCompleteChildSource_;class WriteTreeCompleteChildSource{constructor(i,a,d=null){this.writes_=i,this.viewCache_=a,this.optCompleteServerCache_=d}getCompleteChild(i){const a=this.viewCache_.eventCache;if(a.isCompleteForChild(i))return a.getNode().getImmediateChild(i);{const d=this.optCompleteServerCache_!=null?new CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return writeTreeRefCalcCompleteChild(this.writes_,i,d)}}getChildAfterChild(i,a,d){const g=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:viewCacheGetCompleteServerSnap(this.viewCache_),b=writeTreeRefCalcIndexedSlice(this.writes_,g,a,1,d,i);return b.length===0?null:b[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function newViewProcessor(s){return{filter:s}}function viewProcessorAssertIndexed(s,i){assert(i.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),assert(i.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed")}function viewProcessorApplyOperation(s,i,a,d,g){const b=new ChildChangeAccumulator;let $,tt;if(a.type===OperationType.OVERWRITE){const rt=a;rt.source.fromUser?$=viewProcessorApplyUserOverwrite(s,i,rt.path,rt.snap,d,g,b):(assert(rt.source.fromServer,"Unknown source."),tt=rt.source.tagged||i.serverCache.isFiltered()&&!pathIsEmpty(rt.path),$=viewProcessorApplyServerOverwrite(s,i,rt.path,rt.snap,d,g,tt,b))}else if(a.type===OperationType.MERGE){const rt=a;rt.source.fromUser?$=viewProcessorApplyUserMerge(s,i,rt.path,rt.children,d,g,b):(assert(rt.source.fromServer,"Unknown source."),tt=rt.source.tagged||i.serverCache.isFiltered(),$=viewProcessorApplyServerMerge(s,i,rt.path,rt.children,d,g,tt,b))}else if(a.type===OperationType.ACK_USER_WRITE){const rt=a;rt.revert?$=viewProcessorRevertUserWrite(s,i,rt.path,d,g,b):$=viewProcessorAckUserWrite(s,i,rt.path,rt.affectedTree,d,g,b)}else if(a.type===OperationType.LISTEN_COMPLETE)$=viewProcessorListenComplete(s,i,a.path,d,b);else throw assertionError("Unknown operation type: "+a.type);const it=b.getChanges();return viewProcessorMaybeAddValueEvent(i,$,it),{viewCache:$,changes:it}}function viewProcessorMaybeAddValueEvent(s,i,a){const d=i.eventCache;if(d.isFullyInitialized()){const g=d.getNode().isLeafNode()||d.getNode().isEmpty(),b=viewCacheGetCompleteEventSnap(s);(a.length>0||!s.eventCache.isFullyInitialized()||g&&!d.getNode().equals(b)||!d.getNode().getPriority().equals(b.getPriority()))&&a.push(changeValue(viewCacheGetCompleteEventSnap(i)))}}function viewProcessorGenerateEventCacheAfterServerEvent(s,i,a,d,g,b){const $=i.eventCache;if(writeTreeRefShadowingWrite(d,a)!=null)return i;{let tt,it;if(pathIsEmpty(a))if(assert(i.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),i.serverCache.isFiltered()){const rt=viewCacheGetCompleteServerSnap(i),ot=rt instanceof ChildrenNode?rt:ChildrenNode.EMPTY_NODE,lt=writeTreeRefCalcCompleteEventChildren(d,ot);tt=s.filter.updateFullNode(i.eventCache.getNode(),lt,b)}else{const rt=writeTreeRefCalcCompleteEventCache(d,viewCacheGetCompleteServerSnap(i));tt=s.filter.updateFullNode(i.eventCache.getNode(),rt,b)}else{const rt=pathGetFront(a);if(rt===".priority"){assert(pathGetLength(a)===1,"Can't have a priority with additional path components");const ot=$.getNode();it=i.serverCache.getNode();const lt=writeTreeRefCalcEventCacheAfterServerOverwrite(d,a,ot,it);lt!=null?tt=s.filter.updatePriority(ot,lt):tt=$.getNode()}else{const ot=pathPopFront(a);let lt;if($.isCompleteForChild(rt)){it=i.serverCache.getNode();const ut=writeTreeRefCalcEventCacheAfterServerOverwrite(d,a,$.getNode(),it);ut!=null?lt=$.getNode().getImmediateChild(rt).updateChild(ot,ut):lt=$.getNode().getImmediateChild(rt)}else lt=writeTreeRefCalcCompleteChild(d,rt,i.serverCache);lt!=null?tt=s.filter.updateChild($.getNode(),rt,lt,ot,g,b):tt=$.getNode()}}return viewCacheUpdateEventSnap(i,tt,$.isFullyInitialized()||pathIsEmpty(a),s.filter.filtersNodes())}}function viewProcessorApplyServerOverwrite(s,i,a,d,g,b,$,tt){const it=i.serverCache;let rt;const ot=$?s.filter:s.filter.getIndexedFilter();if(pathIsEmpty(a))rt=ot.updateFullNode(it.getNode(),d,null);else if(ot.filtersNodes()&&!it.isFiltered()){const pt=it.getNode().updateChild(a,d);rt=ot.updateFullNode(it.getNode(),pt,null)}else{const pt=pathGetFront(a);if(!it.isCompleteForPath(a)&&pathGetLength(a)>1)return i;const _t=pathPopFront(a),vt=it.getNode().getImmediateChild(pt).updateChild(_t,d);pt===".priority"?rt=ot.updatePriority(it.getNode(),vt):rt=ot.updateChild(it.getNode(),pt,vt,_t,NO_COMPLETE_CHILD_SOURCE,null)}const lt=viewCacheUpdateServerSnap(i,rt,it.isFullyInitialized()||pathIsEmpty(a),ot.filtersNodes()),ut=new WriteTreeCompleteChildSource(g,lt,b);return viewProcessorGenerateEventCacheAfterServerEvent(s,lt,a,g,ut,tt)}function viewProcessorApplyUserOverwrite(s,i,a,d,g,b,$){const tt=i.eventCache;let it,rt;const ot=new WriteTreeCompleteChildSource(g,i,b);if(pathIsEmpty(a))rt=s.filter.updateFullNode(i.eventCache.getNode(),d,$),it=viewCacheUpdateEventSnap(i,rt,!0,s.filter.filtersNodes());else{const lt=pathGetFront(a);if(lt===".priority")rt=s.filter.updatePriority(i.eventCache.getNode(),d),it=viewCacheUpdateEventSnap(i,rt,tt.isFullyInitialized(),tt.isFiltered());else{const ut=pathPopFront(a),pt=tt.getNode().getImmediateChild(lt);let _t;if(pathIsEmpty(ut))_t=d;else{const wt=ot.getCompleteChild(lt);wt!=null?pathGetBack(ut)===".priority"&&wt.getChild(pathParent(ut)).isEmpty()?_t=wt:_t=wt.updateChild(ut,d):_t=ChildrenNode.EMPTY_NODE}if(pt.equals(_t))it=i;else{const wt=s.filter.updateChild(tt.getNode(),lt,_t,ut,ot,$);it=viewCacheUpdateEventSnap(i,wt,tt.isFullyInitialized(),s.filter.filtersNodes())}}}return it}function viewProcessorCacheHasChild(s,i){return s.eventCache.isCompleteForChild(i)}function viewProcessorApplyUserMerge(s,i,a,d,g,b,$){let tt=i;return d.foreach((it,rt)=>{const ot=pathChild(a,it);viewProcessorCacheHasChild(i,pathGetFront(ot))&&(tt=viewProcessorApplyUserOverwrite(s,tt,ot,rt,g,b,$))}),d.foreach((it,rt)=>{const ot=pathChild(a,it);viewProcessorCacheHasChild(i,pathGetFront(ot))||(tt=viewProcessorApplyUserOverwrite(s,tt,ot,rt,g,b,$))}),tt}function viewProcessorApplyMerge(s,i,a){return a.foreach((d,g)=>{i=i.updateChild(d,g)}),i}function viewProcessorApplyServerMerge(s,i,a,d,g,b,$,tt){if(i.serverCache.getNode().isEmpty()&&!i.serverCache.isFullyInitialized())return i;let it=i,rt;pathIsEmpty(a)?rt=d:rt=new ImmutableTree(null).setTree(a,d);const ot=i.serverCache.getNode();return rt.children.inorderTraversal((lt,ut)=>{if(ot.hasChild(lt)){const pt=i.serverCache.getNode().getImmediateChild(lt),_t=viewProcessorApplyMerge(s,pt,ut);it=viewProcessorApplyServerOverwrite(s,it,new Path(lt),_t,g,b,$,tt)}}),rt.children.inorderTraversal((lt,ut)=>{const pt=!i.serverCache.isCompleteForChild(lt)&&ut.value===null;if(!ot.hasChild(lt)&&!pt){const _t=i.serverCache.getNode().getImmediateChild(lt),wt=viewProcessorApplyMerge(s,_t,ut);it=viewProcessorApplyServerOverwrite(s,it,new Path(lt),wt,g,b,$,tt)}}),it}function viewProcessorAckUserWrite(s,i,a,d,g,b,$){if(writeTreeRefShadowingWrite(g,a)!=null)return i;const tt=i.serverCache.isFiltered(),it=i.serverCache;if(d.value!=null){if(pathIsEmpty(a)&&it.isFullyInitialized()||it.isCompleteForPath(a))return viewProcessorApplyServerOverwrite(s,i,a,it.getNode().getChild(a),g,b,tt,$);if(pathIsEmpty(a)){let rt=new ImmutableTree(null);return it.getNode().forEachChild(KEY_INDEX,(ot,lt)=>{rt=rt.set(new Path(ot),lt)}),viewProcessorApplyServerMerge(s,i,a,rt,g,b,tt,$)}else return i}else{let rt=new ImmutableTree(null);return d.foreach((ot,lt)=>{const ut=pathChild(a,ot);it.isCompleteForPath(ut)&&(rt=rt.set(ot,it.getNode().getChild(ut)))}),viewProcessorApplyServerMerge(s,i,a,rt,g,b,tt,$)}}function viewProcessorListenComplete(s,i,a,d,g){const b=i.serverCache,$=viewCacheUpdateServerSnap(i,b.getNode(),b.isFullyInitialized()||pathIsEmpty(a),b.isFiltered());return viewProcessorGenerateEventCacheAfterServerEvent(s,$,a,d,NO_COMPLETE_CHILD_SOURCE,g)}function viewProcessorRevertUserWrite(s,i,a,d,g,b){let $;if(writeTreeRefShadowingWrite(d,a)!=null)return i;{const tt=new WriteTreeCompleteChildSource(d,i,g),it=i.eventCache.getNode();let rt;if(pathIsEmpty(a)||pathGetFront(a)===".priority"){let ot;if(i.serverCache.isFullyInitialized())ot=writeTreeRefCalcCompleteEventCache(d,viewCacheGetCompleteServerSnap(i));else{const lt=i.serverCache.getNode();assert(lt instanceof ChildrenNode,"serverChildren would be complete if leaf node"),ot=writeTreeRefCalcCompleteEventChildren(d,lt)}ot=ot,rt=s.filter.updateFullNode(it,ot,b)}else{const ot=pathGetFront(a);let lt=writeTreeRefCalcCompleteChild(d,ot,i.serverCache);lt==null&&i.serverCache.isCompleteForChild(ot)&&(lt=it.getImmediateChild(ot)),lt!=null?rt=s.filter.updateChild(it,ot,lt,pathPopFront(a),tt,b):i.eventCache.getNode().hasChild(ot)?rt=s.filter.updateChild(it,ot,ChildrenNode.EMPTY_NODE,pathPopFront(a),tt,b):rt=it,rt.isEmpty()&&i.serverCache.isFullyInitialized()&&($=writeTreeRefCalcCompleteEventCache(d,viewCacheGetCompleteServerSnap(i)),$.isLeafNode()&&(rt=s.filter.updateFullNode(rt,$,b)))}return $=i.serverCache.isFullyInitialized()||writeTreeRefShadowingWrite(d,newEmptyPath())!=null,viewCacheUpdateEventSnap(i,rt,$,s.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class View{constructor(i,a){this.query_=i,this.eventRegistrations_=[];const d=this.query_._queryParams,g=new IndexedFilter(d.getIndex()),b=queryParamsGetNodeFilter(d);this.processor_=newViewProcessor(b);const $=a.serverCache,tt=a.eventCache,it=g.updateFullNode(ChildrenNode.EMPTY_NODE,$.getNode(),null),rt=b.updateFullNode(ChildrenNode.EMPTY_NODE,tt.getNode(),null),ot=new CacheNode(it,$.isFullyInitialized(),g.filtersNodes()),lt=new CacheNode(rt,tt.isFullyInitialized(),b.filtersNodes());this.viewCache_=newViewCache(lt,ot),this.eventGenerator_=new EventGenerator(this.query_)}get query(){return this.query_}}function viewGetServerCache(s){return s.viewCache_.serverCache.getNode()}function viewGetCompleteServerCache(s,i){const a=viewCacheGetCompleteServerSnap(s.viewCache_);return a&&(s.query._queryParams.loadsAllData()||!pathIsEmpty(i)&&!a.getImmediateChild(pathGetFront(i)).isEmpty())?a.getChild(i):null}function viewIsEmpty(s){return s.eventRegistrations_.length===0}function viewAddEventRegistration(s,i){s.eventRegistrations_.push(i)}function viewRemoveEventRegistration(s,i,a){const d=[];if(a){assert(i==null,"A cancel should cancel all event registrations.");const g=s.query._path;s.eventRegistrations_.forEach(b=>{const $=b.createCancelEvent(a,g);$&&d.push($)})}if(i){let g=[];for(let b=0;b<s.eventRegistrations_.length;++b){const $=s.eventRegistrations_[b];if(!$.matches(i))g.push($);else if(i.hasAnyCallback()){g=g.concat(s.eventRegistrations_.slice(b+1));break}}s.eventRegistrations_=g}else s.eventRegistrations_=[];return d}function viewApplyOperation(s,i,a,d){i.type===OperationType.MERGE&&i.source.queryId!==null&&(assert(viewCacheGetCompleteServerSnap(s.viewCache_),"We should always have a full cache before handling merges"),assert(viewCacheGetCompleteEventSnap(s.viewCache_),"Missing event cache, even though we have a server cache"));const g=s.viewCache_,b=viewProcessorApplyOperation(s.processor_,g,i,a,d);return viewProcessorAssertIndexed(s.processor_,b.viewCache),assert(b.viewCache.serverCache.isFullyInitialized()||!g.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),s.viewCache_=b.viewCache,viewGenerateEventsForChanges_(s,b.changes,b.viewCache.eventCache.getNode(),null)}function viewGetInitialEvents(s,i){const a=s.viewCache_.eventCache,d=[];return a.getNode().isLeafNode()||a.getNode().forEachChild(PRIORITY_INDEX,(b,$)=>{d.push(changeChildAdded(b,$))}),a.isFullyInitialized()&&d.push(changeValue(a.getNode())),viewGenerateEventsForChanges_(s,d,a.getNode(),i)}function viewGenerateEventsForChanges_(s,i,a,d){const g=d?[d]:s.eventRegistrations_;return eventGeneratorGenerateEventsForChanges(s.eventGenerator_,i,a,g)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let referenceConstructor$1;class SyncPoint{constructor(){this.views=new Map}}function syncPointSetReferenceConstructor(s){assert(!referenceConstructor$1,"__referenceConstructor has already been defined"),referenceConstructor$1=s}function syncPointGetReferenceConstructor(){return assert(referenceConstructor$1,"Reference.ts has not been loaded"),referenceConstructor$1}function syncPointIsEmpty(s){return s.views.size===0}function syncPointApplyOperation(s,i,a,d){const g=i.source.queryId;if(g!==null){const b=s.views.get(g);return assert(b!=null,"SyncTree gave us an op for an invalid query."),viewApplyOperation(b,i,a,d)}else{let b=[];for(const $ of s.views.values())b=b.concat(viewApplyOperation($,i,a,d));return b}}function syncPointGetView(s,i,a,d,g){const b=i._queryIdentifier,$=s.views.get(b);if(!$){let tt=writeTreeRefCalcCompleteEventCache(a,g?d:null),it=!1;tt?it=!0:d instanceof ChildrenNode?(tt=writeTreeRefCalcCompleteEventChildren(a,d),it=!1):(tt=ChildrenNode.EMPTY_NODE,it=!1);const rt=newViewCache(new CacheNode(tt,it,!1),new CacheNode(d,g,!1));return new View(i,rt)}return $}function syncPointAddEventRegistration(s,i,a,d,g,b){const $=syncPointGetView(s,i,d,g,b);return s.views.has(i._queryIdentifier)||s.views.set(i._queryIdentifier,$),viewAddEventRegistration($,a),viewGetInitialEvents($,a)}function syncPointRemoveEventRegistration(s,i,a,d){const g=i._queryIdentifier,b=[];let $=[];const tt=syncPointHasCompleteView(s);if(g==="default")for(const[it,rt]of s.views.entries())$=$.concat(viewRemoveEventRegistration(rt,a,d)),viewIsEmpty(rt)&&(s.views.delete(it),rt.query._queryParams.loadsAllData()||b.push(rt.query));else{const it=s.views.get(g);it&&($=$.concat(viewRemoveEventRegistration(it,a,d)),viewIsEmpty(it)&&(s.views.delete(g),it.query._queryParams.loadsAllData()||b.push(it.query)))}return tt&&!syncPointHasCompleteView(s)&&b.push(new(syncPointGetReferenceConstructor())(i._repo,i._path)),{removed:b,events:$}}function syncPointGetQueryViews(s){const i=[];for(const a of s.views.values())a.query._queryParams.loadsAllData()||i.push(a);return i}function syncPointGetCompleteServerCache(s,i){let a=null;for(const d of s.views.values())a=a||viewGetCompleteServerCache(d,i);return a}function syncPointViewForQuery(s,i){if(i._queryParams.loadsAllData())return syncPointGetCompleteView(s);{const d=i._queryIdentifier;return s.views.get(d)}}function syncPointViewExistsForQuery(s,i){return syncPointViewForQuery(s,i)!=null}function syncPointHasCompleteView(s){return syncPointGetCompleteView(s)!=null}function syncPointGetCompleteView(s){for(const i of s.views.values())if(i.query._queryParams.loadsAllData())return i;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let referenceConstructor;function syncTreeSetReferenceConstructor(s){assert(!referenceConstructor,"__referenceConstructor has already been defined"),referenceConstructor=s}function syncTreeGetReferenceConstructor(){return assert(referenceConstructor,"Reference.ts has not been loaded"),referenceConstructor}let syncTreeNextQueryTag_=1;class SyncTree{constructor(i){this.listenProvider_=i,this.syncPointTree_=new ImmutableTree(null),this.pendingWriteTree_=newWriteTree(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function syncTreeApplyUserOverwrite(s,i,a,d,g){return writeTreeAddOverwrite(s.pendingWriteTree_,i,a,d,g),g?syncTreeApplyOperationToSyncPoints_(s,new Overwrite(newOperationSourceUser(),i,a)):[]}function syncTreeAckUserWrite(s,i,a=!1){const d=writeTreeGetWrite(s.pendingWriteTree_,i);if(writeTreeRemoveWrite(s.pendingWriteTree_,i)){let b=new ImmutableTree(null);return d.snap!=null?b=b.set(newEmptyPath(),!0):each(d.children,$=>{b=b.set(new Path($),!0)}),syncTreeApplyOperationToSyncPoints_(s,new AckUserWrite(d.path,b,a))}else return[]}function syncTreeApplyServerOverwrite(s,i,a){return syncTreeApplyOperationToSyncPoints_(s,new Overwrite(newOperationSourceServer(),i,a))}function syncTreeApplyServerMerge(s,i,a){const d=ImmutableTree.fromObject(a);return syncTreeApplyOperationToSyncPoints_(s,new Merge(newOperationSourceServer(),i,d))}function syncTreeApplyListenComplete(s,i){return syncTreeApplyOperationToSyncPoints_(s,new ListenComplete(newOperationSourceServer(),i))}function syncTreeApplyTaggedListenComplete(s,i,a){const d=syncTreeQueryKeyForTag_(s,a);if(d){const g=syncTreeParseQueryKey_(d),b=g.path,$=g.queryId,tt=newRelativePath(b,i),it=new ListenComplete(newOperationSourceServerTaggedQuery($),tt);return syncTreeApplyTaggedOperation_(s,b,it)}else return[]}function syncTreeRemoveEventRegistration(s,i,a,d,g=!1){const b=i._path,$=s.syncPointTree_.get(b);let tt=[];if($&&(i._queryIdentifier==="default"||syncPointViewExistsForQuery($,i))){const it=syncPointRemoveEventRegistration($,i,a,d);syncPointIsEmpty($)&&(s.syncPointTree_=s.syncPointTree_.remove(b));const rt=it.removed;if(tt=it.events,!g){const ot=rt.findIndex(ut=>ut._queryParams.loadsAllData())!==-1,lt=s.syncPointTree_.findOnPath(b,(ut,pt)=>syncPointHasCompleteView(pt));if(ot&&!lt){const ut=s.syncPointTree_.subtree(b);if(!ut.isEmpty()){const pt=syncTreeCollectDistinctViewsForSubTree_(ut);for(let _t=0;_t<pt.length;++_t){const wt=pt[_t],vt=wt.query,ht=syncTreeCreateListenerForView_(s,wt);s.listenProvider_.startListening(syncTreeQueryForListening_(vt),syncTreeTagForQuery(s,vt),ht.hashFn,ht.onComplete)}}}!lt&&rt.length>0&&!d&&(ot?s.listenProvider_.stopListening(syncTreeQueryForListening_(i),null):rt.forEach(ut=>{const pt=s.queryToTagMap.get(syncTreeMakeQueryKey_(ut));s.listenProvider_.stopListening(syncTreeQueryForListening_(ut),pt)}))}syncTreeRemoveTags_(s,rt)}return tt}function syncTreeApplyTaggedQueryOverwrite(s,i,a,d){const g=syncTreeQueryKeyForTag_(s,d);if(g!=null){const b=syncTreeParseQueryKey_(g),$=b.path,tt=b.queryId,it=newRelativePath($,i),rt=new Overwrite(newOperationSourceServerTaggedQuery(tt),it,a);return syncTreeApplyTaggedOperation_(s,$,rt)}else return[]}function syncTreeApplyTaggedQueryMerge(s,i,a,d){const g=syncTreeQueryKeyForTag_(s,d);if(g){const b=syncTreeParseQueryKey_(g),$=b.path,tt=b.queryId,it=newRelativePath($,i),rt=ImmutableTree.fromObject(a),ot=new Merge(newOperationSourceServerTaggedQuery(tt),it,rt);return syncTreeApplyTaggedOperation_(s,$,ot)}else return[]}function syncTreeAddEventRegistration(s,i,a,d=!1){const g=i._path;let b=null,$=!1;s.syncPointTree_.foreachOnPath(g,(ut,pt)=>{const _t=newRelativePath(ut,g);b=b||syncPointGetCompleteServerCache(pt,_t),$=$||syncPointHasCompleteView(pt)});let tt=s.syncPointTree_.get(g);tt?($=$||syncPointHasCompleteView(tt),b=b||syncPointGetCompleteServerCache(tt,newEmptyPath())):(tt=new SyncPoint,s.syncPointTree_=s.syncPointTree_.set(g,tt));let it;b!=null?it=!0:(it=!1,b=ChildrenNode.EMPTY_NODE,s.syncPointTree_.subtree(g).foreachChild((pt,_t)=>{const wt=syncPointGetCompleteServerCache(_t,newEmptyPath());wt&&(b=b.updateImmediateChild(pt,wt))}));const rt=syncPointViewExistsForQuery(tt,i);if(!rt&&!i._queryParams.loadsAllData()){const ut=syncTreeMakeQueryKey_(i);assert(!s.queryToTagMap.has(ut),"View does not exist, but we have a tag");const pt=syncTreeGetNextQueryTag_();s.queryToTagMap.set(ut,pt),s.tagToQueryMap.set(pt,ut)}const ot=writeTreeChildWrites(s.pendingWriteTree_,g);let lt=syncPointAddEventRegistration(tt,i,a,ot,b,it);if(!rt&&!$&&!d){const ut=syncPointViewForQuery(tt,i);lt=lt.concat(syncTreeSetupListener_(s,i,ut))}return lt}function syncTreeCalcCompleteEventCache(s,i,a){const g=s.pendingWriteTree_,b=s.syncPointTree_.findOnPath(i,($,tt)=>{const it=newRelativePath($,i),rt=syncPointGetCompleteServerCache(tt,it);if(rt)return rt});return writeTreeCalcCompleteEventCache(g,i,b,a,!0)}function syncTreeApplyOperationToSyncPoints_(s,i){return syncTreeApplyOperationHelper_(i,s.syncPointTree_,null,writeTreeChildWrites(s.pendingWriteTree_,newEmptyPath()))}function syncTreeApplyOperationHelper_(s,i,a,d){if(pathIsEmpty(s.path))return syncTreeApplyOperationDescendantsHelper_(s,i,a,d);{const g=i.get(newEmptyPath());a==null&&g!=null&&(a=syncPointGetCompleteServerCache(g,newEmptyPath()));let b=[];const $=pathGetFront(s.path),tt=s.operationForChild($),it=i.children.get($);if(it&&tt){const rt=a?a.getImmediateChild($):null,ot=writeTreeRefChild(d,$);b=b.concat(syncTreeApplyOperationHelper_(tt,it,rt,ot))}return g&&(b=b.concat(syncPointApplyOperation(g,s,d,a))),b}}function syncTreeApplyOperationDescendantsHelper_(s,i,a,d){const g=i.get(newEmptyPath());a==null&&g!=null&&(a=syncPointGetCompleteServerCache(g,newEmptyPath()));let b=[];return i.children.inorderTraversal(($,tt)=>{const it=a?a.getImmediateChild($):null,rt=writeTreeRefChild(d,$),ot=s.operationForChild($);ot&&(b=b.concat(syncTreeApplyOperationDescendantsHelper_(ot,tt,it,rt)))}),g&&(b=b.concat(syncPointApplyOperation(g,s,d,a))),b}function syncTreeCreateListenerForView_(s,i){const a=i.query,d=syncTreeTagForQuery(s,a);return{hashFn:()=>(viewGetServerCache(i)||ChildrenNode.EMPTY_NODE).hash(),onComplete:g=>{if(g==="ok")return d?syncTreeApplyTaggedListenComplete(s,a._path,d):syncTreeApplyListenComplete(s,a._path);{const b=errorForServerCode(g,a);return syncTreeRemoveEventRegistration(s,a,null,b)}}}}function syncTreeTagForQuery(s,i){const a=syncTreeMakeQueryKey_(i);return s.queryToTagMap.get(a)}function syncTreeMakeQueryKey_(s){return s._path.toString()+"$"+s._queryIdentifier}function syncTreeQueryKeyForTag_(s,i){return s.tagToQueryMap.get(i)}function syncTreeParseQueryKey_(s){const i=s.indexOf("$");return assert(i!==-1&&i<s.length-1,"Bad queryKey."),{queryId:s.substr(i+1),path:new Path(s.substr(0,i))}}function syncTreeApplyTaggedOperation_(s,i,a){const d=s.syncPointTree_.get(i);assert(d,"Missing sync point for query tag that we're tracking");const g=writeTreeChildWrites(s.pendingWriteTree_,i);return syncPointApplyOperation(d,a,g,null)}function syncTreeCollectDistinctViewsForSubTree_(s){return s.fold((i,a,d)=>{if(a&&syncPointHasCompleteView(a))return[syncPointGetCompleteView(a)];{let g=[];return a&&(g=syncPointGetQueryViews(a)),each(d,(b,$)=>{g=g.concat($)}),g}})}function syncTreeQueryForListening_(s){return s._queryParams.loadsAllData()&&!s._queryParams.isDefault()?new(syncTreeGetReferenceConstructor())(s._repo,s._path):s}function syncTreeRemoveTags_(s,i){for(let a=0;a<i.length;++a){const d=i[a];if(!d._queryParams.loadsAllData()){const g=syncTreeMakeQueryKey_(d),b=s.queryToTagMap.get(g);s.queryToTagMap.delete(g),s.tagToQueryMap.delete(b)}}}function syncTreeGetNextQueryTag_(){return syncTreeNextQueryTag_++}function syncTreeSetupListener_(s,i,a){const d=i._path,g=syncTreeTagForQuery(s,i),b=syncTreeCreateListenerForView_(s,a),$=s.listenProvider_.startListening(syncTreeQueryForListening_(i),g,b.hashFn,b.onComplete),tt=s.syncPointTree_.subtree(d);if(g)assert(!syncPointHasCompleteView(tt.value),"If we're adding a query, it shouldn't be shadowed");else{const it=tt.fold((rt,ot,lt)=>{if(!pathIsEmpty(rt)&&ot&&syncPointHasCompleteView(ot))return[syncPointGetCompleteView(ot).query];{let ut=[];return ot&&(ut=ut.concat(syncPointGetQueryViews(ot).map(pt=>pt.query))),each(lt,(pt,_t)=>{ut=ut.concat(_t)}),ut}});for(let rt=0;rt<it.length;++rt){const ot=it[rt];s.listenProvider_.stopListening(syncTreeQueryForListening_(ot),syncTreeTagForQuery(s,ot))}}return $}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ExistingValueProvider{constructor(i){this.node_=i}getImmediateChild(i){const a=this.node_.getImmediateChild(i);return new ExistingValueProvider(a)}node(){return this.node_}}class DeferredValueProvider{constructor(i,a){this.syncTree_=i,this.path_=a}getImmediateChild(i){const a=pathChild(this.path_,i);return new DeferredValueProvider(this.syncTree_,a)}node(){return syncTreeCalcCompleteEventCache(this.syncTree_,this.path_)}}const generateWithValues=function(s){return s=s||{},s.timestamp=s.timestamp||new Date().getTime(),s},resolveDeferredLeafValue=function(s,i,a){if(!s||typeof s!="object")return s;if(assert(".sv"in s,"Unexpected leaf node or priority contents"),typeof s[".sv"]=="string")return resolveScalarDeferredValue(s[".sv"],i,a);if(typeof s[".sv"]=="object")return resolveComplexDeferredValue(s[".sv"],i);assert(!1,"Unexpected server value: "+JSON.stringify(s,null,2))},resolveScalarDeferredValue=function(s,i,a){switch(s){case"timestamp":return a.timestamp;default:assert(!1,"Unexpected server value: "+s)}},resolveComplexDeferredValue=function(s,i,a){s.hasOwnProperty("increment")||assert(!1,"Unexpected server value: "+JSON.stringify(s,null,2));const d=s.increment;typeof d!="number"&&assert(!1,"Unexpected increment value: "+d);const g=i.node();if(assert(g!==null&&typeof g<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!g.isLeafNode())return d;const $=g.getValue();return typeof $!="number"?d:$+d},resolveDeferredValueTree=function(s,i,a,d){return resolveDeferredValue(i,new DeferredValueProvider(a,s),d)},resolveDeferredValueSnapshot=function(s,i,a){return resolveDeferredValue(s,new ExistingValueProvider(i),a)};function resolveDeferredValue(s,i,a){const d=s.getPriority().val(),g=resolveDeferredLeafValue(d,i.getImmediateChild(".priority"),a);let b;if(s.isLeafNode()){const $=s,tt=resolveDeferredLeafValue($.getValue(),i,a);return tt!==$.getValue()||g!==$.getPriority().val()?new LeafNode(tt,nodeFromJSON(g)):s}else{const $=s;return b=$,g!==$.getPriority().val()&&(b=b.updatePriority(new LeafNode(g))),$.forEachChild(PRIORITY_INDEX,(tt,it)=>{const rt=resolveDeferredValue(it,i.getImmediateChild(tt),a);rt!==it&&(b=b.updateImmediateChild(tt,rt))}),b}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tree{constructor(i="",a=null,d={children:{},childCount:0}){this.name=i,this.parent=a,this.node=d}}function treeSubTree(s,i){let a=i instanceof Path?i:new Path(i),d=s,g=pathGetFront(a);for(;g!==null;){const b=safeGet(d.node.children,g)||{children:{},childCount:0};d=new Tree(g,d,b),a=pathPopFront(a),g=pathGetFront(a)}return d}function treeGetValue(s){return s.node.value}function treeSetValue(s,i){s.node.value=i,treeUpdateParents(s)}function treeHasChildren(s){return s.node.childCount>0}function treeIsEmpty(s){return treeGetValue(s)===void 0&&!treeHasChildren(s)}function treeForEachChild(s,i){each(s.node.children,(a,d)=>{i(new Tree(a,s,d))})}function treeForEachDescendant(s,i,a,d){a&&!d&&i(s),treeForEachChild(s,g=>{treeForEachDescendant(g,i,!0,d)}),a&&d&&i(s)}function treeForEachAncestor(s,i,a){let d=s.parent;for(;d!==null;){if(i(d))return!0;d=d.parent}return!1}function treeGetPath(s){return new Path(s.parent===null?s.name:treeGetPath(s.parent)+"/"+s.name)}function treeUpdateParents(s){s.parent!==null&&treeUpdateChild(s.parent,s.name,s)}function treeUpdateChild(s,i,a){const d=treeIsEmpty(a),g=contains(s.node.children,i);d&&g?(delete s.node.children[i],s.node.childCount--,treeUpdateParents(s)):!d&&!g&&(s.node.children[i]=a.node,s.node.childCount++,treeUpdateParents(s))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,MAX_LEAF_SIZE_=10*1024*1024,isValidKey=function(s){return typeof s=="string"&&s.length!==0&&!INVALID_KEY_REGEX_.test(s)},isValidPathString=function(s){return typeof s=="string"&&s.length!==0&&!INVALID_PATH_REGEX_.test(s)},isValidRootPathString=function(s){return s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),isValidPathString(s)},validateFirebaseDataArg=function(s,i,a,d){validateFirebaseData(errorPrefix(s,"value"),i,a)},validateFirebaseData=function(s,i,a){const d=a instanceof Path?new ValidationPath(a,s):a;if(i===void 0)throw new Error(s+"contains undefined "+validationPathToErrorString(d));if(typeof i=="function")throw new Error(s+"contains a function "+validationPathToErrorString(d)+" with contents = "+i.toString());if(isInvalidJSONNumber(i))throw new Error(s+"contains "+i.toString()+" "+validationPathToErrorString(d));if(typeof i=="string"&&i.length>MAX_LEAF_SIZE_/3&&stringLength(i)>MAX_LEAF_SIZE_)throw new Error(s+"contains a string greater than "+MAX_LEAF_SIZE_+" utf8 bytes "+validationPathToErrorString(d)+" ('"+i.substring(0,50)+"...')");if(i&&typeof i=="object"){let g=!1,b=!1;if(each(i,($,tt)=>{if($===".value")g=!0;else if($!==".priority"&&$!==".sv"&&(b=!0,!isValidKey($)))throw new Error(s+" contains an invalid key ("+$+") "+validationPathToErrorString(d)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);validationPathPush(d,$),validateFirebaseData(s,tt,d),validationPathPop(d)}),g&&b)throw new Error(s+' contains ".value" child '+validationPathToErrorString(d)+" in addition to actual children.")}},validatePathString=function(s,i,a,d){if(!isValidPathString(a))throw new Error(errorPrefix(s,i)+'was an invalid path = "'+a+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},validateRootPathString=function(s,i,a,d){a&&(a=a.replace(/^\/*\.info(\/|$)/,"/")),validatePathString(s,i,a)},validateWritablePath=function(s,i){if(pathGetFront(i)===".info")throw new Error(s+" failed = Can't modify data under /.info/")},validateUrl=function(s,i){const a=i.path.toString();if(typeof i.repoInfo.host!="string"||i.repoInfo.host.length===0||!isValidKey(i.repoInfo.namespace)&&i.repoInfo.host.split(":")[0]!=="localhost"||a.length!==0&&!isValidRootPathString(a))throw new Error(errorPrefix(s,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EventQueue{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function eventQueueQueueEvents(s,i){let a=null;for(let d=0;d<i.length;d++){const g=i[d],b=g.getPath();a!==null&&!pathEquals(b,a.path)&&(s.eventLists_.push(a),a=null),a===null&&(a={events:[],path:b}),a.events.push(g)}a&&s.eventLists_.push(a)}function eventQueueRaiseEventsAtPath(s,i,a){eventQueueQueueEvents(s,a),eventQueueRaiseQueuedEventsMatchingPredicate(s,d=>pathEquals(d,i))}function eventQueueRaiseEventsForChangedPath(s,i,a){eventQueueQueueEvents(s,a),eventQueueRaiseQueuedEventsMatchingPredicate(s,d=>pathContains(d,i)||pathContains(i,d))}function eventQueueRaiseQueuedEventsMatchingPredicate(s,i){s.recursionDepth_++;let a=!0;for(let d=0;d<s.eventLists_.length;d++){const g=s.eventLists_[d];if(g){const b=g.path;i(b)?(eventListRaise(s.eventLists_[d]),s.eventLists_[d]=null):a=!1}}a&&(s.eventLists_=[]),s.recursionDepth_--}function eventListRaise(s){for(let i=0;i<s.events.length;i++){const a=s.events[i];if(a!==null){s.events[i]=null;const d=a.getEventRunner();logger$1&&log("event: "+a.toString()),exceptionGuard(d)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INTERRUPT_REASON="repo_interrupt",MAX_TRANSACTION_RETRIES=25;class Repo{constructor(i,a,d,g){this.repoInfo_=i,this.forceRestClient_=a,this.authTokenProvider_=d,this.appCheckProvider_=g,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=newSparseSnapshotTree(),this.transactionQueueTree_=new Tree,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function repoStart(s,i,a){if(s.stats_=statsManagerGetCollection(s.repoInfo_),s.forceRestClient_||beingCrawled())s.server_=new ReadonlyRestClient(s.repoInfo_,(d,g,b,$)=>{repoOnDataUpdate(s,d,g,b,$)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(()=>repoOnConnectStatus(s,!0),0);else{if(typeof a<"u"&&a!==null){if(typeof a!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{stringify(a)}catch(d){throw new Error("Invalid authOverride provided: "+d)}}s.persistentConnection_=new PersistentConnection(s.repoInfo_,i,(d,g,b,$)=>{repoOnDataUpdate(s,d,g,b,$)},d=>{repoOnConnectStatus(s,d)},d=>{repoOnServerInfoUpdate(s,d)},s.authTokenProvider_,s.appCheckProvider_,a),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(d=>{s.server_.refreshAuthToken(d)}),s.appCheckProvider_.addTokenChangeListener(d=>{s.server_.refreshAppCheckToken(d.token)}),s.statsReporter_=statsManagerGetOrCreateReporter(s.repoInfo_,()=>new StatsReporter(s.stats_,s.server_)),s.infoData_=new SnapshotHolder,s.infoSyncTree_=new SyncTree({startListening:(d,g,b,$)=>{let tt=[];const it=s.infoData_.getNode(d._path);return it.isEmpty()||(tt=syncTreeApplyServerOverwrite(s.infoSyncTree_,d._path,it),setTimeout(()=>{$("ok")},0)),tt},stopListening:()=>{}}),repoUpdateInfo(s,"connected",!1),s.serverSyncTree_=new SyncTree({startListening:(d,g,b,$)=>(s.server_.listen(d,b,g,(tt,it)=>{const rt=$(tt,it);eventQueueRaiseEventsForChangedPath(s.eventQueue_,d._path,rt)}),[]),stopListening:(d,g)=>{s.server_.unlisten(d,g)}})}function repoServerTime(s){const a=s.infoData_.getNode(new Path(".info/serverTimeOffset")).val()||0;return new Date().getTime()+a}function repoGenerateServerValues(s){return generateWithValues({timestamp:repoServerTime(s)})}function repoOnDataUpdate(s,i,a,d,g){s.dataUpdateCount++;const b=new Path(i);a=s.interceptServerDataCallback_?s.interceptServerDataCallback_(i,a):a;let $=[];if(g)if(d){const it=map(a,rt=>nodeFromJSON(rt));$=syncTreeApplyTaggedQueryMerge(s.serverSyncTree_,b,it,g)}else{const it=nodeFromJSON(a);$=syncTreeApplyTaggedQueryOverwrite(s.serverSyncTree_,b,it,g)}else if(d){const it=map(a,rt=>nodeFromJSON(rt));$=syncTreeApplyServerMerge(s.serverSyncTree_,b,it)}else{const it=nodeFromJSON(a);$=syncTreeApplyServerOverwrite(s.serverSyncTree_,b,it)}let tt=b;$.length>0&&(tt=repoRerunTransactions(s,b)),eventQueueRaiseEventsForChangedPath(s.eventQueue_,tt,$)}function repoOnConnectStatus(s,i){repoUpdateInfo(s,"connected",i),i===!1&&repoRunOnDisconnectEvents(s)}function repoOnServerInfoUpdate(s,i){each(i,(a,d)=>{repoUpdateInfo(s,a,d)})}function repoUpdateInfo(s,i,a){const d=new Path("/.info/"+i),g=nodeFromJSON(a);s.infoData_.updateSnapshot(d,g);const b=syncTreeApplyServerOverwrite(s.infoSyncTree_,d,g);eventQueueRaiseEventsForChangedPath(s.eventQueue_,d,b)}function repoGetNextWriteId(s){return s.nextWriteId_++}function repoSetWithPriority(s,i,a,d,g){repoLog(s,"set",{path:i.toString(),value:a,priority:d});const b=repoGenerateServerValues(s),$=nodeFromJSON(a,d),tt=syncTreeCalcCompleteEventCache(s.serverSyncTree_,i),it=resolveDeferredValueSnapshot($,tt,b),rt=repoGetNextWriteId(s),ot=syncTreeApplyUserOverwrite(s.serverSyncTree_,i,it,rt,!0);eventQueueQueueEvents(s.eventQueue_,ot),s.server_.put(i.toString(),$.val(!0),(ut,pt)=>{const _t=ut==="ok";_t||warn("set at "+i+" failed: "+ut);const wt=syncTreeAckUserWrite(s.serverSyncTree_,rt,!_t);eventQueueRaiseEventsForChangedPath(s.eventQueue_,i,wt),repoCallOnCompleteCallback(s,g,ut,pt)});const lt=repoAbortTransactions(s,i);repoRerunTransactions(s,lt),eventQueueRaiseEventsForChangedPath(s.eventQueue_,lt,[])}function repoRunOnDisconnectEvents(s){repoLog(s,"onDisconnectEvents");const i=repoGenerateServerValues(s),a=newSparseSnapshotTree();sparseSnapshotTreeForEachTree(s.onDisconnect_,newEmptyPath(),(g,b)=>{const $=resolveDeferredValueTree(g,b,s.serverSyncTree_,i);sparseSnapshotTreeRemember(a,g,$)});let d=[];sparseSnapshotTreeForEachTree(a,newEmptyPath(),(g,b)=>{d=d.concat(syncTreeApplyServerOverwrite(s.serverSyncTree_,g,b));const $=repoAbortTransactions(s,g);repoRerunTransactions(s,$)}),s.onDisconnect_=newSparseSnapshotTree(),eventQueueRaiseEventsForChangedPath(s.eventQueue_,newEmptyPath(),d)}function repoAddEventCallbackForQuery(s,i,a){let d;pathGetFront(i._path)===".info"?d=syncTreeAddEventRegistration(s.infoSyncTree_,i,a):d=syncTreeAddEventRegistration(s.serverSyncTree_,i,a),eventQueueRaiseEventsAtPath(s.eventQueue_,i._path,d)}function repoRemoveEventCallbackForQuery(s,i,a){let d;pathGetFront(i._path)===".info"?d=syncTreeRemoveEventRegistration(s.infoSyncTree_,i,a):d=syncTreeRemoveEventRegistration(s.serverSyncTree_,i,a),eventQueueRaiseEventsAtPath(s.eventQueue_,i._path,d)}function repoInterrupt(s){s.persistentConnection_&&s.persistentConnection_.interrupt(INTERRUPT_REASON)}function repoLog(s,...i){let a="";s.persistentConnection_&&(a=s.persistentConnection_.id+":"),log(a,...i)}function repoCallOnCompleteCallback(s,i,a,d){i&&exceptionGuard(()=>{if(a==="ok")i(null);else{const g=(a||"error").toUpperCase();let b=g;d&&(b+=": "+d);const $=new Error(b);$.code=g,i($)}})}function repoGetLatestState(s,i,a){return syncTreeCalcCompleteEventCache(s.serverSyncTree_,i,a)||ChildrenNode.EMPTY_NODE}function repoSendReadyTransactions(s,i=s.transactionQueueTree_){if(i||repoPruneCompletedTransactionsBelowNode(s,i),treeGetValue(i)){const a=repoBuildTransactionQueue(s,i);assert(a.length>0,"Sending zero length transaction queue"),a.every(g=>g.status===0)&&repoSendTransactionQueue(s,treeGetPath(i),a)}else treeHasChildren(i)&&treeForEachChild(i,a=>{repoSendReadyTransactions(s,a)})}function repoSendTransactionQueue(s,i,a){const d=a.map(rt=>rt.currentWriteId),g=repoGetLatestState(s,i,d);let b=g;const $=g.hash();for(let rt=0;rt<a.length;rt++){const ot=a[rt];assert(ot.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),ot.status=1,ot.retryCount++;const lt=newRelativePath(i,ot.path);b=b.updateChild(lt,ot.currentOutputSnapshotRaw)}const tt=b.val(!0),it=i;s.server_.put(it.toString(),tt,rt=>{repoLog(s,"transaction put response",{path:it.toString(),status:rt});let ot=[];if(rt==="ok"){const lt=[];for(let ut=0;ut<a.length;ut++)a[ut].status=2,ot=ot.concat(syncTreeAckUserWrite(s.serverSyncTree_,a[ut].currentWriteId)),a[ut].onComplete&&lt.push(()=>a[ut].onComplete(null,!0,a[ut].currentOutputSnapshotResolved)),a[ut].unwatcher();repoPruneCompletedTransactionsBelowNode(s,treeSubTree(s.transactionQueueTree_,i)),repoSendReadyTransactions(s,s.transactionQueueTree_),eventQueueRaiseEventsForChangedPath(s.eventQueue_,i,ot);for(let ut=0;ut<lt.length;ut++)exceptionGuard(lt[ut])}else{if(rt==="datastale")for(let lt=0;lt<a.length;lt++)a[lt].status===3?a[lt].status=4:a[lt].status=0;else{warn("transaction at "+it.toString()+" failed: "+rt);for(let lt=0;lt<a.length;lt++)a[lt].status=4,a[lt].abortReason=rt}repoRerunTransactions(s,i)}},$)}function repoRerunTransactions(s,i){const a=repoGetAncestorTransactionNode(s,i),d=treeGetPath(a),g=repoBuildTransactionQueue(s,a);return repoRerunTransactionQueue(s,g,d),d}function repoRerunTransactionQueue(s,i,a){if(i.length===0)return;const d=[];let g=[];const $=i.filter(tt=>tt.status===0).map(tt=>tt.currentWriteId);for(let tt=0;tt<i.length;tt++){const it=i[tt],rt=newRelativePath(a,it.path);let ot=!1,lt;if(assert(rt!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),it.status===4)ot=!0,lt=it.abortReason,g=g.concat(syncTreeAckUserWrite(s.serverSyncTree_,it.currentWriteId,!0));else if(it.status===0)if(it.retryCount>=MAX_TRANSACTION_RETRIES)ot=!0,lt="maxretry",g=g.concat(syncTreeAckUserWrite(s.serverSyncTree_,it.currentWriteId,!0));else{const ut=repoGetLatestState(s,it.path,$);it.currentInputSnapshot=ut;const pt=i[tt].update(ut.val());if(pt!==void 0){validateFirebaseData("transaction failed: Data returned ",pt,it.path);let _t=nodeFromJSON(pt);typeof pt=="object"&&pt!=null&&contains(pt,".priority")||(_t=_t.updatePriority(ut.getPriority()));const vt=it.currentWriteId,ht=repoGenerateServerValues(s),ft=resolveDeferredValueSnapshot(_t,ut,ht);it.currentOutputSnapshotRaw=_t,it.currentOutputSnapshotResolved=ft,it.currentWriteId=repoGetNextWriteId(s),$.splice($.indexOf(vt),1),g=g.concat(syncTreeApplyUserOverwrite(s.serverSyncTree_,it.path,ft,it.currentWriteId,it.applyLocally)),g=g.concat(syncTreeAckUserWrite(s.serverSyncTree_,vt,!0))}else ot=!0,lt="nodata",g=g.concat(syncTreeAckUserWrite(s.serverSyncTree_,it.currentWriteId,!0))}eventQueueRaiseEventsForChangedPath(s.eventQueue_,a,g),g=[],ot&&(i[tt].status=2,function(ut){setTimeout(ut,Math.floor(0))}(i[tt].unwatcher),i[tt].onComplete&&(lt==="nodata"?d.push(()=>i[tt].onComplete(null,!1,i[tt].currentInputSnapshot)):d.push(()=>i[tt].onComplete(new Error(lt),!1,null))))}repoPruneCompletedTransactionsBelowNode(s,s.transactionQueueTree_);for(let tt=0;tt<d.length;tt++)exceptionGuard(d[tt]);repoSendReadyTransactions(s,s.transactionQueueTree_)}function repoGetAncestorTransactionNode(s,i){let a,d=s.transactionQueueTree_;for(a=pathGetFront(i);a!==null&&treeGetValue(d)===void 0;)d=treeSubTree(d,a),i=pathPopFront(i),a=pathGetFront(i);return d}function repoBuildTransactionQueue(s,i){const a=[];return repoAggregateTransactionQueuesForNode(s,i,a),a.sort((d,g)=>d.order-g.order),a}function repoAggregateTransactionQueuesForNode(s,i,a){const d=treeGetValue(i);if(d)for(let g=0;g<d.length;g++)a.push(d[g]);treeForEachChild(i,g=>{repoAggregateTransactionQueuesForNode(s,g,a)})}function repoPruneCompletedTransactionsBelowNode(s,i){const a=treeGetValue(i);if(a){let d=0;for(let g=0;g<a.length;g++)a[g].status!==2&&(a[d]=a[g],d++);a.length=d,treeSetValue(i,a.length>0?a:void 0)}treeForEachChild(i,d=>{repoPruneCompletedTransactionsBelowNode(s,d)})}function repoAbortTransactions(s,i){const a=treeGetPath(repoGetAncestorTransactionNode(s,i)),d=treeSubTree(s.transactionQueueTree_,i);return treeForEachAncestor(d,g=>{repoAbortTransactionsOnNode(s,g)}),repoAbortTransactionsOnNode(s,d),treeForEachDescendant(d,g=>{repoAbortTransactionsOnNode(s,g)}),a}function repoAbortTransactionsOnNode(s,i){const a=treeGetValue(i);if(a){const d=[];let g=[],b=-1;for(let $=0;$<a.length;$++)a[$].status===3||(a[$].status===1?(assert(b===$-1,"All SENT items should be at beginning of queue."),b=$,a[$].status=3,a[$].abortReason="set"):(assert(a[$].status===0,"Unexpected transaction status in abort"),a[$].unwatcher(),g=g.concat(syncTreeAckUserWrite(s.serverSyncTree_,a[$].currentWriteId,!0)),a[$].onComplete&&d.push(a[$].onComplete.bind(null,new Error("set"),!1,null))));b===-1?treeSetValue(i,void 0):a.length=b+1,eventQueueRaiseEventsForChangedPath(s.eventQueue_,treeGetPath(i),g);for(let $=0;$<d.length;$++)exceptionGuard(d[$])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function decodePath(s){let i="";const a=s.split("/");for(let d=0;d<a.length;d++)if(a[d].length>0){let g=a[d];try{g=decodeURIComponent(g.replace(/\+/g," "))}catch{}i+="/"+g}return i}function decodeQuery(s){const i={};s.charAt(0)==="?"&&(s=s.substring(1));for(const a of s.split("&")){if(a.length===0)continue;const d=a.split("=");d.length===2?i[decodeURIComponent(d[0])]=decodeURIComponent(d[1]):warn(`Invalid query segment '${a}' in query '${s}'`)}return i}const parseRepoInfo=function(s,i){const a=parseDatabaseURL(s),d=a.namespace;a.domain==="firebase.com"&&fatal(a.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!d||d==="undefined")&&a.domain!=="localhost"&&fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),a.secure||warnIfPageIsSecure();const g=a.scheme==="ws"||a.scheme==="wss";return{repoInfo:new RepoInfo(a.host,a.secure,d,g,i,"",d!==a.subdomain),path:new Path(a.pathString)}},parseDatabaseURL=function(s){let i="",a="",d="",g="",b="",$=!0,tt="https",it=443;if(typeof s=="string"){let rt=s.indexOf("//");rt>=0&&(tt=s.substring(0,rt-1),s=s.substring(rt+2));let ot=s.indexOf("/");ot===-1&&(ot=s.length);let lt=s.indexOf("?");lt===-1&&(lt=s.length),i=s.substring(0,Math.min(ot,lt)),ot<lt&&(g=decodePath(s.substring(ot,lt)));const ut=decodeQuery(s.substring(Math.min(s.length,lt)));rt=i.indexOf(":"),rt>=0?($=tt==="https"||tt==="wss",it=parseInt(i.substring(rt+1),10)):rt=i.length;const pt=i.slice(0,rt);if(pt.toLowerCase()==="localhost")a="localhost";else if(pt.split(".").length<=2)a=pt;else{const _t=i.indexOf(".");d=i.substring(0,_t).toLowerCase(),a=i.substring(_t+1),b=d}"ns"in ut&&(b=ut.ns)}return{host:i,port:it,domain:a,subdomain:d,secure:$,scheme:tt,pathString:g,namespace:b}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DataEvent{constructor(i,a,d,g){this.eventType=i,this.eventRegistration=a,this.snapshot=d,this.prevName=g}getPath(){const i=this.snapshot.ref;return this.eventType==="value"?i._path:i.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+stringify(this.snapshot.exportVal())}}class CancelEvent{constructor(i,a,d){this.eventRegistration=i,this.error=a,this.path=d}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CallbackContext{constructor(i,a){this.snapshotCallback=i,this.cancelCallback=a}onValue(i,a){this.snapshotCallback.call(null,i,a)}onCancel(i){return assert(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,i)}get hasCancelCallback(){return!!this.cancelCallback}matches(i){return this.snapshotCallback===i.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===i.snapshotCallback.userCallback&&this.snapshotCallback.context===i.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryImpl{constructor(i,a,d,g){this._repo=i,this._path=a,this._queryParams=d,this._orderByCalled=g}get key(){return pathIsEmpty(this._path)?null:pathGetBack(this._path)}get ref(){return new ReferenceImpl(this._repo,this._path)}get _queryIdentifier(){const i=queryParamsGetQueryObject(this._queryParams),a=ObjectToUniqueKey(i);return a==="{}"?"default":a}get _queryObject(){return queryParamsGetQueryObject(this._queryParams)}isEqual(i){if(i=getModularInstance(i),!(i instanceof QueryImpl))return!1;const a=this._repo===i._repo,d=pathEquals(this._path,i._path),g=this._queryIdentifier===i._queryIdentifier;return a&&d&&g}toJSON(){return this.toString()}toString(){return this._repo.toString()+pathToUrlEncodedString(this._path)}}class ReferenceImpl extends QueryImpl{constructor(i,a){super(i,a,new QueryParams,!1)}get parent(){const i=pathParent(this._path);return i===null?null:new ReferenceImpl(this._repo,i)}get root(){let i=this;for(;i.parent!==null;)i=i.parent;return i}}class DataSnapshot{constructor(i,a,d){this._node=i,this.ref=a,this._index=d}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(i){const a=new Path(i),d=child(this.ref,i);return new DataSnapshot(this._node.getChild(a),d,PRIORITY_INDEX)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(i){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(d,g)=>i(new DataSnapshot(g,child(this.ref,d),PRIORITY_INDEX)))}hasChild(i){const a=new Path(i);return!this._node.getChild(a).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ref(s,i){return s=getModularInstance(s),s._checkNotDeleted("ref"),i!==void 0?child(s._root,i):s._root}function child(s,i){return s=getModularInstance(s),pathGetFront(s._path)===null?validateRootPathString("child","path",i):validatePathString("child","path",i),new ReferenceImpl(s._repo,pathChild(s._path,i))}function set$1(s,i){s=getModularInstance(s),validateWritablePath("set",s._path),validateFirebaseDataArg("set",i,s._path);const a=new Deferred$1;return repoSetWithPriority(s._repo,s._path,i,null,a.wrapCallback(()=>{})),a.promise}class ValueEventRegistration{constructor(i){this.callbackContext=i}respondsTo(i){return i==="value"}createEvent(i,a){const d=a._queryParams.getIndex();return new DataEvent("value",this,new DataSnapshot(i.snapshotNode,new ReferenceImpl(a._repo,a._path),d))}getEventRunner(i){return i.getEventType()==="cancel"?()=>this.callbackContext.onCancel(i.error):()=>this.callbackContext.onValue(i.snapshot,null)}createCancelEvent(i,a){return this.callbackContext.hasCancelCallback?new CancelEvent(this,i,a):null}matches(i){return i instanceof ValueEventRegistration?!i.callbackContext||!this.callbackContext?!0:i.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function addEventListener(s,i,a,d,g){let b;if(typeof d=="object"&&(b=void 0,g=d),typeof d=="function"&&(b=d),g&&g.onlyOnce){const it=a,rt=(ot,lt)=>{repoRemoveEventCallbackForQuery(s._repo,s,tt),it(ot,lt)};rt.userCallback=a.userCallback,rt.context=a.context,a=rt}const $=new CallbackContext(a,b||void 0),tt=new ValueEventRegistration($);return repoAddEventCallbackForQuery(s._repo,s,tt),()=>repoRemoveEventCallbackForQuery(s._repo,s,tt)}function onValue(s,i,a,d){return addEventListener(s,"value",i,a,d)}syncPointSetReferenceConstructor(ReferenceImpl);syncTreeSetReferenceConstructor(ReferenceImpl);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FIREBASE_DATABASE_EMULATOR_HOST_VAR="FIREBASE_DATABASE_EMULATOR_HOST",repos={};let useRestClient=!1;function repoManagerApplyEmulatorSettings(s,i,a,d){s.repoInfo_=new RepoInfo(`${i}:${a}`,!1,s.repoInfo_.namespace,s.repoInfo_.webSocketOnly,s.repoInfo_.nodeAdmin,s.repoInfo_.persistenceKey,s.repoInfo_.includeNamespaceInQueryParams,!0),d&&(s.authTokenProvider_=d)}function repoManagerDatabaseFromApp(s,i,a,d,g){let b=d||s.options.databaseURL;b===void 0&&(s.options.projectId||fatal("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),log("Using default host for project ",s.options.projectId),b=`${s.options.projectId}-default-rtdb.firebaseio.com`);let $=parseRepoInfo(b,g),tt=$.repoInfo,it;typeof process<"u"&&define_process_env_default&&(it=define_process_env_default[FIREBASE_DATABASE_EMULATOR_HOST_VAR]),it?(b=`http://${it}?ns=${tt.namespace}`,$=parseRepoInfo(b,g),tt=$.repoInfo):$.repoInfo.secure;const rt=new FirebaseAuthTokenProvider(s.name,s.options,i);validateUrl("Invalid Firebase Database URL",$),pathIsEmpty($.path)||fatal("Database URL must point to the root of a Firebase Database (not including a child path).");const ot=repoManagerCreateRepo(tt,s,rt,new AppCheckTokenProvider(s.name,a));return new Database(ot,s)}function repoManagerDeleteRepo(s,i){const a=repos[i];(!a||a[s.key]!==s)&&fatal(`Database ${i}(${s.repoInfo_}) has already been deleted.`),repoInterrupt(s),delete a[s.key]}function repoManagerCreateRepo(s,i,a,d){let g=repos[i.name];g||(g={},repos[i.name]=g);let b=g[s.toURLString()];return b&&fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),b=new Repo(s,useRestClient,a,d),g[s.toURLString()]=b,b}class Database{constructor(i,a){this._repoInternal=i,this.app=a,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(repoStart(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ReferenceImpl(this._repo,newEmptyPath())),this._rootInternal}_delete(){return this._rootInternal!==null&&(repoManagerDeleteRepo(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(i){this._rootInternal===null&&fatal("Cannot call "+i+" on a deleted database.")}}function getDatabase(s=getApp(),i){const a=_getProvider(s,"database").getImmediate({identifier:i});if(!a._instanceStarted){const d=getDefaultEmulatorHostnameAndPort("database");d&&connectDatabaseEmulator(a,...d)}return a}function connectDatabaseEmulator(s,i,a,d={}){s=getModularInstance(s),s._checkNotDeleted("useEmulator"),s._instanceStarted&&fatal("Cannot call useEmulator() after instance has already been initialized.");const g=s._repoInternal;let b;if(g.repoInfo_.nodeAdmin)d.mockUserToken&&fatal('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),b=new EmulatorTokenProvider(EmulatorTokenProvider.OWNER);else if(d.mockUserToken){const $=typeof d.mockUserToken=="string"?d.mockUserToken:createMockUserToken(d.mockUserToken,s.app.options.projectId);b=new EmulatorTokenProvider($)}repoManagerApplyEmulatorSettings(g,i,a,b)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerDatabase(s){setSDKVersion(SDK_VERSION$1),_registerComponent(new Component("database",(i,{instanceIdentifier:a})=>{const d=i.getProvider("app").getImmediate(),g=i.getProvider("auth-internal"),b=i.getProvider("app-check-internal");return repoManagerDatabaseFromApp(d,g,b,a)},"PUBLIC").setMultipleInstances(!0)),registerVersion(name$4,version$9,s),registerVersion(name$4,version$9,"esm2017")}PersistentConnection.prototype.simpleListen=function(s,i){this.sendRequest("q",{p:s},i)};PersistentConnection.prototype.echo=function(s,i){this.sendRequest("echo",{d:s},i)};registerDatabase();var name$3="firebase",version$8="10.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */registerVersion(name$3,version$8,"app");function __rest$2(s,i){var a={};for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&i.indexOf(d)<0&&(a[d]=s[d]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,d=Object.getOwnPropertySymbols(s);g<d.length;g++)i.indexOf(d[g])<0&&Object.prototype.propertyIsEnumerable.call(s,d[g])&&(a[d[g]]=s[d[g]]);return a}typeof SuppressedError=="function"&&SuppressedError;function _prodErrorMap(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const prodErrorMap=_prodErrorMap,_DEFAULT_AUTH_ERROR_FACTORY=new ErrorFactory("auth","Firebase",_prodErrorMap());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient=new Logger("@firebase/auth");function _logWarn(s,...i){logClient.logLevel<=LogLevel.WARN&&logClient.warn(`Auth (${SDK_VERSION$1}): ${s}`,...i)}function _logError(s,...i){logClient.logLevel<=LogLevel.ERROR&&logClient.error(`Auth (${SDK_VERSION$1}): ${s}`,...i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(s,...i){throw createErrorInternal(s,...i)}function _createError(s,...i){return createErrorInternal(s,...i)}function _errorWithCustomMessage(s,i,a){const d=Object.assign(Object.assign({},prodErrorMap()),{[i]:a});return new ErrorFactory("auth","Firebase",d).create(i,{appName:s.name})}function _serverAppCurrentUserOperationNotSupportedError(s){return _errorWithCustomMessage(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function createErrorInternal(s,...i){if(typeof s!="string"){const a=i[0],d=[...i.slice(1)];return d[0]&&(d[0].appName=s.name),s._errorFactory.create(a,...d)}return _DEFAULT_AUTH_ERROR_FACTORY.create(s,...i)}function _assert(s,i,...a){if(!s)throw createErrorInternal(i,...a)}function debugFail(s){const i="INTERNAL ASSERTION FAILED: "+s;throw _logError(i),new Error(i)}function debugAssert(s,i){s||debugFail(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){var s;return typeof self<"u"&&((s=self.location)===null||s===void 0?void 0:s.href)||""}function _isHttpOrHttps(){return _getCurrentScheme()==="http:"||_getCurrentScheme()==="https:"}function _getCurrentScheme(){var s;return typeof self<"u"&&((s=self.location)===null||s===void 0?void 0:s.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isOnline(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_isHttpOrHttps()||isBrowserExtension()||"connection"in navigator)?navigator.onLine:!0}function _getUserLanguage(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Delay{constructor(i,a){this.shortDelay=i,this.longDelay=a,debugAssert(a>i,"Short delay should be less than long delay!"),this.isMobile=isMobileCordova()||isReactNative()}get(){return _isOnline()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(s,i){debugAssert(s.emulator,"Emulator should always be set here");const{url:a}=s.emulator;return i?`${a}${i.startsWith("/")?i.slice(1):i}`:a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FetchProvider{static initialize(i,a,d){this.fetchImpl=i,a&&(this.headersImpl=a),d&&(this.responseImpl=d)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_ERROR_MAP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_API_TIMEOUT_MS=new Delay(3e4,6e4);function _addTidIfNecessary(s,i){return s.tenantId&&!i.tenantId?Object.assign(Object.assign({},i),{tenantId:s.tenantId}):i}async function _performApiRequest(s,i,a,d,g={}){return _performFetchWithErrorHandling(s,g,async()=>{let b={},$={};d&&(i==="GET"?$=d:b={body:JSON.stringify(d)});const tt=querystring(Object.assign({key:s.config.apiKey},$)).slice(1),it=await s._getAdditionalHeaders();return it["Content-Type"]="application/json",s.languageCode&&(it["X-Firebase-Locale"]=s.languageCode),FetchProvider.fetch()(_getFinalTarget(s,s.config.apiHost,a,tt),Object.assign({method:i,headers:it,referrerPolicy:"no-referrer"},b))})}async function _performFetchWithErrorHandling(s,i,a){s._canInitEmulator=!1;const d=Object.assign(Object.assign({},SERVER_ERROR_MAP),i);try{const g=new NetworkTimeout(s),b=await Promise.race([a(),g.promise]);g.clearNetworkTimeout();const $=await b.json();if("needConfirmation"in $)throw _makeTaggedError(s,"account-exists-with-different-credential",$);if(b.ok&&!("errorMessage"in $))return $;{const tt=b.ok?$.errorMessage:$.error.message,[it,rt]=tt.split(" : ");if(it==="FEDERATED_USER_ID_ALREADY_LINKED")throw _makeTaggedError(s,"credential-already-in-use",$);if(it==="EMAIL_EXISTS")throw _makeTaggedError(s,"email-already-in-use",$);if(it==="USER_DISABLED")throw _makeTaggedError(s,"user-disabled",$);const ot=d[it]||it.toLowerCase().replace(/[_\s]+/g,"-");if(rt)throw _errorWithCustomMessage(s,ot,rt);_fail(s,ot)}}catch(g){if(g instanceof FirebaseError)throw g;_fail(s,"network-request-failed",{message:String(g)})}}async function _performSignInRequest(s,i,a,d,g={}){const b=await _performApiRequest(s,i,a,d,g);return"mfaPendingCredential"in b&&_fail(s,"multi-factor-auth-required",{_serverResponse:b}),b}function _getFinalTarget(s,i,a,d){const g=`${i}${a}?${d}`;return s.config.emulator?_emulatorUrl(s.config,g):`${s.config.apiScheme}://${g}`}class NetworkTimeout{constructor(i){this.auth=i,this.timer=null,this.promise=new Promise((a,d)=>{this.timer=setTimeout(()=>d(_createError(this.auth,"network-request-failed")),DEFAULT_API_TIMEOUT_MS.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function _makeTaggedError(s,i,a){const d={appName:s.name};a.email&&(d.email=a.email),a.phoneNumber&&(d.phoneNumber=a.phoneNumber);const g=_createError(s,i,d);return g.customData._tokenResponse=a,g}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function deleteAccount(s,i){return _performApiRequest(s,"POST","/v1/accounts:delete",i)}async function getAccountInfo(s,i){return _performApiRequest(s,"POST","/v1/accounts:lookup",i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(s){if(s)try{const i=new Date(Number(s));if(!isNaN(i.getTime()))return i.toUTCString()}catch{}}async function getIdTokenResult(s,i=!1){const a=getModularInstance(s),d=await a.getIdToken(i),g=_parseToken(d);_assert(g&&g.exp&&g.auth_time&&g.iat,a.auth,"internal-error");const b=typeof g.firebase=="object"?g.firebase:void 0,$=b==null?void 0:b.sign_in_provider;return{claims:g,token:d,authTime:utcTimestampToDateString(secondsStringToMilliseconds(g.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(g.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(g.exp)),signInProvider:$||null,signInSecondFactor:(b==null?void 0:b.sign_in_second_factor)||null}}function secondsStringToMilliseconds(s){return Number(s)*1e3}function _parseToken(s){const[i,a,d]=s.split(".");if(i===void 0||a===void 0||d===void 0)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{const g=base64Decode(a);return g?JSON.parse(g):(_logError("Failed to decode base64 JWT payload"),null)}catch(g){return _logError("Caught error parsing JWT payload as JSON",g==null?void 0:g.toString()),null}}function _tokenExpiresIn(s){const i=_parseToken(s);return _assert(i,"internal-error"),_assert(typeof i.exp<"u","internal-error"),_assert(typeof i.iat<"u","internal-error"),Number(i.exp)-Number(i.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _logoutIfInvalidated(s,i,a=!1){if(a)return i;try{return await i}catch(d){throw d instanceof FirebaseError&&isUserInvalidated(d)&&s.auth.currentUser===s&&await s.auth.signOut(),d}}function isUserInvalidated({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ProactiveRefresh{constructor(i){this.user=i,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(i){var a;if(i){const d=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),d}else{this.errorBackoff=3e4;const g=((a=this.user.stsTokenManager.expirationTime)!==null&&a!==void 0?a:0)-Date.now()-3e5;return Math.max(0,g)}}schedule(i=!1){if(!this.isRunning)return;const a=this.getInterval(i);this.timerId=setTimeout(async()=>{await this.iteration()},a)}async iteration(){try{await this.user.getIdToken(!0)}catch(i){(i==null?void 0:i.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserMetadata{constructor(i,a){this.createdAt=i,this.lastLoginAt=a,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy(i){this.createdAt=i.createdAt,this.lastLoginAt=i.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reloadWithoutSaving(s){var i;const a=s.auth,d=await s.getIdToken(),g=await _logoutIfInvalidated(s,getAccountInfo(a,{idToken:d}));_assert(g==null?void 0:g.users.length,a,"internal-error");const b=g.users[0];s._notifyReloadListener(b);const $=!((i=b.providerUserInfo)===null||i===void 0)&&i.length?extractProviderData(b.providerUserInfo):[],tt=mergeProviderData(s.providerData,$),it=s.isAnonymous,rt=!(s.email&&b.passwordHash)&&!(tt!=null&&tt.length),ot=it?rt:!1,lt={uid:b.localId,displayName:b.displayName||null,photoURL:b.photoUrl||null,email:b.email||null,emailVerified:b.emailVerified||!1,phoneNumber:b.phoneNumber||null,tenantId:b.tenantId||null,providerData:tt,metadata:new UserMetadata(b.createdAt,b.lastLoginAt),isAnonymous:ot};Object.assign(s,lt)}async function reload(s){const i=getModularInstance(s);await _reloadWithoutSaving(i),await i.auth._persistUserIfCurrent(i),i.auth._notifyListenersIfCurrent(i)}function mergeProviderData(s,i){return[...s.filter(d=>!i.some(g=>g.providerId===d.providerId)),...i]}function extractProviderData(s){return s.map(i=>{var{providerId:a}=i,d=__rest$2(i,["providerId"]);return{providerId:a,uid:d.rawId||"",displayName:d.displayName||null,email:d.email||null,phoneNumber:d.phoneNumber||null,photoURL:d.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function requestStsToken(s,i){const a=await _performFetchWithErrorHandling(s,{},async()=>{const d=querystring({grant_type:"refresh_token",refresh_token:i}).slice(1),{tokenApiHost:g,apiKey:b}=s.config,$=_getFinalTarget(s,g,"/v1/token",`key=${b}`),tt=await s._getAdditionalHeaders();return tt["Content-Type"]="application/x-www-form-urlencoded",FetchProvider.fetch()($,{method:"POST",headers:tt,body:d})});return{accessToken:a.access_token,expiresIn:a.expires_in,refreshToken:a.refresh_token}}async function revokeToken(s,i){return _performApiRequest(s,"POST","/v2/accounts:revokeToken",_addTidIfNecessary(s,i))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(i){_assert(i.idToken,"internal-error"),_assert(typeof i.idToken<"u","internal-error"),_assert(typeof i.refreshToken<"u","internal-error");const a="expiresIn"in i&&typeof i.expiresIn<"u"?Number(i.expiresIn):_tokenExpiresIn(i.idToken);this.updateTokensAndExpiration(i.idToken,i.refreshToken,a)}updateFromIdToken(i){_assert(i.length!==0,"internal-error");const a=_tokenExpiresIn(i);this.updateTokensAndExpiration(i,null,a)}async getToken(i,a=!1){return!a&&this.accessToken&&!this.isExpired?this.accessToken:(_assert(this.refreshToken,i,"user-token-expired"),this.refreshToken?(await this.refresh(i,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(i,a){const{accessToken:d,refreshToken:g,expiresIn:b}=await requestStsToken(i,a);this.updateTokensAndExpiration(d,g,Number(b))}updateTokensAndExpiration(i,a,d){this.refreshToken=a||null,this.accessToken=i||null,this.expirationTime=Date.now()+d*1e3}static fromJSON(i,a){const{refreshToken:d,accessToken:g,expirationTime:b}=a,$=new StsTokenManager;return d&&(_assert(typeof d=="string","internal-error",{appName:i}),$.refreshToken=d),g&&(_assert(typeof g=="string","internal-error",{appName:i}),$.accessToken=g),b&&(_assert(typeof b=="number","internal-error",{appName:i}),$.expirationTime=b),$}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(i){this.accessToken=i.accessToken,this.refreshToken=i.refreshToken,this.expirationTime=i.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(s,i){_assert(typeof s=="string"||typeof s>"u","internal-error",{appName:i})}class UserImpl{constructor(i){var{uid:a,auth:d,stsTokenManager:g}=i,b=__rest$2(i,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=a,this.auth=d,this.stsTokenManager=g,this.accessToken=g.accessToken,this.displayName=b.displayName||null,this.email=b.email||null,this.emailVerified=b.emailVerified||!1,this.phoneNumber=b.phoneNumber||null,this.photoURL=b.photoURL||null,this.isAnonymous=b.isAnonymous||!1,this.tenantId=b.tenantId||null,this.providerData=b.providerData?[...b.providerData]:[],this.metadata=new UserMetadata(b.createdAt||void 0,b.lastLoginAt||void 0)}async getIdToken(i){const a=await _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,i));return _assert(a,this.auth,"internal-error"),this.accessToken!==a&&(this.accessToken=a,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),a}getIdTokenResult(i){return getIdTokenResult(this,i)}reload(){return reload(this)}_assign(i){this!==i&&(_assert(this.uid===i.uid,this.auth,"internal-error"),this.displayName=i.displayName,this.photoURL=i.photoURL,this.email=i.email,this.emailVerified=i.emailVerified,this.phoneNumber=i.phoneNumber,this.isAnonymous=i.isAnonymous,this.tenantId=i.tenantId,this.providerData=i.providerData.map(a=>Object.assign({},a)),this.metadata._copy(i.metadata),this.stsTokenManager._assign(i.stsTokenManager))}_clone(i){const a=new UserImpl(Object.assign(Object.assign({},this),{auth:i,stsTokenManager:this.stsTokenManager._clone()}));return a.metadata._copy(this.metadata),a}_onReload(i){_assert(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=i,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(i){this.reloadListener?this.reloadListener(i):this.reloadUserInfo=i}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(i,a=!1){let d=!1;i.idToken&&i.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(i),d=!0),a&&await _reloadWithoutSaving(this),await this.auth._persistUserIfCurrent(this),d&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_isFirebaseServerApp(this.auth.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this.auth));const i=await this.getIdToken();return await _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:i})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(i=>Object.assign({},i)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(i,a){var d,g,b,$,tt,it,rt,ot;const lt=(d=a.displayName)!==null&&d!==void 0?d:void 0,ut=(g=a.email)!==null&&g!==void 0?g:void 0,pt=(b=a.phoneNumber)!==null&&b!==void 0?b:void 0,_t=($=a.photoURL)!==null&&$!==void 0?$:void 0,wt=(tt=a.tenantId)!==null&&tt!==void 0?tt:void 0,vt=(it=a._redirectEventId)!==null&&it!==void 0?it:void 0,ht=(rt=a.createdAt)!==null&&rt!==void 0?rt:void 0,ft=(ot=a.lastLoginAt)!==null&&ot!==void 0?ot:void 0,{uid:mt,emailVerified:bt,isAnonymous:Et,providerData:It,stsTokenManager:Ot}=a;_assert(mt&&Ot,i,"internal-error");const jt=StsTokenManager.fromJSON(this.name,Ot);_assert(typeof mt=="string",i,"internal-error"),assertStringOrUndefined(lt,i.name),assertStringOrUndefined(ut,i.name),_assert(typeof bt=="boolean",i,"internal-error"),_assert(typeof Et=="boolean",i,"internal-error"),assertStringOrUndefined(pt,i.name),assertStringOrUndefined(_t,i.name),assertStringOrUndefined(wt,i.name),assertStringOrUndefined(vt,i.name),assertStringOrUndefined(ht,i.name),assertStringOrUndefined(ft,i.name);const xt=new UserImpl({uid:mt,auth:i,email:ut,emailVerified:bt,displayName:lt,isAnonymous:Et,photoURL:_t,phoneNumber:pt,tenantId:wt,stsTokenManager:jt,createdAt:ht,lastLoginAt:ft});return It&&Array.isArray(It)&&(xt.providerData=It.map(Lt=>Object.assign({},Lt))),vt&&(xt._redirectEventId=vt),xt}static async _fromIdTokenResponse(i,a,d=!1){const g=new StsTokenManager;g.updateFromServerResponse(a);const b=new UserImpl({uid:a.localId,auth:i,stsTokenManager:g,isAnonymous:d});return await _reloadWithoutSaving(b),b}static async _fromGetAccountInfoResponse(i,a,d){const g=a.users[0];_assert(g.localId!==void 0,"internal-error");const b=g.providerUserInfo!==void 0?extractProviderData(g.providerUserInfo):[],$=!(g.email&&g.passwordHash)&&!(b!=null&&b.length),tt=new StsTokenManager;tt.updateFromIdToken(d);const it=new UserImpl({uid:g.localId,auth:i,stsTokenManager:tt,isAnonymous:$}),rt={uid:g.localId,displayName:g.displayName||null,photoURL:g.photoUrl||null,email:g.email||null,emailVerified:g.emailVerified||!1,phoneNumber:g.phoneNumber||null,tenantId:g.tenantId||null,providerData:b,metadata:new UserMetadata(g.createdAt,g.lastLoginAt),isAnonymous:!(g.email&&g.passwordHash)&&!(b!=null&&b.length)};return Object.assign(it,rt),it}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instanceCache=new Map;function _getInstance(s){debugAssert(s instanceof Function,"Expected a class definition");let i=instanceCache.get(s);return i?(debugAssert(i instanceof s,"Instance stored in cache mismatched with class"),i):(i=new s,instanceCache.set(s,i),i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(i,a){this.storage[i]=a}async _get(i){const a=this.storage[i];return a===void 0?null:a}async _remove(i){delete this.storage[i]}_addListener(i,a){}_removeListener(i,a){}}InMemoryPersistence.type="NONE";const inMemoryPersistence=InMemoryPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(s,i,a){return`firebase:${s}:${i}:${a}`}class PersistenceUserManager{constructor(i,a,d){this.persistence=i,this.auth=a,this.userKey=d;const{config:g,name:b}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,g.apiKey,b),this.fullPersistenceKey=_persistenceKeyName("persistence",g.apiKey,b),this.boundEventHandler=a._onStorageEvent.bind(a),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(i){return this.persistence._set(this.fullUserKey,i.toJSON())}async getCurrentUser(){const i=await this.persistence._get(this.fullUserKey);return i?UserImpl._fromJSON(this.auth,i):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(i){if(this.persistence===i)return;const a=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=i,a)return this.setCurrentUser(a)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(i,a,d="authUser"){if(!a.length)return new PersistenceUserManager(_getInstance(inMemoryPersistence),i,d);const g=(await Promise.all(a.map(async rt=>{if(await rt._isAvailable())return rt}))).filter(rt=>rt);let b=g[0]||_getInstance(inMemoryPersistence);const $=_persistenceKeyName(d,i.config.apiKey,i.name);let tt=null;for(const rt of a)try{const ot=await rt._get($);if(ot){const lt=UserImpl._fromJSON(i,ot);rt!==b&&(tt=lt),b=rt;break}}catch{}const it=g.filter(rt=>rt._shouldAllowMigration);return!b._shouldAllowMigration||!it.length?new PersistenceUserManager(b,i,d):(b=it[0],tt&&await b._set($,tt.toJSON()),await Promise.all(a.map(async rt=>{if(rt!==b)try{await rt._remove($)}catch{}})),new PersistenceUserManager(b,i,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(s){const i=s.toLowerCase();if(i.includes("opera/")||i.includes("opr/")||i.includes("opios/"))return"Opera";if(_isIEMobile(i))return"IEMobile";if(i.includes("msie")||i.includes("trident/"))return"IE";if(i.includes("edge/"))return"Edge";if(_isFirefox(i))return"Firefox";if(i.includes("silk/"))return"Silk";if(_isBlackBerry(i))return"Blackberry";if(_isWebOS(i))return"Webos";if(_isSafari(i))return"Safari";if((i.includes("chrome/")||_isChromeIOS(i))&&!i.includes("edge/"))return"Chrome";if(_isAndroid(i))return"Android";{const a=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,d=s.match(a);if((d==null?void 0:d.length)===2)return d[1]}return"Other"}function _isFirefox(s=getUA()){return/firefox\//i.test(s)}function _isSafari(s=getUA()){const i=s.toLowerCase();return i.includes("safari/")&&!i.includes("chrome/")&&!i.includes("crios/")&&!i.includes("android")}function _isChromeIOS(s=getUA()){return/crios\//i.test(s)}function _isIEMobile(s=getUA()){return/iemobile/i.test(s)}function _isAndroid(s=getUA()){return/android/i.test(s)}function _isBlackBerry(s=getUA()){return/blackberry/i.test(s)}function _isWebOS(s=getUA()){return/webos/i.test(s)}function _isIOS(s=getUA()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function _isIOSStandalone(s=getUA()){var i;return _isIOS(s)&&!!(!((i=window.navigator)===null||i===void 0)&&i.standalone)}function _isIE10(){return isIE()&&document.documentMode===10}function _isMobileBrowser(s=getUA()){return _isIOS(s)||_isAndroid(s)||_isWebOS(s)||_isBlackBerry(s)||/windows phone/i.test(s)||_isIEMobile(s)}function _isIframe(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(s,i=[]){let a;switch(s){case"Browser":a=_getBrowserName(getUA());break;case"Worker":a=`${_getBrowserName(getUA())}-${s}`;break;default:a=s}const d=i.length?i.join(","):"FirebaseCore-web";return`${a}/JsCore/${SDK_VERSION$1}/${d}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthMiddlewareQueue{constructor(i){this.auth=i,this.queue=[]}pushCallback(i,a){const d=b=>new Promise(($,tt)=>{try{const it=i(b);$(it)}catch(it){tt(it)}});d.onAbort=a,this.queue.push(d);const g=this.queue.length-1;return()=>{this.queue[g]=()=>Promise.resolve()}}async runMiddleware(i){if(this.auth.currentUser===i)return;const a=[];try{for(const d of this.queue)await d(i),d.onAbort&&a.push(d.onAbort)}catch(d){a.reverse();for(const g of a)try{g()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:d==null?void 0:d.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getPasswordPolicy(s,i={}){return _performApiRequest(s,"GET","/v2/passwordPolicy",_addTidIfNecessary(s,i))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MINIMUM_MIN_PASSWORD_LENGTH=6;class PasswordPolicyImpl{constructor(i){var a,d,g,b;const $=i.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(a=$.minPasswordLength)!==null&&a!==void 0?a:MINIMUM_MIN_PASSWORD_LENGTH,$.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=$.maxPasswordLength),$.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=$.containsLowercaseCharacter),$.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=$.containsUppercaseCharacter),$.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=$.containsNumericCharacter),$.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=$.containsNonAlphanumericCharacter),this.enforcementState=i.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(g=(d=i.allowedNonAlphanumericCharacters)===null||d===void 0?void 0:d.join(""))!==null&&g!==void 0?g:"",this.forceUpgradeOnSignin=(b=i.forceUpgradeOnSignin)!==null&&b!==void 0?b:!1,this.schemaVersion=i.schemaVersion}validatePassword(i){var a,d,g,b,$,tt;const it={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(i,it),this.validatePasswordCharacterOptions(i,it),it.isValid&&(it.isValid=(a=it.meetsMinPasswordLength)!==null&&a!==void 0?a:!0),it.isValid&&(it.isValid=(d=it.meetsMaxPasswordLength)!==null&&d!==void 0?d:!0),it.isValid&&(it.isValid=(g=it.containsLowercaseLetter)!==null&&g!==void 0?g:!0),it.isValid&&(it.isValid=(b=it.containsUppercaseLetter)!==null&&b!==void 0?b:!0),it.isValid&&(it.isValid=($=it.containsNumericCharacter)!==null&&$!==void 0?$:!0),it.isValid&&(it.isValid=(tt=it.containsNonAlphanumericCharacter)!==null&&tt!==void 0?tt:!0),it}validatePasswordLengthOptions(i,a){const d=this.customStrengthOptions.minPasswordLength,g=this.customStrengthOptions.maxPasswordLength;d&&(a.meetsMinPasswordLength=i.length>=d),g&&(a.meetsMaxPasswordLength=i.length<=g)}validatePasswordCharacterOptions(i,a){this.updatePasswordCharacterOptionsStatuses(a,!1,!1,!1,!1);let d;for(let g=0;g<i.length;g++)d=i.charAt(g),this.updatePasswordCharacterOptionsStatuses(a,d>="a"&&d<="z",d>="A"&&d<="Z",d>="0"&&d<="9",this.allowedNonAlphanumericCharacters.includes(d))}updatePasswordCharacterOptionsStatuses(i,a,d,g,b){this.customStrengthOptions.containsLowercaseLetter&&(i.containsLowercaseLetter||(i.containsLowercaseLetter=a)),this.customStrengthOptions.containsUppercaseLetter&&(i.containsUppercaseLetter||(i.containsUppercaseLetter=d)),this.customStrengthOptions.containsNumericCharacter&&(i.containsNumericCharacter||(i.containsNumericCharacter=g)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(i.containsNonAlphanumericCharacter||(i.containsNonAlphanumericCharacter=b))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthImpl{constructor(i,a,d,g){this.app=i,this.heartbeatServiceProvider=a,this.appCheckServiceProvider=d,this.config=g,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription(this),this.idTokenSubscription=new Subscription(this),this.beforeStateQueue=new AuthMiddlewareQueue(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_DEFAULT_AUTH_ERROR_FACTORY,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=i.name,this.clientVersion=g.sdkClientVersion}_initializeWithPersistence(i,a){return a&&(this._popupRedirectResolver=_getInstance(a)),this._initializationPromise=this.queue(async()=>{var d,g;if(!this._deleted&&(this.persistenceManager=await PersistenceUserManager.create(this,i),!this._deleted)){if(!((d=this._popupRedirectResolver)===null||d===void 0)&&d._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(a),this.lastNotifiedUid=((g=this.currentUser)===null||g===void 0?void 0:g.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const i=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!i)){if(this.currentUser&&i&&this.currentUser.uid===i.uid){this._currentUser._assign(i),await this.currentUser.getIdToken();return}await this._updateCurrentUser(i,!0)}}async initializeCurrentUserFromIdToken(i){try{const a=await getAccountInfo(this,{idToken:i}),d=await UserImpl._fromGetAccountInfoResponse(this,a,i);await this.directlySetCurrentUser(d)}catch(a){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",a),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(i){var a;if(_isFirebaseServerApp(this.app)){const $=this.app.settings.authIdToken;return $?new Promise(tt=>{setTimeout(()=>this.initializeCurrentUserFromIdToken($).then(tt,tt))}):this.directlySetCurrentUser(null)}const d=await this.assertedPersistence.getCurrentUser();let g=d,b=!1;if(i&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const $=(a=this.redirectUser)===null||a===void 0?void 0:a._redirectEventId,tt=g==null?void 0:g._redirectEventId,it=await this.tryRedirectSignIn(i);(!$||$===tt)&&(it!=null&&it.user)&&(g=it.user,b=!0)}if(!g)return this.directlySetCurrentUser(null);if(!g._redirectEventId){if(b)try{await this.beforeStateQueue.runMiddleware(g)}catch($){g=d,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject($))}return g?this.reloadAndSetCurrentUserOrClear(g):this.directlySetCurrentUser(null)}return _assert(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===g._redirectEventId?this.directlySetCurrentUser(g):this.reloadAndSetCurrentUserOrClear(g)}async tryRedirectSignIn(i){let a=null;try{a=await this._popupRedirectResolver._completeRedirectFn(this,i,!0)}catch{await this._setRedirectUser(null)}return a}async reloadAndSetCurrentUserOrClear(i){try{await _reloadWithoutSaving(i)}catch(a){if((a==null?void 0:a.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(i)}useDeviceLanguage(){this.languageCode=_getUserLanguage()}async _delete(){this._deleted=!0}async updateCurrentUser(i){if(_isFirebaseServerApp(this.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this));const a=i?getModularInstance(i):null;return a&&_assert(a.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(a&&a._clone(this))}async _updateCurrentUser(i,a=!1){if(!this._deleted)return i&&_assert(this.tenantId===i.tenantId,this,"tenant-id-mismatch"),a||await this.beforeStateQueue.runMiddleware(i),this.queue(async()=>{await this.directlySetCurrentUser(i),this.notifyAuthListeners()})}async signOut(){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(i){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_getInstance(i))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(i){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const a=this._getPasswordPolicyInternal();return a.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):a.validatePassword(i)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const i=await _getPasswordPolicy(this),a=new PasswordPolicyImpl(i);this.tenantId===null?this._projectPasswordPolicy=a:this._tenantPasswordPolicies[this.tenantId]=a}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(i){this._errorFactory=new ErrorFactory("auth","Firebase",i())}onAuthStateChanged(i,a,d){return this.registerStateListener(this.authStateSubscription,i,a,d)}beforeAuthStateChanged(i,a){return this.beforeStateQueue.pushCallback(i,a)}onIdTokenChanged(i,a,d){return this.registerStateListener(this.idTokenSubscription,i,a,d)}authStateReady(){return new Promise((i,a)=>{if(this.currentUser)i();else{const d=this.onAuthStateChanged(()=>{d(),i()},a)}})}async revokeAccessToken(i){if(this.currentUser){const a=await this.currentUser.getIdToken(),d={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:i,idToken:a};this.tenantId!=null&&(d.tenantId=this.tenantId),await revokeToken(this,d)}}toJSON(){var i;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(i=this._currentUser)===null||i===void 0?void 0:i.toJSON()}}async _setRedirectUser(i,a){const d=await this.getOrInitRedirectPersistenceManager(a);return i===null?d.removeCurrentUser():d.setCurrentUser(i)}async getOrInitRedirectPersistenceManager(i){if(!this.redirectPersistenceManager){const a=i&&_getInstance(i)||this._popupRedirectResolver;_assert(a,this,"argument-error"),this.redirectPersistenceManager=await PersistenceUserManager.create(this,[_getInstance(a._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(i){var a,d;return this._isInitialized&&await this.queue(async()=>{}),((a=this._currentUser)===null||a===void 0?void 0:a._redirectEventId)===i?this._currentUser:((d=this.redirectUser)===null||d===void 0?void 0:d._redirectEventId)===i?this.redirectUser:null}async _persistUserIfCurrent(i){if(i===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(i))}_notifyListenersIfCurrent(i){i===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var i,a;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const d=(a=(i=this.currentUser)===null||i===void 0?void 0:i.uid)!==null&&a!==void 0?a:null;this.lastNotifiedUid!==d&&(this.lastNotifiedUid=d,this.authStateSubscription.next(this.currentUser))}registerStateListener(i,a,d,g){if(this._deleted)return()=>{};const b=typeof a=="function"?a:a.next.bind(a);let $=!1;const tt=this._isInitialized?Promise.resolve():this._initializationPromise;if(_assert(tt,this,"internal-error"),tt.then(()=>{$||b(this.currentUser)}),typeof a=="function"){const it=i.addObserver(a,d,g);return()=>{$=!0,it()}}else{const it=i.addObserver(a);return()=>{$=!0,it()}}}async directlySetCurrentUser(i){this.currentUser&&this.currentUser!==i&&this._currentUser._stopProactiveRefresh(),i&&this.isProactiveRefreshEnabled&&i._startProactiveRefresh(),this.currentUser=i,i?await this.assertedPersistence.setCurrentUser(i):await this.assertedPersistence.removeCurrentUser()}queue(i){return this.operations=this.operations.then(i,i),this.operations}get assertedPersistence(){return _assert(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(i){!i||this.frameworks.includes(i)||(this.frameworks.push(i),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const a={"X-Client-Version":this.clientVersion};this.app.options.appId&&(a["X-Firebase-gmpid"]=this.app.options.appId);const d=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||i===void 0?void 0:i.getHeartbeatsHeader());d&&(a["X-Firebase-Client"]=d);const g=await this._getAppCheckToken();return g&&(a["X-Firebase-AppCheck"]=g),a}async _getAppCheckToken(){var i;const a=await((i=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||i===void 0?void 0:i.getToken());return a!=null&&a.error&&_logWarn(`Error while retrieving App Check token: ${a.error}`),a==null?void 0:a.token}}function _castAuth(s){return getModularInstance(s)}class Subscription{constructor(i){this.auth=i,this.observer=null,this.addObserver=createSubscribe(a=>this.observer=a)}get next(){return _assert(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let externalJSProvider={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _setExternalJSProvider(s){externalJSProvider=s}function _loadJS(s){return externalJSProvider.loadJS(s)}function _gapiScriptUrl(){return externalJSProvider.gapiScript}function _generateCallbackName(s){return`__${s}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initializeAuth(s,i){const a=_getProvider(s,"auth");if(a.isInitialized()){const g=a.getImmediate(),b=a.getOptions();if(deepEqual(b,i??{}))return g;_fail(g,"already-initialized")}return a.initialize({options:i})}function _initializeAuthInstance(s,i){const a=(i==null?void 0:i.persistence)||[],d=(Array.isArray(a)?a:[a]).map(_getInstance);i!=null&&i.errorMap&&s._updateErrorMap(i.errorMap),s._initializeWithPersistence(d,i==null?void 0:i.popupRedirectResolver)}function connectAuthEmulator(s,i,a){const d=_castAuth(s);_assert(d._canInitEmulator,d,"emulator-config-failed"),_assert(/^https?:\/\//.test(i),d,"invalid-emulator-scheme");const g=!1,b=extractProtocol(i),{host:$,port:tt}=extractHostAndPort(i),it=tt===null?"":`:${tt}`;d.config.emulator={url:`${b}//${$}${it}/`},d.settings.appVerificationDisabledForTesting=!0,d.emulatorConfig=Object.freeze({host:$,port:tt,protocol:b.replace(":",""),options:Object.freeze({disableWarnings:g})}),emitEmulatorWarning()}function extractProtocol(s){const i=s.indexOf(":");return i<0?"":s.substr(0,i+1)}function extractHostAndPort(s){const i=extractProtocol(s),a=/(\/\/)?([^?#/]+)/.exec(s.substr(i.length));if(!a)return{host:"",port:null};const d=a[2].split("@").pop()||"",g=/^(\[[^\]]+\])(:|$)/.exec(d);if(g){const b=g[1];return{host:b,port:parsePort(d.substr(b.length+1))}}else{const[b,$]=d.split(":");return{host:b,port:parsePort($)}}}function parsePort(s){if(!s)return null;const i=Number(s);return isNaN(i)?null:i}function emitEmulatorWarning(){function s(){const i=document.createElement("p"),a=i.style;i.innerText="Running in emulator mode. Do not use with production credentials.",a.position="fixed",a.width="100%",a.backgroundColor="#ffffff",a.border=".1em solid #000000",a.color="#b50000",a.bottom="0px",a.left="0px",a.margin="0px",a.zIndex="10000",a.textAlign="center",i.classList.add("firebase-emulator-warning"),document.body.appendChild(i)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthCredential{constructor(i,a){this.providerId=i,this.signInMethod=a}toJSON(){return debugFail("not implemented")}_getIdTokenResponse(i){return debugFail("not implemented")}_linkToIdToken(i,a){return debugFail("not implemented")}_getReauthenticationResolver(i){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithIdp(s,i){return _performSignInRequest(s,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(s,i))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI$1="http://localhost";class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(i){const a=new OAuthCredential(i.providerId,i.signInMethod);return i.idToken||i.accessToken?(i.idToken&&(a.idToken=i.idToken),i.accessToken&&(a.accessToken=i.accessToken),i.nonce&&!i.pendingToken&&(a.nonce=i.nonce),i.pendingToken&&(a.pendingToken=i.pendingToken)):i.oauthToken&&i.oauthTokenSecret?(a.accessToken=i.oauthToken,a.secret=i.oauthTokenSecret):_fail("argument-error"),a}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(i){const a=typeof i=="string"?JSON.parse(i):i,{providerId:d,signInMethod:g}=a,b=__rest$2(a,["providerId","signInMethod"]);if(!d||!g)return null;const $=new OAuthCredential(d,g);return $.idToken=b.idToken||void 0,$.accessToken=b.accessToken||void 0,$.secret=b.secret,$.nonce=b.nonce,$.pendingToken=b.pendingToken||null,$}_getIdTokenResponse(i){const a=this.buildRequest();return signInWithIdp(i,a)}_linkToIdToken(i,a){const d=this.buildRequest();return d.idToken=a,signInWithIdp(i,d)}_getReauthenticationResolver(i){const a=this.buildRequest();return a.autoCreate=!1,signInWithIdp(i,a)}buildRequest(){const i={requestUri:IDP_REQUEST_URI$1,returnSecureToken:!0};if(this.pendingToken)i.pendingToken=this.pendingToken;else{const a={};this.idToken&&(a.id_token=this.idToken),this.accessToken&&(a.access_token=this.accessToken),this.secret&&(a.oauth_token_secret=this.secret),a.providerId=this.providerId,this.nonce&&!this.pendingToken&&(a.nonce=this.nonce),i.postBody=querystring(a)}return i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FederatedAuthProvider{constructor(i){this.providerId=i,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(i){this.defaultLanguageCode=i}setCustomParameters(i){return this.customParameters=i,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope(i){return this.scopes.includes(i)||this.scopes.push(i),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential(i){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:i})}static credentialFromResult(i){return FacebookAuthProvider.credentialFromTaggedObject(i)}static credentialFromError(i){return FacebookAuthProvider.credentialFromTaggedObject(i.customData||{})}static credentialFromTaggedObject({_tokenResponse:i}){if(!i||!("oauthAccessToken"in i)||!i.oauthAccessToken)return null;try{return FacebookAuthProvider.credential(i.oauthAccessToken)}catch{return null}}}FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com";FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential(i,a){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:i,accessToken:a})}static credentialFromResult(i){return GoogleAuthProvider.credentialFromTaggedObject(i)}static credentialFromError(i){return GoogleAuthProvider.credentialFromTaggedObject(i.customData||{})}static credentialFromTaggedObject({_tokenResponse:i}){if(!i)return null;const{oauthIdToken:a,oauthAccessToken:d}=i;if(!a&&!d)return null;try{return GoogleAuthProvider.credential(a,d)}catch{return null}}}GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com";GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential(i){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:i})}static credentialFromResult(i){return GithubAuthProvider.credentialFromTaggedObject(i)}static credentialFromError(i){return GithubAuthProvider.credentialFromTaggedObject(i.customData||{})}static credentialFromTaggedObject({_tokenResponse:i}){if(!i||!("oauthAccessToken"in i)||!i.oauthAccessToken)return null;try{return GithubAuthProvider.credential(i.oauthAccessToken)}catch{return null}}}GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com";GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential(i,a){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:i,oauthTokenSecret:a})}static credentialFromResult(i){return TwitterAuthProvider.credentialFromTaggedObject(i)}static credentialFromError(i){return TwitterAuthProvider.credentialFromTaggedObject(i.customData||{})}static credentialFromTaggedObject({_tokenResponse:i}){if(!i)return null;const{oauthAccessToken:a,oauthTokenSecret:d}=i;if(!a||!d)return null;try{return TwitterAuthProvider.credential(a,d)}catch{return null}}}TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com";TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserCredentialImpl{constructor(i){this.user=i.user,this.providerId=i.providerId,this._tokenResponse=i._tokenResponse,this.operationType=i.operationType}static async _fromIdTokenResponse(i,a,d,g=!1){const b=await UserImpl._fromIdTokenResponse(i,d,g),$=providerIdForResponse(d);return new UserCredentialImpl({user:b,providerId:$,_tokenResponse:d,operationType:a})}static async _forOperation(i,a,d){await i._updateTokensIfNecessary(d,!0);const g=providerIdForResponse(d);return new UserCredentialImpl({user:i,providerId:g,_tokenResponse:d,operationType:a})}}function providerIdForResponse(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorError extends FirebaseError{constructor(i,a,d,g){var b;super(a.code,a.message),this.operationType=d,this.user=g,Object.setPrototypeOf(this,MultiFactorError.prototype),this.customData={appName:i.name,tenantId:(b=i.tenantId)!==null&&b!==void 0?b:void 0,_serverResponse:a.customData._serverResponse,operationType:d}}static _fromErrorAndOperation(i,a,d,g){return new MultiFactorError(i,a,d,g)}}function _processCredentialSavingMfaContextIfNecessary(s,i,a,d){return(i==="reauthenticate"?a._getReauthenticationResolver(s):a._getIdTokenResponse(s)).catch(b=>{throw b.code==="auth/multi-factor-auth-required"?MultiFactorError._fromErrorAndOperation(s,b,i,d):b})}async function _link$1(s,i,a=!1){const d=await _logoutIfInvalidated(s,i._linkToIdToken(s.auth,await s.getIdToken()),a);return UserCredentialImpl._forOperation(s,"link",d)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reauthenticate(s,i,a=!1){const{auth:d}=s;if(_isFirebaseServerApp(d.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(d));const g="reauthenticate";try{const b=await _logoutIfInvalidated(s,_processCredentialSavingMfaContextIfNecessary(d,g,i,s),a);_assert(b.idToken,d,"internal-error");const $=_parseToken(b.idToken);_assert($,d,"internal-error");const{sub:tt}=$;return _assert(s.uid===tt,d,"user-mismatch"),UserCredentialImpl._forOperation(s,g,b)}catch(b){throw(b==null?void 0:b.code)==="auth/user-not-found"&&_fail(d,"user-mismatch"),b}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _signInWithCredential(s,i,a=!1){if(_isFirebaseServerApp(s.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(s));const d="signIn",g=await _processCredentialSavingMfaContextIfNecessary(s,d,i),b=await UserCredentialImpl._fromIdTokenResponse(s,d,g);return a||await s._updateCurrentUser(b.user),b}function onIdTokenChanged(s,i,a,d){return getModularInstance(s).onIdTokenChanged(i,a,d)}function beforeAuthStateChanged(s,i,a){return getModularInstance(s).beforeAuthStateChanged(i,a)}const STORAGE_AVAILABLE_KEY="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserPersistenceClass{constructor(i,a){this.storageRetriever=i,this.type=a}_isAvailable(){try{return this.storage?(this.storage.setItem(STORAGE_AVAILABLE_KEY,"1"),this.storage.removeItem(STORAGE_AVAILABLE_KEY),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(i,a){return this.storage.setItem(i,JSON.stringify(a)),Promise.resolve()}_get(i){const a=this.storage.getItem(i);return Promise.resolve(a?JSON.parse(a):null)}_remove(i){return this.storage.removeItem(i),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _iframeCannotSyncWebStorage(){const s=getUA();return _isSafari(s)||_isIOS(s)}const _POLLING_INTERVAL_MS$1=1e3,IE10_LOCAL_STORAGE_SYNC_DELAY=10;class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(i,a)=>this.onStorageEvent(i,a),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=_iframeCannotSyncWebStorage()&&_isIframe(),this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0}forAllChangedKeys(i){for(const a of Object.keys(this.listeners)){const d=this.storage.getItem(a),g=this.localCache[a];d!==g&&i(a,g,d)}}onStorageEvent(i,a=!1){if(!i.key){this.forAllChangedKeys(($,tt,it)=>{this.notifyListeners($,it)});return}const d=i.key;if(a?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const $=this.storage.getItem(d);if(i.newValue!==$)i.newValue!==null?this.storage.setItem(d,i.newValue):this.storage.removeItem(d);else if(this.localCache[d]===i.newValue&&!a)return}const g=()=>{const $=this.storage.getItem(d);!a&&this.localCache[d]===$||this.notifyListeners(d,$)},b=this.storage.getItem(d);_isIE10()&&b!==i.newValue&&i.newValue!==i.oldValue?setTimeout(g,IE10_LOCAL_STORAGE_SYNC_DELAY):g()}notifyListeners(i,a){this.localCache[i]=a;const d=this.listeners[i];if(d)for(const g of Array.from(d))g(a&&JSON.parse(a))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((i,a,d)=>{this.onStorageEvent(new StorageEvent("storage",{key:i,oldValue:a,newValue:d}),!0)})},_POLLING_INTERVAL_MS$1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(i,a){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[i]||(this.listeners[i]=new Set,this.localCache[i]=this.storage.getItem(i)),this.listeners[i].add(a)}_removeListener(i,a){this.listeners[i]&&(this.listeners[i].delete(a),this.listeners[i].size===0&&delete this.listeners[i]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(i,a){await super._set(i,a),this.localCache[i]=JSON.stringify(a)}async _get(i){const a=await super._get(i);return this.localCache[i]=JSON.stringify(a),a}async _remove(i){await super._remove(i),delete this.localCache[i]}}BrowserLocalPersistence.type="LOCAL";const browserLocalPersistence=BrowserLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(i,a){}_removeListener(i,a){}}BrowserSessionPersistence.type="SESSION";const browserSessionPersistence=BrowserSessionPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _allSettled(s){return Promise.all(s.map(async i=>{try{return{fulfilled:!0,value:await i}}catch(a){return{fulfilled:!1,reason:a}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Receiver{constructor(i){this.eventTarget=i,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(i){const a=this.receivers.find(g=>g.isListeningto(i));if(a)return a;const d=new Receiver(i);return this.receivers.push(d),d}isListeningto(i){return this.eventTarget===i}async handleEvent(i){const a=i,{eventId:d,eventType:g,data:b}=a.data,$=this.handlersMap[g];if(!($!=null&&$.size))return;a.ports[0].postMessage({status:"ack",eventId:d,eventType:g});const tt=Array.from($).map(async rt=>rt(a.origin,b)),it=await _allSettled(tt);a.ports[0].postMessage({status:"done",eventId:d,eventType:g,response:it})}_subscribe(i,a){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[i]||(this.handlersMap[i]=new Set),this.handlersMap[i].add(a)}_unsubscribe(i,a){this.handlersMap[i]&&a&&this.handlersMap[i].delete(a),(!a||this.handlersMap[i].size===0)&&delete this.handlersMap[i],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Receiver.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(s="",i=10){let a="";for(let d=0;d<i;d++)a+=Math.floor(Math.random()*10);return s+a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sender{constructor(i){this.target=i,this.handlers=new Set}removeMessageHandler(i){i.messageChannel&&(i.messageChannel.port1.removeEventListener("message",i.onMessage),i.messageChannel.port1.close()),this.handlers.delete(i)}async _send(i,a,d=50){const g=typeof MessageChannel<"u"?new MessageChannel:null;if(!g)throw new Error("connection_unavailable");let b,$;return new Promise((tt,it)=>{const rt=_generateEventId("",20);g.port1.start();const ot=setTimeout(()=>{it(new Error("unsupported_event"))},d);$={messageChannel:g,onMessage(lt){const ut=lt;if(ut.data.eventId===rt)switch(ut.data.status){case"ack":clearTimeout(ot),b=setTimeout(()=>{it(new Error("timeout"))},3e3);break;case"done":clearTimeout(b),tt(ut.data.response);break;default:clearTimeout(ot),clearTimeout(b),it(new Error("invalid_response"));break}}},this.handlers.add($),g.port1.addEventListener("message",$.onMessage),this.target.postMessage({eventType:i,eventId:rt,data:a},[g.port2])}).finally(()=>{$&&this.removeMessageHandler($)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window(){return window}function _setWindowLocation(s){_window().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker(){return typeof _window().WorkerGlobalScope<"u"&&typeof _window().importScripts=="function"}async function _getActiveServiceWorker(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _getServiceWorkerController(){var s;return((s=navigator==null?void 0:navigator.serviceWorker)===null||s===void 0?void 0:s.controller)||null}function _getWorkerGlobalScope(){return _isWorker()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebaseLocalStorageDb",DB_VERSION=1,DB_OBJECTSTORE_NAME="firebaseLocalStorage",DB_DATA_KEYPATH="fbase_key";class DBPromise{constructor(i){this.request=i}toPromise(){return new Promise((i,a)=>{this.request.addEventListener("success",()=>{i(this.request.result)}),this.request.addEventListener("error",()=>{a(this.request.error)})})}}function getObjectStore(s,i){return s.transaction([DB_OBJECTSTORE_NAME],i?"readwrite":"readonly").objectStore(DB_OBJECTSTORE_NAME)}function _deleteDatabase(){const s=indexedDB.deleteDatabase(DB_NAME);return new DBPromise(s).toPromise()}function _openDatabase(){const s=indexedDB.open(DB_NAME,DB_VERSION);return new Promise((i,a)=>{s.addEventListener("error",()=>{a(s.error)}),s.addEventListener("upgradeneeded",()=>{const d=s.result;try{d.createObjectStore(DB_OBJECTSTORE_NAME,{keyPath:DB_DATA_KEYPATH})}catch(g){a(g)}}),s.addEventListener("success",async()=>{const d=s.result;d.objectStoreNames.contains(DB_OBJECTSTORE_NAME)?i(d):(d.close(),await _deleteDatabase(),i(await _openDatabase()))})})}async function _putObject(s,i,a){const d=getObjectStore(s,!0).put({[DB_DATA_KEYPATH]:i,value:a});return new DBPromise(d).toPromise()}async function getObject(s,i){const a=getObjectStore(s,!1).get(i),d=await new DBPromise(a).toPromise();return d===void 0?null:d.value}function _deleteObject(s,i){const a=getObjectStore(s,!0).delete(i);return new DBPromise(a).toPromise()}const _POLLING_INTERVAL_MS=800,_TRANSACTION_RETRY_COUNT=3;class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _openDatabase(),this.db)}async _withRetries(i){let a=0;for(;;)try{const d=await this._openDb();return await i(d)}catch(d){if(a++>_TRANSACTION_RETRY_COUNT)throw d;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _isWorker()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Receiver._getInstance(_getWorkerGlobalScope()),this.receiver._subscribe("keyChanged",async(i,a)=>({keyProcessed:(await this._poll()).includes(a.key)})),this.receiver._subscribe("ping",async(i,a)=>["keyChanged"])}async initializeSender(){var i,a;if(this.activeServiceWorker=await _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);const d=await this.sender._send("ping",{},800);d&&!((i=d[0])===null||i===void 0)&&i.fulfilled&&!((a=d[0])===null||a===void 0)&&a.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(i){if(!(!this.sender||!this.activeServiceWorker||_getServiceWorkerController()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:i},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const i=await _openDatabase();return await _putObject(i,STORAGE_AVAILABLE_KEY,"1"),await _deleteObject(i,STORAGE_AVAILABLE_KEY),!0}catch{}return!1}async _withPendingWrite(i){this.pendingWrites++;try{await i()}finally{this.pendingWrites--}}async _set(i,a){return this._withPendingWrite(async()=>(await this._withRetries(d=>_putObject(d,i,a)),this.localCache[i]=a,this.notifyServiceWorker(i)))}async _get(i){const a=await this._withRetries(d=>getObject(d,i));return this.localCache[i]=a,a}async _remove(i){return this._withPendingWrite(async()=>(await this._withRetries(a=>_deleteObject(a,i)),delete this.localCache[i],this.notifyServiceWorker(i)))}async _poll(){const i=await this._withRetries(g=>{const b=getObjectStore(g,!1).getAll();return new DBPromise(b).toPromise()});if(!i)return[];if(this.pendingWrites!==0)return[];const a=[],d=new Set;if(i.length!==0)for(const{fbase_key:g,value:b}of i)d.add(g),JSON.stringify(this.localCache[g])!==JSON.stringify(b)&&(this.notifyListeners(g,b),a.push(g));for(const g of Object.keys(this.localCache))this.localCache[g]&&!d.has(g)&&(this.notifyListeners(g,null),a.push(g));return a}notifyListeners(i,a){this.localCache[i]=a;const d=this.listeners[i];if(d)for(const g of Array.from(d))g(a)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_POLLING_INTERVAL_MS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(i,a){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[i]||(this.listeners[i]=new Set,this._get(i)),this.listeners[i].add(a)}_removeListener(i,a){this.listeners[i]&&(this.listeners[i].delete(a),this.listeners[i].size===0&&delete this.listeners[i]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IndexedDBLocalPersistence.type="LOCAL";const indexedDBLocalPersistence=IndexedDBLocalPersistence;new Delay(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _withDefaultResolver(s,i){return i?_getInstance(i):(_assert(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IdpCredential extends AuthCredential{constructor(i){super("custom","custom"),this.params=i}_getIdTokenResponse(i){return signInWithIdp(i,this._buildIdpRequest())}_linkToIdToken(i,a){return signInWithIdp(i,this._buildIdpRequest(a))}_getReauthenticationResolver(i){return signInWithIdp(i,this._buildIdpRequest())}_buildIdpRequest(i){const a={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return i&&(a.idToken=i),a}}function _signIn(s){return _signInWithCredential(s.auth,new IdpCredential(s),s.bypassAuthState)}function _reauth(s){const{auth:i,user:a}=s;return _assert(a,i,"internal-error"),_reauthenticate(a,new IdpCredential(s),s.bypassAuthState)}async function _link(s){const{auth:i,user:a}=s;return _assert(a,i,"internal-error"),_link$1(a,new IdpCredential(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AbstractPopupRedirectOperation{constructor(i,a,d,g,b=!1){this.auth=i,this.resolver=d,this.user=g,this.bypassAuthState=b,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(a)?a:[a]}execute(){return new Promise(async(i,a)=>{this.pendingPromise={resolve:i,reject:a};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(d){this.reject(d)}})}async onAuthEvent(i){const{urlResponse:a,sessionId:d,postBody:g,tenantId:b,error:$,type:tt}=i;if($){this.reject($);return}const it={auth:this.auth,requestUri:a,sessionId:d,tenantId:b||void 0,postBody:g||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(tt)(it))}catch(rt){this.reject(rt)}}onError(i){this.reject(i)}getIdpTask(i){switch(i){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve(i){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(i),this.unregisterAndCleanUp()}reject(i){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(i),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLL_WINDOW_CLOSE_TIMEOUT=new Delay(2e3,1e4);class PopupOperation extends AbstractPopupRedirectOperation{constructor(i,a,d,g,b){super(i,a,g,b),this.provider=d,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}async executeNotNull(){const i=await this.execute();return _assert(i,this.auth,"internal-error"),i}async onExecution(){debugAssert(this.filter.length===1,"Popup operations only handle one event");const i=_generateEventId();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],i),this.authWindow.associatedEvent=i,this.resolver._originValidation(this.auth).catch(a=>{this.reject(a)}),this.resolver._isIframeWebStorageSupported(this.auth,a=>{a||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var i;return((i=this.authWindow)===null||i===void 0?void 0:i.associatedEvent)||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){const i=()=>{var a,d;if(!((d=(a=this.authWindow)===null||a===void 0?void 0:a.window)===null||d===void 0)&&d.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(i,_POLL_WINDOW_CLOSE_TIMEOUT.get())};i()}}PopupOperation.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_REDIRECT_KEY="pendingRedirect",redirectOutcomeMap=new Map;class RedirectAction extends AbstractPopupRedirectOperation{constructor(i,a,d=!1){super(i,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],a,void 0,d),this.eventId=null}async execute(){let i=redirectOutcomeMap.get(this.auth._key());if(!i){try{const d=await _getAndClearPendingRedirectStatus(this.resolver,this.auth)?await super.execute():null;i=()=>Promise.resolve(d)}catch(a){i=()=>Promise.reject(a)}redirectOutcomeMap.set(this.auth._key(),i)}return this.bypassAuthState||redirectOutcomeMap.set(this.auth._key(),()=>Promise.resolve(null)),i()}async onAuthEvent(i){if(i.type==="signInViaRedirect")return super.onAuthEvent(i);if(i.type==="unknown"){this.resolve(null);return}if(i.eventId){const a=await this.auth._redirectUserForId(i.eventId);if(a)return this.user=a,super.onAuthEvent(i);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _getAndClearPendingRedirectStatus(s,i){const a=pendingRedirectKey(i),d=resolverPersistence(s);if(!await d._isAvailable())return!1;const g=await d._get(a)==="true";return await d._remove(a),g}function _overrideRedirectResult(s,i){redirectOutcomeMap.set(s._key(),i)}function resolverPersistence(s){return _getInstance(s._redirectPersistence)}function pendingRedirectKey(s){return _persistenceKeyName(PENDING_REDIRECT_KEY,s.config.apiKey,s.name)}async function _getRedirectResult(s,i,a=!1){if(_isFirebaseServerApp(s.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(s));const d=_castAuth(s),g=_withDefaultResolver(d,i),$=await new RedirectAction(d,g,a).execute();return $&&!a&&(delete $.user._redirectEventId,await d._persistUserIfCurrent($.user),await d._setRedirectUser(null,i)),$}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EVENT_DUPLICATION_CACHE_DURATION_MS=10*60*1e3;class AuthEventManager{constructor(i){this.auth=i,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(i){this.consumers.add(i),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,i)&&(this.sendToConsumer(this.queuedRedirectEvent,i),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(i){this.consumers.delete(i)}onEvent(i){if(this.hasEventBeenHandled(i))return!1;let a=!1;return this.consumers.forEach(d=>{this.isEventForConsumer(i,d)&&(a=!0,this.sendToConsumer(i,d),this.saveEventToCache(i))}),this.hasHandledPotentialRedirect||!isRedirectEvent(i)||(this.hasHandledPotentialRedirect=!0,a||(this.queuedRedirectEvent=i,a=!0)),a}sendToConsumer(i,a){var d;if(i.error&&!isNullRedirectEvent(i)){const g=((d=i.error.code)===null||d===void 0?void 0:d.split("auth/")[1])||"internal-error";a.onError(_createError(this.auth,g))}else a.onAuthEvent(i)}isEventForConsumer(i,a){const d=a.eventId===null||!!i.eventId&&i.eventId===a.eventId;return a.filter.includes(i.type)&&d}hasEventBeenHandled(i){return Date.now()-this.lastProcessedEventTime>=EVENT_DUPLICATION_CACHE_DURATION_MS&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid(i))}saveEventToCache(i){this.cachedEventUids.add(eventUid(i)),this.lastProcessedEventTime=Date.now()}}function eventUid(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(i=>i).join("-")}function isNullRedirectEvent({type:s,error:i}){return s==="unknown"&&(i==null?void 0:i.code)==="auth/no-auth-event"}function isRedirectEvent(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getProjectConfig(s,i={}){return _performApiRequest(s,"GET","/v1/projects",i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP_ADDRESS_REGEX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HTTP_REGEX=/^https?/;async function _validateOrigin(s){if(s.config.emulator)return;const{authorizedDomains:i}=await _getProjectConfig(s);for(const a of i)try{if(matchDomain(a))return}catch{}_fail(s,"unauthorized-domain")}function matchDomain(s){const i=_getCurrentUrl(),{protocol:a,hostname:d}=new URL(i);if(s.startsWith("chrome-extension://")){const $=new URL(s);return $.hostname===""&&d===""?a==="chrome-extension:"&&s.replace("chrome-extension://","")===i.replace("chrome-extension://",""):a==="chrome-extension:"&&$.hostname===d}if(!HTTP_REGEX.test(a))return!1;if(IP_ADDRESS_REGEX.test(s))return d===s;const g=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+g+"|"+g+")$","i").test(d)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NETWORK_TIMEOUT=new Delay(3e4,6e4);function resetUnloadedGapiModules(){const s=_window().___jsl;if(s!=null&&s.H){for(const i of Object.keys(s.H))if(s.H[i].r=s.H[i].r||[],s.H[i].L=s.H[i].L||[],s.H[i].r=[...s.H[i].L],s.CP)for(let a=0;a<s.CP.length;a++)s.CP[a]=null}}function loadGapi(s){return new Promise((i,a)=>{var d,g,b;function $(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{i(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),a(_createError(s,"network-request-failed"))},timeout:NETWORK_TIMEOUT.get()})}if(!((g=(d=_window().gapi)===null||d===void 0?void 0:d.iframes)===null||g===void 0)&&g.Iframe)i(gapi.iframes.getContext());else if(!((b=_window().gapi)===null||b===void 0)&&b.load)$();else{const tt=_generateCallbackName("iframefcb");return _window()[tt]=()=>{gapi.load?$():a(_createError(s,"network-request-failed"))},_loadJS(`${_gapiScriptUrl()}?onload=${tt}`).catch(it=>a(it))}}).catch(i=>{throw cachedGApiLoader=null,i})}let cachedGApiLoader=null;function _loadGapi(s){return cachedGApiLoader=cachedGApiLoader||loadGapi(s),cachedGApiLoader}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PING_TIMEOUT=new Delay(5e3,15e3),IFRAME_PATH="__/auth/iframe",EMULATED_IFRAME_PATH="emulator/auth/iframe",IFRAME_ATTRIBUTES={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},EID_FROM_APIHOST=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function getIframeUrl(s){const i=s.config;_assert(i.authDomain,s,"auth-domain-config-required");const a=i.emulator?_emulatorUrl(i,EMULATED_IFRAME_PATH):`https://${s.config.authDomain}/${IFRAME_PATH}`,d={apiKey:i.apiKey,appName:s.name,v:SDK_VERSION$1},g=EID_FROM_APIHOST.get(s.config.apiHost);g&&(d.eid=g);const b=s._getFrameworks();return b.length&&(d.fw=b.join(",")),`${a}?${querystring(d).slice(1)}`}async function _openIframe(s){const i=await _loadGapi(s),a=_window().gapi;return _assert(a,s,"internal-error"),i.open({where:document.body,url:getIframeUrl(s),messageHandlersFilter:a.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IFRAME_ATTRIBUTES,dontclear:!0},d=>new Promise(async(g,b)=>{await d.restyle({setHideOnLeave:!1});const $=_createError(s,"network-request-failed"),tt=_window().setTimeout(()=>{b($)},PING_TIMEOUT.get());function it(){_window().clearTimeout(tt),g(d)}d.ping(it).then(it,()=>{b($)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BASE_POPUP_OPTIONS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DEFAULT_WIDTH=500,DEFAULT_HEIGHT=600,TARGET_BLANK="_blank",FIREFOX_EMPTY_URL="http://localhost";class AuthPopup{constructor(i){this.window=i,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _open(s,i,a,d=DEFAULT_WIDTH,g=DEFAULT_HEIGHT){const b=Math.max((window.screen.availHeight-g)/2,0).toString(),$=Math.max((window.screen.availWidth-d)/2,0).toString();let tt="";const it=Object.assign(Object.assign({},BASE_POPUP_OPTIONS),{width:d.toString(),height:g.toString(),top:b,left:$}),rt=getUA().toLowerCase();a&&(tt=_isChromeIOS(rt)?TARGET_BLANK:a),_isFirefox(rt)&&(i=i||FIREFOX_EMPTY_URL,it.scrollbars="yes");const ot=Object.entries(it).reduce((ut,[pt,_t])=>`${ut}${pt}=${_t},`,"");if(_isIOSStandalone(rt)&&tt!=="_self")return openAsNewWindowIOS(i||"",tt),new AuthPopup(null);const lt=window.open(i||"",tt,ot);_assert(lt,s,"popup-blocked");try{lt.focus()}catch{}return new AuthPopup(lt)}function openAsNewWindowIOS(s,i){const a=document.createElement("a");a.href=s,a.target=i;const d=document.createEvent("MouseEvent");d.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),a.dispatchEvent(d)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WIDGET_PATH="__/auth/handler",EMULATOR_WIDGET_PATH="emulator/auth/handler",FIREBASE_APP_CHECK_FRAGMENT_ID=encodeURIComponent("fac");async function _getRedirectUrl(s,i,a,d,g,b){_assert(s.config.authDomain,s,"auth-domain-config-required"),_assert(s.config.apiKey,s,"invalid-api-key");const $={apiKey:s.config.apiKey,appName:s.name,authType:a,redirectUrl:d,v:SDK_VERSION$1,eventId:g};if(i instanceof FederatedAuthProvider){i.setDefaultLanguage(s.languageCode),$.providerId=i.providerId||"",isEmpty(i.getCustomParameters())||($.customParameters=JSON.stringify(i.getCustomParameters()));for(const[ot,lt]of Object.entries({}))$[ot]=lt}if(i instanceof BaseOAuthProvider){const ot=i.getScopes().filter(lt=>lt!=="");ot.length>0&&($.scopes=ot.join(","))}s.tenantId&&($.tid=s.tenantId);const tt=$;for(const ot of Object.keys(tt))tt[ot]===void 0&&delete tt[ot];const it=await s._getAppCheckToken(),rt=it?`#${FIREBASE_APP_CHECK_FRAGMENT_ID}=${encodeURIComponent(it)}`:"";return`${getHandlerBase(s)}?${querystring(tt).slice(1)}${rt}`}function getHandlerBase({config:s}){return s.emulator?_emulatorUrl(s,EMULATOR_WIDGET_PATH):`https://${s.authDomain}/${WIDGET_PATH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEB_STORAGE_SUPPORT_KEY="webStorageSupport";class BrowserPopupRedirectResolver{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _openPopup(i,a,d,g){var b;debugAssert((b=this.eventManagers[i._key()])===null||b===void 0?void 0:b.manager,"_initialize() not called before _openPopup()");const $=await _getRedirectUrl(i,a,d,_getCurrentUrl(),g);return _open(i,$,_generateEventId())}async _openRedirect(i,a,d,g){await this._originValidation(i);const b=await _getRedirectUrl(i,a,d,_getCurrentUrl(),g);return _setWindowLocation(b),new Promise(()=>{})}_initialize(i){const a=i._key();if(this.eventManagers[a]){const{manager:g,promise:b}=this.eventManagers[a];return g?Promise.resolve(g):(debugAssert(b,"If manager is not set, promise should be"),b)}const d=this.initAndGetManager(i);return this.eventManagers[a]={promise:d},d.catch(()=>{delete this.eventManagers[a]}),d}async initAndGetManager(i){const a=await _openIframe(i),d=new AuthEventManager(i);return a.register("authEvent",g=>(_assert(g==null?void 0:g.authEvent,i,"invalid-auth-event"),{status:d.onEvent(g.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[i._key()]={manager:d},this.iframes[i._key()]=a,d}_isIframeWebStorageSupported(i,a){this.iframes[i._key()].send(WEB_STORAGE_SUPPORT_KEY,{type:WEB_STORAGE_SUPPORT_KEY},g=>{var b;const $=(b=g==null?void 0:g[0])===null||b===void 0?void 0:b[WEB_STORAGE_SUPPORT_KEY];$!==void 0&&a(!!$),_fail(i,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(i){const a=i._key();return this.originValidationPromises[a]||(this.originValidationPromises[a]=_validateOrigin(i)),this.originValidationPromises[a]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}}const browserPopupRedirectResolver=BrowserPopupRedirectResolver;var name$2="@firebase/auth",version$7="1.7.3";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthInterop{constructor(i){this.auth=i,this.internalListeners=new Map}getUid(){var i;return this.assertAuthConfigured(),((i=this.auth.currentUser)===null||i===void 0?void 0:i.uid)||null}async getToken(i){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(i)}:null}addAuthTokenListener(i){if(this.assertAuthConfigured(),this.internalListeners.has(i))return;const a=this.auth.onIdTokenChanged(d=>{i((d==null?void 0:d.stsTokenManager.accessToken)||null)});this.internalListeners.set(i,a),this.updateProactiveRefresh()}removeAuthTokenListener(i){this.assertAuthConfigured();const a=this.internalListeners.get(i);a&&(this.internalListeners.delete(i),a(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getVersionForPlatform(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function registerAuth(s){_registerComponent(new Component("auth",(i,{options:a})=>{const d=i.getProvider("app").getImmediate(),g=i.getProvider("heartbeat"),b=i.getProvider("app-check-internal"),{apiKey:$,authDomain:tt}=d.options;_assert($&&!$.includes(":"),"invalid-api-key",{appName:d.name});const it={apiKey:$,authDomain:tt,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(s)},rt=new AuthImpl(d,g,b,it);return _initializeAuthInstance(rt,a),rt},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((i,a,d)=>{i.getProvider("auth-internal").initialize()})),_registerComponent(new Component("auth-internal",i=>{const a=_castAuth(i.getProvider("auth").getImmediate());return(d=>new AuthInterop(d))(a)},"PRIVATE").setInstantiationMode("EXPLICIT")),registerVersion(name$2,version$7,getVersionForPlatform(s)),registerVersion(name$2,version$7,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ID_TOKEN_MAX_AGE=5*60,authIdTokenMaxAge=getExperimentalSetting("authIdTokenMaxAge")||DEFAULT_ID_TOKEN_MAX_AGE;let lastPostedIdToken=null;const mintCookieFactory=s=>async i=>{const a=i&&await i.getIdTokenResult(),d=a&&(new Date().getTime()-Date.parse(a.issuedAtTime))/1e3;if(d&&d>authIdTokenMaxAge)return;const g=a==null?void 0:a.token;lastPostedIdToken!==g&&(lastPostedIdToken=g,await fetch(s,{method:g?"POST":"DELETE",headers:g?{Authorization:`Bearer ${g}`}:{}}))};function getAuth(s=getApp()){const i=_getProvider(s,"auth");if(i.isInitialized())return i.getImmediate();const a=initializeAuth(s,{popupRedirectResolver:browserPopupRedirectResolver,persistence:[indexedDBLocalPersistence,browserLocalPersistence,browserSessionPersistence]}),d=getExperimentalSetting("authTokenSyncURL");if(d&&typeof isSecureContext=="boolean"&&isSecureContext){const b=new URL(d,location.origin);if(location.origin===b.origin){const $=mintCookieFactory(b.toString());beforeAuthStateChanged(a,$,()=>$(a.currentUser)),onIdTokenChanged(a,tt=>$(tt))}}const g=getDefaultEmulatorHost("auth");return g&&connectAuthEmulator(a,`http://${g}`),a}function getScriptParentElement(){var s,i;return(i=(s=document.getElementsByTagName("head"))===null||s===void 0?void 0:s[0])!==null&&i!==void 0?i:document}_setExternalJSProvider({loadJS(s){return new Promise((i,a)=>{const d=document.createElement("script");d.setAttribute("src",s),d.onload=i,d.onerror=g=>{const b=_createError("internal-error");b.customData=g,a(b)},d.type="text/javascript",d.charset="UTF-8",getScriptParentElement().appendChild(d)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});registerAuth("Browser");const name$1="@firebase/installations",version$6="0.6.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_TIMEOUT_MS=1e4,PACKAGE_VERSION=`w:${version$6}`,INTERNAL_AUTH_VERSION="FIS_v2",INSTALLATIONS_API_URL="https://firebaseinstallations.googleapis.com/v1",TOKEN_EXPIRATION_BUFFER=60*60*1e3,SERVICE="installations",SERVICE_NAME="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_DESCRIPTION_MAP={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ERROR_FACTORY$1=new ErrorFactory(SERVICE,SERVICE_NAME,ERROR_DESCRIPTION_MAP);function isServerError(s){return s instanceof FirebaseError&&s.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getInstallationsEndpoint({projectId:s}){return`${INSTALLATIONS_API_URL}/projects/${s}/installations`}function extractAuthTokenInfoFromResponse(s){return{token:s.token,requestStatus:2,expiresIn:getExpiresInFromResponseExpiresIn(s.expiresIn),creationTime:Date.now()}}async function getErrorFromResponse(s,i){const d=(await i.json()).error;return ERROR_FACTORY$1.create("request-failed",{requestName:s,serverCode:d.code,serverMessage:d.message,serverStatus:d.status})}function getHeaders$1({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function getHeadersWithAuth(s,{refreshToken:i}){const a=getHeaders$1(s);return a.append("Authorization",getAuthorizationHeader(i)),a}async function retryIfServerError(s){const i=await s();return i.status>=500&&i.status<600?s():i}function getExpiresInFromResponseExpiresIn(s){return Number(s.replace("s","000"))}function getAuthorizationHeader(s){return`${INTERNAL_AUTH_VERSION} ${s}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function createInstallationRequest({appConfig:s,heartbeatServiceProvider:i},{fid:a}){const d=getInstallationsEndpoint(s),g=getHeaders$1(s),b=i.getImmediate({optional:!0});if(b){const rt=await b.getHeartbeatsHeader();rt&&g.append("x-firebase-client",rt)}const $={fid:a,authVersion:INTERNAL_AUTH_VERSION,appId:s.appId,sdkVersion:PACKAGE_VERSION},tt={method:"POST",headers:g,body:JSON.stringify($)},it=await retryIfServerError(()=>fetch(d,tt));if(it.ok){const rt=await it.json();return{fid:rt.fid||a,registrationStatus:2,refreshToken:rt.refreshToken,authToken:extractAuthTokenInfoFromResponse(rt.authToken)}}else throw await getErrorFromResponse("Create Installation",it)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sleep$1(s){return new Promise(i=>{setTimeout(i,s)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bufferToBase64UrlSafe(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VALID_FID_PATTERN=/^[cdef][\w-]{21}$/,INVALID_FID="";function generateFid(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const a=encode(s);return VALID_FID_PATTERN.test(a)?a:INVALID_FID}catch{return INVALID_FID}}function encode(s){return bufferToBase64UrlSafe(s).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getKey(s){return`${s.appName}!${s.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fidChangeCallbacks=new Map;function fidChanged(s,i){const a=getKey(s);callFidChangeCallbacks(a,i),broadcastFidChange(a,i)}function callFidChangeCallbacks(s,i){const a=fidChangeCallbacks.get(s);if(a)for(const d of a)d(i)}function broadcastFidChange(s,i){const a=getBroadcastChannel();a&&a.postMessage({key:s,fid:i}),closeBroadcastChannel()}let broadcastChannel=null;function getBroadcastChannel(){return!broadcastChannel&&"BroadcastChannel"in self&&(broadcastChannel=new BroadcastChannel("[Firebase] FID Change"),broadcastChannel.onmessage=s=>{callFidChangeCallbacks(s.data.key,s.data.fid)}),broadcastChannel}function closeBroadcastChannel(){fidChangeCallbacks.size===0&&broadcastChannel&&(broadcastChannel.close(),broadcastChannel=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DATABASE_NAME="firebase-installations-database",DATABASE_VERSION=1,OBJECT_STORE_NAME="firebase-installations-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DATABASE_NAME,DATABASE_VERSION,{upgrade:(s,i)=>{switch(i){case 0:s.createObjectStore(OBJECT_STORE_NAME)}}})),dbPromise}async function set(s,i){const a=getKey(s),g=(await getDbPromise()).transaction(OBJECT_STORE_NAME,"readwrite"),b=g.objectStore(OBJECT_STORE_NAME),$=await b.get(a);return await b.put(i,a),await g.done,(!$||$.fid!==i.fid)&&fidChanged(s,i.fid),i}async function remove$1(s){const i=getKey(s),d=(await getDbPromise()).transaction(OBJECT_STORE_NAME,"readwrite");await d.objectStore(OBJECT_STORE_NAME).delete(i),await d.done}async function update(s,i){const a=getKey(s),g=(await getDbPromise()).transaction(OBJECT_STORE_NAME,"readwrite"),b=g.objectStore(OBJECT_STORE_NAME),$=await b.get(a),tt=i($);return tt===void 0?await b.delete(a):await b.put(tt,a),await g.done,tt&&(!$||$.fid!==tt.fid)&&fidChanged(s,tt.fid),tt}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function getInstallationEntry(s){let i;const a=await update(s.appConfig,d=>{const g=updateOrCreateInstallationEntry(d),b=triggerRegistrationIfNecessary(s,g);return i=b.registrationPromise,b.installationEntry});return a.fid===INVALID_FID?{installationEntry:await i}:{installationEntry:a,registrationPromise:i}}function updateOrCreateInstallationEntry(s){const i=s||{fid:generateFid(),registrationStatus:0};return clearTimedOutRequest(i)}function triggerRegistrationIfNecessary(s,i){if(i.registrationStatus===0){if(!navigator.onLine){const g=Promise.reject(ERROR_FACTORY$1.create("app-offline"));return{installationEntry:i,registrationPromise:g}}const a={fid:i.fid,registrationStatus:1,registrationTime:Date.now()},d=registerInstallation(s,a);return{installationEntry:a,registrationPromise:d}}else return i.registrationStatus===1?{installationEntry:i,registrationPromise:waitUntilFidRegistration(s)}:{installationEntry:i}}async function registerInstallation(s,i){try{const a=await createInstallationRequest(s,i);return set(s.appConfig,a)}catch(a){throw isServerError(a)&&a.customData.serverCode===409?await remove$1(s.appConfig):await set(s.appConfig,{fid:i.fid,registrationStatus:0}),a}}async function waitUntilFidRegistration(s){let i=await updateInstallationRequest(s.appConfig);for(;i.registrationStatus===1;)await sleep$1(100),i=await updateInstallationRequest(s.appConfig);if(i.registrationStatus===0){const{installationEntry:a,registrationPromise:d}=await getInstallationEntry(s);return d||a}return i}function updateInstallationRequest(s){return update(s,i=>{if(!i)throw ERROR_FACTORY$1.create("installation-not-found");return clearTimedOutRequest(i)})}function clearTimedOutRequest(s){return hasInstallationRequestTimedOut(s)?{fid:s.fid,registrationStatus:0}:s}function hasInstallationRequestTimedOut(s){return s.registrationStatus===1&&s.registrationTime+PENDING_TIMEOUT_MS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function generateAuthTokenRequest({appConfig:s,heartbeatServiceProvider:i},a){const d=getGenerateAuthTokenEndpoint(s,a),g=getHeadersWithAuth(s,a),b=i.getImmediate({optional:!0});if(b){const rt=await b.getHeartbeatsHeader();rt&&g.append("x-firebase-client",rt)}const $={installation:{sdkVersion:PACKAGE_VERSION,appId:s.appId}},tt={method:"POST",headers:g,body:JSON.stringify($)},it=await retryIfServerError(()=>fetch(d,tt));if(it.ok){const rt=await it.json();return extractAuthTokenInfoFromResponse(rt)}else throw await getErrorFromResponse("Generate Auth Token",it)}function getGenerateAuthTokenEndpoint(s,{fid:i}){return`${getInstallationsEndpoint(s)}/${i}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function refreshAuthToken(s,i=!1){let a;const d=await update(s.appConfig,b=>{if(!isEntryRegistered(b))throw ERROR_FACTORY$1.create("not-registered");const $=b.authToken;if(!i&&isAuthTokenValid($))return b;if($.requestStatus===1)return a=waitUntilAuthTokenRequest(s,i),b;{if(!navigator.onLine)throw ERROR_FACTORY$1.create("app-offline");const tt=makeAuthTokenRequestInProgressEntry(b);return a=fetchAuthTokenFromServer(s,tt),tt}});return a?await a:d.authToken}async function waitUntilAuthTokenRequest(s,i){let a=await updateAuthTokenRequest(s.appConfig);for(;a.authToken.requestStatus===1;)await sleep$1(100),a=await updateAuthTokenRequest(s.appConfig);const d=a.authToken;return d.requestStatus===0?refreshAuthToken(s,i):d}function updateAuthTokenRequest(s){return update(s,i=>{if(!isEntryRegistered(i))throw ERROR_FACTORY$1.create("not-registered");const a=i.authToken;return hasAuthTokenRequestTimedOut(a)?Object.assign(Object.assign({},i),{authToken:{requestStatus:0}}):i})}async function fetchAuthTokenFromServer(s,i){try{const a=await generateAuthTokenRequest(s,i),d=Object.assign(Object.assign({},i),{authToken:a});return await set(s.appConfig,d),a}catch(a){if(isServerError(a)&&(a.customData.serverCode===401||a.customData.serverCode===404))await remove$1(s.appConfig);else{const d=Object.assign(Object.assign({},i),{authToken:{requestStatus:0}});await set(s.appConfig,d)}throw a}}function isEntryRegistered(s){return s!==void 0&&s.registrationStatus===2}function isAuthTokenValid(s){return s.requestStatus===2&&!isAuthTokenExpired(s)}function isAuthTokenExpired(s){const i=Date.now();return i<s.creationTime||s.creationTime+s.expiresIn<i+TOKEN_EXPIRATION_BUFFER}function makeAuthTokenRequestInProgressEntry(s){const i={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},s),{authToken:i})}function hasAuthTokenRequestTimedOut(s){return s.requestStatus===1&&s.requestTime+PENDING_TIMEOUT_MS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function getId(s){const i=s,{installationEntry:a,registrationPromise:d}=await getInstallationEntry(i);return d?d.catch(console.error):refreshAuthToken(i).catch(console.error),a.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function getToken(s,i=!1){const a=s;return await completeInstallationRegistration(a),(await refreshAuthToken(a,i)).token}async function completeInstallationRegistration(s){const{registrationPromise:i}=await getInstallationEntry(s);i&&await i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function extractAppConfig(s){if(!s||!s.options)throw getMissingValueError("App Configuration");if(!s.name)throw getMissingValueError("App Name");const i=["projectId","apiKey","appId"];for(const a of i)if(!s.options[a])throw getMissingValueError(a);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function getMissingValueError(s){return ERROR_FACTORY$1.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INSTALLATIONS_NAME="installations",INSTALLATIONS_NAME_INTERNAL="installations-internal",publicFactory=s=>{const i=s.getProvider("app").getImmediate(),a=extractAppConfig(i),d=_getProvider(i,"heartbeat");return{app:i,appConfig:a,heartbeatServiceProvider:d,_delete:()=>Promise.resolve()}},internalFactory=s=>{const i=s.getProvider("app").getImmediate(),a=_getProvider(i,INSTALLATIONS_NAME).getImmediate();return{getId:()=>getId(a),getToken:g=>getToken(a,g)}};function registerInstallations(){_registerComponent(new Component(INSTALLATIONS_NAME,publicFactory,"PUBLIC")),_registerComponent(new Component(INSTALLATIONS_NAME_INTERNAL,internalFactory,"PRIVATE"))}registerInstallations();registerVersion(name$1,version$6);registerVersion(name$1,version$6,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ANALYTICS_TYPE="analytics",GA_FID_KEY="firebase_id",ORIGIN_KEY="origin",FETCH_TIMEOUT_MILLIS=60*1e3,DYNAMIC_CONFIG_URL="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",GTAG_URL="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger=new Logger("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ERROR_FACTORY=new ErrorFactory("analytics","Analytics",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createGtagTrustedTypesScriptURL(s){if(!s.startsWith(GTAG_URL)){const i=ERROR_FACTORY.create("invalid-gtag-resource",{gtagURL:s});return logger.warn(i.message),""}return s}function promiseAllSettled(s){return Promise.all(s.map(i=>i.catch(a=>a)))}function createTrustedTypesPolicy(s,i){let a;return window.trustedTypes&&(a=window.trustedTypes.createPolicy(s,i)),a}function insertScriptTag(s,i){const a=createTrustedTypesPolicy("firebase-js-sdk-policy",{createScriptURL:createGtagTrustedTypesScriptURL}),d=document.createElement("script"),g=`${GTAG_URL}?l=${s}&id=${i}`;d.src=a?a==null?void 0:a.createScriptURL(g):g,d.async=!0,document.head.appendChild(d)}function getOrCreateDataLayer(s){let i=[];return Array.isArray(window[s])?i=window[s]:window[s]=i,i}async function gtagOnConfig(s,i,a,d,g,b){const $=d[g];try{if($)await i[$];else{const it=(await promiseAllSettled(a)).find(rt=>rt.measurementId===g);it&&await i[it.appId]}}catch(tt){logger.error(tt)}s("config",g,b)}async function gtagOnEvent(s,i,a,d,g){try{let b=[];if(g&&g.send_to){let $=g.send_to;Array.isArray($)||($=[$]);const tt=await promiseAllSettled(a);for(const it of $){const rt=tt.find(lt=>lt.measurementId===it),ot=rt&&i[rt.appId];if(ot)b.push(ot);else{b=[];break}}}b.length===0&&(b=Object.values(i)),await Promise.all(b),s("event",d,g||{})}catch(b){logger.error(b)}}function wrapGtag(s,i,a,d){async function g(b,...$){try{if(b==="event"){const[tt,it]=$;await gtagOnEvent(s,i,a,tt,it)}else if(b==="config"){const[tt,it]=$;await gtagOnConfig(s,i,a,d,tt,it)}else if(b==="consent"){const[tt]=$;s("consent","update",tt)}else if(b==="get"){const[tt,it,rt]=$;s("get",tt,it,rt)}else if(b==="set"){const[tt]=$;s("set",tt)}else s(b,...$)}catch(tt){logger.error(tt)}}return g}function wrapOrCreateGtag(s,i,a,d,g){let b=function(...$){window[d].push(arguments)};return window[g]&&typeof window[g]=="function"&&(b=window[g]),window[g]=wrapGtag(b,s,i,a),{gtagCore:b,wrappedGtag:window[g]}}function findGtagScriptOnPage(s){const i=window.document.getElementsByTagName("script");for(const a of Object.values(i))if(a.src&&a.src.includes(GTAG_URL)&&a.src.includes(s))return a;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LONG_RETRY_FACTOR=30,BASE_INTERVAL_MILLIS=1e3;class RetryData{constructor(i={},a=BASE_INTERVAL_MILLIS){this.throttleMetadata=i,this.intervalMillis=a}getThrottleMetadata(i){return this.throttleMetadata[i]}setThrottleMetadata(i,a){this.throttleMetadata[i]=a}deleteThrottleMetadata(i){delete this.throttleMetadata[i]}}const defaultRetryData=new RetryData;function getHeaders(s){return new Headers({Accept:"application/json","x-goog-api-key":s})}async function fetchDynamicConfig(s){var i;const{appId:a,apiKey:d}=s,g={method:"GET",headers:getHeaders(d)},b=DYNAMIC_CONFIG_URL.replace("{app-id}",a),$=await fetch(b,g);if($.status!==200&&$.status!==304){let tt="";try{const it=await $.json();!((i=it.error)===null||i===void 0)&&i.message&&(tt=it.error.message)}catch{}throw ERROR_FACTORY.create("config-fetch-failed",{httpStatus:$.status,responseMessage:tt})}return $.json()}async function fetchDynamicConfigWithRetry(s,i=defaultRetryData,a){const{appId:d,apiKey:g,measurementId:b}=s.options;if(!d)throw ERROR_FACTORY.create("no-app-id");if(!g){if(b)return{measurementId:b,appId:d};throw ERROR_FACTORY.create("no-api-key")}const $=i.getThrottleMetadata(d)||{backoffCount:0,throttleEndTimeMillis:Date.now()},tt=new AnalyticsAbortSignal;return setTimeout(async()=>{tt.abort()},FETCH_TIMEOUT_MILLIS),attemptFetchDynamicConfigWithRetry({appId:d,apiKey:g,measurementId:b},$,tt,i)}async function attemptFetchDynamicConfigWithRetry(s,{throttleEndTimeMillis:i,backoffCount:a},d,g=defaultRetryData){var b;const{appId:$,measurementId:tt}=s;try{await setAbortableTimeout(d,i)}catch(it){if(tt)return logger.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${tt} provided in the "measurementId" field in the local Firebase config. [${it==null?void 0:it.message}]`),{appId:$,measurementId:tt};throw it}try{const it=await fetchDynamicConfig(s);return g.deleteThrottleMetadata($),it}catch(it){const rt=it;if(!isRetriableError(rt)){if(g.deleteThrottleMetadata($),tt)return logger.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${tt} provided in the "measurementId" field in the local Firebase config. [${rt==null?void 0:rt.message}]`),{appId:$,measurementId:tt};throw it}const ot=Number((b=rt==null?void 0:rt.customData)===null||b===void 0?void 0:b.httpStatus)===503?calculateBackoffMillis(a,g.intervalMillis,LONG_RETRY_FACTOR):calculateBackoffMillis(a,g.intervalMillis),lt={throttleEndTimeMillis:Date.now()+ot,backoffCount:a+1};return g.setThrottleMetadata($,lt),logger.debug(`Calling attemptFetch again in ${ot} millis`),attemptFetchDynamicConfigWithRetry(s,lt,d,g)}}function setAbortableTimeout(s,i){return new Promise((a,d)=>{const g=Math.max(i-Date.now(),0),b=setTimeout(a,g);s.addEventListener(()=>{clearTimeout(b),d(ERROR_FACTORY.create("fetch-throttle",{throttleEndTimeMillis:i}))})})}function isRetriableError(s){if(!(s instanceof FirebaseError)||!s.customData)return!1;const i=Number(s.customData.httpStatus);return i===429||i===500||i===503||i===504}class AnalyticsAbortSignal{constructor(){this.listeners=[]}addEventListener(i){this.listeners.push(i)}abort(){this.listeners.forEach(i=>i())}}async function logEvent$1(s,i,a,d,g){if(g&&g.global){s("event",a,d);return}else{const b=await i,$=Object.assign(Object.assign({},d),{send_to:b});s("event",a,$)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function validateIndexedDB(){if(isIndexedDBAvailable())try{await validateIndexedDBOpenable()}catch(s){return logger.warn(ERROR_FACTORY.create("indexeddb-unavailable",{errorInfo:s==null?void 0:s.toString()}).message),!1}else return logger.warn(ERROR_FACTORY.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function _initializeAnalytics(s,i,a,d,g,b,$){var tt;const it=fetchDynamicConfigWithRetry(s);it.then(pt=>{a[pt.measurementId]=pt.appId,s.options.measurementId&&pt.measurementId!==s.options.measurementId&&logger.warn(`The measurement ID in the local Firebase config (${s.options.measurementId}) does not match the measurement ID fetched from the server (${pt.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(pt=>logger.error(pt)),i.push(it);const rt=validateIndexedDB().then(pt=>{if(pt)return d.getId()}),[ot,lt]=await Promise.all([it,rt]);findGtagScriptOnPage(b)||insertScriptTag(b,ot.measurementId),g("js",new Date);const ut=(tt=$==null?void 0:$.config)!==null&&tt!==void 0?tt:{};return ut[ORIGIN_KEY]="firebase",ut.update=!0,lt!=null&&(ut[GA_FID_KEY]=lt),g("config",ot.measurementId,ut),ot.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AnalyticsService{constructor(i){this.app=i}_delete(){return delete initializationPromisesMap[this.app.options.appId],Promise.resolve()}}let initializationPromisesMap={},dynamicConfigPromisesList=[];const measurementIdToAppId={};let dataLayerName="dataLayer",gtagName="gtag",gtagCoreFunction,wrappedGtagFunction,globalInitDone=!1;function warnOnBrowserContextMismatch(){const s=[];if(isBrowserExtension()&&s.push("This is a browser extension environment."),areCookiesEnabled()||s.push("Cookies are not available."),s.length>0){const i=s.map((d,g)=>`(${g+1}) ${d}`).join(" "),a=ERROR_FACTORY.create("invalid-analytics-context",{errorInfo:i});logger.warn(a.message)}}function factory(s,i,a){warnOnBrowserContextMismatch();const d=s.options.appId;if(!d)throw ERROR_FACTORY.create("no-app-id");if(!s.options.apiKey)if(s.options.measurementId)logger.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${s.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ERROR_FACTORY.create("no-api-key");if(initializationPromisesMap[d]!=null)throw ERROR_FACTORY.create("already-exists",{id:d});if(!globalInitDone){getOrCreateDataLayer(dataLayerName);const{wrappedGtag:b,gtagCore:$}=wrapOrCreateGtag(initializationPromisesMap,dynamicConfigPromisesList,measurementIdToAppId,dataLayerName,gtagName);wrappedGtagFunction=b,gtagCoreFunction=$,globalInitDone=!0}return initializationPromisesMap[d]=_initializeAnalytics(s,dynamicConfigPromisesList,measurementIdToAppId,i,gtagCoreFunction,dataLayerName,a),new AnalyticsService(s)}function logEvent(s,i,a,d){s=getModularInstance(s),logEvent$1(wrappedGtagFunction,initializationPromisesMap[s.app.options.appId],i,a,d).catch(g=>logger.error(g))}const name="@firebase/analytics",version$5="0.10.3";function registerAnalytics(){_registerComponent(new Component(ANALYTICS_TYPE,(i,{options:a})=>{const d=i.getProvider("app").getImmediate(),g=i.getProvider("installations-internal").getImmediate();return factory(d,g,a)},"PUBLIC")),_registerComponent(new Component("analytics-internal",s,"PRIVATE")),registerVersion(name,version$5),registerVersion(name,version$5,"esm2017");function s(i){try{const a=i.getProvider(ANALYTICS_TYPE).getImmediate();return{logEvent:(d,g,b)=>logEvent(a,d,g,b)}}catch(a){throw ERROR_FACTORY.create("interop-component-reg-failed",{reason:a})}}}registerAnalytics();var firebaseConfig={apiKey:"AIzaSyBic7Ky1Znd3RMIh0XLLGG1BgXUiOwKOBA",authDomain:"sci-mcq.firebaseapp.com",databaseURL:"https://sci-mcq-default-rtdb.firebaseio.com",projectId:"sci-mcq",storageBucket:"sci-mcq.appspot.com",messagingSenderId:"208145204531",appId:"1:208145204531:web:a9286fd532dad7f9f96a46"};const app=initializeApp(firebaseConfig);getAuth();const db=getDatabase(app);var IDX=256,HEX=[],SIZE=256,BUFFER;for(;IDX--;)HEX[IDX]=(IDX+256).toString(16).substring(1);function uid(s){var i=0,a=11;if(!BUFFER||IDX+a>SIZE*2)for(BUFFER="",IDX=0;i<SIZE;i++)BUFFER+=HEX[Math.random()*256|0];return BUFFER.substring(IDX,IDX+++a)}const scriptRel="modulepreload",assetsURL=function(s){return"/"+s},seen={},__vitePreload=function s(i,a,d){let g=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const b=document.querySelector("meta[property=csp-nonce]"),$=(b==null?void 0:b.nonce)||(b==null?void 0:b.getAttribute("nonce"));g=Promise.all(a.map(tt=>{if(tt=assetsURL(tt),tt in seen)return;seen[tt]=!0;const it=tt.endsWith(".css"),rt=it?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${tt}"]${rt}`))return;const ot=document.createElement("link");if(ot.rel=it?"stylesheet":scriptRel,it||(ot.as="script",ot.crossOrigin=""),ot.href=tt,$&&ot.setAttribute("nonce",$),document.head.appendChild(ot),it)return new Promise((lt,ut)=>{ot.addEventListener("load",lt),ot.addEventListener("error",()=>ut(new Error(`Unable to preload CSS for ${tt}`)))})}))}return g.then(()=>i()).catch(b=>{const $=new Event("vite:preloadError",{cancelable:!0});if($.payload=b,window.dispatchEvent($),!$.defaultPrevented)throw b})},resolveFetch$3=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...a)=>__vitePreload(()=>Promise.resolve().then(()=>browser$1),void 0).then(({default:d})=>d(...a)):i=fetch,(...a)=>i(...a)};class FunctionsError extends Error{constructor(i,a="FunctionsError",d){super(i),this.name=a,this.context=d}}class FunctionsFetchError extends FunctionsError{constructor(i){super("Failed to send a request to the Edge Function","FunctionsFetchError",i)}}class FunctionsRelayError extends FunctionsError{constructor(i){super("Relay Error invoking the Edge Function","FunctionsRelayError",i)}}class FunctionsHttpError extends FunctionsError{constructor(i){super("Edge Function returned a non-2xx status code","FunctionsHttpError",i)}}var FunctionRegion;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(FunctionRegion||(FunctionRegion={}));var __awaiter$6=function(s,i,a,d){function g(b){return b instanceof a?b:new a(function($){$(b)})}return new(a||(a=Promise))(function(b,$){function tt(ot){try{rt(d.next(ot))}catch(lt){$(lt)}}function it(ot){try{rt(d.throw(ot))}catch(lt){$(lt)}}function rt(ot){ot.done?b(ot.value):g(ot.value).then(tt,it)}rt((d=d.apply(s,i||[])).next())})};class FunctionsClient{constructor(i,{headers:a={},customFetch:d,region:g=FunctionRegion.Any}={}){this.url=i,this.headers=a,this.region=g,this.fetch=resolveFetch$3(d)}setAuth(i){this.headers.Authorization=`Bearer ${i}`}invoke(i,a={}){var d;return __awaiter$6(this,void 0,void 0,function*(){try{const{headers:g,method:b,body:$}=a;let tt={},{region:it}=a;it||(it=this.region),it&&it!=="any"&&(tt["x-region"]=it);let rt;$&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)&&(typeof Blob<"u"&&$ instanceof Blob||$ instanceof ArrayBuffer?(tt["Content-Type"]="application/octet-stream",rt=$):typeof $=="string"?(tt["Content-Type"]="text/plain",rt=$):typeof FormData<"u"&&$ instanceof FormData?rt=$:(tt["Content-Type"]="application/json",rt=JSON.stringify($)));const ot=yield this.fetch(`${this.url}/${i}`,{method:b||"POST",headers:Object.assign(Object.assign(Object.assign({},tt),this.headers),g),body:rt}).catch(_t=>{throw new FunctionsFetchError(_t)}),lt=ot.headers.get("x-relay-error");if(lt&&lt==="true")throw new FunctionsRelayError(ot);if(!ot.ok)throw new FunctionsHttpError(ot);let ut=((d=ot.headers.get("Content-Type"))!==null&&d!==void 0?d:"text/plain").split(";")[0].trim(),pt;return ut==="application/json"?pt=yield ot.json():ut==="application/octet-stream"?pt=yield ot.blob():ut==="text/event-stream"?pt=ot:ut==="multipart/form-data"?pt=yield ot.formData():pt=yield ot.text(),{data:pt,error:null}}catch(g){return{data:null,error:g}}})}}var getGlobal=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},globalObject=getGlobal();const fetch$1=globalObject.fetch,nodeFetch=globalObject.fetch.bind(globalObject),Headers$1=globalObject.Headers,Request=globalObject.Request,Response$1=globalObject.Response,browser$1=Object.freeze(Object.defineProperty({__proto__:null,Headers:Headers$1,Request,Response:Response$1,default:nodeFetch,fetch:fetch$1},Symbol.toStringTag,{value:"Module"}));class PostgrestError extends Error{constructor(i){super(i.message),this.name="PostgrestError",this.details=i.details,this.hint=i.hint,this.code=i.code}}class PostgrestBuilder{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=nodeFetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(i,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const d=this.fetch;let g=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async b=>{var $,tt,it;let rt=null,ot=null,lt=null,ut=b.status,pt=b.statusText;if(b.ok){if(this.method!=="HEAD"){const ht=await b.text();ht===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?ot=ht:ot=JSON.parse(ht))}const wt=($=this.headers.Prefer)===null||$===void 0?void 0:$.match(/count=(exact|planned|estimated)/),vt=(tt=b.headers.get("content-range"))===null||tt===void 0?void 0:tt.split("/");wt&&vt&&vt.length>1&&(lt=parseInt(vt[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(ot)&&(ot.length>1?(rt={code:"PGRST116",details:`Results contain ${ot.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},ot=null,lt=null,ut=406,pt="Not Acceptable"):ot.length===1?ot=ot[0]:ot=null)}else{const wt=await b.text();try{rt=JSON.parse(wt),Array.isArray(rt)&&b.status===404&&(ot=[],rt=null,ut=200,pt="OK")}catch{b.status===404&&wt===""?(ut=204,pt="No Content"):rt={message:wt}}if(rt&&this.isMaybeSingle&&(!((it=rt==null?void 0:rt.details)===null||it===void 0)&&it.includes("0 rows"))&&(rt=null,ut=200,pt="OK"),rt&&this.shouldThrowOnError)throw new PostgrestError(rt)}return{error:rt,data:ot,count:lt,status:ut,statusText:pt}});return this.shouldThrowOnError||(g=g.catch(b=>{var $,tt,it;return{error:{message:`${($=b==null?void 0:b.name)!==null&&$!==void 0?$:"FetchError"}: ${b==null?void 0:b.message}`,details:`${(tt=b==null?void 0:b.stack)!==null&&tt!==void 0?tt:""}`,hint:"",code:`${(it=b==null?void 0:b.code)!==null&&it!==void 0?it:""}`},data:null,count:null,status:0,statusText:""}})),g.then(i,a)}}class PostgrestTransformBuilder extends PostgrestBuilder{select(i){let a=!1;const d=(i??"*").split("").map(g=>/\s/.test(g)&&!a?"":(g==='"'&&(a=!a),g)).join("");return this.url.searchParams.set("select",d),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(i,{ascending:a=!0,nullsFirst:d,foreignTable:g,referencedTable:b=g}={}){const $=b?`${b}.order`:"order",tt=this.url.searchParams.get($);return this.url.searchParams.set($,`${tt?`${tt},`:""}${i}.${a?"asc":"desc"}${d===void 0?"":d?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:a,referencedTable:d=a}={}){const g=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(g,`${i}`),this}range(i,a,{foreignTable:d,referencedTable:g=d}={}){const b=typeof g>"u"?"offset":`${g}.offset`,$=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(b,`${i}`),this.url.searchParams.set($,`${a-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:i=!1,verbose:a=!1,settings:d=!1,buffers:g=!1,wal:b=!1,format:$="text"}={}){var tt;const it=[i?"analyze":null,a?"verbose":null,d?"settings":null,g?"buffers":null,b?"wal":null].filter(Boolean).join("|"),rt=(tt=this.headers.Accept)!==null&&tt!==void 0?tt:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${$}; for="${rt}"; options=${it};`,$==="json"?this:this}rollback(){var i;return((i=this.headers.Prefer)!==null&&i!==void 0?i:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class PostgrestFilterBuilder extends PostgrestTransformBuilder{eq(i,a){return this.url.searchParams.append(i,`eq.${a}`),this}neq(i,a){return this.url.searchParams.append(i,`neq.${a}`),this}gt(i,a){return this.url.searchParams.append(i,`gt.${a}`),this}gte(i,a){return this.url.searchParams.append(i,`gte.${a}`),this}lt(i,a){return this.url.searchParams.append(i,`lt.${a}`),this}lte(i,a){return this.url.searchParams.append(i,`lte.${a}`),this}like(i,a){return this.url.searchParams.append(i,`like.${a}`),this}likeAllOf(i,a){return this.url.searchParams.append(i,`like(all).{${a.join(",")}}`),this}likeAnyOf(i,a){return this.url.searchParams.append(i,`like(any).{${a.join(",")}}`),this}ilike(i,a){return this.url.searchParams.append(i,`ilike.${a}`),this}ilikeAllOf(i,a){return this.url.searchParams.append(i,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(i,a){return this.url.searchParams.append(i,`ilike(any).{${a.join(",")}}`),this}is(i,a){return this.url.searchParams.append(i,`is.${a}`),this}in(i,a){const d=Array.from(new Set(a)).map(g=>typeof g=="string"&&new RegExp("[,()]").test(g)?`"${g}"`:`${g}`).join(",");return this.url.searchParams.append(i,`in.(${d})`),this}contains(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cs.{${a.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(a)}`),this}containedBy(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cd.{${a.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(a)}`),this}rangeGt(i,a){return this.url.searchParams.append(i,`sr.${a}`),this}rangeGte(i,a){return this.url.searchParams.append(i,`nxl.${a}`),this}rangeLt(i,a){return this.url.searchParams.append(i,`sl.${a}`),this}rangeLte(i,a){return this.url.searchParams.append(i,`nxr.${a}`),this}rangeAdjacent(i,a){return this.url.searchParams.append(i,`adj.${a}`),this}overlaps(i,a){return typeof a=="string"?this.url.searchParams.append(i,`ov.${a}`):this.url.searchParams.append(i,`ov.{${a.join(",")}}`),this}textSearch(i,a,{config:d,type:g}={}){let b="";g==="plain"?b="pl":g==="phrase"?b="ph":g==="websearch"&&(b="w");const $=d===void 0?"":`(${d})`;return this.url.searchParams.append(i,`${b}fts${$}.${a}`),this}match(i){return Object.entries(i).forEach(([a,d])=>{this.url.searchParams.append(a,`eq.${d}`)}),this}not(i,a,d){return this.url.searchParams.append(i,`not.${a}.${d}`),this}or(i,{foreignTable:a,referencedTable:d=a}={}){const g=d?`${d}.or`:"or";return this.url.searchParams.append(g,`(${i})`),this}filter(i,a,d){return this.url.searchParams.append(i,`${a}.${d}`),this}}class PostgrestQueryBuilder{constructor(i,{headers:a={},schema:d,fetch:g}){this.url=i,this.headers=a,this.schema=d,this.fetch=g}select(i,{head:a=!1,count:d}={}){const g=a?"HEAD":"GET";let b=!1;const $=(i??"*").split("").map(tt=>/\s/.test(tt)&&!b?"":(tt==='"'&&(b=!b),tt)).join("");return this.url.searchParams.set("select",$),d&&(this.headers.Prefer=`count=${d}`),new PostgrestFilterBuilder({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(i,{count:a,defaultToNull:d=!0}={}){const g="POST",b=[];if(this.headers.Prefer&&b.push(this.headers.Prefer),a&&b.push(`count=${a}`),d||b.push("missing=default"),this.headers.Prefer=b.join(","),Array.isArray(i)){const $=i.reduce((tt,it)=>tt.concat(Object.keys(it)),[]);if($.length>0){const tt=[...new Set($)].map(it=>`"${it}"`);this.url.searchParams.set("columns",tt.join(","))}}return new PostgrestFilterBuilder({method:g,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}upsert(i,{onConflict:a,ignoreDuplicates:d=!1,count:g,defaultToNull:b=!0}={}){const $="POST",tt=[`resolution=${d?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&tt.push(this.headers.Prefer),g&&tt.push(`count=${g}`),b||tt.push("missing=default"),this.headers.Prefer=tt.join(","),Array.isArray(i)){const it=i.reduce((rt,ot)=>rt.concat(Object.keys(ot)),[]);if(it.length>0){const rt=[...new Set(it)].map(ot=>`"${ot}"`);this.url.searchParams.set("columns",rt.join(","))}}return new PostgrestFilterBuilder({method:$,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}update(i,{count:a}={}){const d="PATCH",g=[];return this.headers.Prefer&&g.push(this.headers.Prefer),a&&g.push(`count=${a}`),this.headers.Prefer=g.join(","),new PostgrestFilterBuilder({method:d,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}delete({count:i}={}){const a="DELETE",d=[];return i&&d.push(`count=${i}`),this.headers.Prefer&&d.unshift(this.headers.Prefer),this.headers.Prefer=d.join(","),new PostgrestFilterBuilder({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const version$4="1.15.2",DEFAULT_HEADERS$4={"X-Client-Info":`postgrest-js/${version$4}`};class PostgrestClient{constructor(i,{headers:a={},schema:d,fetch:g}={}){this.url=i,this.headers=Object.assign(Object.assign({},DEFAULT_HEADERS$4),a),this.schemaName=d,this.fetch=g}from(i){const a=new URL(`${this.url}/${i}`);return new PostgrestQueryBuilder(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new PostgrestClient(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,a={},{head:d=!1,get:g=!1,count:b}={}){let $;const tt=new URL(`${this.url}/rpc/${i}`);let it;d||g?($=d?"HEAD":"GET",Object.entries(a).filter(([ot,lt])=>lt!==void 0).map(([ot,lt])=>[ot,Array.isArray(lt)?`{${lt.join(",")}}`:`${lt}`]).forEach(([ot,lt])=>{tt.searchParams.append(ot,lt)})):($="POST",it=a);const rt=Object.assign({},this.headers);return b&&(rt.Prefer=`count=${b}`),new PostgrestFilterBuilder({method:$,url:tt,headers:rt,schema:this.schemaName,body:it,fetch:this.fetch,allowEmpty:!1})}}const version$3="2.9.5",DEFAULT_HEADERS$3={"X-Client-Info":`realtime-js/${version$3}`},VSN="1.0.0",DEFAULT_TIMEOUT=1e4,WS_CLOSE_NORMAL=1e3;var SOCKET_STATES;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(SOCKET_STATES||(SOCKET_STATES={}));var CHANNEL_STATES;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(CHANNEL_STATES||(CHANNEL_STATES={}));var CHANNEL_EVENTS;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(CHANNEL_EVENTS||(CHANNEL_EVENTS={}));var TRANSPORTS;(function(s){s.websocket="websocket"})(TRANSPORTS||(TRANSPORTS={}));var CONNECTION_STATE;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(CONNECTION_STATE||(CONNECTION_STATE={}));class Timer{constructor(i,a){this.callback=i,this.timerCalc=a,this.timer=void 0,this.tries=0,this.callback=i,this.timerCalc=a}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Serializer{constructor(){this.HEADER_LENGTH=1}decode(i,a){return i.constructor===ArrayBuffer?a(this._binaryDecode(i)):a(typeof i=="string"?JSON.parse(i):{})}_binaryDecode(i){const a=new DataView(i),d=new TextDecoder;return this._decodeBroadcast(i,a,d)}_decodeBroadcast(i,a,d){const g=a.getUint8(1),b=a.getUint8(2);let $=this.HEADER_LENGTH+2;const tt=d.decode(i.slice($,$+g));$=$+g;const it=d.decode(i.slice($,$+b));$=$+b;const rt=JSON.parse(d.decode(i.slice($,i.byteLength)));return{ref:null,topic:tt,event:it,payload:rt}}}class Push{constructor(i,a,d={},g=DEFAULT_TIMEOUT){this.channel=i,this.event=a,this.payload=d,this.timeout=g,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(i){this.timeout=i,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(i){this.payload=Object.assign(Object.assign({},this.payload),i)}receive(i,a){var d;return this._hasReceived(i)&&a((d=this.receivedResp)===null||d===void 0?void 0:d.response),this.recHooks.push({status:i,callback:a}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const i=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},i),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(i,a){this.refEvent&&this.channel._trigger(this.refEvent,{status:i,response:a})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:i,response:a}){this.recHooks.filter(d=>d.status===i).forEach(d=>d.callback(a))}_hasReceived(i){return this.receivedResp&&this.receivedResp.status===i}}var REALTIME_PRESENCE_LISTEN_EVENTS;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(REALTIME_PRESENCE_LISTEN_EVENTS||(REALTIME_PRESENCE_LISTEN_EVENTS={}));class RealtimePresence{constructor(i,a){this.channel=i,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const d=(a==null?void 0:a.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(d.state,{},g=>{const{onJoin:b,onLeave:$,onSync:tt}=this.caller;this.joinRef=this.channel._joinRef(),this.state=RealtimePresence.syncState(this.state,g,b,$),this.pendingDiffs.forEach(it=>{this.state=RealtimePresence.syncDiff(this.state,it,b,$)}),this.pendingDiffs=[],tt()}),this.channel._on(d.diff,{},g=>{const{onJoin:b,onLeave:$,onSync:tt}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(g):(this.state=RealtimePresence.syncDiff(this.state,g,b,$),tt())}),this.onJoin((g,b,$)=>{this.channel._trigger("presence",{event:"join",key:g,currentPresences:b,newPresences:$})}),this.onLeave((g,b,$)=>{this.channel._trigger("presence",{event:"leave",key:g,currentPresences:b,leftPresences:$})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(i,a,d,g){const b=this.cloneDeep(i),$=this.transformState(a),tt={},it={};return this.map(b,(rt,ot)=>{$[rt]||(it[rt]=ot)}),this.map($,(rt,ot)=>{const lt=b[rt];if(lt){const ut=ot.map(vt=>vt.presence_ref),pt=lt.map(vt=>vt.presence_ref),_t=ot.filter(vt=>pt.indexOf(vt.presence_ref)<0),wt=lt.filter(vt=>ut.indexOf(vt.presence_ref)<0);_t.length>0&&(tt[rt]=_t),wt.length>0&&(it[rt]=wt)}else tt[rt]=ot}),this.syncDiff(b,{joins:tt,leaves:it},d,g)}static syncDiff(i,a,d,g){const{joins:b,leaves:$}={joins:this.transformState(a.joins),leaves:this.transformState(a.leaves)};return d||(d=()=>{}),g||(g=()=>{}),this.map(b,(tt,it)=>{var rt;const ot=(rt=i[tt])!==null&&rt!==void 0?rt:[];if(i[tt]=this.cloneDeep(it),ot.length>0){const lt=i[tt].map(pt=>pt.presence_ref),ut=ot.filter(pt=>lt.indexOf(pt.presence_ref)<0);i[tt].unshift(...ut)}d(tt,ot,it)}),this.map($,(tt,it)=>{let rt=i[tt];if(!rt)return;const ot=it.map(lt=>lt.presence_ref);rt=rt.filter(lt=>ot.indexOf(lt.presence_ref)<0),i[tt]=rt,g(tt,rt,it),rt.length===0&&delete i[tt]}),i}static map(i,a){return Object.getOwnPropertyNames(i).map(d=>a(d,i[d]))}static transformState(i){return i=this.cloneDeep(i),Object.getOwnPropertyNames(i).reduce((a,d)=>{const g=i[d];return"metas"in g?a[d]=g.metas.map(b=>(b.presence_ref=b.phx_ref,delete b.phx_ref,delete b.phx_ref_prev,b)):a[d]=g,a},{})}static cloneDeep(i){return JSON.parse(JSON.stringify(i))}onJoin(i){this.caller.onJoin=i}onLeave(i){this.caller.onLeave=i}onSync(i){this.caller.onSync=i}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var PostgresTypes;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(PostgresTypes||(PostgresTypes={}));const convertChangeData=(s,i,a={})=>{var d;const g=(d=a.skipTypes)!==null&&d!==void 0?d:[];return Object.keys(i).reduce((b,$)=>(b[$]=convertColumn($,s,i,g),b),{})},convertColumn=(s,i,a,d)=>{const g=i.find(tt=>tt.name===s),b=g==null?void 0:g.type,$=a[s];return b&&!d.includes(b)?convertCell(b,$):noop$1($)},convertCell=(s,i)=>{if(s.charAt(0)==="_"){const a=s.slice(1,s.length);return toArray(i,a)}switch(s){case PostgresTypes.bool:return toBoolean(i);case PostgresTypes.float4:case PostgresTypes.float8:case PostgresTypes.int2:case PostgresTypes.int4:case PostgresTypes.int8:case PostgresTypes.numeric:case PostgresTypes.oid:return toNumber(i);case PostgresTypes.json:case PostgresTypes.jsonb:return toJson(i);case PostgresTypes.timestamp:return toTimestampString(i);case PostgresTypes.abstime:case PostgresTypes.date:case PostgresTypes.daterange:case PostgresTypes.int4range:case PostgresTypes.int8range:case PostgresTypes.money:case PostgresTypes.reltime:case PostgresTypes.text:case PostgresTypes.time:case PostgresTypes.timestamptz:case PostgresTypes.timetz:case PostgresTypes.tsrange:case PostgresTypes.tstzrange:return noop$1(i);default:return noop$1(i)}},noop$1=s=>s,toBoolean=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},toNumber=s=>{if(typeof s=="string"){const i=parseFloat(s);if(!Number.isNaN(i))return i}return s},toJson=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(i){return console.log(`JSON parse error: ${i}`),s}return s},toArray=(s,i)=>{if(typeof s!="string")return s;const a=s.length-1,d=s[a];if(s[0]==="{"&&d==="}"){let b;const $=s.slice(1,a);try{b=JSON.parse("["+$+"]")}catch{b=$?$.split(","):[]}return b.map(tt=>convertCell(i,tt))}return s},toTimestampString=s=>typeof s=="string"?s.replace(" ","T"):s;var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT||(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT={}));var REALTIME_LISTEN_TYPES;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes"})(REALTIME_LISTEN_TYPES||(REALTIME_LISTEN_TYPES={}));var REALTIME_SUBSCRIBE_STATES;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(REALTIME_SUBSCRIBE_STATES||(REALTIME_SUBSCRIBE_STATES={}));class RealtimeChannel{constructor(i,a={config:{}},d){this.topic=i,this.params=a,this.socket=d,this.bindings={},this.state=CHANNEL_STATES.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=i.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},a.config),this.timeout=this.socket.timeout,this.joinPush=new Push(this,CHANNEL_EVENTS.join,this.params,this.timeout),this.rejoinTimer=new Timer(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=CHANNEL_STATES.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(g=>g.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=CHANNEL_STATES.closed,this.socket._remove(this)}),this._onError(g=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,g),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this._on(CHANNEL_EVENTS.reply,{},(g,b)=>{this._trigger(this._replyEventName(b),g)}),this.presence=new RealtimePresence(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(i,a=this.timeout){var d,g;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:b,presence:$}}=this.params;this._onError(rt=>i&&i("CHANNEL_ERROR",rt)),this._onClose(()=>i&&i("CLOSED"));const tt={},it={broadcast:b,presence:$,postgres_changes:(g=(d=this.bindings.postgres_changes)===null||d===void 0?void 0:d.map(rt=>rt.filter))!==null&&g!==void 0?g:[]};this.socket.accessToken&&(tt.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:it},tt)),this.joinedOnce=!0,this._rejoin(a),this.joinPush.receive("ok",({postgres_changes:rt})=>{var ot;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),rt===void 0){i&&i("SUBSCRIBED");return}else{const lt=this.bindings.postgres_changes,ut=(ot=lt==null?void 0:lt.length)!==null&&ot!==void 0?ot:0,pt=[];for(let _t=0;_t<ut;_t++){const wt=lt[_t],{filter:{event:vt,schema:ht,table:ft,filter:mt}}=wt,bt=rt&&rt[_t];if(bt&&bt.event===vt&&bt.schema===ht&&bt.table===ft&&bt.filter===mt)pt.push(Object.assign(Object.assign({},wt),{id:bt.id}));else{this.unsubscribe(),i&&i("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=pt,i&&i("SUBSCRIBED");return}}).receive("error",rt=>{i&&i("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(rt).join(", ")||"error")))}).receive("timeout",()=>{i&&i("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(i,a={}){return await this.send({type:"presence",event:"track",payload:i},a.timeout||this.timeout)}async untrack(i={}){return await this.send({type:"presence",event:"untrack"},i)}on(i,a,d){return this._on(i,a,d)}async send(i,a={}){var d,g;if(!this._canPush()&&i.type==="broadcast"){const{event:b,payload:$}=i,tt={method:"POST",headers:{apikey:(d=this.socket.apiKey)!==null&&d!==void 0?d:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:b,payload:$}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,tt,(g=a.timeout)!==null&&g!==void 0?g:this.timeout)).ok?"ok":"error"}catch(it){return it.name==="AbortError"?"timed out":"error"}}else return new Promise(b=>{var $,tt,it;const rt=this._push(i.type,i,a.timeout||this.timeout);i.type==="broadcast"&&!(!((it=(tt=($=this.params)===null||$===void 0?void 0:$.config)===null||tt===void 0?void 0:tt.broadcast)===null||it===void 0)&&it.ack)&&b("ok"),rt.receive("ok",()=>b("ok")),rt.receive("error",()=>b("error")),rt.receive("timeout",()=>b("timed out"))})}updateJoinPayload(i){this.joinPush.updatePayload(i)}unsubscribe(i=this.timeout){this.state=CHANNEL_STATES.leaving;const a=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(CHANNEL_EVENTS.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(d=>{const g=new Push(this,CHANNEL_EVENTS.leave,{},i);g.receive("ok",()=>{a(),d("ok")}).receive("timeout",()=>{a(),d("timed out")}).receive("error",()=>{d("error")}),g.send(),this._canPush()||g.trigger("ok",{})})}_broadcastEndpointURL(){let i=this.socket.endPoint;return i=i.replace(/^ws/i,"http"),i=i.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),i.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(i,a,d){const g=new AbortController,b=setTimeout(()=>g.abort(),d),$=await this.socket.fetch(i,Object.assign(Object.assign({},a),{signal:g.signal}));return clearTimeout(b),$}_push(i,a,d=this.timeout){if(!this.joinedOnce)throw`tried to push '${i}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let g=new Push(this,i,a,d);return this._canPush()?g.send():(g.startTimeout(),this.pushBuffer.push(g)),g}_onMessage(i,a,d){return a}_isMember(i){return this.topic===i}_joinRef(){return this.joinPush.ref}_trigger(i,a,d){var g,b;const $=i.toLocaleLowerCase(),{close:tt,error:it,leave:rt,join:ot}=CHANNEL_EVENTS;if(d&&[tt,it,rt,ot].indexOf($)>=0&&d!==this._joinRef())return;let ut=this._onMessage($,a,d);if(a&&!ut)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes($)?(g=this.bindings.postgres_changes)===null||g===void 0||g.filter(pt=>{var _t,wt,vt;return((_t=pt.filter)===null||_t===void 0?void 0:_t.event)==="*"||((vt=(wt=pt.filter)===null||wt===void 0?void 0:wt.event)===null||vt===void 0?void 0:vt.toLocaleLowerCase())===$}).map(pt=>pt.callback(ut,d)):(b=this.bindings[$])===null||b===void 0||b.filter(pt=>{var _t,wt,vt,ht,ft,mt;if(["broadcast","presence","postgres_changes"].includes($))if("id"in pt){const bt=pt.id,Et=(_t=pt.filter)===null||_t===void 0?void 0:_t.event;return bt&&((wt=a.ids)===null||wt===void 0?void 0:wt.includes(bt))&&(Et==="*"||(Et==null?void 0:Et.toLocaleLowerCase())===((vt=a.data)===null||vt===void 0?void 0:vt.type.toLocaleLowerCase()))}else{const bt=(ft=(ht=pt==null?void 0:pt.filter)===null||ht===void 0?void 0:ht.event)===null||ft===void 0?void 0:ft.toLocaleLowerCase();return bt==="*"||bt===((mt=a==null?void 0:a.event)===null||mt===void 0?void 0:mt.toLocaleLowerCase())}else return pt.type.toLocaleLowerCase()===$}).map(pt=>{if(typeof ut=="object"&&"ids"in ut){const _t=ut.data,{schema:wt,table:vt,commit_timestamp:ht,type:ft,errors:mt}=_t;ut=Object.assign(Object.assign({},{schema:wt,table:vt,commit_timestamp:ht,eventType:ft,new:{},old:{},errors:mt}),this._getPayloadRecords(_t))}pt.callback(ut,d)})}_isClosed(){return this.state===CHANNEL_STATES.closed}_isJoined(){return this.state===CHANNEL_STATES.joined}_isJoining(){return this.state===CHANNEL_STATES.joining}_isLeaving(){return this.state===CHANNEL_STATES.leaving}_replyEventName(i){return`chan_reply_${i}`}_on(i,a,d){const g=i.toLocaleLowerCase(),b={type:g,filter:a,callback:d};return this.bindings[g]?this.bindings[g].push(b):this.bindings[g]=[b],this}_off(i,a){const d=i.toLocaleLowerCase();return this.bindings[d]=this.bindings[d].filter(g=>{var b;return!(((b=g.type)===null||b===void 0?void 0:b.toLocaleLowerCase())===d&&RealtimeChannel.isEqual(g.filter,a))}),this}static isEqual(i,a){if(Object.keys(i).length!==Object.keys(a).length)return!1;for(const d in i)if(i[d]!==a[d])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(i){this._on(CHANNEL_EVENTS.close,{},i)}_onError(i){this._on(CHANNEL_EVENTS.error,{},a=>i(a))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(i=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=CHANNEL_STATES.joining,this.joinPush.resend(i))}_getPayloadRecords(i){const a={new:{},old:{}};return(i.type==="INSERT"||i.type==="UPDATE")&&(a.new=convertChangeData(i.columns,i.record)),(i.type==="UPDATE"||i.type==="DELETE")&&(a.old=convertChangeData(i.columns,i.old_record)),a}}const noop=()=>{},NATIVE_WEBSOCKET_AVAILABLE=typeof WebSocket<"u";class RealtimeClient{constructor(i,a){var d;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=DEFAULT_HEADERS$3,this.params={},this.timeout=DEFAULT_TIMEOUT,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=noop,this.conn=null,this.sendBuffer=[],this.serializer=new Serializer,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=b=>{let $;return b?$=b:typeof fetch>"u"?$=(...tt)=>__vitePreload(()=>Promise.resolve().then(()=>browser$1),void 0).then(({default:it})=>it(...tt)):$=fetch,(...tt)=>$(...tt)},this.endPoint=`${i}/${TRANSPORTS.websocket}`,a!=null&&a.transport?this.transport=a.transport:this.transport=null,a!=null&&a.params&&(this.params=a.params),a!=null&&a.headers&&(this.headers=Object.assign(Object.assign({},this.headers),a.headers)),a!=null&&a.timeout&&(this.timeout=a.timeout),a!=null&&a.logger&&(this.logger=a.logger),a!=null&&a.heartbeatIntervalMs&&(this.heartbeatIntervalMs=a.heartbeatIntervalMs);const g=(d=a==null?void 0:a.params)===null||d===void 0?void 0:d.apikey;g&&(this.accessToken=g,this.apiKey=g),this.reconnectAfterMs=a!=null&&a.reconnectAfterMs?a.reconnectAfterMs:b=>[1e3,2e3,5e3,1e4][b-1]||1e4,this.encode=a!=null&&a.encode?a.encode:(b,$)=>$(JSON.stringify(b)),this.decode=a!=null&&a.decode?a.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Timer(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(a==null?void 0:a.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(NATIVE_WEBSOCKET_AVAILABLE){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new WSWebSocketDummy(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),__vitePreload(()=>import("./browser-DxE3tW_V.js").then(i=>i.b),[]).then(({default:i})=>{this.conn=new i(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(i,a){this.conn&&(this.conn.onclose=function(){},i?this.conn.close(i,a??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(i){const a=await i.unsubscribe();return this.channels.length===0&&this.disconnect(),a}async removeAllChannels(){const i=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.disconnect(),i}log(i,a,d){this.logger(i,a,d)}connectionState(){switch(this.conn&&this.conn.readyState){case SOCKET_STATES.connecting:return CONNECTION_STATE.Connecting;case SOCKET_STATES.open:return CONNECTION_STATE.Open;case SOCKET_STATES.closing:return CONNECTION_STATE.Closing;default:return CONNECTION_STATE.Closed}}isConnected(){return this.connectionState()===CONNECTION_STATE.Open}channel(i,a={config:{}}){const d=new RealtimeChannel(`realtime:${i}`,a,this);return this.channels.push(d),d}push(i){const{topic:a,event:d,payload:g,ref:b}=i,$=()=>{this.encode(i,tt=>{var it;(it=this.conn)===null||it===void 0||it.send(tt)})};this.log("push",`${a} ${d} (${b})`,g),this.isConnected()?$():this.sendBuffer.push($)}setAuth(i){this.accessToken=i,this.channels.forEach(a=>{i&&a.updateJoinPayload({access_token:i}),a.joinedOnce&&a._isJoined()&&a._push(CHANNEL_EVENTS.access_token,{access_token:i})})}_makeRef(){let i=this.ref+1;return i===this.ref?this.ref=0:this.ref=i,this.ref.toString()}_leaveOpenTopic(i){let a=this.channels.find(d=>d.topic===i&&(d._isJoined()||d._isJoining()));a&&(this.log("transport",`leaving duplicate topic "${i}"`),a.unsubscribe())}_remove(i){this.channels=this.channels.filter(a=>a._joinRef()!==i._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=i=>this._onConnError(i),this.conn.onmessage=i=>this._onConnMessage(i),this.conn.onclose=i=>this._onConnClose(i))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:VSN}))}_onConnMessage(i){this.decode(i.data,a=>{let{topic:d,event:g,payload:b,ref:$}=a;($&&$===this.pendingHeartbeatRef||g===(b==null?void 0:b.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${b.status||""} ${d} ${g} ${$&&"("+$+")"||""}`,b),this.channels.filter(tt=>tt._isMember(d)).forEach(tt=>tt._trigger(g,b,$)),this.stateChangeCallbacks.message.forEach(tt=>tt(a))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(i=>i())}_onConnClose(i){this.log("transport","close",i),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(a=>a(i))}_onConnError(i){this.log("transport",i.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(a=>a(i))}_triggerChanError(){this.channels.forEach(i=>i._trigger(CHANNEL_EVENTS.error))}_appendParams(i,a){if(Object.keys(a).length===0)return i;const d=i.match(/\?/)?"&":"?",g=new URLSearchParams(a);return`${i}${d}${g}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(i=>i()),this.sendBuffer=[])}_sendHeartbeat(){var i;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(i=this.conn)===null||i===void 0||i.close(WS_CLOSE_NORMAL,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class WSWebSocketDummy{constructor(i,a,d){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=SOCKET_STATES.connecting,this.send=()=>{},this.url=null,this.url=i,this.close=d.close}}class StorageError extends Error{constructor(i){super(i),this.__isStorageError=!0,this.name="StorageError"}}function isStorageError(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class StorageApiError extends StorageError{constructor(i,a){super(i),this.name="StorageApiError",this.status=a}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class StorageUnknownError extends StorageError{constructor(i,a){super(i),this.name="StorageUnknownError",this.originalError=a}}var __awaiter$5=function(s,i,a,d){function g(b){return b instanceof a?b:new a(function($){$(b)})}return new(a||(a=Promise))(function(b,$){function tt(ot){try{rt(d.next(ot))}catch(lt){$(lt)}}function it(ot){try{rt(d.throw(ot))}catch(lt){$(lt)}}function rt(ot){ot.done?b(ot.value):g(ot.value).then(tt,it)}rt((d=d.apply(s,i||[])).next())})};const resolveFetch$2=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...a)=>__vitePreload(()=>Promise.resolve().then(()=>browser$1),void 0).then(({default:d})=>d(...a)):i=fetch,(...a)=>i(...a)},resolveResponse=()=>__awaiter$5(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield __vitePreload(()=>Promise.resolve().then(()=>browser$1),void 0)).Response:Response});var __awaiter$4=function(s,i,a,d){function g(b){return b instanceof a?b:new a(function($){$(b)})}return new(a||(a=Promise))(function(b,$){function tt(ot){try{rt(d.next(ot))}catch(lt){$(lt)}}function it(ot){try{rt(d.throw(ot))}catch(lt){$(lt)}}function rt(ot){ot.done?b(ot.value):g(ot.value).then(tt,it)}rt((d=d.apply(s,i||[])).next())})};const _getErrorMessage$1=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),handleError$1=(s,i)=>__awaiter$4(void 0,void 0,void 0,function*(){const a=yield resolveResponse();s instanceof a?s.json().then(d=>{i(new StorageApiError(_getErrorMessage$1(d),s.status||500))}).catch(d=>{i(new StorageUnknownError(_getErrorMessage$1(d),d))}):i(new StorageUnknownError(_getErrorMessage$1(s),s))}),_getRequestParams$1=(s,i,a,d)=>{const g={method:s,headers:(i==null?void 0:i.headers)||{}};return s==="GET"?g:(g.headers=Object.assign({"Content-Type":"application/json"},i==null?void 0:i.headers),g.body=JSON.stringify(d),Object.assign(Object.assign({},g),a))};function _handleRequest$1(s,i,a,d,g,b){return __awaiter$4(this,void 0,void 0,function*(){return new Promise(($,tt)=>{s(a,_getRequestParams$1(i,d,g,b)).then(it=>{if(!it.ok)throw it;return d!=null&&d.noResolveJson?it:it.json()}).then(it=>$(it)).catch(it=>handleError$1(it,tt))})})}function get(s,i,a,d){return __awaiter$4(this,void 0,void 0,function*(){return _handleRequest$1(s,"GET",i,a,d)})}function post(s,i,a,d,g){return __awaiter$4(this,void 0,void 0,function*(){return _handleRequest$1(s,"POST",i,d,g,a)})}function put(s,i,a,d,g){return __awaiter$4(this,void 0,void 0,function*(){return _handleRequest$1(s,"PUT",i,d,g,a)})}function remove(s,i,a,d,g){return __awaiter$4(this,void 0,void 0,function*(){return _handleRequest$1(s,"DELETE",i,d,g,a)})}var __awaiter$3=function(s,i,a,d){function g(b){return b instanceof a?b:new a(function($){$(b)})}return new(a||(a=Promise))(function(b,$){function tt(ot){try{rt(d.next(ot))}catch(lt){$(lt)}}function it(ot){try{rt(d.throw(ot))}catch(lt){$(lt)}}function rt(ot){ot.done?b(ot.value):g(ot.value).then(tt,it)}rt((d=d.apply(s,i||[])).next())})};const DEFAULT_SEARCH_OPTIONS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},DEFAULT_FILE_OPTIONS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class StorageFileApi{constructor(i,a={},d,g){this.url=i,this.headers=a,this.bucketId=d,this.fetch=resolveFetch$2(g)}uploadOrUpdate(i,a,d,g){return __awaiter$3(this,void 0,void 0,function*(){try{let b;const $=Object.assign(Object.assign({},DEFAULT_FILE_OPTIONS),g),tt=Object.assign(Object.assign({},this.headers),i==="POST"&&{"x-upsert":String($.upsert)});typeof Blob<"u"&&d instanceof Blob?(b=new FormData,b.append("cacheControl",$.cacheControl),b.append("",d)):typeof FormData<"u"&&d instanceof FormData?(b=d,b.append("cacheControl",$.cacheControl)):(b=d,tt["cache-control"]=`max-age=${$.cacheControl}`,tt["content-type"]=$.contentType);const it=this._removeEmptyFolders(a),rt=this._getFinalPath(it),ot=yield this.fetch(`${this.url}/object/${rt}`,Object.assign({method:i,body:b,headers:tt},$!=null&&$.duplex?{duplex:$.duplex}:{})),lt=yield ot.json();return ot.ok?{data:{path:it,id:lt.Id,fullPath:lt.Key},error:null}:{data:null,error:lt}}catch(b){if(isStorageError(b))return{data:null,error:b};throw b}})}upload(i,a,d){return __awaiter$3(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",i,a,d)})}uploadToSignedUrl(i,a,d,g){return __awaiter$3(this,void 0,void 0,function*(){const b=this._removeEmptyFolders(i),$=this._getFinalPath(b),tt=new URL(this.url+`/object/upload/sign/${$}`);tt.searchParams.set("token",a);try{let it;const rt=Object.assign({upsert:DEFAULT_FILE_OPTIONS.upsert},g),ot=Object.assign(Object.assign({},this.headers),{"x-upsert":String(rt.upsert)});typeof Blob<"u"&&d instanceof Blob?(it=new FormData,it.append("cacheControl",rt.cacheControl),it.append("",d)):typeof FormData<"u"&&d instanceof FormData?(it=d,it.append("cacheControl",rt.cacheControl)):(it=d,ot["cache-control"]=`max-age=${rt.cacheControl}`,ot["content-type"]=rt.contentType);const lt=yield this.fetch(tt.toString(),{method:"PUT",body:it,headers:ot}),ut=yield lt.json();return lt.ok?{data:{path:b,fullPath:ut.Key},error:null}:{data:null,error:ut}}catch(it){if(isStorageError(it))return{data:null,error:it};throw it}})}createSignedUploadUrl(i){return __awaiter$3(this,void 0,void 0,function*(){try{let a=this._getFinalPath(i);const d=yield post(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:this.headers}),g=new URL(this.url+d.url),b=g.searchParams.get("token");if(!b)throw new StorageError("No token returned by API");return{data:{signedUrl:g.toString(),path:i,token:b},error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}update(i,a,d){return __awaiter$3(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",i,a,d)})}move(i,a){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:i,destinationKey:a},{headers:this.headers}),error:null}}catch(d){if(isStorageError(d))return{data:null,error:d};throw d}})}copy(i,a){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:{path:(yield post(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:i,destinationKey:a},{headers:this.headers})).Key},error:null}}catch(d){if(isStorageError(d))return{data:null,error:d};throw d}})}createSignedUrl(i,a,d){return __awaiter$3(this,void 0,void 0,function*(){try{let g=this._getFinalPath(i),b=yield post(this.fetch,`${this.url}/object/sign/${g}`,Object.assign({expiresIn:a},d!=null&&d.transform?{transform:d.transform}:{}),{headers:this.headers});const $=d!=null&&d.download?`&download=${d.download===!0?"":d.download}`:"";return b={signedUrl:encodeURI(`${this.url}${b.signedURL}${$}`)},{data:b,error:null}}catch(g){if(isStorageError(g))return{data:null,error:g};throw g}})}createSignedUrls(i,a,d){return __awaiter$3(this,void 0,void 0,function*(){try{const g=yield post(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:a,paths:i},{headers:this.headers}),b=d!=null&&d.download?`&download=${d.download===!0?"":d.download}`:"";return{data:g.map($=>Object.assign(Object.assign({},$),{signedUrl:$.signedURL?encodeURI(`${this.url}${$.signedURL}${b}`):null})),error:null}}catch(g){if(isStorageError(g))return{data:null,error:g};throw g}})}download(i,a){return __awaiter$3(this,void 0,void 0,function*(){const g=typeof(a==null?void 0:a.transform)<"u"?"render/image/authenticated":"object",b=this.transformOptsToQueryString((a==null?void 0:a.transform)||{}),$=b?`?${b}`:"";try{const tt=this._getFinalPath(i);return{data:yield(yield get(this.fetch,`${this.url}/${g}/${tt}${$}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(tt){if(isStorageError(tt))return{data:null,error:tt};throw tt}})}getPublicUrl(i,a){const d=this._getFinalPath(i),g=[],b=a!=null&&a.download?`download=${a.download===!0?"":a.download}`:"";b!==""&&g.push(b);const tt=typeof(a==null?void 0:a.transform)<"u"?"render/image":"object",it=this.transformOptsToQueryString((a==null?void 0:a.transform)||{});it!==""&&g.push(it);let rt=g.join("&");return rt!==""&&(rt=`?${rt}`),{data:{publicUrl:encodeURI(`${this.url}/${tt}/public/${d}${rt}`)}}}remove(i){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:i},{headers:this.headers}),error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}list(i,a,d){return __awaiter$3(this,void 0,void 0,function*(){try{const g=Object.assign(Object.assign(Object.assign({},DEFAULT_SEARCH_OPTIONS),a),{prefix:i||""});return{data:yield post(this.fetch,`${this.url}/object/list/${this.bucketId}`,g,{headers:this.headers},d),error:null}}catch(g){if(isStorageError(g))return{data:null,error:g};throw g}})}_getFinalPath(i){return`${this.bucketId}/${i}`}_removeEmptyFolders(i){return i.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(i){const a=[];return i.width&&a.push(`width=${i.width}`),i.height&&a.push(`height=${i.height}`),i.resize&&a.push(`resize=${i.resize}`),i.format&&a.push(`format=${i.format}`),i.quality&&a.push(`quality=${i.quality}`),a.join("&")}}const version$2="2.5.5",DEFAULT_HEADERS$2={"X-Client-Info":`storage-js/${version$2}`};var __awaiter$2=function(s,i,a,d){function g(b){return b instanceof a?b:new a(function($){$(b)})}return new(a||(a=Promise))(function(b,$){function tt(ot){try{rt(d.next(ot))}catch(lt){$(lt)}}function it(ot){try{rt(d.throw(ot))}catch(lt){$(lt)}}function rt(ot){ot.done?b(ot.value):g(ot.value).then(tt,it)}rt((d=d.apply(s,i||[])).next())})};class StorageBucketApi{constructor(i,a={},d){this.url=i,this.headers=Object.assign(Object.assign({},DEFAULT_HEADERS$2),a),this.fetch=resolveFetch$2(d)}listBuckets(){return __awaiter$2(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}getBucket(i){return __awaiter$2(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket/${i}`,{headers:this.headers}),error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}createBucket(i,a={public:!1}){return __awaiter$2(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket`,{id:i,name:i,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(d){if(isStorageError(d))return{data:null,error:d};throw d}})}updateBucket(i,a){return __awaiter$2(this,void 0,void 0,function*(){try{return{data:yield put(this.fetch,`${this.url}/bucket/${i}`,{id:i,name:i,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(d){if(isStorageError(d))return{data:null,error:d};throw d}})}emptyBucket(i){return __awaiter$2(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket/${i}/empty`,{},{headers:this.headers}),error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}deleteBucket(i){return __awaiter$2(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/bucket/${i}`,{},{headers:this.headers}),error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}}class StorageClient extends StorageBucketApi{constructor(i,a={},d){super(i,a,d)}from(i){return new StorageFileApi(this.url,this.headers,i,this.fetch)}}const version$1="2.43.2";let JS_ENV="";typeof Deno<"u"?JS_ENV="deno":typeof document<"u"?JS_ENV="web":typeof navigator<"u"&&navigator.product==="ReactNative"?JS_ENV="react-native":JS_ENV="node";const DEFAULT_HEADERS$1={"X-Client-Info":`supabase-js-${JS_ENV}/${version$1}`},DEFAULT_GLOBAL_OPTIONS={headers:DEFAULT_HEADERS$1},DEFAULT_DB_OPTIONS={schema:"public"},DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DEFAULT_REALTIME_OPTIONS={};var __awaiter$1=function(s,i,a,d){function g(b){return b instanceof a?b:new a(function($){$(b)})}return new(a||(a=Promise))(function(b,$){function tt(ot){try{rt(d.next(ot))}catch(lt){$(lt)}}function it(ot){try{rt(d.throw(ot))}catch(lt){$(lt)}}function rt(ot){ot.done?b(ot.value):g(ot.value).then(tt,it)}rt((d=d.apply(s,i||[])).next())})};const resolveFetch$1=s=>{let i;return s?i=s:typeof fetch>"u"?i=nodeFetch:i=fetch,(...a)=>i(...a)},resolveHeadersConstructor=()=>typeof Headers>"u"?Headers$1:Headers,fetchWithAuth=(s,i,a)=>{const d=resolveFetch$1(a),g=resolveHeadersConstructor();return(b,$)=>__awaiter$1(void 0,void 0,void 0,function*(){var tt;const it=(tt=yield i())!==null&&tt!==void 0?tt:s;let rt=new g($==null?void 0:$.headers);return rt.has("apikey")||rt.set("apikey",s),rt.has("Authorization")||rt.set("Authorization",`Bearer ${it}`),d(b,Object.assign(Object.assign({},$),{headers:rt}))})};function stripTrailingSlash(s){return s.replace(/\/$/,"")}function applySettingDefaults(s,i){const{db:a,auth:d,realtime:g,global:b}=s,{db:$,auth:tt,realtime:it,global:rt}=i;return{db:Object.assign(Object.assign({},$),a),auth:Object.assign(Object.assign({},tt),d),realtime:Object.assign(Object.assign({},it),g),global:Object.assign(Object.assign({},rt),b)}}const version="2.64.2",GOTRUE_URL="http://localhost:9999",STORAGE_KEY="supabase.auth.token",DEFAULT_HEADERS={"X-Client-Info":`gotrue-js/${version}`},EXPIRY_MARGIN=10,API_VERSION_HEADER_NAME="X-Supabase-Api-Version",API_VERSIONS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function expiresAt(s){return Math.round(Date.now()/1e3)+s}function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const i=Math.random()*16|0;return(s=="x"?i:i&3|8).toString(16)})}const isBrowser=()=>typeof document<"u",localStorageWriteTests={tested:!1,writable:!1},supportsLocalStorage=()=>{if(!isBrowser())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(localStorageWriteTests.tested)return localStorageWriteTests.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!0}catch{localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!1}return localStorageWriteTests.writable};function parseParametersFromURL(s){const i={},a=new URL(s);if(a.hash&&a.hash[0]==="#")try{new URLSearchParams(a.hash.substring(1)).forEach((g,b)=>{i[b]=g})}catch{}return a.searchParams.forEach((d,g)=>{i[g]=d}),i}const resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...a)=>__vitePreload(()=>Promise.resolve().then(()=>browser$1),void 0).then(({default:d})=>d(...a)):i=fetch,(...a)=>i(...a)},looksLikeFetchResponse=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",setItemAsync=async(s,i,a)=>{await s.setItem(i,JSON.stringify(a))},getItemAsync=async(s,i)=>{const a=await s.getItem(i);if(!a)return null;try{return JSON.parse(a)}catch{return a}},removeItemAsync=async(s,i)=>{await s.removeItem(i)};function decodeBase64URL(s){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let a="",d,g,b,$,tt,it,rt,ot=0;for(s=s.replace("-","+").replace("_","/");ot<s.length;)$=i.indexOf(s.charAt(ot++)),tt=i.indexOf(s.charAt(ot++)),it=i.indexOf(s.charAt(ot++)),rt=i.indexOf(s.charAt(ot++)),d=$<<2|tt>>4,g=(tt&15)<<4|it>>2,b=(it&3)<<6|rt,a=a+String.fromCharCode(d),it!=64&&g!=0&&(a=a+String.fromCharCode(g)),rt!=64&&b!=0&&(a=a+String.fromCharCode(b));return a}class Deferred{constructor(){this.promise=new Deferred.promiseConstructor((i,a)=>{this.resolve=i,this.reject=a})}}Deferred.promiseConstructor=Promise;function decodeJWTPayload(s){const i=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,a=s.split(".");if(a.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!i.test(a[1]))throw new Error("JWT is not valid: payload is not in base64url format");const d=a[1];return JSON.parse(decodeBase64URL(d))}async function sleep(s){return await new Promise(i=>{setTimeout(()=>i(null),s)})}function retryable(s,i){return new Promise((d,g)=>{(async()=>{for(let b=0;b<1/0;b++)try{const $=await s(b);if(!i(b,null,$)){d($);return}}catch($){if(!i(b,$)){g($);return}}})()})}function dec2hex(s){return("0"+s.toString(16)).substr(-2)}function generatePKCEVerifier(){const i=new Uint32Array(56);if(typeof crypto>"u"){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",d=a.length;let g="";for(let b=0;b<56;b++)g+=a.charAt(Math.floor(Math.random()*d));return g}return crypto.getRandomValues(i),Array.from(i,dec2hex).join("")}async function sha256(s){const a=new TextEncoder().encode(s),d=await crypto.subtle.digest("SHA-256",a),g=new Uint8Array(d);return Array.from(g).map(b=>String.fromCharCode(b)).join("")}function base64urlencode(s){return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function generatePKCEChallenge(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const a=await sha256(s);return base64urlencode(a)}async function getCodeChallengeAndMethod(s,i,a=!1){const d=generatePKCEVerifier();let g=d;a&&(g+="/PASSWORD_RECOVERY"),await setItemAsync(s,`${i}-code-verifier`,g);const b=await generatePKCEChallenge(d);return[b,d===b?"plain":"s256"]}const API_VERSION_REGEX=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function parseResponseAPIVersion(s){const i=s.headers.get(API_VERSION_HEADER_NAME);if(!i||!i.match(API_VERSION_REGEX))return null;try{return new Date(`${i}T00:00:00.0Z`)}catch{return null}}class AuthError extends Error{constructor(i,a,d){super(i),this.__isAuthError=!0,this.name="AuthError",this.status=a,this.code=d}}function isAuthError(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class AuthApiError extends AuthError{constructor(i,a,d){super(i,a,d),this.name="AuthApiError",this.status=a,this.code=d}}function isAuthApiError(s){return isAuthError(s)&&s.name==="AuthApiError"}class AuthUnknownError extends AuthError{constructor(i,a){super(i),this.name="AuthUnknownError",this.originalError=a}}class CustomAuthError extends AuthError{constructor(i,a,d,g){super(i,d,g),this.name=a,this.status=d}}class AuthSessionMissingError extends CustomAuthError{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class AuthInvalidTokenResponseError extends CustomAuthError{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class AuthInvalidCredentialsError extends CustomAuthError{constructor(i){super(i,"AuthInvalidCredentialsError",400,void 0)}}class AuthImplicitGrantRedirectError extends CustomAuthError{constructor(i,a=null){super(i,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthPKCEGrantCodeExchangeError extends CustomAuthError{constructor(i,a=null){super(i,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthRetryableFetchError extends CustomAuthError{constructor(i,a){super(i,"AuthRetryableFetchError",a,void 0)}}function isAuthRetryableFetchError(s){return isAuthError(s)&&s.name==="AuthRetryableFetchError"}class AuthWeakPasswordError extends CustomAuthError{constructor(i,a,d){super(i,"AuthWeakPasswordError",a,"weak_password"),this.reasons=d}}var __rest$1=function(s,i){var a={};for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&i.indexOf(d)<0&&(a[d]=s[d]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,d=Object.getOwnPropertySymbols(s);g<d.length;g++)i.indexOf(d[g])<0&&Object.prototype.propertyIsEnumerable.call(s,d[g])&&(a[d[g]]=s[d[g]]);return a};const _getErrorMessage=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),NETWORK_ERROR_CODES=[502,503,504];async function handleError(s){var i;if(!looksLikeFetchResponse(s))throw new AuthRetryableFetchError(_getErrorMessage(s),0);if(NETWORK_ERROR_CODES.includes(s.status))throw new AuthRetryableFetchError(_getErrorMessage(s),s.status);let a;try{a=await s.json()}catch(b){throw new AuthUnknownError(_getErrorMessage(b),b)}let d;const g=parseResponseAPIVersion(s);if(g&&g.getTime()>=API_VERSIONS["2024-01-01"].timestamp&&typeof a=="object"&&a&&typeof a.code=="string"?d=a.code:typeof a=="object"&&a&&typeof a.error_code=="string"&&(d=a.error_code),d){if(d==="weak_password")throw new AuthWeakPasswordError(_getErrorMessage(a),s.status,((i=a.weak_password)===null||i===void 0?void 0:i.reasons)||[])}else if(typeof a=="object"&&a&&typeof a.weak_password=="object"&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce((b,$)=>b&&typeof $=="string",!0))throw new AuthWeakPasswordError(_getErrorMessage(a),s.status,a.weak_password.reasons);throw new AuthApiError(_getErrorMessage(a),s.status||500,d)}const _getRequestParams=(s,i,a,d)=>{const g={method:s,headers:(i==null?void 0:i.headers)||{}};return s==="GET"?g:(g.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},i==null?void 0:i.headers),g.body=JSON.stringify(d),Object.assign(Object.assign({},g),a))};async function _request(s,i,a,d){var g;const b=Object.assign({},d==null?void 0:d.headers);b[API_VERSION_HEADER_NAME]||(b[API_VERSION_HEADER_NAME]=API_VERSIONS["2024-01-01"].name),d!=null&&d.jwt&&(b.Authorization=`Bearer ${d.jwt}`);const $=(g=d==null?void 0:d.query)!==null&&g!==void 0?g:{};d!=null&&d.redirectTo&&($.redirect_to=d.redirectTo);const tt=Object.keys($).length?"?"+new URLSearchParams($).toString():"",it=await _handleRequest(s,i,a+tt,{headers:b,noResolveJson:d==null?void 0:d.noResolveJson},{},d==null?void 0:d.body);return d!=null&&d.xform?d==null?void 0:d.xform(it):{data:Object.assign({},it),error:null}}async function _handleRequest(s,i,a,d,g,b){const $=_getRequestParams(i,d,g,b);let tt;try{tt=await s(a,Object.assign({},$))}catch(it){throw console.error(it),new AuthRetryableFetchError(_getErrorMessage(it),0)}if(tt.ok||await handleError(tt),d!=null&&d.noResolveJson)return tt;try{return await tt.json()}catch(it){await handleError(it)}}function _sessionResponse(s){var i;let a=null;hasSession(s)&&(a=Object.assign({},s),s.expires_at||(a.expires_at=expiresAt(s.expires_in)));const d=(i=s.user)!==null&&i!==void 0?i:s;return{data:{session:a,user:d},error:null}}function _sessionResponsePassword(s){const i=_sessionResponse(s);return!i.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((a,d)=>a&&typeof d=="string",!0)&&(i.data.weak_password=s.weak_password),i}function _userResponse(s){var i;return{data:{user:(i=s.user)!==null&&i!==void 0?i:s},error:null}}function _ssoResponse(s){return{data:s,error:null}}function _generateLinkResponse(s){const{action_link:i,email_otp:a,hashed_token:d,redirect_to:g,verification_type:b}=s,$=__rest$1(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),tt={action_link:i,email_otp:a,hashed_token:d,redirect_to:g,verification_type:b},it=Object.assign({},$);return{data:{properties:tt,user:it},error:null}}function _noResolveJsonResponse(s){return s}function hasSession(s){return s.access_token&&s.refresh_token&&s.expires_in}var __rest=function(s,i){var a={};for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&i.indexOf(d)<0&&(a[d]=s[d]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,d=Object.getOwnPropertySymbols(s);g<d.length;g++)i.indexOf(d[g])<0&&Object.prototype.propertyIsEnumerable.call(s,d[g])&&(a[d[g]]=s[d[g]]);return a};class GoTrueAdminApi{constructor({url:i="",headers:a={},fetch:d}){this.url=i,this.headers=a,this.fetch=resolveFetch(d),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(i,a="global"){try{return await _request(this.fetch,"POST",`${this.url}/logout?scope=${a}`,{headers:this.headers,jwt:i,noResolveJson:!0}),{data:null,error:null}}catch(d){if(isAuthError(d))return{data:null,error:d};throw d}}async inviteUserByEmail(i,a={}){try{return await _request(this.fetch,"POST",`${this.url}/invite`,{body:{email:i,data:a.data},headers:this.headers,redirectTo:a.redirectTo,xform:_userResponse})}catch(d){if(isAuthError(d))return{data:{user:null},error:d};throw d}}async generateLink(i){try{const{options:a}=i,d=__rest(i,["options"]),g=Object.assign(Object.assign({},d),a);return"newEmail"in d&&(g.new_email=d==null?void 0:d.newEmail,delete g.newEmail),await _request(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:g,headers:this.headers,xform:_generateLinkResponse,redirectTo:a==null?void 0:a.redirectTo})}catch(a){if(isAuthError(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(i){try{return await _request(this.fetch,"POST",`${this.url}/admin/users`,{body:i,headers:this.headers,xform:_userResponse})}catch(a){if(isAuthError(a))return{data:{user:null},error:a};throw a}}async listUsers(i){var a,d,g,b,$,tt,it;try{const rt={nextPage:null,lastPage:0,total:0},ot=await _request(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(d=(a=i==null?void 0:i.page)===null||a===void 0?void 0:a.toString())!==null&&d!==void 0?d:"",per_page:(b=(g=i==null?void 0:i.perPage)===null||g===void 0?void 0:g.toString())!==null&&b!==void 0?b:""},xform:_noResolveJsonResponse});if(ot.error)throw ot.error;const lt=await ot.json(),ut=($=ot.headers.get("x-total-count"))!==null&&$!==void 0?$:0,pt=(it=(tt=ot.headers.get("link"))===null||tt===void 0?void 0:tt.split(","))!==null&&it!==void 0?it:[];return pt.length>0&&(pt.forEach(_t=>{const wt=parseInt(_t.split(";")[0].split("=")[1].substring(0,1)),vt=JSON.parse(_t.split(";")[1].split("=")[1]);rt[`${vt}Page`]=wt}),rt.total=parseInt(ut)),{data:Object.assign(Object.assign({},lt),rt),error:null}}catch(rt){if(isAuthError(rt))return{data:{users:[]},error:rt};throw rt}}async getUserById(i){try{return await _request(this.fetch,"GET",`${this.url}/admin/users/${i}`,{headers:this.headers,xform:_userResponse})}catch(a){if(isAuthError(a))return{data:{user:null},error:a};throw a}}async updateUserById(i,a){try{return await _request(this.fetch,"PUT",`${this.url}/admin/users/${i}`,{body:a,headers:this.headers,xform:_userResponse})}catch(d){if(isAuthError(d))return{data:{user:null},error:d};throw d}}async deleteUser(i,a=!1){try{return await _request(this.fetch,"DELETE",`${this.url}/admin/users/${i}`,{headers:this.headers,body:{should_soft_delete:a},xform:_userResponse})}catch(d){if(isAuthError(d))return{data:{user:null},error:d};throw d}}async _listFactors(i){try{const{data:a,error:d}=await _request(this.fetch,"GET",`${this.url}/admin/users/${i.userId}/factors`,{headers:this.headers,xform:g=>({data:{factors:g},error:null})});return{data:a,error:d}}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}async _deleteFactor(i){try{return{data:await _request(this.fetch,"DELETE",`${this.url}/admin/users/${i.userId}/factors/${i.id}`,{headers:this.headers}),error:null}}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}}const localStorageAdapter={getItem:s=>supportsLocalStorage()?globalThis.localStorage.getItem(s):null,setItem:(s,i)=>{supportsLocalStorage()&&globalThis.localStorage.setItem(s,i)},removeItem:s=>{supportsLocalStorage()&&globalThis.localStorage.removeItem(s)}};function memoryLocalStorageAdapter(s={}){return{getItem:i=>s[i]||null,setItem:(i,a)=>{s[i]=a},removeItem:i=>{delete s[i]}}}function polyfillGlobalThis(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const internals={debug:!!(globalThis&&supportsLocalStorage()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class LockAcquireTimeoutError extends Error{constructor(i){super(i),this.isAcquireTimeout=!0}}class NavigatorLockAcquireTimeoutError extends LockAcquireTimeoutError{}async function navigatorLock(s,i,a){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,i);const d=new globalThis.AbortController;return i>0&&setTimeout(()=>{d.abort(),internals.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},i),await globalThis.navigator.locks.request(s,i===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:d.signal},async g=>{if(g){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,g.name);try{return await a()}finally{internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,g.name)}}else{if(i===0)throw internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new NavigatorLockAcquireTimeoutError(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(internals.debug)try{const b=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(b,null,"  "))}catch(b){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",b)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await a()}})}polyfillGlobalThis();const DEFAULT_OPTIONS={url:GOTRUE_URL,storageKey:STORAGE_KEY,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:DEFAULT_HEADERS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},AUTO_REFRESH_TICK_DURATION=30*1e3,AUTO_REFRESH_TICK_THRESHOLD=3;async function lockNoOp(s,i,a){return await a()}class GoTrueClient{constructor(i){var a,d;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=GoTrueClient.nextInstanceID,GoTrueClient.nextInstanceID+=1,this.instanceID>0&&isBrowser()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const g=Object.assign(Object.assign({},DEFAULT_OPTIONS),i);if(this.logDebugMessages=!!g.debug,typeof g.debug=="function"&&(this.logger=g.debug),this.persistSession=g.persistSession,this.storageKey=g.storageKey,this.autoRefreshToken=g.autoRefreshToken,this.admin=new GoTrueAdminApi({url:g.url,headers:g.headers,fetch:g.fetch}),this.url=g.url,this.headers=g.headers,this.fetch=resolveFetch(g.fetch),this.lock=g.lock||lockNoOp,this.detectSessionInUrl=g.detectSessionInUrl,this.flowType=g.flowType,this.hasCustomAuthorizationHeader=g.hasCustomAuthorizationHeader,g.lock?this.lock=g.lock:isBrowser()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=navigatorLock:this.lock=lockNoOp,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?g.storage?this.storage=g.storage:supportsLocalStorage()?this.storage=localStorageAdapter:(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)):(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),isBrowser()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(b){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",b)}(d=this.broadcastChannel)===null||d===void 0||d.addEventListener("message",async b=>{this._debug("received broadcast notification from other tab or client",b),await this._notifyAllSubscribers(b.data.event,b.data.session,!1)})}this.initialize()}_debug(...i){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${version}) ${new Date().toISOString()}`,...i),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const i=isBrowser()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",i),i||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:a,error:d}=await this._getSessionFromURL(i);if(d)return this._debug("#_initialize()","error detecting session from URL",d),(d==null?void 0:d.message)==="Identity is already linked"||(d==null?void 0:d.message)==="Identity is already linked to another user"?{error:d}:(await this._removeSession(),{error:d});const{session:g,redirectType:b}=a;return this._debug("#_initialize()","detected session in URL",g,"redirect type",b),await this._saveSession(g),setTimeout(async()=>{b==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",g):await this._notifyAllSubscribers("SIGNED_IN",g)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(i){return isAuthError(i)?{error:i}:{error:new AuthUnknownError("Unexpected error during initialization",i)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(i){var a,d,g;try{await this._removeSession();const b=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(d=(a=i==null?void 0:i.options)===null||a===void 0?void 0:a.data)!==null&&d!==void 0?d:{},gotrue_meta_security:{captcha_token:(g=i==null?void 0:i.options)===null||g===void 0?void 0:g.captchaToken}},xform:_sessionResponse}),{data:$,error:tt}=b;if(tt||!$)return{data:{user:null,session:null},error:tt};const it=$.session,rt=$.user;return $.session&&(await this._saveSession($.session),await this._notifyAllSubscribers("SIGNED_IN",it)),{data:{user:rt,session:it},error:null}}catch(b){if(isAuthError(b))return{data:{user:null,session:null},error:b};throw b}}async signUp(i){var a,d,g;try{await this._removeSession();let b;if("email"in i){const{email:ot,password:lt,options:ut}=i;let pt=null,_t=null;this.flowType==="pkce"&&([pt,_t]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),b=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:ut==null?void 0:ut.emailRedirectTo,body:{email:ot,password:lt,data:(a=ut==null?void 0:ut.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:ut==null?void 0:ut.captchaToken},code_challenge:pt,code_challenge_method:_t},xform:_sessionResponse})}else if("phone"in i){const{phone:ot,password:lt,options:ut}=i;b=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:ot,password:lt,data:(d=ut==null?void 0:ut.data)!==null&&d!==void 0?d:{},channel:(g=ut==null?void 0:ut.channel)!==null&&g!==void 0?g:"sms",gotrue_meta_security:{captcha_token:ut==null?void 0:ut.captchaToken}},xform:_sessionResponse})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:$,error:tt}=b;if(tt||!$)return{data:{user:null,session:null},error:tt};const it=$.session,rt=$.user;return $.session&&(await this._saveSession($.session),await this._notifyAllSubscribers("SIGNED_IN",it)),{data:{user:rt,session:it},error:null}}catch(b){if(isAuthError(b))return{data:{user:null,session:null},error:b};throw b}}async signInWithPassword(i){try{await this._removeSession();let a;if("email"in i){const{email:b,password:$,options:tt}=i;a=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:b,password:$,gotrue_meta_security:{captcha_token:tt==null?void 0:tt.captchaToken}},xform:_sessionResponsePassword})}else if("phone"in i){const{phone:b,password:$,options:tt}=i;a=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:b,password:$,gotrue_meta_security:{captcha_token:tt==null?void 0:tt.captchaToken}},xform:_sessionResponsePassword})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:d,error:g}=a;return g?{data:{user:null,session:null},error:g}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:Object.assign({user:d.user,session:d.session},d.weak_password?{weakPassword:d.weak_password}:null),error:g})}catch(a){if(isAuthError(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOAuth(i){var a,d,g,b;return await this._removeSession(),await this._handleProviderSignIn(i.provider,{redirectTo:(a=i.options)===null||a===void 0?void 0:a.redirectTo,scopes:(d=i.options)===null||d===void 0?void 0:d.scopes,queryParams:(g=i.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:(b=i.options)===null||b===void 0?void 0:b.skipBrowserRedirect})}async exchangeCodeForSession(i){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(i))}async _exchangeCodeForSession(i){const a=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`),[d,g]=(a??"").split("/"),{data:b,error:$}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:i,code_verifier:d},xform:_sessionResponse});return await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),$?{data:{user:null,session:null,redirectType:null},error:$}:!b||!b.session||!b.user?{data:{user:null,session:null,redirectType:null},error:new AuthInvalidTokenResponseError}:(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign(Object.assign({},b),{redirectType:g??null}),error:$})}async signInWithIdToken(i){await this._removeSession();try{const{options:a,provider:d,token:g,access_token:b,nonce:$}=i,tt=await _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:d,id_token:g,access_token:b,nonce:$,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:_sessionResponse}),{data:it,error:rt}=tt;return rt?{data:{user:null,session:null},error:rt}:!it||!it.session||!it.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(it.session&&(await this._saveSession(it.session),await this._notifyAllSubscribers("SIGNED_IN",it.session)),{data:it,error:rt})}catch(a){if(isAuthError(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOtp(i){var a,d,g,b,$;try{if(await this._removeSession(),"email"in i){const{email:tt,options:it}=i;let rt=null,ot=null;this.flowType==="pkce"&&([rt,ot]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{error:lt}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:tt,data:(a=it==null?void 0:it.data)!==null&&a!==void 0?a:{},create_user:(d=it==null?void 0:it.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:it==null?void 0:it.captchaToken},code_challenge:rt,code_challenge_method:ot},redirectTo:it==null?void 0:it.emailRedirectTo});return{data:{user:null,session:null},error:lt}}if("phone"in i){const{phone:tt,options:it}=i,{data:rt,error:ot}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:tt,data:(g=it==null?void 0:it.data)!==null&&g!==void 0?g:{},create_user:(b=it==null?void 0:it.shouldCreateUser)!==null&&b!==void 0?b:!0,gotrue_meta_security:{captcha_token:it==null?void 0:it.captchaToken},channel:($=it==null?void 0:it.channel)!==null&&$!==void 0?$:"sms"}});return{data:{user:null,session:null,messageId:rt==null?void 0:rt.message_id},error:ot}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number.")}catch(tt){if(isAuthError(tt))return{data:{user:null,session:null},error:tt};throw tt}}async verifyOtp(i){var a,d;try{i.type!=="email_change"&&i.type!=="phone_change"&&await this._removeSession();let g,b;"options"in i&&(g=(a=i.options)===null||a===void 0?void 0:a.redirectTo,b=(d=i.options)===null||d===void 0?void 0:d.captchaToken);const{data:$,error:tt}=await _request(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},i),{gotrue_meta_security:{captcha_token:b}}),redirectTo:g,xform:_sessionResponse});if(tt)throw tt;if(!$)throw new Error("An error occurred on token verification.");const it=$.session,rt=$.user;return it!=null&&it.access_token&&(await this._saveSession(it),await this._notifyAllSubscribers(i.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",it)),{data:{user:rt,session:it},error:null}}catch(g){if(isAuthError(g))return{data:{user:null,session:null},error:g};throw g}}async signInWithSSO(i){var a,d,g;try{await this._removeSession();let b=null,$=null;return this.flowType==="pkce"&&([b,$]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),await _request(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in i?{provider_id:i.providerId}:null),"domain"in i?{domain:i.domain}:null),{redirect_to:(d=(a=i.options)===null||a===void 0?void 0:a.redirectTo)!==null&&d!==void 0?d:void 0}),!((g=i==null?void 0:i.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:i.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:b,code_challenge_method:$}),headers:this.headers,xform:_ssoResponse})}catch(b){if(isAuthError(b))return{data:null,error:b};throw b}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async i=>{const{data:{session:a},error:d}=i;if(d)throw d;if(!a)throw new AuthSessionMissingError;const{error:g}=await _request(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:a.access_token});return{data:{user:null,session:null},error:g}})}catch(i){if(isAuthError(i))return{data:{user:null,session:null},error:i};throw i}}async resend(i){try{i.type!="email_change"&&i.type!="phone_change"&&await this._removeSession();const a=`${this.url}/resend`;if("email"in i){const{email:d,type:g,options:b}=i,{error:$}=await _request(this.fetch,"POST",a,{headers:this.headers,body:{email:d,type:g,gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken}},redirectTo:b==null?void 0:b.emailRedirectTo});return{data:{user:null,session:null},error:$}}else if("phone"in i){const{phone:d,type:g,options:b}=i,{data:$,error:tt}=await _request(this.fetch,"POST",a,{headers:this.headers,body:{phone:d,type:g,gotrue_meta_security:{captcha_token:b==null?void 0:b.captchaToken}}});return{data:{user:null,session:null,messageId:$==null?void 0:$.message_id},error:tt}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a type")}catch(a){if(isAuthError(a))return{data:{user:null,session:null},error:a};throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async a=>a))}async _acquireLock(i,a){this._debug("#_acquireLock","begin",i);try{if(this.lockAcquired){const d=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),g=(async()=>(await d,await a()))();return this.pendingInLock.push((async()=>{try{await g}catch{}})()),g}return await this.lock(`lock:${this.storageKey}`,i,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const d=a();for(this.pendingInLock.push((async()=>{try{await d}catch{}})()),await d;this.pendingInLock.length;){const g=[...this.pendingInLock];await Promise.all(g),this.pendingInLock.splice(0,g.length)}return await d}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(i){this._debug("#_useSession","begin");try{const a=await this.__loadSession();return await i(a)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let i=null;const a=await getItemAsync(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",a),a!==null&&(this._isValidSession(a)?i=a:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!i)return{data:{session:null},error:null};const d=i.expires_at?i.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${d?"":" not"} expired`,"expires_at",i.expires_at),!d){if(this.storage.isServer){const $=this.suppressGetSessionWarning;i=new Proxy(i,{get(it,rt,ot){return!$&&rt==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(it,rt,ot)}})}return{data:{session:i},error:null}}const{session:g,error:b}=await this._callRefreshToken(i.refresh_token);return b?{data:{session:null},error:b}:{data:{session:g},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(i){return i?await this._getUser(i):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(i){try{return i?await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:i,xform:_userResponse}):await this._useSession(async a=>{var d,g,b;const{data:$,error:tt}=a;if(tt)throw tt;return!(!((d=$.session)===null||d===void 0)&&d.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new AuthSessionMissingError}:await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(b=(g=$.session)===null||g===void 0?void 0:g.access_token)!==null&&b!==void 0?b:void 0,xform:_userResponse})})}catch(a){if(isAuthError(a))return{data:{user:null},error:a};throw a}}async updateUser(i,a={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(i,a))}async _updateUser(i,a={}){try{return await this._useSession(async d=>{const{data:g,error:b}=d;if(b)throw b;if(!g.session)throw new AuthSessionMissingError;const $=g.session;let tt=null,it=null;this.flowType==="pkce"&&i.email!=null&&([tt,it]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{data:rt,error:ot}=await _request(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:a==null?void 0:a.emailRedirectTo,body:Object.assign(Object.assign({},i),{code_challenge:tt,code_challenge_method:it}),jwt:$.access_token,xform:_userResponse});if(ot)throw ot;return $.user=rt.user,await this._saveSession($),await this._notifyAllSubscribers("USER_UPDATED",$),{data:{user:$.user},error:null}})}catch(d){if(isAuthError(d))return{data:{user:null},error:d};throw d}}_decodeJWT(i){return decodeJWTPayload(i)}async setSession(i){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(i))}async _setSession(i){try{if(!i.access_token||!i.refresh_token)throw new AuthSessionMissingError;const a=Date.now()/1e3;let d=a,g=!0,b=null;const $=decodeJWTPayload(i.access_token);if($.exp&&(d=$.exp,g=d<=a),g){const{session:tt,error:it}=await this._callRefreshToken(i.refresh_token);if(it)return{data:{user:null,session:null},error:it};if(!tt)return{data:{user:null,session:null},error:null};b=tt}else{const{data:tt,error:it}=await this._getUser(i.access_token);if(it)throw it;b={access_token:i.access_token,refresh_token:i.refresh_token,user:tt.user,token_type:"bearer",expires_in:d-a,expires_at:d},await this._saveSession(b),await this._notifyAllSubscribers("SIGNED_IN",b)}return{data:{user:b.user,session:b},error:null}}catch(a){if(isAuthError(a))return{data:{session:null,user:null},error:a};throw a}}async refreshSession(i){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(i))}async _refreshSession(i){try{return await this._useSession(async a=>{var d;if(!i){const{data:$,error:tt}=a;if(tt)throw tt;i=(d=$.session)!==null&&d!==void 0?d:void 0}if(!(i!=null&&i.refresh_token))throw new AuthSessionMissingError;const{session:g,error:b}=await this._callRefreshToken(i.refresh_token);return b?{data:{user:null,session:null},error:b}:g?{data:{user:g.user,session:g},error:null}:{data:{user:null,session:null},error:null}})}catch(a){if(isAuthError(a))return{data:{user:null,session:null},error:a};throw a}}async _getSessionFromURL(i){try{if(!isBrowser())throw new AuthImplicitGrantRedirectError("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new AuthImplicitGrantRedirectError("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!i)throw new AuthPKCEGrantCodeExchangeError("Not a valid PKCE flow url.");const a=parseParametersFromURL(window.location.href);if(i){if(!a.code)throw new AuthPKCEGrantCodeExchangeError("No code detected.");const{data:ft,error:mt}=await this._exchangeCodeForSession(a.code);if(mt)throw mt;const bt=new URL(window.location.href);return bt.searchParams.delete("code"),window.history.replaceState(window.history.state,"",bt.toString()),{data:{session:ft.session,redirectType:null},error:null}}if(a.error||a.error_description||a.error_code)throw new AuthImplicitGrantRedirectError(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});const{provider_token:d,provider_refresh_token:g,access_token:b,refresh_token:$,expires_in:tt,expires_at:it,token_type:rt}=a;if(!b||!tt||!$||!rt)throw new AuthImplicitGrantRedirectError("No session defined in URL");const ot=Math.round(Date.now()/1e3),lt=parseInt(tt);let ut=ot+lt;it&&(ut=parseInt(it));const pt=ut-ot;pt*1e3<=AUTO_REFRESH_TICK_DURATION&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${pt}s, should have been closer to ${lt}s`);const _t=ut-lt;ot-_t>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_t,ut,ot):ot-_t<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",_t,ut,ot);const{data:wt,error:vt}=await this._getUser(b);if(vt)throw vt;const ht={provider_token:d,provider_refresh_token:g,access_token:b,expires_in:lt,expires_at:ut,refresh_token:$,token_type:rt,user:wt.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:ht,redirectType:a.type},error:null}}catch(a){if(isAuthError(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantFlow(){const i=parseParametersFromURL(window.location.href);return!!(isBrowser()&&(i.access_token||i.error_description))}async _isPKCEFlow(){const i=parseParametersFromURL(window.location.href),a=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`);return!!(i.code&&a)}async signOut(i={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(i))}async _signOut({scope:i}={scope:"global"}){return await this._useSession(async a=>{var d;const{data:g,error:b}=a;if(b)return{error:b};const $=(d=g.session)===null||d===void 0?void 0:d.access_token;if($){const{error:tt}=await this.admin.signOut($,i);if(tt&&!(isAuthApiError(tt)&&(tt.status===404||tt.status===401||tt.status===403)))return{error:tt}}return i!=="others"&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(i){const a=uuid(),d={id:a,callback:i,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",a),this.stateChangeEmitters.delete(a)}};return this._debug("#onAuthStateChange()","registered callback with id",a),this.stateChangeEmitters.set(a,d),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(a)})))(),{data:{subscription:d}}}async _emitInitialSession(i){return await this._useSession(async a=>{var d,g;try{const{data:{session:b},error:$}=a;if($)throw $;await((d=this.stateChangeEmitters.get(i))===null||d===void 0?void 0:d.callback("INITIAL_SESSION",b)),this._debug("INITIAL_SESSION","callback id",i,"session",b)}catch(b){await((g=this.stateChangeEmitters.get(i))===null||g===void 0?void 0:g.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",i,"error",b),console.error(b)}})}async resetPasswordForEmail(i,a={}){let d=null,g=null;this.flowType==="pkce"&&([d,g]=await getCodeChallengeAndMethod(this.storage,this.storageKey,!0));try{return await _request(this.fetch,"POST",`${this.url}/recover`,{body:{email:i,code_challenge:d,code_challenge_method:g,gotrue_meta_security:{captcha_token:a.captchaToken}},headers:this.headers,redirectTo:a.redirectTo})}catch(b){if(isAuthError(b))return{data:null,error:b};throw b}}async getUserIdentities(){var i;try{const{data:a,error:d}=await this.getUser();if(d)throw d;return{data:{identities:(i=a.user.identities)!==null&&i!==void 0?i:[]},error:null}}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}async linkIdentity(i){var a;try{const{data:d,error:g}=await this._useSession(async b=>{var $,tt,it,rt,ot;const{data:lt,error:ut}=b;if(ut)throw ut;const pt=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,i.provider,{redirectTo:($=i.options)===null||$===void 0?void 0:$.redirectTo,scopes:(tt=i.options)===null||tt===void 0?void 0:tt.scopes,queryParams:(it=i.options)===null||it===void 0?void 0:it.queryParams,skipBrowserRedirect:!0});return await _request(this.fetch,"GET",pt,{headers:this.headers,jwt:(ot=(rt=lt.session)===null||rt===void 0?void 0:rt.access_token)!==null&&ot!==void 0?ot:void 0})});if(g)throw g;return isBrowser()&&!(!((a=i.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(d==null?void 0:d.url),{data:{provider:i.provider,url:d==null?void 0:d.url},error:null}}catch(d){if(isAuthError(d))return{data:{provider:i.provider,url:null},error:d};throw d}}async unlinkIdentity(i){try{return await this._useSession(async a=>{var d,g;const{data:b,error:$}=a;if($)throw $;return await _request(this.fetch,"DELETE",`${this.url}/user/identities/${i.identity_id}`,{headers:this.headers,jwt:(g=(d=b.session)===null||d===void 0?void 0:d.access_token)!==null&&g!==void 0?g:void 0})})}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}async _refreshAccessToken(i){const a=`#_refreshAccessToken(${i.substring(0,5)}...)`;this._debug(a,"begin");try{const d=Date.now();return await retryable(async g=>(g>0&&await sleep(200*Math.pow(2,g-1)),this._debug(a,"refreshing attempt",g),await _request(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:i},headers:this.headers,xform:_sessionResponse})),(g,b)=>{const $=200*Math.pow(2,g);return b&&isAuthRetryableFetchError(b)&&Date.now()+$-d<AUTO_REFRESH_TICK_DURATION})}catch(d){if(this._debug(a,"error",d),isAuthError(d))return{data:{session:null,user:null},error:d};throw d}finally{this._debug(a,"end")}}_isValidSession(i){return typeof i=="object"&&i!==null&&"access_token"in i&&"refresh_token"in i&&"expires_at"in i}async _handleProviderSignIn(i,a){const d=await this._getUrlForProvider(`${this.url}/authorize`,i,{redirectTo:a.redirectTo,scopes:a.scopes,queryParams:a.queryParams});return this._debug("#_handleProviderSignIn()","provider",i,"options",a,"url",d),isBrowser()&&!a.skipBrowserRedirect&&window.location.assign(d),{data:{provider:i,url:d},error:null}}async _recoverAndRefresh(){var i;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const d=await getItemAsync(this.storage,this.storageKey);if(this._debug(a,"session from storage",d),!this._isValidSession(d)){this._debug(a,"session is not valid"),d!==null&&await this._removeSession();return}const g=Math.round(Date.now()/1e3),b=((i=d.expires_at)!==null&&i!==void 0?i:1/0)<g+EXPIRY_MARGIN;if(this._debug(a,`session has${b?"":" not"} expired with margin of ${EXPIRY_MARGIN}s`),b){if(this.autoRefreshToken&&d.refresh_token){const{error:$}=await this._callRefreshToken(d.refresh_token);$&&(console.error($),isAuthRetryableFetchError($)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",$),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",d)}catch(d){this._debug(a,"error",d),console.error(d);return}finally{this._debug(a,"end")}}async _callRefreshToken(i){var a,d;if(!i)throw new AuthSessionMissingError;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const g=`#_callRefreshToken(${i.substring(0,5)}...)`;this._debug(g,"begin");try{this.refreshingDeferred=new Deferred;const{data:b,error:$}=await this._refreshAccessToken(i);if($)throw $;if(!b.session)throw new AuthSessionMissingError;await this._saveSession(b.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",b.session);const tt={session:b.session,error:null};return this.refreshingDeferred.resolve(tt),tt}catch(b){if(this._debug(g,"error",b),isAuthError(b)){const $={session:null,error:b};return isAuthRetryableFetchError(b)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(a=this.refreshingDeferred)===null||a===void 0||a.resolve($),$}throw(d=this.refreshingDeferred)===null||d===void 0||d.reject(b),b}finally{this.refreshingDeferred=null,this._debug(g,"end")}}async _notifyAllSubscribers(i,a,d=!0){const g=`#_notifyAllSubscribers(${i})`;this._debug(g,"begin",a,`broadcast = ${d}`);try{this.broadcastChannel&&d&&this.broadcastChannel.postMessage({event:i,session:a});const b=[],$=Array.from(this.stateChangeEmitters.values()).map(async tt=>{try{await tt.callback(i,a)}catch(it){b.push(it)}});if(await Promise.all($),b.length>0){for(let tt=0;tt<b.length;tt+=1)console.error(b[tt]);throw b[0]}}finally{this._debug(g,"end")}}async _saveSession(i){this._debug("#_saveSession()",i),this.suppressGetSessionWarning=!0,await setItemAsync(this.storage,this.storageKey,i)}async _removeSession(){this._debug("#_removeSession()"),await removeItemAsync(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const i=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{i&&isBrowser()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",i)}catch(a){console.error("removing visibilitychange callback failed",a)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const i=setInterval(()=>this._autoRefreshTokenTick(),AUTO_REFRESH_TICK_DURATION);this.autoRefreshTicker=i,i&&typeof i=="object"&&typeof i.unref=="function"?i.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(i),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const i=this.autoRefreshTicker;this.autoRefreshTicker=null,i&&clearInterval(i)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const i=Date.now();try{return await this._useSession(async a=>{const{data:{session:d}}=a;if(!d||!d.refresh_token||!d.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const g=Math.floor((d.expires_at*1e3-i)/AUTO_REFRESH_TICK_DURATION);this._debug("#_autoRefreshTokenTick()",`access token expires in ${g} ticks, a tick lasts ${AUTO_REFRESH_TICK_DURATION}ms, refresh threshold is ${AUTO_REFRESH_TICK_THRESHOLD} ticks`),g<=AUTO_REFRESH_TICK_THRESHOLD&&await this._callRefreshToken(d.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(i){if(i.isAcquireTimeout||i instanceof LockAcquireTimeoutError)this._debug("auto refresh token tick lock not available");else throw i}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!isBrowser()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(i){console.error("_handleVisibilityChange",i)}}async _onVisibilityChanged(i){const a=`#_onVisibilityChanged(${i})`;this._debug(a,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),i||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(a,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(i,a,d){const g=[`provider=${encodeURIComponent(a)}`];if(d!=null&&d.redirectTo&&g.push(`redirect_to=${encodeURIComponent(d.redirectTo)}`),d!=null&&d.scopes&&g.push(`scopes=${encodeURIComponent(d.scopes)}`),this.flowType==="pkce"){const[b,$]=await getCodeChallengeAndMethod(this.storage,this.storageKey),tt=new URLSearchParams({code_challenge:`${encodeURIComponent(b)}`,code_challenge_method:`${encodeURIComponent($)}`});g.push(tt.toString())}if(d!=null&&d.queryParams){const b=new URLSearchParams(d.queryParams);g.push(b.toString())}return d!=null&&d.skipBrowserRedirect&&g.push(`skip_http_redirect=${d.skipBrowserRedirect}`),`${i}?${g.join("&")}`}async _unenroll(i){try{return await this._useSession(async a=>{var d;const{data:g,error:b}=a;return b?{data:null,error:b}:await _request(this.fetch,"DELETE",`${this.url}/factors/${i.factorId}`,{headers:this.headers,jwt:(d=g==null?void 0:g.session)===null||d===void 0?void 0:d.access_token})})}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}async _enroll(i){try{return await this._useSession(async a=>{var d,g;const{data:b,error:$}=a;if($)return{data:null,error:$};const{data:tt,error:it}=await _request(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:i.friendlyName,factor_type:i.factorType,issuer:i.issuer},headers:this.headers,jwt:(d=b==null?void 0:b.session)===null||d===void 0?void 0:d.access_token});return it?{data:null,error:it}:(!((g=tt==null?void 0:tt.totp)===null||g===void 0)&&g.qr_code&&(tt.totp.qr_code=`data:image/svg+xml;utf-8,${tt.totp.qr_code}`),{data:tt,error:null})})}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}}async _verify(i){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var d;const{data:g,error:b}=a;if(b)return{data:null,error:b};const{data:$,error:tt}=await _request(this.fetch,"POST",`${this.url}/factors/${i.factorId}/verify`,{body:{code:i.code,challenge_id:i.challengeId},headers:this.headers,jwt:(d=g==null?void 0:g.session)===null||d===void 0?void 0:d.access_token});return tt?{data:null,error:tt}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+$.expires_in},$)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",$),{data:$,error:tt})})}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}})}async _challenge(i){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var d;const{data:g,error:b}=a;return b?{data:null,error:b}:await _request(this.fetch,"POST",`${this.url}/factors/${i.factorId}/challenge`,{headers:this.headers,jwt:(d=g==null?void 0:g.session)===null||d===void 0?void 0:d.access_token})})}catch(a){if(isAuthError(a))return{data:null,error:a};throw a}})}async _challengeAndVerify(i){const{data:a,error:d}=await this._challenge({factorId:i.factorId});return d?{data:null,error:d}:await this._verify({factorId:i.factorId,challengeId:a.id,code:i.code})}async _listFactors(){const{data:{user:i},error:a}=await this.getUser();if(a)return{data:null,error:a};const d=(i==null?void 0:i.factors)||[],g=d.filter(b=>b.factor_type==="totp"&&b.status==="verified");return{data:{all:d,totp:g},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async i=>{var a,d;const{data:{session:g},error:b}=i;if(b)return{data:null,error:b};if(!g)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const $=this._decodeJWT(g.access_token);let tt=null;$.aal&&(tt=$.aal);let it=tt;((d=(a=g.user.factors)===null||a===void 0?void 0:a.filter(lt=>lt.status==="verified"))!==null&&d!==void 0?d:[]).length>0&&(it="aal2");const ot=$.amr||[];return{data:{currentLevel:tt,nextLevel:it,currentAuthenticationMethods:ot},error:null}}))}}GoTrueClient.nextInstanceID=0;const AuthClient=GoTrueClient;class SupabaseAuthClient extends AuthClient{constructor(i){super(i)}}var __awaiter=function(s,i,a,d){function g(b){return b instanceof a?b:new a(function($){$(b)})}return new(a||(a=Promise))(function(b,$){function tt(ot){try{rt(d.next(ot))}catch(lt){$(lt)}}function it(ot){try{rt(d.throw(ot))}catch(lt){$(lt)}}function rt(ot){ot.done?b(ot.value):g(ot.value).then(tt,it)}rt((d=d.apply(s,i||[])).next())})};class SupabaseClient{constructor(i,a,d){var g,b,$,tt,it,rt,ot,lt;if(this.supabaseUrl=i,this.supabaseKey=a,!i)throw new Error("supabaseUrl is required.");if(!a)throw new Error("supabaseKey is required.");const ut=stripTrailingSlash(i);this.realtimeUrl=`${ut}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${ut}/auth/v1`,this.storageUrl=`${ut}/storage/v1`,this.functionsUrl=`${ut}/functions/v1`;const pt=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,_t={db:DEFAULT_DB_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},DEFAULT_AUTH_OPTIONS),{storageKey:pt}),global:DEFAULT_GLOBAL_OPTIONS},wt=applySettingDefaults(d??{},_t);this.storageKey=(b=(g=wt.auth)===null||g===void 0?void 0:g.storageKey)!==null&&b!==void 0?b:"",this.headers=(tt=($=wt.global)===null||$===void 0?void 0:$.headers)!==null&&tt!==void 0?tt:{},this.auth=this._initSupabaseAuthClient((it=wt.auth)!==null&&it!==void 0?it:{},this.headers,(rt=wt.global)===null||rt===void 0?void 0:rt.fetch),this.fetch=fetchWithAuth(a,this._getAccessToken.bind(this),(ot=wt.global)===null||ot===void 0?void 0:ot.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},wt.realtime)),this.rest=new PostgrestClient(`${ut}/rest/v1`,{headers:this.headers,schema:(lt=wt.db)===null||lt===void 0?void 0:lt.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new FunctionsClient(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new StorageClient(this.storageUrl,this.headers,this.fetch)}from(i){return this.rest.from(i)}schema(i){return this.rest.schema(i)}rpc(i,a={},d={}){return this.rest.rpc(i,a,d)}channel(i,a={config:{}}){return this.realtime.channel(i,a)}getChannels(){return this.realtime.getChannels()}removeChannel(i){return this.realtime.removeChannel(i)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var i,a;return __awaiter(this,void 0,void 0,function*(){const{data:d}=yield this.auth.getSession();return(a=(i=d.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:null})}_initSupabaseAuthClient({autoRefreshToken:i,persistSession:a,detectSessionInUrl:d,storage:g,storageKey:b,flowType:$,debug:tt},it,rt){var ot;const lt={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SupabaseAuthClient({url:this.authUrl,headers:Object.assign(Object.assign({},lt),it),storageKey:b,autoRefreshToken:i,persistSession:a,detectSessionInUrl:d,storage:g,flowType:$,debug:tt,fetch:rt,hasCustomAuthorizationHeader:(ot="Authorization"in this.headers)!==null&&ot!==void 0?ot:!1})}_initRealtimeClient(i){return new RealtimeClient(this.realtimeUrl,Object.assign(Object.assign({},i),{params:Object.assign({apikey:this.supabaseKey},i==null?void 0:i.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,d)=>{this._handleTokenChanged(a,"CLIENT",d==null?void 0:d.access_token)})}_handleTokenChanged(i,a,d){(i==="TOKEN_REFRESHED"||i==="SIGNED_IN")&&this.changedAccessToken!==d?(this.realtime.setAuth(d??null),this.changedAccessToken=d):i==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),a=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const createClient=(s,i,a)=>new SupabaseClient(s,i,a),supabaseURL="https://iwafpiddqcbmlatthyme.supabase.co",supabaseAnonKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml3YWZwaWRkcWNibWxhdHRoeW1lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTYyMzUyNTIsImV4cCI6MjAzMTgxMTI1Mn0.mRuZQyyo6TC-hytA3weEssed_ujYCgh6GEswR8g7mEY",supabase=createClient(supabaseURL,supabaseAnonKey);var mathjax3React_umd={exports:{}};(function(s,i){(function(a,d){d(i,jsxRuntimeExports,reactExports)})(commonjsGlobal,function(a,d,g){const b={url:"",attrs:{},inBody:!1,insertInto:null,removeScript:!1};function $(wt){return Array.isArray(wt)?Promise.all(wt.map($)):new Promise((vt,ht)=>{if(!(typeof wt=="object"&&wt.url||typeof wt=="string"))return console.log({config:wt}),void ht(new Error("Object with url or url string needed"));const ft=Object.assign({},b,typeof wt=="string"?{url:wt}:wt),{url:mt,attrs:bt,inBody:Et,insertInto:It,removeScript:Ot}=ft,jt=document.createElement("script"),xt=It?document.querySelector(It):Et?document.body:document.head;if(bt&&typeof bt=="object")for(const Lt of Object.keys(bt))jt.setAttribute(Lt,bt[Lt]);xt!=null?(jt.addEventListener("load",()=>{Ot&&xt.removeChild(jt),vt(Ot?void 0:jt)}),jt.addEventListener("error",()=>{Ot&&xt.removeChild(jt),ht(new Error("Loading script error"))}),jt.src=mt,xt.appendChild(jt)):ht(new Error("No DOM element to append script"))})}const tt=g.createContext({}),it=wt=>{const vt=wt.url||ot,ht=wt.options||rt,[ft,mt]=g.useState(ht);window.MathJax=ft,g.useEffect(()=>{$(vt).then(bt).catch(Et)},[vt]);function bt(){mt(window.MathJax)}function Et(It){console.log(It)}return d.jsx(tt.Provider,{value:ft,...wt})},rt={},ot="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js",lt=()=>g.useContext(tt),ut=()=>{const wt=lt();function vt(ft=()=>{}){!wt||typeof wt.typesetPromise!="function"||wt.typesetPromise().then(ft).catch(mt=>{ht(mt)||console.log(mt)})}function ht(ft){return ft instanceof TypeError}return[wt,vt]};function pt({formula:wt}){const[vt,ht]=ut();return g.useEffect(()=>{ht()}),vt?d.jsx("div",{children:wt}):d.jsx(d.Fragment,{})}function _t({html:wt,onFinishRender:vt}){const[ht,ft]=ut();return g.useEffect(()=>{ht&&ft(vt)},[ht,ft,vt]),ht?d.jsx("div",{dangerouslySetInnerHTML:{__html:wt}}):d.jsx(d.Fragment,{})}a.MathJaxFormula=pt,a.MathJaxHtml=_t,a.MathJaxProvider=it,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})})(mathjax3React_umd,mathjax3React_umd.exports);var mathjax3React_umdExports=mathjax3React_umd.exports;function QuestionCard(s){const i=s.item,[a,d]=reactExports.useState(),[g,b]=reactExports.useState(),[$,tt]=reactExports.useState(),[it,rt]=reactExports.useState(),[ot,lt]=reactExports.useState(),[ut,pt]=reactExports.useState(),[_t,wt]=reactExports.useState(),[vt,ht]=reactExports.useState(),[ft,mt]=reactExports.useState(),[bt,Et]=reactExports.useState(),[It,Ot]=reactExports.useState(!1),jt=()=>Ot(!0),xt=()=>Ot(!1);async function Lt(Yt){try{const{data:$n,error:$t}=await supabase.from("questions").delete().eq("id",i.id);if($t)throw $t;window.location.reload()}catch($n){console.log($n)}}async function qt(){try{const{data:Yt,error:$n}=await supabase.from("questions").update({subject:vt,question:a,type:bt,option1:$,option2:it,option3:ot,option4:ut,correct:_t,explanation:ft,tags:g}).eq("id",i.id);if($n)throw $n;window.location=window.location,xt()}catch(Yt){console.log(Yt)}}return jsxRuntimeExports.jsx(mathjax3React_umdExports.MathJaxProvider,{children:jsxRuntimeExports.jsx("div",{className:"card w-full bg-base-100 shadow-xl",children:jsxRuntimeExports.jsxs("div",{className:"card-body",children:[jsxRuntimeExports.jsxs("div",{className:"card-actions justify-end",children:[jsxRuntimeExports.jsx("div",{className:"badge badge-neutral",children:i.type||"Type of Question"}),jsxRuntimeExports.jsx("div",{className:"badge badge-neutral",children:i.tags||"Subject"}),jsxRuntimeExports.jsx("div",{className:"badge badge-neutral",children:i.subject||"Subject"}),jsxRuntimeExports.jsx("button",{className:"btn btn-square btn-sm",onClick:Yt=>{Lt(i.id)},children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6",children:jsxRuntimeExports.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})})}),jsxRuntimeExports.jsx("button",{className:"btn btn-square btn-sm",onClick:()=>{jt(),openUpdate(items)},children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6",children:jsxRuntimeExports.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{children:jsxRuntimeExports.jsx(mathjax3React_umdExports.MathJaxHtml,{html:i.question})||"question"}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{children:"Option 1:"})," ",jsxRuntimeExports.jsx("span",{children:jsxRuntimeExports.jsx(mathjax3React_umdExports.MathJaxHtml,{html:i.option1})||"op"})]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{children:"Option 2:"})," ",jsxRuntimeExports.jsx("span",{children:jsxRuntimeExports.jsx(mathjax3React_umdExports.MathJaxHtml,{html:i.option2})||"op"})]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{children:"Option 3:"})," ",jsxRuntimeExports.jsx("span",{children:jsxRuntimeExports.jsx(mathjax3React_umdExports.MathJaxHtml,{html:i.option3})||"op"})]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{children:"Option 4:"})," ",jsxRuntimeExports.jsx("span",{children:jsxRuntimeExports.jsx(mathjax3React_umdExports.MathJaxHtml,{html:i.option4})||"op"})]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{children:"Correct:"})," ",jsxRuntimeExports.jsx("span",{children:i.correct||"correct"})]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{children:"Explanation"})," ",jsxRuntimeExports.jsx("span",{children:jsxRuntimeExports.jsx(mathjax3React_umdExports.MathJaxHtml,{html:i.explanation})||"correct"})]})]}),jsxRuntimeExports.jsx("dialog",{className:It?"modal modal-open":" modal",children:jsxRuntimeExports.jsxs("div",{className:"modal-box flex flex-col max-w-[48rem] ",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between  ",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold my-2 text-lg ",children:"Add new question here"}),jsxRuntimeExports.jsx("div",{className:"modal-action -mt-1 ",children:jsxRuntimeExports.jsx("button",{onClick:()=>{xt()},className:"btn btn-square btn-sm",children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})})]}),jsxRuntimeExports.jsxs("div",{className:" flex flex-col gap-3",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{className:"flex-wrap md:flex-row gap-2",children:jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["Tags",jsxRuntimeExports.jsx("input",{type:"text",onChange:Yt=>b(Yt.target.value),className:"grow",required:!0,defaultValue:i.tags})]})})}),jsxRuntimeExports.jsxs("label",{className:"form-control w-full max-w-xs",children:[jsxRuntimeExports.jsx("div",{className:"label",children:jsxRuntimeExports.jsx("span",{className:"label-text",children:"Type of Question"})}),jsxRuntimeExports.jsxs("select",{className:"select select-bordered",required:!0,onChange:Yt=>{Et(Yt.target.value)},defaultValue:i.type,children:[jsxRuntimeExports.jsx("option",{disabled:!0,selected:!0,children:"Pick one"}),jsxRuntimeExports.jsx("option",{children:"Single Correct"}),jsxRuntimeExports.jsx("option",{children:"Multiple Correct"}),jsxRuntimeExports.jsx("option",{children:"Numerical/Fill in the Blanks"}),jsxRuntimeExports.jsx("option",{children:"Subjective"})]})]}),jsxRuntimeExports.jsxs("label",{className:"form-control w-full max-w-xs",children:[jsxRuntimeExports.jsx("div",{className:"label",children:jsxRuntimeExports.jsx("span",{className:"label-text",children:"Subject"})}),jsxRuntimeExports.jsxs("select",{className:"select select-bordered mb-2",required:!0,onChange:Yt=>{ht(Yt.target.value)},defaultValue:i.subject,children:[jsxRuntimeExports.jsx("option",{disabled:!0,selected:!0,children:"Pick one"}),jsxRuntimeExports.jsx("option",{children:"Physics"}),jsxRuntimeExports.jsx("option",{children:"Chemistry"}),jsxRuntimeExports.jsx("option",{children:"Maths"}),jsxRuntimeExports.jsx("option",{children:"Bio"})]})]}),jsxRuntimeExports.jsx("textarea",{className:"textarea w-full input-bordered",placeholder:a,defaultValue:i.question,onChange:Yt=>{d(Yt.target.value)}}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP1",jsxRuntimeExports.jsx("input",{type:"text",onChange:Yt=>tt(Yt.target.value),className:"grow",defaultValue:i.option1,placeholder:"Option 1"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:Yt=>{wt("op1")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP2",jsxRuntimeExports.jsx("input",{type:"text",onChange:Yt=>rt(Yt.target.value),className:"grow",defaultValue:i.option2,placeholder:"Option 2"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:Yt=>{wt("op2")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP3",jsxRuntimeExports.jsx("input",{type:"text",onChange:Yt=>lt(Yt.target.value),className:"grow",defaultValue:i.option3,placeholder:"Option 3"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:Yt=>{wt("op3")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP4",jsxRuntimeExports.jsx("input",{type:"text",onChange:Yt=>pt(Yt.target.value),className:"grow",defaultValue:i.option4,placeholder:"Option 4"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:Yt=>{wt("op4")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["Correct",jsxRuntimeExports.jsx("input",{type:"text",onChange:Yt=>pt(Yt.target.value),className:"grow",defaultValue:i.correct,placeholder:"Option 4",required:!0})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["Explanation",jsxRuntimeExports.jsx("input",{type:"text",onChange:Yt=>mt(Yt.target.value),className:"grow",defaultValue:i.explanation,placeholder:"Explanation",required:!0})]}),jsxRuntimeExports.jsx(Editor,{})]}),jsxRuntimeExports.jsx("button",{className:"btn mt-2",onClick:Yt=>{qt()},children:a?"Subbmit":"Close"})]})})]})})})}var alert$3=!1;function Mains(){const[s,i]=reactExports.useState(),[a,d]=reactExports.useState(),[g,b]=reactExports.useState(!1),[$,tt]=reactExports.useState(),[it,rt]=reactExports.useState(),[ot,lt]=reactExports.useState(),[ut,pt]=reactExports.useState(),[_t,wt]=reactExports.useState();reactExports.useState("");const[vt,ht]=reactExports.useState(),[ft,mt]=reactExports.useState(),[bt,Et]=reactExports.useState([]);reactExports.useState([]);function It(){alert$3=!alert$3}function Ot(){!it||!ot||!ut||!_t?It():mt("Success")}const jt=()=>{const xt=uid(),Lt=ref(db,"mains/"+s+"/"+a+"/"+xt);console.log(Lt),set$1(Lt,{question:$,op1:it,op2:ot,op3:ut,op4:_t,correct:vt,uid:xt}).then(qt=>{console.log("success")}).catch(qt=>{console.log(qt)})};return reactExports.useEffect(()=>{(async()=>{const Lt=ref(db,"mains/"+s+"/"+a);Lt&&onValue(Lt,qt=>{if(qt){const Yt=qt.val();Et(Yt)}},qt=>{console.error("Error fetching data:",qt)})})().then(Lt=>{console.log(Object.values(bt))}).catch(Lt=>{console.log(Lt)})},[s,a]),jsxRuntimeExports.jsxs("div",{className:"mx-8",children:[jsxRuntimeExports.jsx("h1",{className:"w-full text-center text-xl sm:text-lg",children:"Jee Mains"}),jsxRuntimeExports.jsxs("div",{role:"alert",className:"alert alert-errorn "+(alert$3?"show":"hidden"),children:[jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),jsxRuntimeExports.jsx("span",{children:"All fields must be filled!!."}),jsxRuntimeExports.jsx("button",{className:"btn btn-sm",onClick:xt=>{It()},children:"Close"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row justify-between",children:[jsxRuntimeExports.jsxs("details",{role:"button",open:g,className:"dropdown dropdown-start  mr-8",children:[jsxRuntimeExports.jsx("summary",{className:"m-1 ",children:s||"Year"}),jsxRuntimeExports.jsxs("ul",{className:"p-2 shadow menu dropdown-content gap-1 z-[1] bg-base-100 rounded-box w-52",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2020"),b(!1)},children:"2020"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2021"),b(!1)},children:"2021"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2022"),b(!1)},children:"2022"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2023"),b(!1)},children:"2023"})})]})]}),jsxRuntimeExports.jsxs("details",{role:"button",className:"dropdown dropdown-start  mr-8",children:[jsxRuntimeExports.jsx("summary",{className:"m-1 ",children:a||"Subject"}),jsxRuntimeExports.jsxs("ul",{className:"p-2 shadow menu dropdown-content gap-1 z-[1] bg-base-100 rounded-box w-52",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),d("Phy")},children:"Phy"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),d("Chem")},children:"chem"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),d("maths")},children:"maths"})})]})]}),jsxRuntimeExports.jsx("button",{className:s&&a?"show btn":"hidden",onClick:()=>document.getElementById("my_modal_1").showModal(),children:"Add new Question"})]}),jsxRuntimeExports.jsx("dialog",{id:"my_modal_1",className:"modal",children:jsxRuntimeExports.jsxs("div",{className:"modal-box flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold my-2 text-lg ",children:"Add new question here"}),jsxRuntimeExports.jsx("div",{className:"modal-action -mt-1 ",children:jsxRuntimeExports.jsx("form",{method:"dialog",children:jsxRuntimeExports.jsx("button",{className:"btn btn-square btn-sm",children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})})})]}),jsxRuntimeExports.jsxs("div",{className:" flex flex-col gap-3",children:[jsxRuntimeExports.jsx("textarea",{className:"textarea w-full input-bordered",placeholder:"Question",onChange:xt=>{tt(xt.target.value)}}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP1",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>rt(xt.target.value),className:"grow",placeholder:"Option 1"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op1")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP2",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>lt(xt.target.value),className:"grow",placeholder:"Option 2"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op2")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP3",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>pt(xt.target.value),className:"grow",placeholder:"Option 3"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op3")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP4",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>wt(xt.target.value),className:"grow",placeholder:"Option 4"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op4")},name:"radio-1",className:"radio"})]})]}),jsxRuntimeExports.jsx("button",{className:"btn mt-2",onClick:xt=>{console.log($),$&&Ot(),jt()},children:$?"Subbmit":"Close"})]})}),jsxRuntimeExports.jsx("div",{children:bt&&Object.values(bt).map(xt=>jsxRuntimeExports.jsx(Question,{item:xt,year:s,sub:a,exam:"mains"}))})]})}var alert$2=!1;function Advance(){const[s,i]=reactExports.useState(),[a,d]=reactExports.useState(),[g,b]=reactExports.useState(!1),[$,tt]=reactExports.useState(),[it,rt]=reactExports.useState(),[ot,lt]=reactExports.useState(),[ut,pt]=reactExports.useState(),[_t,wt]=reactExports.useState();reactExports.useState("");const[vt,ht]=reactExports.useState(),[ft,mt]=reactExports.useState(),[bt,Et]=reactExports.useState([]);reactExports.useState([]);function It(){alert$2=!alert$2}function Ot(){!it||!ot||!ut||!_t?It():mt("Success")}const jt=()=>{const xt=uid(),Lt=ref(db,"advance/"+s+"/"+a+"/"+xt);console.log(Lt),set$1(Lt,{question:$,op1:it,op2:ot,op3:ut,op4:_t,correct:vt,uid:xt}).then(qt=>{console.log("success")}).catch(qt=>{console.log(qt)})};return reactExports.useEffect(()=>{(async()=>{const Lt=ref(db,"advance/"+s+"/"+a);Lt&&onValue(Lt,qt=>{if(qt){const Yt=qt.val();Et(Yt)}},qt=>{console.error("Error fetching data:",qt)})})().then(Lt=>{console.log(Object.values(bt))}).catch(Lt=>{console.log(Lt)})},[s,a]),jsxRuntimeExports.jsxs("div",{className:"mx-8",children:[jsxRuntimeExports.jsx("h1",{className:"w-full text-center text-xl sm:text-lg",children:"Jee Advance"}),jsxRuntimeExports.jsxs("div",{role:"alert",className:"alert alert-errorn "+(alert$2?"show":"hidden"),children:[jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),jsxRuntimeExports.jsx("span",{children:"All fields must be filled!!."}),jsxRuntimeExports.jsx("button",{className:"btn btn-sm",onClick:xt=>{It()},children:"Close"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row justify-between",children:[jsxRuntimeExports.jsxs("details",{role:"button",open:g,className:"dropdown dropdown-start  mr-8",children:[jsxRuntimeExports.jsx("summary",{className:"m-1 ",children:s||"Year"}),jsxRuntimeExports.jsxs("ul",{className:"p-2 shadow menu dropdown-content gap-1 z-[1] bg-base-100 rounded-box w-52",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2020"),b(!1)},children:"2020"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2021"),b(!1)},children:"2021"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2022"),b(!1)},children:"2022"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2023"),b(!1)},children:"2023"})})]})]}),jsxRuntimeExports.jsxs("details",{role:"button",className:"dropdown dropdown-start  mr-8",children:[jsxRuntimeExports.jsx("summary",{className:"m-1 ",children:a||"Subject"}),jsxRuntimeExports.jsxs("ul",{className:"p-2 shadow menu dropdown-content gap-1 z-[1] bg-base-100 rounded-box w-52",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),d("Phy")},children:"Phy"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),d("Chem")},children:"chem"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),d("maths")},children:"maths"})})]})]}),jsxRuntimeExports.jsx("button",{className:s&&a?"show btn":"hidden",onClick:()=>document.getElementById("my_modal_1").showModal(),children:"Add new Question"})]}),jsxRuntimeExports.jsx("dialog",{id:"my_modal_1",className:"modal",children:jsxRuntimeExports.jsxs("div",{className:"modal-box flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold my-2 text-lg ",children:"Add new question here"}),jsxRuntimeExports.jsx("div",{className:"modal-action -mt-1 ",children:jsxRuntimeExports.jsx("form",{method:"dialog",children:jsxRuntimeExports.jsx("button",{className:"btn btn-square btn-sm",children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})})})]}),jsxRuntimeExports.jsxs("div",{className:" flex flex-col gap-3",children:[jsxRuntimeExports.jsx("textarea",{className:"textarea w-full input-bordered",placeholder:"Question",onChange:xt=>{tt(xt.target.value)}}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP1",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>rt(xt.target.value),className:"grow",placeholder:"Option 1"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op1")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP2",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>lt(xt.target.value),className:"grow",placeholder:"Option 2"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op2")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP3",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>pt(xt.target.value),className:"grow",placeholder:"Option 3"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op3")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP4",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>wt(xt.target.value),className:"grow",placeholder:"Option 4"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op4")},name:"radio-1",className:"radio"})]})]}),jsxRuntimeExports.jsx("button",{className:"btn mt-2",onClick:xt=>{console.log($),$&&Ot(),jt()},children:$?"Subbmit":"Close"})]})}),jsxRuntimeExports.jsx("div",{children:bt&&Object.values(bt).map(xt=>jsxRuntimeExports.jsx(Question,{item:xt,year:s,sub:a,exam:"advance"}))})]})}var alert$1=!1;function Neet(){const[s,i]=reactExports.useState(),[a,d]=reactExports.useState(),[g,b]=reactExports.useState(!1),[$,tt]=reactExports.useState(),[it,rt]=reactExports.useState(),[ot,lt]=reactExports.useState(),[ut,pt]=reactExports.useState(),[_t,wt]=reactExports.useState();reactExports.useState("");const[vt,ht]=reactExports.useState(),[ft,mt]=reactExports.useState(),[bt,Et]=reactExports.useState([]);reactExports.useState([]);function It(){alert$1=!alert$1}function Ot(){!it||!ot||!ut||!_t?It():mt("Success")}const jt=()=>{const xt=uid(),Lt=ref(db,"neet/"+s+"/"+a+"/"+xt);console.log(Lt),set$1(Lt,{question:$,op1:it,op2:ot,op3:ut,op4:_t,correct:vt,uid:xt}).then(qt=>{console.log("success")}).catch(qt=>{console.log(qt)})};return reactExports.useEffect(()=>{(async()=>{const Lt=ref(db,"neet/"+s+"/"+a);Lt&&onValue(Lt,qt=>{if(qt){const Yt=qt.val();Et(Yt)}},qt=>{console.error("Error fetching data:",qt)})})().then(Lt=>{console.log(Object.values(bt))}).catch(Lt=>{console.log(Lt)})},[s,a]),jsxRuntimeExports.jsxs("div",{className:"mx-8",children:[jsxRuntimeExports.jsx("h1",{className:"w-full text-center text-xl sm:text-lg",children:"NEET"}),jsxRuntimeExports.jsxs("div",{role:"alert",className:"alert alert-errorn "+(alert$1?"show":"hidden"),children:[jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),jsxRuntimeExports.jsx("span",{children:"All fields must be filled!!."}),jsxRuntimeExports.jsx("button",{className:"btn btn-sm",onClick:xt=>{It()},children:"Close"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row justify-between",children:[jsxRuntimeExports.jsxs("details",{role:"button",open:g,className:"dropdown dropdown-start  mr-8",children:[jsxRuntimeExports.jsx("summary",{className:"m-1 ",children:s||"Year"}),jsxRuntimeExports.jsxs("ul",{className:"p-2 shadow menu dropdown-content gap-1 z-[1] bg-base-100 rounded-box w-52",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2020"),b(!1)},children:"2020"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2021"),b(!1)},children:"2021"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2022"),b(!1)},children:"2022"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),i("2023"),b(!1)},children:"2023"})})]})]}),jsxRuntimeExports.jsxs("details",{role:"button",className:"dropdown dropdown-start  mr-8",children:[jsxRuntimeExports.jsx("summary",{className:"m-1 ",children:a||"Subject"}),jsxRuntimeExports.jsxs("ul",{className:"p-2 shadow menu dropdown-content gap-1 z-[1] bg-base-100 rounded-box w-52",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),d("Phy")},children:"Phy"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),d("Chem")},children:"chem"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:xt=>{xt.preventDefault(),d("bio")},children:"bio"})})]})]}),jsxRuntimeExports.jsx("button",{className:s&&a?"show btn":"hidden",onClick:()=>document.getElementById("my_modal_1").showModal(),children:"Add new Question"})]}),jsxRuntimeExports.jsx("dialog",{id:"my_modal_1",className:"modal",children:jsxRuntimeExports.jsxs("div",{className:"modal-box flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold my-2 text-lg ",children:"Add new question here"}),jsxRuntimeExports.jsx("div",{className:"modal-action -mt-1 ",children:jsxRuntimeExports.jsx("form",{method:"dialog",children:jsxRuntimeExports.jsx("button",{className:"btn btn-square btn-sm",children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})})})]}),jsxRuntimeExports.jsxs("div",{className:" flex flex-col gap-3",children:[jsxRuntimeExports.jsx("textarea",{className:"textarea w-full input-bordered",placeholder:"Question",onChange:xt=>{tt(xt.target.value)}}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP1",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>rt(xt.target.value),className:"grow",placeholder:"Option 1"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op1")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP2",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>lt(xt.target.value),className:"grow",placeholder:"Option 2"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op2")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP3",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>pt(xt.target.value),className:"grow",placeholder:"Option 3"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op3")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP4",jsxRuntimeExports.jsx("input",{type:"text",onChange:xt=>wt(xt.target.value),className:"grow",placeholder:"Option 4"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:xt=>{ht("op4")},name:"radio-1",className:"radio"})]})]}),jsxRuntimeExports.jsx("button",{className:"btn mt-2",onClick:xt=>{console.log($),$&&Ot(),jt()},children:$?"Subbmit":"Close"})]})}),jsxRuntimeExports.jsx("div",{children:bt&&Object.values(bt).map(xt=>jsxRuntimeExports.jsx(Question,{item:xt,year:s,sub:a,exam:"neet"}))})]})}var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(s){(function(){var i={}.hasOwnProperty;function a(){for(var b="",$=0;$<arguments.length;$++){var tt=arguments[$];tt&&(b=g(b,d(tt)))}return b}function d(b){if(typeof b=="string"||typeof b=="number")return b;if(typeof b!="object")return"";if(Array.isArray(b))return a.apply(null,b);if(b.toString!==Object.prototype.toString&&!b.toString.toString().includes("[native code]"))return b.toString();var $="";for(var tt in b)i.call(b,tt)&&b[tt]&&($=g($,tt));return $}function g(b,$){return $?b?b+" "+$:b+$:b}s.exports?(a.default=a,s.exports=a):window.classNames=a})()})(classnames);if(typeof window<"u"){var passiveTestOptions={get passive(){}};window.addEventListener("testPassive",null,passiveTestOptions),window.removeEventListener("testPassive",null,passiveTestOptions)}function Questions(){const[s,i]=reactExports.useState([]),[a,d]=reactExports.useState(),[g,b]=reactExports.useState(),[$,tt]=reactExports.useState(!1),[it,rt]=reactExports.useState(),[ot,lt]=reactExports.useState(),[ut,pt]=reactExports.useState(),[_t,wt]=reactExports.useState(),[vt,ht]=reactExports.useState(),[ft,mt]=reactExports.useState(),[bt,Et]=reactExports.useState(),[It,Ot]=reactExports.useState(),[jt,xt]=reactExports.useState(),[Lt,qt]=reactExports.useState(),[Yt,$n]=reactExports.useState(),[$t,Rt]=reactExports.useState(!1);reactExports.useState(!0),reactExports.useState(!0),reactExports.useState(!0);const Dt=()=>Rt(!0),Vt=()=>Rt(!1);async function St(){try{const{data:Pt,error:Gt}=await supabase.from("questions").insert({subject:It,question:it,type:Yt,option1:ut,option2:_t,option3:vt,option4:ft,correct:bt,explanation:Lt,tags:ot}).single();if(Gt)throw Gt;window.location.reload()}catch(Pt){console.log(Pt)}}reactExports.useEffect(()=>{Bt()},[]);async function Bt(){try{const{data:Pt,error:Gt}=await supabase.from("questions").select("*").limit(30);if(Gt)throw Gt;Pt!=null&&i(Pt)}catch{}}return jsxRuntimeExports.jsxs("div",{className:"mx-8",children:[jsxRuntimeExports.jsx("h1",{className:"w-full text-center text-xl sm:text-lg",children:"Jee Mains"}),jsxRuntimeExports.jsxs("div",{role:"alert",className:"alert alert-errorn "+(jt?"show":"hidden"),children:[jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),jsxRuntimeExports.jsx("span",{children:"All fields must be filled!!."}),jsxRuntimeExports.jsx("button",{className:"btn btn-sm",onClick:Pt=>{xt()},children:"Close"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row justify-between",children:[jsxRuntimeExports.jsxs("details",{role:"button",open:$,className:"dropdown dropdown-start  mr-8",children:[jsxRuntimeExports.jsx("summary",{className:"m-1 ",children:a||"Year"}),jsxRuntimeExports.jsxs("ul",{className:"p-2 shadow menu dropdown-content gap-1 z-[1] bg-base-100 rounded-box w-52",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:Pt=>{Pt.preventDefault(),d("2020"),tt(!1)},children:"2020"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:Pt=>{Pt.preventDefault(),d("2021"),tt(!1)},children:"2021"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:Pt=>{Pt.preventDefault(),d("2022"),tt(!1)},children:"2022"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:Pt=>{Pt.preventDefault(),d("2023"),tt(!1)},children:"2023"})})]})]}),jsxRuntimeExports.jsxs("details",{role:"button",className:"dropdown dropdown-start  mr-8",children:[jsxRuntimeExports.jsx("summary",{className:"m-1 ",children:g||"Subject"}),jsxRuntimeExports.jsxs("ul",{className:"p-2 shadow menu dropdown-content gap-1 z-[1] bg-base-100 rounded-box w-52",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:Pt=>{Pt.preventDefault(),b("Phy")},children:"Phy"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:Pt=>{Pt.preventDefault(),b("Chem")},children:"chem"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{onClick:Pt=>{Pt.preventDefault(),b("maths")},children:"maths"})})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>Dt(),children:"Add new Question"})]}),jsxRuntimeExports.jsx("dialog",{className:$t?"modal modal-open":" modal",children:jsxRuntimeExports.jsxs("div",{className:"modal-box flex flex-col max-w-[48rem] ",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between  ",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold my-2 text-lg ",children:"Add new question here"}),jsxRuntimeExports.jsx("div",{className:"modal-action -mt-1 ",children:jsxRuntimeExports.jsx("button",{onClick:()=>{Vt(),console.log($t)},className:"btn btn-square btn-sm",children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})})]}),jsxRuntimeExports.jsxs("div",{className:" flex flex-col gap-3",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{className:"flex-wrap md:flex-row gap-2",children:jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["Tags",jsxRuntimeExports.jsx("input",{type:"text",onChange:Pt=>lt(Pt.target.value),className:"grow",required:!0})]})})}),jsxRuntimeExports.jsxs("label",{className:"form-control w-full max-w-xs",children:[jsxRuntimeExports.jsx("div",{className:"label",children:jsxRuntimeExports.jsx("span",{className:"label-text",children:"Type of Question"})}),jsxRuntimeExports.jsxs("select",{className:"select select-bordered",required:!0,onChange:Pt=>{$n(Pt.target.value),console.log(Yt)},children:[jsxRuntimeExports.jsx("option",{disabled:!0,selected:!0,children:"Pick one"}),jsxRuntimeExports.jsx("option",{children:"Single Correct"}),jsxRuntimeExports.jsx("option",{children:"Multiple Correct"}),jsxRuntimeExports.jsx("option",{children:"Numerical/Fill in the Blanks"}),jsxRuntimeExports.jsx("option",{children:"Subjective"})]})]}),jsxRuntimeExports.jsxs("label",{className:"form-control w-full max-w-xs",children:[jsxRuntimeExports.jsx("div",{className:"label",children:jsxRuntimeExports.jsx("span",{className:"label-text",children:"Subject"})}),jsxRuntimeExports.jsxs("select",{className:"select select-bordered mb-2",required:!0,onChange:Pt=>{Ot(Pt.target.value)},children:[jsxRuntimeExports.jsx("option",{disabled:!0,selected:!0,children:"Pick one"}),jsxRuntimeExports.jsx("option",{children:"Physics"}),jsxRuntimeExports.jsx("option",{children:"Chemistry"}),jsxRuntimeExports.jsx("option",{children:"Maths"}),jsxRuntimeExports.jsx("option",{children:"Bio"})]})]}),jsxRuntimeExports.jsx("textarea",{className:"textarea w-full input-bordered",placeholder:it,onChange:Pt=>{rt(Pt.target.value)}}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP1",jsxRuntimeExports.jsx("input",{type:"text",onChange:Pt=>pt(Pt.target.value),className:"grow",placeholder:"Option 1"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:Pt=>{Et("op1")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP2",jsxRuntimeExports.jsx("input",{type:"text",onChange:Pt=>wt(Pt.target.value),className:"grow",placeholder:"Option 2"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:Pt=>{Et("op2")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP3",jsxRuntimeExports.jsx("input",{type:"text",onChange:Pt=>ht(Pt.target.value),className:"grow",placeholder:"Option 3"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:Pt=>{Et("op3")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["OP4",jsxRuntimeExports.jsx("input",{type:"text",onChange:Pt=>mt(Pt.target.value),className:"grow",placeholder:"Option 4"}),jsxRuntimeExports.jsx("input",{type:"radio",onChange:Pt=>{Et("op4")},name:"radio-1",className:"radio"})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["Correct",jsxRuntimeExports.jsx("input",{type:"text",onChange:Pt=>mt(Pt.target.value),className:"grow",placeholder:"Option 4",required:!0})]}),jsxRuntimeExports.jsxs("label",{className:"input input-bordered flex items-center gap-2",children:["Explanation",jsxRuntimeExports.jsx("input",{type:"text",onChange:Pt=>qt(Pt.target.value),className:"grow",placeholder:"Explanation",required:!0})]}),jsxRuntimeExports.jsx(Editor,{})]}),jsxRuntimeExports.jsx("button",{className:"btn mt-2",onClick:Pt=>{console.log(it),St()},children:it?"Subbmit":"Close"})]})}),jsxRuntimeExports.jsx("div",{children:s.map(Pt=>jsxRuntimeExports.jsx(QuestionCard,{item:Pt}))})]})}class Latex extends React.Component{constructor(i){super(i),this.node=React.createRef()}componentDidMount(){this.renderMath()}componentDidUpdate(){this.renderMath()}renderMath(){MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.node.current])}render(){return this.props,jsxRuntimeExports.jsxs("div",{ref:this.node,children:[this.props.children," "]})}}function App(){return reactExports.useState(0),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Navbar,{}),jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{exact:!0,path:"/",element:jsxRuntimeExports.jsx(Exam,{})}),jsxRuntimeExports.jsx(Route,{exact:!0,path:"/year",element:jsxRuntimeExports.jsx(Year,{})}),jsxRuntimeExports.jsx(Route,{exact:!0,path:"/mains",element:jsxRuntimeExports.jsx(Mains,{})}),jsxRuntimeExports.jsx(Route,{exact:!0,path:"/advance",element:jsxRuntimeExports.jsx(Advance,{})}),jsxRuntimeExports.jsx(Route,{exact:!0,path:"/neet",element:jsxRuntimeExports.jsx(Neet,{})}),jsxRuntimeExports.jsx(Route,{exact:!0,path:"/questions",element:jsxRuntimeExports.jsx(Questions,{})})]})]})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(App,{})})}));export{getDefaultExportFromCjs as g};
